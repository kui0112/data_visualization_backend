var NF=Object.defineProperty;var o3=n=>{throw TypeError(n)};var RF=(n,e,t)=>e in n?NF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var A=(n,e,t)=>RF(n,typeof e!="symbol"?e+"":e,t),V0=(n,e,t)=>e.has(n)||o3("Cannot "+t);var Fr=(n,e,t)=>(V0(n,e,"read from private field"),t?t.call(n):e.get(n)),W0=(n,e,t)=>e.has(n)?o3("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Vh=(n,e,t,r)=>(V0(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),H0=(n,e,t)=>(V0(n,e,"access private method"),t);import{w as kF,c as DF,k as LF,a as IF}from"./Service-kX-x3XrH.js";import{g as ah,a as Zr,c as jt,d as BF,r as FF,u as $F,o as zF,b as jF,e as qF,f as GF,h as VF,_ as WF}from"./index-CVbE00YX.js";const _o=(n,e=0,t=1)=>_2(O2(e,n),t),S2=n=>{n._clipped=!1,n._unclipped=n.slice(0);for(let e=0;e<=3;e++)e<3?((n[e]<0||n[e]>255)&&(n._clipped=!0),n[e]=_o(n[e],0,255)):e===3&&(n[e]=_o(n[e],0,1));return n},Rk={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Rk[`[object ${n}]`]=n.toLowerCase();function kt(n){return Rk[Object.prototype.toString.call(n)]||"object"}const Dt=(n,e=null)=>n.length>=3?Array.prototype.slice.call(n):kt(n[0])=="object"&&e?e.split("").filter(t=>n[0][t]!==void 0).map(t=>n[0][t]):n[0],ag=n=>{if(n.length<2)return null;const e=n.length-1;return kt(n[e])=="string"?n[e].toLowerCase():null},{PI:sg,min:_2,max:O2}=Math,ki=sg*2,U0=sg/3,HF=sg/180,UF=180/sg,_t={format:{},autodetect:[]};let it=class{constructor(...e){const t=this;if(kt(e[0])==="object"&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];let r=ag(e),i=!1;if(!r){i=!0,_t.sorted||(_t.autodetect=_t.autodetect.sort((a,s)=>s.p-a.p),_t.sorted=!0);for(let a of _t.autodetect)if(r=a.test(...e),r)break}if(_t.format[r]){const a=_t.format[r].apply(null,i?e:e.slice(0,-1));t._rgb=S2(a)}else throw new Error("unknown format: "+e);t._rgb.length===3&&t._rgb.push(1)}toString(){return kt(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}};const YF="2.6.1-0",Mt=(...n)=>new it(...n);Mt.version=YF;const KF=(...n)=>{n=Dt(n,"cmyk");const[e,t,r,i]=n,a=n.length>4?n[4]:1;return i===1?[0,0,0,a]:[e>=1?0:255*(1-e)*(1-i),t>=1?0:255*(1-t)*(1-i),r>=1?0:255*(1-r)*(1-i),a]},{max:c3}=Math,XF=(...n)=>{let[e,t,r]=Dt(n,"rgb");e=e/255,t=t/255,r=r/255;const i=1-c3(e,c3(t,r)),a=i<1?1/(1-i):0,s=(1-e-i)*a,o=(1-t-i)*a,c=(1-r-i)*a;return[s,o,c,i]};it.prototype.cmyk=function(){return XF(this._rgb)};Mt.cmyk=(...n)=>new it(...n,"cmyk");_t.format.cmyk=KF;_t.autodetect.push({p:2,test:(...n)=>{if(n=Dt(n,"cmyk"),kt(n)==="array"&&n.length===4)return"cmyk"}});const Y0=n=>Math.round(n*100)/100,ZF=(...n)=>{const e=Dt(n,"hsla");let t=ag(n)||"lsa";return e[0]=Y0(e[0]||0),e[1]=Y0(e[1]*100)+"%",e[2]=Y0(e[2]*100)+"%",t==="hsla"||e.length>3&&e[3]<1?(e[3]=e.length>3?e[3]:1,t="hsla"):e.length=3,`${t}(${e.join(",")})`},kk=(...n)=>{n=Dt(n,"rgba");let[e,t,r]=n;e/=255,t/=255,r/=255;const i=_2(e,t,r),a=O2(e,t,r),s=(a+i)/2;let o,c;return a===i?(o=0,c=Number.NaN):o=s<.5?(a-i)/(a+i):(a-i)/(2-a-i),e==a?c=(t-r)/(a-i):t==a?c=2+(r-e)/(a-i):r==a&&(c=4+(e-t)/(a-i)),c*=60,c<0&&(c+=360),n.length>3&&n[3]!==void 0?[c,o,s,n[3]]:[c,o,s]},{round:K0}=Math,QF=(...n)=>{const e=Dt(n,"rgba");let t=ag(n)||"rgb";return t.substr(0,3)=="hsl"?ZF(kk(e),t):(e[0]=K0(e[0]),e[1]=K0(e[1]),e[2]=K0(e[2]),(t==="rgba"||e.length>3&&e[3]<1)&&(e[3]=e.length>3?e[3]:1,t="rgba"),`${t}(${e.slice(0,t==="rgb"?3:4).join(",")})`)},xx=(...n)=>{n=Dt(n,"hsl");const[e,t,r]=n;let i,a,s;if(t===0)i=a=s=r*255;else{const o=[0,0,0],c=[0,0,0],l=r<.5?r*(1+t):r+t-r*t,u=2*r-l,h=e/360;o[0]=h+1/3,o[1]=h,o[2]=h-1/3;for(let f=0;f<3;f++)o[f]<0&&(o[f]+=1),o[f]>1&&(o[f]-=1),6*o[f]<1?c[f]=u+(l-u)*6*o[f]:2*o[f]<1?c[f]=l:3*o[f]<2?c[f]=u+(l-u)*(2/3-o[f])*6:c[f]=u;[i,a,s]=[c[0]*255,c[1]*255,c[2]*255]}return n.length>3?[i,a,s,n[3]]:[i,a,s,1]},Dk=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,Lk=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Ik=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Bk=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Fk=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,$k=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:Wh}=Math,P2=n=>{n=n.toLowerCase().trim();let e;if(_t.format.named)try{return _t.format.named(n)}catch{}if(e=n.match(Dk)){const t=e.slice(1,4);for(let r=0;r<3;r++)t[r]=+t[r];return t[3]=1,t}if(e=n.match(Lk)){const t=e.slice(1,5);for(let r=0;r<4;r++)t[r]=+t[r];return t}if(e=n.match(Ik)){const t=e.slice(1,4);for(let r=0;r<3;r++)t[r]=Wh(t[r]*2.55);return t[3]=1,t}if(e=n.match(Bk)){const t=e.slice(1,5);for(let r=0;r<3;r++)t[r]=Wh(t[r]*2.55);return t[3]=+t[3],t}if(e=n.match(Fk)){const t=e.slice(1,4);t[1]*=.01,t[2]*=.01;const r=xx(t);for(let i=0;i<3;i++)r[i]=Wh(r[i]);return r[3]=1,r}if(e=n.match($k)){const t=e.slice(1,4);t[1]*=.01,t[2]*=.01;const r=xx(t);for(let i=0;i<3;i++)r[i]=Wh(r[i]);return r[3]=+e[4],r}};P2.test=n=>Dk.test(n)||Lk.test(n)||Ik.test(n)||Bk.test(n)||Fk.test(n)||$k.test(n);it.prototype.css=function(n){return QF(this._rgb,n)};Mt.css=(...n)=>new it(...n,"css");_t.format.css=P2;_t.autodetect.push({p:5,test:(n,...e)=>{if(!e.length&&kt(n)==="string"&&P2.test(n))return"css"}});_t.format.gl=(...n)=>{const e=Dt(n,"rgba");return e[0]*=255,e[1]*=255,e[2]*=255,e};Mt.gl=(...n)=>new it(...n,"gl");it.prototype.gl=function(){const n=this._rgb;return[n[0]/255,n[1]/255,n[2]/255,n[3]]};const{floor:JF}=Math,t$=(...n)=>{n=Dt(n,"hcg");let[e,t,r]=n,i,a,s;r=r*255;const o=t*255;if(t===0)i=a=s=r;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const c=JF(e),l=e-c,u=r*(1-t),h=u+o*(1-l),f=u+o*l,d=u+o;switch(c){case 0:[i,a,s]=[d,f,u];break;case 1:[i,a,s]=[h,d,u];break;case 2:[i,a,s]=[u,d,f];break;case 3:[i,a,s]=[u,h,d];break;case 4:[i,a,s]=[f,u,d];break;case 5:[i,a,s]=[d,u,h];break}}return[i,a,s,n.length>3?n[3]:1]},e$=(...n)=>{const[e,t,r]=Dt(n,"rgb"),i=_2(e,t,r),a=O2(e,t,r),s=a-i,o=s*100/255,c=i/(255-s)*100;let l;return s===0?l=Number.NaN:(e===a&&(l=(t-r)/s),t===a&&(l=2+(r-e)/s),r===a&&(l=4+(e-t)/s),l*=60,l<0&&(l+=360)),[l,o,c]};it.prototype.hcg=function(){return e$(this._rgb)};Mt.hcg=(...n)=>new it(...n,"hcg");_t.format.hcg=t$;_t.autodetect.push({p:1,test:(...n)=>{if(n=Dt(n,"hcg"),kt(n)==="array"&&n.length===3)return"hcg"}});const n$=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,r$=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,zk=n=>{if(n.match(n$)){(n.length===4||n.length===7)&&(n=n.substr(1)),n.length===3&&(n=n.split(""),n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);const e=parseInt(n,16),t=e>>16,r=e>>8&255,i=e&255;return[t,r,i,1]}if(n.match(r$)){(n.length===5||n.length===9)&&(n=n.substr(1)),n.length===4&&(n=n.split(""),n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]);const e=parseInt(n,16),t=e>>24&255,r=e>>16&255,i=e>>8&255,a=Math.round((e&255)/255*100)/100;return[t,r,i,a]}throw new Error(`unknown hex color: ${n}`)},{round:Hh}=Math,jk=(...n)=>{let[e,t,r,i]=Dt(n,"rgba"),a=ag(n)||"auto";i===void 0&&(i=1),a==="auto"&&(a=i<1?"rgba":"rgb"),e=Hh(e),t=Hh(t),r=Hh(r);let o="000000"+(e<<16|t<<8|r).toString(16);o=o.substr(o.length-6);let c="0"+Hh(i*255).toString(16);switch(c=c.substr(c.length-2),a.toLowerCase()){case"rgba":return`#${o}${c}`;case"argb":return`#${c}${o}`;default:return`#${o}`}};it.prototype.hex=function(n){return jk(this._rgb,n)};Mt.hex=(...n)=>new it(...n,"hex");_t.format.hex=zk;_t.autodetect.push({p:4,test:(n,...e)=>{if(!e.length&&kt(n)==="string"&&[3,4,5,6,7,8,9].indexOf(n.length)>=0)return"hex"}});const{cos:Js}=Math,i$=(...n)=>{n=Dt(n,"hsi");let[e,t,r]=n,i,a,s;return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e>360&&(e-=360),e<0&&(e+=360),e/=360,e<1/3?(s=(1-t)/3,i=(1+t*Js(ki*e)/Js(U0-ki*e))/3,a=1-(s+i)):e<2/3?(e-=1/3,i=(1-t)/3,a=(1+t*Js(ki*e)/Js(U0-ki*e))/3,s=1-(i+a)):(e-=2/3,a=(1-t)/3,s=(1+t*Js(ki*e)/Js(U0-ki*e))/3,i=1-(a+s)),i=_o(r*i*3),a=_o(r*a*3),s=_o(r*s*3),[i*255,a*255,s*255,n.length>3?n[3]:1]},{min:a$,sqrt:s$,acos:o$}=Math,c$=(...n)=>{let[e,t,r]=Dt(n,"rgb");e/=255,t/=255,r/=255;let i;const a=a$(e,t,r),s=(e+t+r)/3,o=s>0?1-a/s:0;return o===0?i=NaN:(i=(e-t+(e-r))/2,i/=s$((e-t)*(e-t)+(e-r)*(t-r)),i=o$(i),r>t&&(i=ki-i),i/=ki),[i*360,o,s]};it.prototype.hsi=function(){return c$(this._rgb)};Mt.hsi=(...n)=>new it(...n,"hsi");_t.format.hsi=i$;_t.autodetect.push({p:2,test:(...n)=>{if(n=Dt(n,"hsi"),kt(n)==="array"&&n.length===3)return"hsi"}});it.prototype.hsl=function(){return kk(this._rgb)};Mt.hsl=(...n)=>new it(...n,"hsl");_t.format.hsl=xx;_t.autodetect.push({p:2,test:(...n)=>{if(n=Dt(n,"hsl"),kt(n)==="array"&&n.length===3)return"hsl"}});const{floor:l$}=Math,u$=(...n)=>{n=Dt(n,"hsv");let[e,t,r]=n,i,a,s;if(r*=255,t===0)i=a=s=r;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const o=l$(e),c=e-o,l=r*(1-t),u=r*(1-t*c),h=r*(1-t*(1-c));switch(o){case 0:[i,a,s]=[r,h,l];break;case 1:[i,a,s]=[u,r,l];break;case 2:[i,a,s]=[l,r,h];break;case 3:[i,a,s]=[l,u,r];break;case 4:[i,a,s]=[h,l,r];break;case 5:[i,a,s]=[r,l,u];break}}return[i,a,s,n.length>3?n[3]:1]},{min:h$,max:f$}=Math,d$=(...n)=>{n=Dt(n,"rgb");let[e,t,r]=n;const i=h$(e,t,r),a=f$(e,t,r),s=a-i;let o,c,l;return l=a/255,a===0?(o=Number.NaN,c=0):(c=s/a,e===a&&(o=(t-r)/s),t===a&&(o=2+(r-e)/s),r===a&&(o=4+(e-t)/s),o*=60,o<0&&(o+=360)),[o,c,l]};it.prototype.hsv=function(){return d$(this._rgb)};Mt.hsv=(...n)=>new it(...n,"hsv");_t.format.hsv=u$;_t.autodetect.push({p:2,test:(...n)=>{if(n=Dt(n,"hsv"),kt(n)==="array"&&n.length===3)return"hsv"}});const Gn={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},{pow:p$}=Math,qk=(...n)=>{n=Dt(n,"lab");const[e,t,r]=n;let i,a,s,o,c,l;return a=(e+16)/116,i=isNaN(t)?a:a+t/500,s=isNaN(r)?a:a-r/200,a=Gn.Yn*Z0(a),i=Gn.Xn*Z0(i),s=Gn.Zn*Z0(s),o=X0(3.2404542*i-1.5371385*a-.4985314*s),c=X0(-.969266*i+1.8760108*a+.041556*s),l=X0(.0556434*i-.2040259*a+1.0572252*s),[o,c,l,n.length>3?n[3]:1]},X0=n=>255*(n<=.00304?12.92*n:1.055*p$(n,1/2.4)-.055),Z0=n=>n>Gn.t1?n*n*n:Gn.t2*(n-Gn.t0),{pow:Gk}=Math,Vk=(...n)=>{const[e,t,r]=Dt(n,"rgb"),[i,a,s]=g$(e,t,r),o=116*a-16;return[o<0?0:o,500*(i-a),200*(a-s)]},Q0=n=>(n/=255)<=.04045?n/12.92:Gk((n+.055)/1.055,2.4),J0=n=>n>Gn.t3?Gk(n,1/3):n/Gn.t2+Gn.t0,g$=(n,e,t)=>{n=Q0(n),e=Q0(e),t=Q0(t);const r=J0((.4124564*n+.3575761*e+.1804375*t)/Gn.Xn),i=J0((.2126729*n+.7151522*e+.072175*t)/Gn.Yn),a=J0((.0193339*n+.119192*e+.9503041*t)/Gn.Zn);return[r,i,a]};it.prototype.lab=function(){return Vk(this._rgb)};Mt.lab=(...n)=>new it(...n,"lab");_t.format.lab=qk;_t.autodetect.push({p:2,test:(...n)=>{if(n=Dt(n,"lab"),kt(n)==="array"&&n.length===3)return"lab"}});const{sin:v$,cos:m$}=Math,Wk=(...n)=>{let[e,t,r]=Dt(n,"lch");return isNaN(r)&&(r=0),r=r*HF,[e,m$(r)*t,v$(r)*t]},Hk=(...n)=>{n=Dt(n,"lch");const[e,t,r]=n,[i,a,s]=Wk(e,t,r),[o,c,l]=qk(i,a,s);return[o,c,l,n.length>3?n[3]:1]},y$=(...n)=>{const e=Dt(n,"hcl").reverse();return Hk(...e)},{sqrt:b$,atan2:E$,round:x$}=Math,Uk=(...n)=>{const[e,t,r]=Dt(n,"lab"),i=b$(t*t+r*r);let a=(E$(r,t)*UF+360)%360;return x$(i*1e4)===0&&(a=Number.NaN),[e,i,a]},Yk=(...n)=>{const[e,t,r]=Dt(n,"rgb"),[i,a,s]=Vk(e,t,r);return Uk(i,a,s)};it.prototype.lch=function(){return Yk(this._rgb)};it.prototype.hcl=function(){return Yk(this._rgb).reverse()};Mt.lch=(...n)=>new it(...n,"lch");Mt.hcl=(...n)=>new it(...n,"hcl");_t.format.lch=Hk;_t.format.hcl=y$;["lch","hcl"].forEach(n=>_t.autodetect.push({p:2,test:(...e)=>{if(e=Dt(e,n),kt(e)==="array"&&e.length===3)return n}}));const Lo={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};it.prototype.name=function(){const n=jk(this._rgb,"rgb");for(let e of Object.keys(Lo))if(Lo[e]===n)return e.toLowerCase();return n};_t.format.named=n=>{if(n=n.toLowerCase(),Lo[n])return zk(Lo[n]);throw new Error("unknown color name: "+n)};_t.autodetect.push({p:5,test:(n,...e)=>{if(!e.length&&kt(n)==="string"&&Lo[n.toLowerCase()])return"named"}});const w$=n=>{if(kt(n)=="number"&&n>=0&&n<=16777215){const e=n>>16,t=n>>8&255,r=n&255;return[e,t,r,1]}throw new Error("unknown num color: "+n)},S$=(...n)=>{const[e,t,r]=Dt(n,"rgb");return(e<<16)+(t<<8)+r};it.prototype.num=function(){return S$(this._rgb)};Mt.num=(...n)=>new it(...n,"num");_t.format.num=w$;_t.autodetect.push({p:5,test:(...n)=>{if(n.length===1&&kt(n[0])==="number"&&n[0]>=0&&n[0]<=16777215)return"num"}});const{round:Kk}=Math;it.prototype.rgb=function(n=!0){return n===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Kk)};it.prototype.rgba=function(n=!0){return this._rgb.slice(0,4).map((e,t)=>t<3?n===!1?e:Kk(e):e)};Mt.rgb=(...n)=>new it(...n,"rgb");_t.format.rgb=(...n)=>{const e=Dt(n,"rgba");return e[3]===void 0&&(e[3]=1),e};_t.autodetect.push({p:3,test:(...n)=>{if(n=Dt(n,"rgba"),kt(n)==="array"&&(n.length===3||n.length===4&&kt(n[3])=="number"&&n[3]>=0&&n[3]<=1))return"rgb"}});const{log:Uh}=Math,Xk=n=>{const e=n/100;let t,r,i;return e<66?(t=255,r=e<6?0:-155.25485562709179-.44596950469579133*(r=e-2)+104.49216199393888*Uh(r),i=e<20?0:-254.76935184120902+.8274096064007395*(i=e-10)+115.67994401066147*Uh(i)):(t=351.97690566805693+.114206453784165*(t=e-55)-40.25366309332127*Uh(t),r=325.4494125711974+.07943456536662342*(r=e-50)-28.0852963507957*Uh(r),i=255),[t,r,i,1]},{round:_$}=Math,O$=(...n)=>{const e=Dt(n,"rgb"),t=e[0],r=e[2];let i=1e3,a=4e4;const s=.4;let o;for(;a-i>s;){o=(a+i)*.5;const c=Xk(o);c[2]/c[0]>=r/t?a=o:i=o}return _$(o)};it.prototype.temp=it.prototype.kelvin=it.prototype.temperature=function(){return O$(this._rgb)};Mt.temp=Mt.kelvin=Mt.temperature=(...n)=>new it(...n,"temp");_t.format.temp=_t.format.kelvin=_t.format.temperature=Xk;const{pow:Xf,sign:P$}=Math,Zk=(...n)=>{n=Dt(n,"lab");const[e,t,r]=n,i=Xf(e+.3963377774*t+.2158037573*r,3),a=Xf(e-.1055613458*t-.0638541728*r,3),s=Xf(e-.0894841775*t-1.291485548*r,3);return[255*tv(4.0767416621*i-3.3077115913*a+.2309699292*s),255*tv(-1.2684380046*i+2.6097574011*a-.3413193965*s),255*tv(-.0041960863*i-.7034186147*a+1.707614701*s),n.length>3?n[3]:1]};function tv(n){const e=Math.abs(n);return e>.0031308?(P$(n)||1)*(1.055*Xf(e,1/2.4)-.055):n*12.92}const{cbrt:ev,pow:C$,sign:M$}=Math,Qk=(...n)=>{const[e,t,r]=Dt(n,"rgb"),[i,a,s]=[nv(e/255),nv(t/255),nv(r/255)],o=ev(.4122214708*i+.5363325363*a+.0514459929*s),c=ev(.2119034982*i+.6806995451*a+.1073969566*s),l=ev(.0883024619*i+.2817188376*a+.6299787005*s);return[.2104542553*o+.793617785*c-.0040720468*l,1.9779984951*o-2.428592205*c+.4505937099*l,.0259040371*o+.7827717662*c-.808675766*l]};function nv(n){const e=Math.abs(n);return e<.04045?n/12.92:(M$(n)||1)*C$((e+.055)/1.055,2.4)}it.prototype.oklab=function(){return Qk(this._rgb)};Mt.oklab=(...n)=>new it(...n,"oklab");_t.format.oklab=Zk;_t.autodetect.push({p:3,test:(...n)=>{if(n=Dt(n,"oklab"),kt(n)==="array"&&n.length===3)return"oklab"}});const T$=(...n)=>{n=Dt(n,"lch");const[e,t,r]=n,[i,a,s]=Wk(e,t,r),[o,c,l]=Zk(i,a,s);return[o,c,l,n.length>3?n[3]:1]},A$=(...n)=>{const[e,t,r]=Dt(n,"rgb"),[i,a,s]=Qk(e,t,r);return Uk(i,a,s)};it.prototype.oklch=function(){return A$(this._rgb)};Mt.oklch=(...n)=>new it(...n,"oklch");_t.format.oklch=T$;_t.autodetect.push({p:3,test:(...n)=>{if(n=Dt(n,"oklch"),kt(n)==="array"&&n.length===3)return"oklch"}});it.prototype.alpha=function(n,e=!1){return n!==void 0&&kt(n)==="number"?e?(this._rgb[3]=n,this):new it([this._rgb[0],this._rgb[1],this._rgb[2],n],"rgb"):this._rgb[3]};it.prototype.clipped=function(){return this._rgb._clipped||!1};it.prototype.darken=function(n=1){const e=this,t=e.lab();return t[0]-=Gn.Kn*n,new it(t,"lab").alpha(e.alpha(),!0)};it.prototype.brighten=function(n=1){return this.darken(-n)};it.prototype.darker=it.prototype.darken;it.prototype.brighter=it.prototype.brighten;it.prototype.get=function(n){const[e,t]=n.split("."),r=this[e]();if(t){const i=e.indexOf(t)-(e.substr(0,2)==="ok"?2:0);if(i>-1)return r[i];throw new Error(`unknown channel ${t} in mode ${e}`)}else return r};const{pow:N$}=Math,R$=1e-7,k$=20;it.prototype.luminance=function(n,e="rgb"){if(n!==void 0&&kt(n)==="number"){if(n===0)return new it([0,0,0,this._rgb[3]],"rgb");if(n===1)return new it([255,255,255,this._rgb[3]],"rgb");let t=this.luminance(),r=k$;const i=(s,o)=>{const c=s.interpolate(o,.5,e),l=c.luminance();return Math.abs(n-l)<R$||!r--?c:l>n?i(s,c):i(c,o)},a=(t>n?i(new it([0,0,0]),this):i(this,new it([255,255,255]))).rgb();return new it([...a,this._rgb[3]])}return D$(...this._rgb.slice(0,3))};const D$=(n,e,t)=>(n=rv(n),e=rv(e),t=rv(t),.2126*n+.7152*e+.0722*t),rv=n=>(n/=255,n<=.03928?n/12.92:N$((n+.055)/1.055,2.4)),bn={},Au=(n,e,t=.5,...r)=>{let i=r[0]||"lrgb";if(!bn[i]&&!r.length&&(i=Object.keys(bn)[0]),!bn[i])throw new Error(`interpolation mode ${i} is not defined`);return kt(n)!=="object"&&(n=new it(n)),kt(e)!=="object"&&(e=new it(e)),bn[i](n,e,t).alpha(n.alpha()+t*(e.alpha()-n.alpha()))};it.prototype.mix=it.prototype.interpolate=function(n,e=.5,...t){return Au(this,n,e,...t)};it.prototype.premultiply=function(n=!1){const e=this._rgb,t=e[3];return n?(this._rgb=[e[0]*t,e[1]*t,e[2]*t,t],this):new it([e[0]*t,e[1]*t,e[2]*t,t],"rgb")};it.prototype.saturate=function(n=1){const e=this,t=e.lch();return t[1]+=Gn.Kn*n,t[1]<0&&(t[1]=0),new it(t,"lch").alpha(e.alpha(),!0)};it.prototype.desaturate=function(n=1){return this.saturate(-n)};it.prototype.set=function(n,e,t=!1){const[r,i]=n.split("."),a=this[r]();if(i){const s=r.indexOf(i)-(r.substr(0,2)==="ok"?2:0);if(s>-1){if(kt(e)=="string")switch(e.charAt(0)){case"+":a[s]+=+e;break;case"-":a[s]+=+e;break;case"*":a[s]*=+e.substr(1);break;case"/":a[s]/=+e.substr(1);break;default:a[s]=+e}else if(kt(e)==="number")a[s]=e;else throw new Error("unsupported value for Color.set");const o=new it(a,r);return t?(this._rgb=o._rgb,this):o}throw new Error(`unknown channel ${i} in mode ${r}`)}else return a};it.prototype.tint=function(n=.5,...e){return Au(this,"white",n,...e)};it.prototype.shade=function(n=.5,...e){return Au(this,"black",n,...e)};const L$=(n,e,t)=>{const r=n._rgb,i=e._rgb;return new it(r[0]+t*(i[0]-r[0]),r[1]+t*(i[1]-r[1]),r[2]+t*(i[2]-r[2]),"rgb")};bn.rgb=L$;const{sqrt:iv,pow:to}=Math,I$=(n,e,t)=>{const[r,i,a]=n._rgb,[s,o,c]=e._rgb;return new it(iv(to(r,2)*(1-t)+to(s,2)*t),iv(to(i,2)*(1-t)+to(o,2)*t),iv(to(a,2)*(1-t)+to(c,2)*t),"rgb")};bn.lrgb=I$;const B$=(n,e,t)=>{const r=n.lab(),i=e.lab();return new it(r[0]+t*(i[0]-r[0]),r[1]+t*(i[1]-r[1]),r[2]+t*(i[2]-r[2]),"lab")};bn.lab=B$;const ac=(n,e,t,r)=>{let i,a;r==="hsl"?(i=n.hsl(),a=e.hsl()):r==="hsv"?(i=n.hsv(),a=e.hsv()):r==="hcg"?(i=n.hcg(),a=e.hcg()):r==="hsi"?(i=n.hsi(),a=e.hsi()):r==="lch"||r==="hcl"?(r="hcl",i=n.hcl(),a=e.hcl()):r==="oklch"&&(i=n.oklch().reverse(),a=e.oklch().reverse());let s,o,c,l,u,h;(r.substr(0,1)==="h"||r==="oklch")&&([s,c,u]=i,[o,l,h]=a);let f,d,p,g;return!isNaN(s)&&!isNaN(o)?(o>s&&o-s>180?g=o-(s+360):o<s&&s-o>180?g=o+360-s:g=o-s,d=s+t*g):isNaN(s)?isNaN(o)?d=Number.NaN:(d=o,(u==1||u==0)&&r!="hsv"&&(f=l)):(d=s,(h==1||h==0)&&r!="hsv"&&(f=c)),f===void 0&&(f=c+t*(l-c)),p=u+t*(h-u),r==="oklch"?new it([p,f,d],r):new it([d,f,p],r)},Jk=(n,e,t)=>ac(n,e,t,"lch");bn.lch=Jk;bn.hcl=Jk;const F$=(n,e,t)=>{const r=n.num(),i=e.num();return new it(r+t*(i-r),"num")};bn.num=F$;const $$=(n,e,t)=>ac(n,e,t,"hcg");bn.hcg=$$;const z$=(n,e,t)=>ac(n,e,t,"hsi");bn.hsi=z$;const j$=(n,e,t)=>ac(n,e,t,"hsl");bn.hsl=j$;const q$=(n,e,t)=>ac(n,e,t,"hsv");bn.hsv=q$;const G$=(n,e,t)=>{const r=n.oklab(),i=e.oklab();return new it(r[0]+t*(i[0]-r[0]),r[1]+t*(i[1]-r[1]),r[2]+t*(i[2]-r[2]),"oklab")};bn.oklab=G$;const V$=(n,e,t)=>ac(n,e,t,"oklch");bn.oklch=V$;const{pow:av,sqrt:sv,PI:ov,cos:l3,sin:u3,atan2:W$}=Math,H$=(n,e="lrgb",t=null)=>{const r=n.length;t||(t=Array.from(new Array(r)).map(()=>1));const i=r/t.reduce(function(h,f){return h+f});if(t.forEach((h,f)=>{t[f]*=i}),n=n.map(h=>new it(h)),e==="lrgb")return U$(n,t);const a=n.shift(),s=a.get(e),o=[];let c=0,l=0;for(let h=0;h<s.length;h++)if(s[h]=(s[h]||0)*t[0],o.push(isNaN(s[h])?0:t[0]),e.charAt(h)==="h"&&!isNaN(s[h])){const f=s[h]/180*ov;c+=l3(f)*t[0],l+=u3(f)*t[0]}let u=a.alpha()*t[0];n.forEach((h,f)=>{const d=h.get(e);u+=h.alpha()*t[f+1];for(let p=0;p<s.length;p++)if(!isNaN(d[p]))if(o[p]+=t[f+1],e.charAt(p)==="h"){const g=d[p]/180*ov;c+=l3(g)*t[f+1],l+=u3(g)*t[f+1]}else s[p]+=d[p]*t[f+1]});for(let h=0;h<s.length;h++)if(e.charAt(h)==="h"){let f=W$(l/o[h],c/o[h])/ov*180;for(;f<0;)f+=360;for(;f>=360;)f-=360;s[h]=f}else s[h]=s[h]/o[h];return u/=r,new it(s,e).alpha(u>.99999?1:u,!0)},U$=(n,e)=>{const t=n.length,r=[0,0,0,0];for(let i=0;i<n.length;i++){const a=n[i],s=e[i]/t,o=a._rgb;r[0]+=av(o[0],2)*s,r[1]+=av(o[1],2)*s,r[2]+=av(o[2],2)*s,r[3]+=o[3]*s}return r[0]=sv(r[0]),r[1]=sv(r[1]),r[2]=sv(r[2]),r[3]>.9999999&&(r[3]=1),new it(S2(r))},{pow:Y$}=Math;function bd(n){let e="rgb",t=Mt("#ccc"),r=0,i=[0,1],a=[],s=[0,0],o=!1,c=[],l=!1,u=0,h=1,f=!1,d={},p=!0,g=1;const v=function(_){if(_=_||["#fff","#000"],_&&kt(_)==="string"&&Mt.brewer&&Mt.brewer[_.toLowerCase()]&&(_=Mt.brewer[_.toLowerCase()]),kt(_)==="array"){_.length===1&&(_=[_[0],_[0]]),_=_.slice(0);for(let E=0;E<_.length;E++)_[E]=Mt(_[E]);a.length=0;for(let E=0;E<_.length;E++)a.push(E/(_.length-1))}return x(),c=_},m=function(_){if(o!=null){const E=o.length-1;let P=0;for(;P<E&&_>=o[P];)P++;return P-1}return 0};let y=_=>_,b=_=>_;const w=function(_,E){let P,O;if(E==null&&(E=!1),isNaN(_)||_===null)return t;E?O=_:o&&o.length>2?O=m(_)/(o.length-2):h!==u?O=(_-u)/(h-u):O=1,O=b(O),E||(O=y(O)),g!==1&&(O=Y$(O,g)),O=s[0]+O*(1-s[0]-s[1]),O=_o(O,0,1);const C=Math.floor(O*1e4);if(p&&d[C])P=d[C];else{if(kt(c)==="array")for(let M=0;M<a.length;M++){const T=a[M];if(O<=T){P=c[M];break}if(O>=T&&M===a.length-1){P=c[M];break}if(O>T&&O<a[M+1]){O=(O-T)/(a[M+1]-T),P=Mt.interpolate(c[M],c[M+1],O,e);break}}else kt(c)==="function"&&(P=c(O));p&&(d[C]=P)}return P};var x=()=>d={};v(n);const S=function(_){const E=Mt(w(_));return l&&E[l]?E[l]():E};return S.classes=function(_){if(_!=null){if(kt(_)==="array")o=_,i=[_[0],_[_.length-1]];else{const E=Mt.analyze(i);_===0?o=[E.min,E.max]:o=Mt.limits(E,"e",_)}return S}return o},S.domain=function(_){if(!arguments.length)return i;u=_[0],h=_[_.length-1],a=[];const E=c.length;if(_.length===E&&u!==h)for(let P of Array.from(_))a.push((P-u)/(h-u));else{for(let P=0;P<E;P++)a.push(P/(E-1));if(_.length>2){const P=_.map((C,M)=>M/(_.length-1)),O=_.map(C=>(C-u)/(h-u));O.every((C,M)=>P[M]===C)||(b=C=>{if(C<=0||C>=1)return C;let M=0;for(;C>=O[M+1];)M++;const T=(C-O[M])/(O[M+1]-O[M]);return P[M]+T*(P[M+1]-P[M])})}}return i=[u,h],S},S.mode=function(_){return arguments.length?(e=_,x(),S):e},S.range=function(_,E){return v(_),S},S.out=function(_){return l=_,S},S.spread=function(_){return arguments.length?(r=_,S):r},S.correctLightness=function(_){return _==null&&(_=!0),f=_,x(),f?y=function(E){const P=w(0,!0).lab()[0],O=w(1,!0).lab()[0],C=P>O;let M=w(E,!0).lab()[0];const T=P+(O-P)*E;let R=M-T,D=0,B=1,j=20;for(;Math.abs(R)>.01&&j-- >0;)(function(){return C&&(R*=-1),R<0?(D=E,E+=(B-E)*.5):(B=E,E+=(D-E)*.5),M=w(E,!0).lab()[0],R=M-T})();return E}:y=E=>E,S},S.padding=function(_){return _!=null?(kt(_)==="number"&&(_=[_,_]),s=_,S):s},S.colors=function(_,E){arguments.length<2&&(E="hex");let P=[];if(arguments.length===0)P=c.slice(0);else if(_===1)P=[S(.5)];else if(_>1){const O=i[0],C=i[1]-O;P=K$(0,_).map(M=>S(O+M/(_-1)*C))}else{n=[];let O=[];if(o&&o.length>2)for(let C=1,M=o.length,T=1<=M;T?C<M:C>M;T?C++:C--)O.push((o[C-1]+o[C])*.5);else O=i;P=O.map(C=>S(C))}return Mt[E]&&(P=P.map(O=>O[E]())),P},S.cache=function(_){return _!=null?(p=_,S):p},S.gamma=function(_){return _!=null?(g=_,S):g},S.nodata=function(_){return _!=null?(t=Mt(_),S):t},S}function K$(n,e,t){let r=[],i=n<e,a=e;for(let s=n;i?s<a:s>a;i?s++:s--)r.push(s);return r}const X$=function(n){let e=[1,1];for(let t=1;t<n;t++){let r=[1];for(let i=1;i<=e.length;i++)r[i]=(e[i]||0)+e[i-1];e=r}return e},Z$=function(n){let e,t,r,i;if(n=n.map(a=>new it(a)),n.length===2)[t,r]=n.map(a=>a.lab()),e=function(a){const s=[0,1,2].map(o=>t[o]+a*(r[o]-t[o]));return new it(s,"lab")};else if(n.length===3)[t,r,i]=n.map(a=>a.lab()),e=function(a){const s=[0,1,2].map(o=>(1-a)*(1-a)*t[o]+2*(1-a)*a*r[o]+a*a*i[o]);return new it(s,"lab")};else if(n.length===4){let a;[t,r,i,a]=n.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(c=>(1-s)*(1-s)*(1-s)*t[c]+3*(1-s)*(1-s)*s*r[c]+3*(1-s)*s*s*i[c]+s*s*s*a[c]);return new it(o,"lab")}}else if(n.length>=5){let a,s,o;a=n.map(c=>c.lab()),o=n.length-1,s=X$(o),e=function(c){const l=1-c,u=[0,1,2].map(h=>a.reduce((f,d,p)=>f+s[p]*l**(o-p)*c**p*d[h],0));return new it(u,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return e},Q$=n=>{const e=Z$(n);return e.scale=()=>bd(e),e},Xr=(n,e,t)=>{if(!Xr[t])throw new Error("unknown blend mode "+t);return Xr[t](n,e)},za=n=>(e,t)=>{const r=Mt(t).rgb(),i=Mt(e).rgb();return Mt.rgb(n(r,i))},ja=n=>(e,t)=>{const r=[];return r[0]=n(e[0],t[0]),r[1]=n(e[1],t[1]),r[2]=n(e[2],t[2]),r},J$=n=>n,tz=(n,e)=>n*e/255,ez=(n,e)=>n>e?e:n,nz=(n,e)=>n>e?n:e,rz=(n,e)=>255*(1-(1-n/255)*(1-e/255)),iz=(n,e)=>e<128?2*n*e/255:255*(1-2*(1-n/255)*(1-e/255)),az=(n,e)=>255*(1-(1-e/255)/(n/255)),sz=(n,e)=>n===255?255:(n=255*(e/255)/(1-n/255),n>255?255:n);Xr.normal=za(ja(J$));Xr.multiply=za(ja(tz));Xr.screen=za(ja(rz));Xr.overlay=za(ja(iz));Xr.darken=za(ja(ez));Xr.lighten=za(ja(nz));Xr.dodge=za(ja(sz));Xr.burn=za(ja(az));const{pow:oz,sin:cz,cos:lz}=Math;function uz(n=300,e=-1.5,t=1,r=1,i=[0,1]){let a=0,s;kt(i)==="array"?s=i[1]-i[0]:(s=0,i=[i,i]);const o=function(c){const l=ki*((n+120)/360+e*c),u=oz(i[0]+s*c,r),f=(a!==0?t[0]+c*a:t)*u*(1-u)/2,d=lz(l),p=cz(l),g=u+f*(-.14861*d+1.78277*p),v=u+f*(-.29227*d-.90649*p),m=u+f*(1.97294*d);return Mt(S2([g*255,v*255,m*255,1]))};return o.start=function(c){return c==null?n:(n=c,o)},o.rotations=function(c){return c==null?e:(e=c,o)},o.gamma=function(c){return c==null?r:(r=c,o)},o.hue=function(c){return c==null?t:(t=c,kt(t)==="array"?(a=t[1]-t[0],a===0&&(t=t[1])):a=0,o)},o.lightness=function(c){return c==null?i:(kt(c)==="array"?(i=c,s=c[1]-c[0]):(i=[c,c],s=0),o)},o.scale=()=>Mt.scale(o),o.hue(t),o}const hz="0123456789abcdef",{floor:fz,random:dz}=Math,pz=()=>{let n="#";for(let e=0;e<6;e++)n+=hz.charAt(fz(dz()*16));return new it(n,"hex")},{log:h3,pow:gz,floor:vz,abs:mz}=Math;function tD(n,e=null){const t={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return kt(n)==="object"&&(n=Object.values(n)),n.forEach(r=>{e&&kt(r)==="object"&&(r=r[e]),r!=null&&!isNaN(r)&&(t.values.push(r),t.sum+=r,r<t.min&&(t.min=r),r>t.max&&(t.max=r),t.count+=1)}),t.domain=[t.min,t.max],t.limits=(r,i)=>eD(t,r,i),t}function eD(n,e="equal",t=7){kt(n)=="array"&&(n=tD(n));const{min:r,max:i}=n,a=n.values.sort((o,c)=>o-c);if(t===1)return[r,i];const s=[];if(e.substr(0,1)==="c"&&(s.push(r),s.push(i)),e.substr(0,1)==="e"){s.push(r);for(let o=1;o<t;o++)s.push(r+o/t*(i-r));s.push(i)}else if(e.substr(0,1)==="l"){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");const o=Math.LOG10E*h3(r),c=Math.LOG10E*h3(i);s.push(r);for(let l=1;l<t;l++)s.push(gz(10,o+l/t*(c-o)));s.push(i)}else if(e.substr(0,1)==="q"){s.push(r);for(let o=1;o<t;o++){const c=(a.length-1)*o/t,l=vz(c);if(l===c)s.push(a[l]);else{const u=c-l;s.push(a[l]*(1-u)+a[l+1]*u)}}s.push(i)}else if(e.substr(0,1)==="k"){let o;const c=a.length,l=new Array(c),u=new Array(t);let h=!0,f=0,d=null;d=[],d.push(r);for(let v=1;v<t;v++)d.push(r+v/t*(i-r));for(d.push(i);h;){for(let m=0;m<t;m++)u[m]=0;for(let m=0;m<c;m++){const y=a[m];let b=Number.MAX_VALUE,w;for(let x=0;x<t;x++){const S=mz(d[x]-y);S<b&&(b=S,w=x),u[w]++,l[m]=w}}const v=new Array(t);for(let m=0;m<t;m++)v[m]=null;for(let m=0;m<c;m++)o=l[m],v[o]===null?v[o]=a[m]:v[o]+=a[m];for(let m=0;m<t;m++)v[m]*=1/u[m];h=!1;for(let m=0;m<t;m++)if(v[m]!==d[m]){h=!0;break}d=v,f++,f>200&&(h=!1)}const p={};for(let v=0;v<t;v++)p[v]=[];for(let v=0;v<c;v++)o=l[v],p[o].push(a[v]);let g=[];for(let v=0;v<t;v++)g.push(p[v][0]),g.push(p[v][p[v].length-1]);g=g.sort((v,m)=>v-m),s.push(g[0]);for(let v=1;v<g.length;v+=2){const m=g[v];!isNaN(m)&&s.indexOf(m)===-1&&s.push(m)}}return s}const yz=(n,e)=>{n=new it(n),e=new it(e);const t=n.luminance(),r=e.luminance();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},{sqrt:Mi,pow:Ge,min:bz,max:Ez,atan2:f3,abs:d3,cos:Yh,sin:p3,exp:xz,PI:g3}=Math;function wz(n,e,t=1,r=1,i=1){var a=function(U){return 360*U/(2*g3)},s=function(U){return 2*g3*U/360};n=new it(n),e=new it(e);const[o,c,l]=Array.from(n.lab()),[u,h,f]=Array.from(e.lab()),d=(o+u)/2,p=Mi(Ge(c,2)+Ge(l,2)),g=Mi(Ge(h,2)+Ge(f,2)),v=(p+g)/2,m=.5*(1-Mi(Ge(v,7)/(Ge(v,7)+Ge(25,7)))),y=c*(1+m),b=h*(1+m),w=Mi(Ge(y,2)+Ge(l,2)),x=Mi(Ge(b,2)+Ge(f,2)),S=(w+x)/2,_=a(f3(l,y)),E=a(f3(f,b)),P=_>=0?_:_+360,O=E>=0?E:E+360,C=d3(P-O)>180?(P+O+360)/2:(P+O)/2,M=1-.17*Yh(s(C-30))+.24*Yh(s(2*C))+.32*Yh(s(3*C+6))-.2*Yh(s(4*C-63));let T=O-P;T=d3(T)<=180?T:O<=P?T+360:T-360,T=2*Mi(w*x)*p3(s(T)/2);const R=u-o,D=x-w,B=1+.015*Ge(d-50,2)/Mi(20+Ge(d-50,2)),j=1+.045*S,L=1+.015*S*M,$=30*xz(-Ge((C-275)/25,2)),W=-(2*Mi(Ge(S,7)/(Ge(S,7)+Ge(25,7))))*p3(2*s($)),Y=Mi(Ge(R/(t*B),2)+Ge(D/(r*j),2)+Ge(T/(i*L),2)+W*(D/(r*j))*(T/(i*L)));return Ez(0,bz(100,Y))}function Sz(n,e,t="lab"){n=new it(n),e=new it(e);const r=n.get(t),i=e.get(t);let a=0;for(let s in r){const o=(r[s]||0)-(i[s]||0);a+=o*o}return Math.sqrt(a)}const _z=(...n)=>{try{return new it(...n),!0}catch{return!1}},Oz={cool(){return bd([Mt.hsl(180,1,.9),Mt.hsl(250,.7,.4)])},hot(){return bd(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Zf={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let n of Object.keys(Zf))Zf[n.toLowerCase()]=Zf[n];Object.assign(Mt,{analyze:tD,average:H$,bezier:Q$,blend:Xr,brewer:Zf,Color:it,colors:Lo,contrast:yz,cubehelix:uz,deltaE:wz,distance:Sz,input:_t,interpolate:Au,limits:eD,mix:Au,random:pz,scale:bd,scales:Oz,valid:_z});var wx=function(n,e){return wx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},wx(n,e)};function tt(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");wx(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var G=function(){return G=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},G.apply(this,arguments)};function ie(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Et(n,e,t,r){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(u){try{l(r.next(u))}catch(h){s(h)}}function c(u){try{l(r.throw(u))}catch(h){s(h)}}function l(u){u.done?a(u.value):i(u.value).then(o,c)}l((r=r.apply(n,e||[])).next())})}function Io(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(t=0)),t;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(u){l=[6,u],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function er(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function N(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return a}function Q(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function cv(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}var nD={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function a(c,l,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var d=new i(u,h||c,f),p=t?t+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],d]:c._events[p].push(d):(c._events[p]=d,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},o.prototype.listeners=function(l){var u=t?t+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,d=h.length,p=new Array(d);f<d;f++)p[f]=h[f].fn;return p},o.prototype.listenerCount=function(l){var u=t?t+l:l,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,u,h,f,d,p){var g=t?t+l:l;if(!this._events[g])return!1;var v=this._events[g],m=arguments.length,y,b;if(v.fn){switch(v.once&&this.removeListener(l,v.fn,void 0,!0),m){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,f),!0;case 5:return v.fn.call(v.context,u,h,f,d),!0;case 6:return v.fn.call(v.context,u,h,f,d,p),!0}for(b=1,y=new Array(m-1);b<m;b++)y[b-1]=arguments[b];v.fn.apply(v.context,y)}else{var w=v.length,x;for(b=0;b<w;b++)switch(v[b].once&&this.removeListener(l,v[b].fn,void 0,!0),m){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,u);break;case 3:v[b].fn.call(v[b].context,u,h);break;case 4:v[b].fn.call(v[b].context,u,h,f);break;default:if(!y)for(x=1,y=new Array(m-1);x<m;x++)y[x-1]=arguments[x];v[b].fn.apply(v[b].context,y)}}return!0},o.prototype.on=function(l,u,h){return a(this,l,u,h,!1)},o.prototype.once=function(l,u,h){return a(this,l,u,h,!0)},o.prototype.removeListener=function(l,u,h,f){var d=t?t+l:l;if(!this._events[d])return this;if(!u)return s(this,d),this;var p=this._events[d];if(p.fn)p.fn===u&&(!f||p.once)&&(!h||p.context===h)&&s(this,d);else{for(var g=0,v=[],m=p.length;g<m;g++)(p[g].fn!==u||f&&!p[g].once||h&&p[g].context!==h)&&v.push(p[g]);v.length?this._events[d]=v.length===1?v[0]:v:s(this,d)}return this},o.prototype.removeAllListeners=function(l){var u;return l?(u=t?t+l:l,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o})(nD);var Pz=nD.exports;const C2=ah(Pz);var _e=1e-6,je=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function rD(){var n=new je(9);return je!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Cz(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n}function Mz(n,e,t,r,i,a,s,o,c){var l=new je(9);return l[0]=n,l[1]=e,l[2]=t,l[3]=r,l[4]=i,l[5]=a,l[6]=s,l[7]=o,l[8]=c,l}function og(n,e,t){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=t[0],d=t[1],p=t[2],g=t[3],v=t[4],m=t[5],y=t[6],b=t[7],w=t[8];return n[0]=f*r+d*s+p*l,n[1]=f*i+d*o+p*u,n[2]=f*a+d*c+p*h,n[3]=g*r+v*s+m*l,n[4]=g*i+v*o+m*u,n[5]=g*a+v*c+m*h,n[6]=y*r+b*s+w*l,n[7]=y*i+b*o+w*u,n[8]=y*a+b*c+w*h,n}function Tz(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=e[0],n[7]=e[1],n[8]=1,n}function Az(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=t,n[2]=0,n[3]=-t,n[4]=r,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function Nz(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=e[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function le(){var n=new je(16);return je!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function iD(n){var e=new je(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function Bo(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Rz(n,e,t,r,i,a,s,o,c,l,u,h,f,d,p,g){var v=new je(16);return v[0]=n,v[1]=e,v[2]=t,v[3]=r,v[4]=i,v[5]=a,v[6]=s,v[7]=o,v[8]=c,v[9]=l,v[10]=u,v[11]=h,v[12]=f,v[13]=d,v[14]=p,v[15]=g,v}function Sx(n,e,t,r,i,a,s,o,c,l,u,h,f,d,p,g,v){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=a,n[5]=s,n[6]=o,n[7]=c,n[8]=l,n[9]=u,n[10]=h,n[11]=f,n[12]=d,n[13]=p,n[14]=g,n[15]=v,n}function ks(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function aD(n,e){if(n===e){var t=e[1],r=e[2],i=e[3],a=e[6],s=e[7],o=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=a,n[11]=e[14],n[12]=i,n[13]=s,n[14]=o}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function li(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=t*o-r*s,b=t*c-i*s,w=t*l-a*s,x=r*c-i*o,S=r*l-a*o,_=i*l-a*c,E=u*g-h*p,P=u*v-f*p,O=u*m-d*p,C=h*v-f*g,M=h*m-d*g,T=f*m-d*v,R=y*T-b*M+w*C+x*O-S*P+_*E;return R?(R=1/R,n[0]=(o*T-c*M+l*C)*R,n[1]=(i*M-r*T-a*C)*R,n[2]=(g*_-v*S+m*x)*R,n[3]=(f*S-h*_-d*x)*R,n[4]=(c*O-s*T-l*P)*R,n[5]=(t*T-i*O+a*P)*R,n[6]=(v*w-p*_-m*b)*R,n[7]=(u*_-f*w+d*b)*R,n[8]=(s*M-o*O+l*E)*R,n[9]=(r*O-t*M-a*E)*R,n[10]=(p*S-g*w+m*y)*R,n[11]=(h*w-u*S-d*y)*R,n[12]=(o*P-s*C-c*E)*R,n[13]=(t*C-r*P+i*E)*R,n[14]=(g*b-p*x-v*y)*R,n[15]=(u*x-h*b+f*y)*R,n):null}function kz(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],v=e[14],m=e[15];return n[0]=o*(f*m-d*v)-h*(c*m-l*v)+g*(c*d-l*f),n[1]=-(r*(f*m-d*v)-h*(i*m-a*v)+g*(i*d-a*f)),n[2]=r*(c*m-l*v)-o*(i*m-a*v)+g*(i*l-a*c),n[3]=-(r*(c*d-l*f)-o*(i*d-a*f)+h*(i*l-a*c)),n[4]=-(s*(f*m-d*v)-u*(c*m-l*v)+p*(c*d-l*f)),n[5]=t*(f*m-d*v)-u*(i*m-a*v)+p*(i*d-a*f),n[6]=-(t*(c*m-l*v)-s*(i*m-a*v)+p*(i*l-a*c)),n[7]=t*(c*d-l*f)-s*(i*d-a*f)+u*(i*l-a*c),n[8]=s*(h*m-d*g)-u*(o*m-l*g)+p*(o*d-l*h),n[9]=-(t*(h*m-d*g)-u*(r*m-a*g)+p*(r*d-a*h)),n[10]=t*(o*m-l*g)-s*(r*m-a*g)+p*(r*l-a*o),n[11]=-(t*(o*d-l*h)-s*(r*d-a*h)+u*(r*l-a*o)),n[12]=-(s*(h*v-f*g)-u*(o*v-c*g)+p*(o*f-c*h)),n[13]=t*(h*v-f*g)-u*(r*v-i*g)+p*(r*f-i*h),n[14]=-(t*(o*v-c*g)-s*(r*v-i*g)+p*(r*c-i*o)),n[15]=t*(o*f-c*h)-s*(r*f-i*h)+u*(r*c-i*o),n}function sD(n){var e=n[0],t=n[1],r=n[2],i=n[3],a=n[4],s=n[5],o=n[6],c=n[7],l=n[8],u=n[9],h=n[10],f=n[11],d=n[12],p=n[13],g=n[14],v=n[15],m=e*s-t*a,y=e*o-r*a,b=e*c-i*a,w=t*o-r*s,x=t*c-i*s,S=r*c-i*o,_=l*p-u*d,E=l*g-h*d,P=l*v-f*d,O=u*g-h*p,C=u*v-f*p,M=h*v-f*g;return m*M-y*C+b*O+w*P-x*E+S*_}function En(n,e,t){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],v=e[13],m=e[14],y=e[15],b=t[0],w=t[1],x=t[2],S=t[3];return n[0]=b*r+w*o+x*h+S*g,n[1]=b*i+w*c+x*f+S*v,n[2]=b*a+w*l+x*d+S*m,n[3]=b*s+w*u+x*p+S*y,b=t[4],w=t[5],x=t[6],S=t[7],n[4]=b*r+w*o+x*h+S*g,n[5]=b*i+w*c+x*f+S*v,n[6]=b*a+w*l+x*d+S*m,n[7]=b*s+w*u+x*p+S*y,b=t[8],w=t[9],x=t[10],S=t[11],n[8]=b*r+w*o+x*h+S*g,n[9]=b*i+w*c+x*f+S*v,n[10]=b*a+w*l+x*d+S*m,n[11]=b*s+w*u+x*p+S*y,b=t[12],w=t[13],x=t[14],S=t[15],n[12]=b*r+w*o+x*h+S*g,n[13]=b*i+w*c+x*f+S*v,n[14]=b*a+w*l+x*d+S*m,n[15]=b*s+w*u+x*p+S*y,n}function Oo(n,e,t){var r=t[0],i=t[1],a=t[2],s,o,c,l,u,h,f,d,p,g,v,m;return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*a+e[12],n[13]=e[1]*r+e[5]*i+e[9]*a+e[13],n[14]=e[2]*r+e[6]*i+e[10]*a+e[14],n[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],c=e[2],l=e[3],u=e[4],h=e[5],f=e[6],d=e[7],p=e[8],g=e[9],v=e[10],m=e[11],n[0]=s,n[1]=o,n[2]=c,n[3]=l,n[4]=u,n[5]=h,n[6]=f,n[7]=d,n[8]=p,n[9]=g,n[10]=v,n[11]=m,n[12]=s*r+u*i+p*a+e[12],n[13]=o*r+h*i+g*a+e[13],n[14]=c*r+f*i+v*a+e[14],n[15]=l*r+d*i+m*a+e[15]),n}function oD(n,e,t){var r=t[0],i=t[1],a=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Dz(n,e,t,r){var i=r[0],a=r[1],s=r[2],o=Math.hypot(i,a,s),c,l,u,h,f,d,p,g,v,m,y,b,w,x,S,_,E,P,O,C,M,T,R,D;return o<_e?null:(o=1/o,i*=o,a*=o,s*=o,c=Math.sin(t),l=Math.cos(t),u=1-l,h=e[0],f=e[1],d=e[2],p=e[3],g=e[4],v=e[5],m=e[6],y=e[7],b=e[8],w=e[9],x=e[10],S=e[11],_=i*i*u+l,E=a*i*u+s*c,P=s*i*u-a*c,O=i*a*u-s*c,C=a*a*u+l,M=s*a*u+i*c,T=i*s*u+a*c,R=a*s*u-i*c,D=s*s*u+l,n[0]=h*_+g*E+b*P,n[1]=f*_+v*E+w*P,n[2]=d*_+m*E+x*P,n[3]=p*_+y*E+S*P,n[4]=h*O+g*C+b*M,n[5]=f*O+v*C+w*M,n[6]=d*O+m*C+x*M,n[7]=p*O+y*C+S*M,n[8]=h*T+g*R+b*D,n[9]=f*T+v*R+w*D,n[10]=d*T+m*R+x*D,n[11]=p*T+y*R+S*D,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function cD(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],o=e[6],c=e[7],l=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=a*i+l*r,n[5]=s*i+u*r,n[6]=o*i+h*r,n[7]=c*i+f*r,n[8]=l*i-a*r,n[9]=u*i-s*r,n[10]=h*i-o*r,n[11]=f*i-c*r,n}function lD(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],c=e[3],l=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i-l*r,n[1]=s*i-u*r,n[2]=o*i-h*r,n[3]=c*i-f*r,n[8]=a*r+l*i,n[9]=s*r+u*i,n[10]=o*r+h*i,n[11]=c*r+f*i,n}function Lz(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],c=e[3],l=e[4],u=e[5],h=e[6],f=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i+l*r,n[1]=s*i+u*r,n[2]=o*i+h*r,n[3]=c*i+f*r,n[4]=l*i-a*r,n[5]=u*i-s*r,n[6]=h*i-o*r,n[7]=f*i-c*r,n}function as(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function ss(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function uD(n,e,t){var r=t[0],i=t[1],a=t[2],s=Math.hypot(r,i,a),o,c,l;return s<_e?null:(s=1/s,r*=s,i*=s,a*=s,o=Math.sin(e),c=Math.cos(e),l=1-c,n[0]=r*r*l+c,n[1]=i*r*l+a*o,n[2]=a*r*l-i*o,n[3]=0,n[4]=r*i*l-a*o,n[5]=i*i*l+c,n[6]=a*i*l+r*o,n[7]=0,n[8]=r*a*l+i*o,n[9]=i*a*l-r*o,n[10]=a*a*l+c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function hD(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=t,n[7]=0,n[8]=0,n[9]=-t,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function fD(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=0,n[2]=-t,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=t,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _x(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=t,n[2]=0,n[3]=0,n[4]=-t,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function dD(n,e,t){var r=e[0],i=e[1],a=e[2],s=e[3],o=r+r,c=i+i,l=a+a,u=r*o,h=r*c,f=r*l,d=i*c,p=i*l,g=a*l,v=s*o,m=s*c,y=s*l;return n[0]=1-(d+g),n[1]=h+y,n[2]=f-m,n[3]=0,n[4]=h-y,n[5]=1-(u+g),n[6]=p+v,n[7]=0,n[8]=f+m,n[9]=p-v,n[10]=1-(u+d),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function Iz(n,e){var t=new je(3),r=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],c=e[5],l=e[6],u=e[7],h=r*r+i*i+a*a+s*s;return h>0?(t[0]=(o*s+u*r+c*a-l*i)*2/h,t[1]=(c*s+u*i+l*r-o*a)*2/h,t[2]=(l*s+u*a+o*i-c*r)*2/h):(t[0]=(o*s+u*r+c*a-l*i)*2,t[1]=(c*s+u*i+l*r-o*a)*2,t[2]=(l*s+u*a+o*i-c*r)*2),dD(n,e,t),n}function Ed(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function Fo(n,e){var t=e[0],r=e[1],i=e[2],a=e[4],s=e[5],o=e[6],c=e[8],l=e[9],u=e[10];return n[0]=Math.hypot(t,r,i),n[1]=Math.hypot(a,s,o),n[2]=Math.hypot(c,l,u),n}function xd(n,e){var t=new je(3);Fo(t,e);var r=1/t[0],i=1/t[1],a=1/t[2],s=e[0]*r,o=e[1]*i,c=e[2]*a,l=e[4]*r,u=e[5]*i,h=e[6]*a,f=e[8]*r,d=e[9]*i,p=e[10]*a,g=s+u+p,v=0;return g>0?(v=Math.sqrt(g+1)*2,n[3]=.25*v,n[0]=(h-d)/v,n[1]=(f-c)/v,n[2]=(o-l)/v):s>u&&s>p?(v=Math.sqrt(1+s-u-p)*2,n[3]=(h-d)/v,n[0]=.25*v,n[1]=(o+l)/v,n[2]=(f+c)/v):u>p?(v=Math.sqrt(1+u-s-p)*2,n[3]=(f-c)/v,n[0]=(o+l)/v,n[1]=.25*v,n[2]=(h+d)/v):(v=Math.sqrt(1+p-s-u)*2,n[3]=(o-l)/v,n[0]=(f+c)/v,n[1]=(h+d)/v,n[2]=.25*v),n}function Bz(n,e,t,r){var i=e[0],a=e[1],s=e[2],o=e[3],c=i+i,l=a+a,u=s+s,h=i*c,f=i*l,d=i*u,p=a*l,g=a*u,v=s*u,m=o*c,y=o*l,b=o*u,w=r[0],x=r[1],S=r[2];return n[0]=(1-(p+v))*w,n[1]=(f+b)*w,n[2]=(d-y)*w,n[3]=0,n[4]=(f-b)*x,n[5]=(1-(h+v))*x,n[6]=(g+m)*x,n[7]=0,n[8]=(d+y)*S,n[9]=(g-m)*S,n[10]=(1-(h+p))*S,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function _u(n,e,t,r,i){var a=e[0],s=e[1],o=e[2],c=e[3],l=a+a,u=s+s,h=o+o,f=a*l,d=a*u,p=a*h,g=s*u,v=s*h,m=o*h,y=c*l,b=c*u,w=c*h,x=r[0],S=r[1],_=r[2],E=i[0],P=i[1],O=i[2],C=(1-(g+m))*x,M=(d+w)*x,T=(p-b)*x,R=(d-w)*S,D=(1-(f+m))*S,B=(v+y)*S,j=(p+b)*_,L=(v-y)*_,$=(1-(f+g))*_;return n[0]=C,n[1]=M,n[2]=T,n[3]=0,n[4]=R,n[5]=D,n[6]=B,n[7]=0,n[8]=j,n[9]=L,n[10]=$,n[11]=0,n[12]=t[0]+E-(C*E+R*P+j*O),n[13]=t[1]+P-(M*E+D*P+L*O),n[14]=t[2]+O-(T*E+B*P+$*O),n[15]=1,n}function M2(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=t+t,o=r+r,c=i+i,l=t*s,u=r*s,h=r*o,f=i*s,d=i*o,p=i*c,g=a*s,v=a*o,m=a*c;return n[0]=1-h-p,n[1]=u+m,n[2]=f-v,n[3]=0,n[4]=u-m,n[5]=1-l-p,n[6]=d+g,n[7]=0,n[8]=f+v,n[9]=d-g,n[10]=1-l-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Fz(n,e,t,r,i,a,s){var o=1/(t-e),c=1/(i-r),l=1/(a-s);return n[0]=a*2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a*2*c,n[6]=0,n[7]=0,n[8]=(t+e)*o,n[9]=(i+r)*c,n[10]=(s+a)*l,n[11]=-1,n[12]=0,n[13]=0,n[14]=s*a*2*l,n[15]=0,n}function pD(n,e,t,r,i){var a=1/Math.tan(e/2),s;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(s=1/(r-i),n[10]=(i+r)*s,n[14]=2*i*r*s):(n[10]=-1,n[14]=-2*r),n}var $z=pD;function zz(n,e,t,r,i){var a=1/Math.tan(e/2),s;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(s=1/(r-i),n[10]=i*s,n[14]=i*r*s):(n[10]=-1,n[14]=-r),n}function jz(n,e,t,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),c=2/(s+o),l=2/(i+a);return n[0]=c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l,n[6]=0,n[7]=0,n[8]=-((s-o)*c*.5),n[9]=(i-a)*l*.5,n[10]=r/(t-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*t/(t-r),n[15]=0,n}function gD(n,e,t,r,i,a,s){var o=1/(e-t),c=1/(r-i),l=1/(a-s);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*l,n[11]=0,n[12]=(e+t)*o,n[13]=(i+r)*c,n[14]=(s+a)*l,n[15]=1,n}var vD=gD;function mD(n,e,t,r,i,a,s){var o=1/(e-t),c=1/(r-i),l=1/(a-s);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=l,n[11]=0,n[12]=(e+t)*o,n[13]=(i+r)*c,n[14]=a*l,n[15]=1,n}function yD(n,e,t,r){var i,a,s,o,c,l,u,h,f,d,p=e[0],g=e[1],v=e[2],m=r[0],y=r[1],b=r[2],w=t[0],x=t[1],S=t[2];return Math.abs(p-w)<_e&&Math.abs(g-x)<_e&&Math.abs(v-S)<_e?ks(n):(u=p-w,h=g-x,f=v-S,d=1/Math.hypot(u,h,f),u*=d,h*=d,f*=d,i=y*f-b*h,a=b*u-m*f,s=m*h-y*u,d=Math.hypot(i,a,s),d?(d=1/d,i*=d,a*=d,s*=d):(i=0,a=0,s=0),o=h*s-f*a,c=f*i-u*s,l=u*a-h*i,d=Math.hypot(o,c,l),d?(d=1/d,o*=d,c*=d,l*=d):(o=0,c=0,l=0),n[0]=i,n[1]=o,n[2]=u,n[3]=0,n[4]=a,n[5]=c,n[6]=h,n[7]=0,n[8]=s,n[9]=l,n[10]=f,n[11]=0,n[12]=-(i*p+a*g+s*v),n[13]=-(o*p+c*g+l*v),n[14]=-(u*p+h*g+f*v),n[15]=1,n)}function qz(n,e,t,r){var i=e[0],a=e[1],s=e[2],o=r[0],c=r[1],l=r[2],u=i-t[0],h=a-t[1],f=s-t[2],d=u*u+h*h+f*f;d>0&&(d=1/Math.sqrt(d),u*=d,h*=d,f*=d);var p=c*f-l*h,g=l*u-o*f,v=o*h-c*u;return d=p*p+g*g+v*v,d>0&&(d=1/Math.sqrt(d),p*=d,g*=d,v*=d),n[0]=p,n[1]=g,n[2]=v,n[3]=0,n[4]=h*v-f*g,n[5]=f*p-u*v,n[6]=u*g-h*p,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=0,n[12]=i,n[13]=a,n[14]=s,n[15]=1,n}function Gz(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function Vz(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function Wz(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n}function bD(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n}function Hz(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n}function Uz(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n[4]=e[4]+t[4]*r,n[5]=e[5]+t[5]*r,n[6]=e[6]+t[6]*r,n[7]=e[7]+t[7]*r,n[8]=e[8]+t[8]*r,n[9]=e[9]+t[9]*r,n[10]=e[10]+t[10]*r,n[11]=e[11]+t[11]*r,n[12]=e[12]+t[12]*r,n[13]=e[13]+t[13]*r,n[14]=e[14]+t[14]*r,n[15]=e[15]+t[15]*r,n}function Yz(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]}function Kz(n,e){var t=n[0],r=n[1],i=n[2],a=n[3],s=n[4],o=n[5],c=n[6],l=n[7],u=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15],y=e[0],b=e[1],w=e[2],x=e[3],S=e[4],_=e[5],E=e[6],P=e[7],O=e[8],C=e[9],M=e[10],T=e[11],R=e[12],D=e[13],B=e[14],j=e[15];return Math.abs(t-y)<=_e*Math.max(1,Math.abs(t),Math.abs(y))&&Math.abs(r-b)<=_e*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=_e*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-x)<=_e*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-S)<=_e*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(o-_)<=_e*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(c-E)<=_e*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-P)<=_e*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(u-O)<=_e*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(h-C)<=_e*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(f-M)<=_e*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(d-T)<=_e*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-R)<=_e*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(g-D)<=_e*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-B)<=_e*Math.max(1,Math.abs(v),Math.abs(B))&&Math.abs(m-j)<=_e*Math.max(1,Math.abs(m),Math.abs(j))}var ED=En,Xz=bD;const Zz=Object.freeze(Object.defineProperty({__proto__:null,add:Wz,adjoint:kz,clone:iD,copy:Bo,create:le,determinant:sD,equals:Kz,exactEquals:Yz,frob:Vz,fromQuat:M2,fromQuat2:Iz,fromRotation:uD,fromRotationTranslation:dD,fromRotationTranslationScale:Bz,fromRotationTranslationScaleOrigin:_u,fromScaling:ss,fromTranslation:as,fromValues:Rz,fromXRotation:hD,fromYRotation:fD,fromZRotation:_x,frustum:Fz,getRotation:xd,getScaling:Fo,getTranslation:Ed,identity:ks,invert:li,lookAt:yD,mul:ED,multiply:En,multiplyScalar:Hz,multiplyScalarAndAdd:Uz,ortho:vD,orthoNO:gD,orthoZO:mD,perspective:$z,perspectiveFromFieldOfView:jz,perspectiveNO:pD,perspectiveZO:zz,rotate:Dz,rotateX:cD,rotateY:lD,rotateZ:Lz,scale:oD,set:Sx,str:Gz,sub:Xz,subtract:bD,targetTo:qz,translate:Oo,transpose:aD},Symbol.toStringTag,{value:"Module"}));function Ct(){var n=new je(3);return je!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Ni(n){var e=new je(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Ii(n){var e=n[0],t=n[1],r=n[2];return Math.hypot(e,t,r)}function Wt(n,e,t){var r=new je(3);return r[0]=n,r[1]=e,r[2]=t,r}function va(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function qr(n,e,t,r){return n[0]=e,n[1]=t,n[2]=r,n}function Po(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function v3(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Qz(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function Ox(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function Jz(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2];return Math.hypot(t,r,i)}function vs(n,e){var t=e[0],r=e[1],i=e[2],a=t*t+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n}function ui(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Qf(n,e,t){var r=e[0],i=e[1],a=e[2],s=t[0],o=t[1],c=t[2];return n[0]=i*c-a*o,n[1]=a*s-r*c,n[2]=r*o-i*s,n}function Px(n,e,t,r){var i=e[0],a=e[1],s=e[2];return n[0]=i+r*(t[0]-i),n[1]=a+r*(t[1]-a),n[2]=s+r*(t[2]-s),n}function Ye(n,e,t){var r=e[0],i=e[1],a=e[2],s=t[3]*r+t[7]*i+t[11]*a+t[15];return s=s||1,n[0]=(t[0]*r+t[4]*i+t[8]*a+t[12])/s,n[1]=(t[1]*r+t[5]*i+t[9]*a+t[13])/s,n[2]=(t[2]*r+t[6]*i+t[10]*a+t[14])/s,n}function tj(n,e,t){var r=e[0],i=e[1],a=e[2];return n[0]=r*t[0]+i*t[3]+a*t[6],n[1]=r*t[1]+i*t[4]+a*t[7],n[2]=r*t[2]+i*t[5]+a*t[8],n}function ej(n,e,t){var r=t[0],i=t[1],a=t[2],s=t[3],o=e[0],c=e[1],l=e[2],u=i*l-a*c,h=a*o-r*l,f=r*c-i*o,d=i*f-a*h,p=a*u-r*f,g=r*h-i*u,v=s*2;return u*=v,h*=v,f*=v,d*=2,p*=2,g*=2,n[0]=o+u+d,n[1]=c+h+p,n[2]=l+f+g,n}function Ac(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],s=e[1],o=e[2];return Math.abs(t-a)<=_e*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-s)<=_e*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=_e*Math.max(1,Math.abs(i),Math.abs(o))}var m3=Jz,xD=Ii;(function(){var n=Ct();return function(e,t,r,i,a,s){var o,c;for(t||(t=3),r||(r=0),i?c=Math.min(i*t+r,e.length):c=e.length,o=r;o<c;o+=t)n[0]=e[o],n[1]=e[o+1],n[2]=e[o+2],a(n,n,s),e[o]=n[0],e[o+1]=n[1],e[o+2]=n[2];return e}})();function vo(){var n=new je(4);return je!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function nj(n,e,t,r){var i=new je(4);return i[0]=n,i[1]=e,i[2]=t,i[3]=r,i}function rj(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function ij(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=t*t+r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),n[0]=t*s,n[1]=r*s,n[2]=i*s,n[3]=a*s,n}function su(n,e,t){var r=e[0],i=e[1],a=e[2],s=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*s,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*s,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*s,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*s,n}(function(){var n=vo();return function(e,t,r,i,a,s){var o,c;for(t||(t=4),r||(r=0),i?c=Math.min(i*t+r,e.length):c=e.length,o=r;o<c;o+=t)n[0]=e[o],n[1]=e[o+1],n[2]=e[o+2],n[3]=e[o+3],a(n,n,s),e[o]=n[0],e[o+1]=n[1],e[o+2]=n[2],e[o+3]=n[3];return e}})();function $e(){var n=new je(4);return je!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function ma(n,e,t){t=t*.5;var r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function Oa(n,e,t){var r=e[0],i=e[1],a=e[2],s=e[3],o=t[0],c=t[1],l=t[2],u=t[3];return n[0]=r*u+s*o+i*l-a*c,n[1]=i*u+s*c+a*o-r*l,n[2]=a*u+s*l+r*c-i*o,n[3]=s*u-r*o-i*c-a*l,n}function lv(n,e,t,r){var i=e[0],a=e[1],s=e[2],o=e[3],c=t[0],l=t[1],u=t[2],h=t[3],f,d,p,g,v;return d=i*c+a*l+s*u+o*h,d<0&&(d=-d,c=-c,l=-l,u=-u,h=-h),1-d>_e?(f=Math.acos(d),p=Math.sin(f),g=Math.sin((1-r)*f)/p,v=Math.sin(r*f)/p):(g=1-r,v=r),n[0]=g*i+v*c,n[1]=g*a+v*l,n[2]=g*s+v*u,n[3]=g*o+v*h,n}function uv(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=t*t+r*r+i*i+a*a,o=s?1/s:0;return n[0]=-t*o,n[1]=-r*o,n[2]=-i*o,n[3]=a*o,n}function aj(n,e){var t=e[0]+e[4]+e[8],r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[s*3+s]+1),n[i]=.5*r,r=.5/r,n[3]=(e[a*3+s]-e[s*3+a])*r,n[a]=(e[a*3+i]+e[i*3+a])*r,n[s]=(e[s*3+i]+e[i*3+s])*r}return n}function Kh(n,e,t,r){var i=.5*Math.PI/180;e*=i,t*=i,r*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(t),c=Math.cos(t),l=Math.sin(r),u=Math.cos(r);return n[0]=a*c*u-s*o*l,n[1]=s*o*u+a*c*l,n[2]=s*c*l-a*o*u,n[3]=s*c*u+a*o*l,n}var hv=nj,Xh=rj,y3=Oa,wd=ij;(function(){var n=Ct(),e=Wt(1,0,0),t=Wt(0,1,0);return function(r,i,a){var s=ui(i,a);return s<-.999999?(Qf(n,e,i),xD(n)<1e-6&&Qf(n,t,i),vs(n,n),ma(r,n,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Qf(n,i,a),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+s,wd(r,r))}})();(function(){var n=$e(),e=$e();return function(t,r,i,a,s,o){return lv(n,r,s,o),lv(e,i,a,o),lv(t,n,e,2*o*(1-o)),t}})();(function(){var n=rD();return function(e,t,r,i){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],wd(e,aj(e,n))}})();function sj(){var n=new je(2);return je!=Float32Array&&(n[0]=0,n[1]=0),n}function oj(n,e){var t=new je(2);return t[0]=n,t[1]=e,t}function cj(n,e){return n[0]=e[0],n[1]=e[1],n}function lj(n,e){var t=e[0],r=e[1],i=t*t+r*r;return i>0&&(i=1/Math.sqrt(i)),n[0]=e[0]*i,n[1]=e[1]*i,n}function uj(n,e){return n[0]*e[0]+n[1]*e[1]}function hj(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],s=Math.sqrt(t*t+r*r)*Math.sqrt(i*i+a*a),o=s&&(t*i+r*a)/s;return Math.acos(Math.min(Math.max(o,-1),1))}function fj(n,e){return n[0]===e[0]&&n[1]===e[1]}(function(){var n=sj();return function(e,t,r,i,a,s){var o,c;for(t||(t=2),r||(r=0),i?c=Math.min(i*t+r,e.length):c=e.length,o=r;o<c;o+=t)n[0]=e[o],n[1]=e[o+1],a(n,n,s),e[o]=n[0],e[o+1]=n[1];return e}})();function wD(n){return[parseInt(n.substr(1,2),16),parseInt(n.substr(3,2),16),parseInt(n.substr(5,2),16)]}function fv(n){var e=Math.round(n).toString(16);return e.length===1?"0"+e:e}function SD(n){return"#"+fv(n[0])+fv(n[1])+fv(n[2])}var Vn=function(n){return n!==null&&typeof n!="function"&&isFinite(n.length)},dj=function(n,e){return Vn(n)?n.indexOf(e)>-1:!1};const Sd=dj;var _D=function(n,e){if(!Vn(n))return n;for(var t=[],r=0;r<n.length;r++){var i=n[r];e(i,r)&&t.push(i)}return t},pj=function(n,e){return e===void 0&&(e=[]),_D(n,function(t){return!Sd(e,t)})};const OD=pj,ft=function(n){return typeof n=="function"};var gt=function(n){return n==null},gj={}.toString,bi=function(n,e){return gj.call(n)==="[object "+e+"]"};const me=function(n){return Array.isArray?Array.isArray(n):bi(n,"Array")},ne=function(n){var e=typeof n;return n!==null&&e==="object"||e==="function"};function $o(n,e){if(n){var t;if(me(n))for(var r=0,i=n.length;r<i&&(t=e(n[r],r),t!==!1);r++);else if(ne(n)){for(var a in n)if(n.hasOwnProperty(a)&&(t=e(n[a],a),t===!1))break}}}var vj=Object.keys?function(n){return Object.keys(n)}:function(n){var e=[];return $o(n,function(t,r){ft(n)&&r==="prototype"||e.push(r)}),e};const PD=vj;function CD(n,e){var t=PD(e),r=t.length;if(gt(n))return!r;for(var i=0;i<r;i+=1){var a=t[i];if(e[a]!==n[a]||!(a in n))return!1}return!0}var _d=function(n){return typeof n=="object"&&n!==null},ka=function(n){if(!_d(n)||!bi(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e};function mj(n,e){if(!me(n))return null;var t;if(ft(e)&&(t=e),ka(e)&&(t=function(i){return CD(i,e)}),t){for(var r=0;r<n.length;r+=1)if(t(n[r]))return n[r]}return null}function yj(n,e,t){t===void 0&&(t=0);for(var r=t;r<n.length;r++)if(e(n[r],r))return r;return-1}var bj=function(n,e){for(var t=null,r=0;r<n.length;r++){var i=n[r],a=i[e];if(!gt(a)){me(a)?t=a[0]:t=a;break}}return t};const Ej=bj;var xj=function(n){if(!me(n))return[];for(var e=[],t=0;t<n.length;t++)e=e.concat(n[t]);return e};const wj=xj;var MD=function(n,e){if(e===void 0&&(e=[]),!me(n))e.push(n);else for(var t=0;t<n.length;t+=1)MD(n[t],e);return e};const Sj=MD,zo=function(n){if(me(n))return n.reduce(function(e,t){return Math.max(e,t)},n[0])},jo=function(n){if(me(n))return n.reduce(function(e,t){return Math.min(e,t)},n[0])};var _j=function(n){var e=n.filter(function(s){return!isNaN(s)});if(!e.length)return{min:0,max:0};if(me(n[0])){for(var t=[],r=0;r<n.length;r++)t=t.concat(n[r]);e=t}var i=zo(e),a=jo(e);return{min:a,max:i}};const Oj=_j;var TD=Array.prototype,Pj=TD.splice,Cj=TD.indexOf,Mj=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],a=-1;(a=Cj.call(n,i))>-1;)Pj.call(n,a,1);return n};const Tj=Mj;var Aj=Array.prototype.splice,Nj=function(e,t){if(!Vn(e))return[];for(var r=e?t.length:0,i=r-1;r--;){var a=void 0,s=t[r];(r===i||s!==a)&&(a=s,Aj.call(e,s,1))}return e};const AD=Nj;var ND=function(n,e,t){if(!me(n)&&!ka(n))return n;var r=t;return $o(n,function(i,a){r=e(r,i,a)}),r},Rj=function(n,e){var t=[];if(!Vn(n))return t;for(var r=-1,i=[],a=n.length;++r<a;){var s=n[r];e(s,r,n)&&(t.push(s),i.push(r))}return AD(n,i),t};const kj=Rj,At=function(n){return bi(n,"String")};function Dj(n,e){var t;if(ft(e))t=function(i,a){return e(i)-e(a)};else{var r=[];At(e)?r.push(e):me(e)&&(r=e),t=function(i,a){for(var s=0;s<r.length;s+=1){var o=r[s];if(i[o]>a[o])return 1;if(i[o]<a[o])return-1}return 0}}return n.sort(t),n}function T2(n,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(n))for(var r=0,i=n.length;r<i;r++){var a=n[r];e.has(a)||(t.push(a),e.set(a,!0))}return t}var Lj=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return T2([].concat.apply([],n))};const Ij=Lj,Bj=function(n,e){for(var t=[],r={},i=0;i<n.length;i++){var a=n[i],s=a[e];if(!gt(s)){me(s)||(s=[s]);for(var o=0;o<s.length;o++){var c=s[o];r[c]||(t.push(c),r[c]=!0)}}}return t};function Fj(n){if(Vn(n))return n[0]}function $j(n){if(Vn(n)){var e=n;return e[e.length-1]}}function zj(n,e){return me(n)||At(n)?n[0]===e:!1}function jj(n,e){return me(n)||At(n)?n[n.length-1]===e:!1}var qj=function(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0};const Gj=qj;var Vj=function(n,e){for(var t=0;t<n.length;t++)if(e(n[t],t))return!0;return!1};const Wj=Vj;var Hj=Object.prototype.hasOwnProperty;function sh(n,e){if(!e||!me(n))return{};for(var t={},r=ft(e)?e:function(o){return o[e]},i,a=0;a<n.length;a++){var s=n[a];i=r(s),Hj.call(t,i)?t[i].push(s):t[i]=[s]}return t}function RD(n,e){if(!e)return{0:n};if(!ft(e)){var t=me(e)?e:e.replace(/\s+/g,"").split("*");e=function(r){for(var i="_",a=0,s=t.length;a<s;a++)i+=r[t[a]]&&r[t[a]].toString();return i}}return sh(n,e)}const Uj=function(n,e){if(!e)return[n];var t=RD(n,e),r=[];for(var i in t)r.push(t[i]);return r};function Yj(n,e){return n["_wrap_"+e]}function Kj(n,e){if(n["_wrap_"+e])return n["_wrap_"+e];var t=function(r){n[e](r)};return n["_wrap_"+e]=t,t}var b3={};function Xj(n){var e=b3[n];if(!e){for(var t=n.toString(16),r=t.length;r<6;r++)t="0"+t;e="#"+t,b3[n]=e}return e}function Zj(n){var e=0,t=0,r=0,i=0;return me(n)?n.length===1?e=t=r=i=n[0]:n.length===2?(e=r=n[0],t=i=n[1]):n.length===3?(e=n[0],t=i=n[1],r=n[2]):(e=n[0],t=n[1],r=n[2],i=n[3]):e=t=r=i=n,{r1:e,r2:t,r3:r,r4:i}}var oe=function(n,e,t){return n<e?e:n>t?t:n},Qj=function(n,e){var t=e.toString(),r=t.indexOf(".");if(r===-1)return Math.round(n);var i=t.substr(r+1).length;return i>20&&(i=20),parseFloat(n.toFixed(i))};const Jj=Qj;var rt=function(n){return bi(n,"Number")},t7=function(n){return rt(n)&&n%1!==0};const e7=t7;var n7=function(n){return rt(n)&&n%2===0};const r7=n7;var i7=Number.isInteger?Number.isInteger:function(n){return rt(n)&&n%1===0};const a7=i7;var s7=function(n){return rt(n)&&n<0};const o7=s7;var c7=1e-5;function Co(n,e,t){return t===void 0&&(t=c7),Math.abs(n-e)<t}var l7=function(n){return rt(n)&&n%2!==0};const u7=l7;var h7=function(n){return rt(n)&&n>0};const f7=h7,kD=function(n,e){if(me(n)){for(var t,r=-1/0,i=0;i<n.length;i++){var a=n[i],s=ft(e)?e(a):a[e];s>r&&(t=a,r=s)}return t}},DD=function(n,e){if(me(n)){for(var t,r=1/0,i=0;i<n.length;i++){var a=n[i],s=ft(e)?e(a):a[e];s<r&&(t=a,r=s)}return t}};var d7=function(n,e){return(n%e+e)%e};const A2=d7;var p7=180/Math.PI,g7=function(n){return p7*n};const v7=g7,m7=parseInt;var y7=Math.PI/180,b7=function(n){return y7*n};const E7=b7,E3=function(n,e){return n.hasOwnProperty(e)};var LD=Object.values?function(n){return Object.values(n)}:function(n){var e=[];return $o(n,function(t,r){ft(n)&&r==="prototype"||e.push(t)}),e};const x7=function(n,e){return Sd(LD(n),e)},oh=function(n){return gt(n)?"":n.toString()};var w7=function(n){return oh(n).toLowerCase()};const S7=w7;var ID=function(n){var e=oh(n);return e.charAt(0).toLowerCase()+e.substring(1)};function BD(n,e){return!n||!e?n:n.replace(/\\?\{([^{}]+)\}/g,function(t,r){return t.charAt(0)==="\\"?t.slice(1):e[r]===void 0?"":e[r]})}var _7=function(n){return oh(n).toUpperCase()};const O7=_7;var Nu=function(n){var e=oh(n);return e.charAt(0).toUpperCase()+e.substring(1)},P7={}.toString,C7=function(n){return P7.call(n).replace(/^\[object /,"").replace(/]$/,"")};const FD=C7;var M7=function(n){return bi(n,"Arguments")};const T7=M7;var Ru=function(n){return bi(n,"Boolean")},$D=function(n){return bi(n,"Date")},A7=function(n){return bi(n,"Error")};const N7=A7;function R7(n){return rt(n)&&isFinite(n)}var k7=function(n){return n===null};const zD=k7;var D7=Object.prototype,L7=function(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||D7;return n===t};const jD=L7;var I7=function(n){return bi(n,"RegExp")};const B7=I7;var mt=function(n){return n===void 0},F7=function(n){return n instanceof Element||n instanceof Document};const qD=F7;function $7(n){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)};return e(n)}function z7(n){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;e(n)}function dv(n,e){for(var t in e)e.hasOwnProperty(t)&&t!=="constructor"&&e[t]!==void 0&&(n[t]=e[t])}function ms(n,e,t,r){return e&&dv(n,e),t&&dv(n,t),r&&dv(n,r),n}var j7=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n[0],r=1;r<n.length;r++){var i=n[r];ft(i)&&(i=i.prototype),ms(t.prototype,i)}};const q7=j7;var Cx=function(n){if(typeof n!="object"||n===null)return n;var e;if(me(n)){e=[];for(var t=0,r=n.length;t<r;t++)typeof n[t]=="object"&&n[t]!=null?e[t]=Cx(n[t]):e[t]=n[t]}else{e={};for(var i in n)typeof n[i]=="object"&&n[i]!=null?e[i]=Cx(n[i]):e[i]=n[i]}return e};const _s=Cx;function ch(n,e,t){var r;return function(){var i=this,a=arguments,s=function(){r=null,t||n.apply(i,a)},o=t&&!r;clearTimeout(r),r=setTimeout(s,e),o&&n.apply(i,a)}}function G7(n){var e,t,r,i=n||1;function a(o,c){++e>i&&(r=t,s(1),++e),t[o]=c}function s(o){e=0,t=Object.create(null),o||(r=Object.create(null))}return s(),{clear:s,has:function(o){return t[o]!==void 0||r[o]!==void 0},get:function(o){var c=t[o];if(c!==void 0)return c;if((c=r[o])!==void 0)return a(o,c),c},set:function(o,c){t[o]!==void 0?t[o]=c:a(o,c)}}}const N2=function(n,e,t){if(t===void 0&&(t=128),!ft(n))throw new TypeError("Expected a function");var r=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=e?e.apply(this,i):i[0],o=r.cache;if(o.has(s))return o.get(s);var c=n.apply(this,i);return o.set(s,c),c};return r.cache=G7(t),r};var V7=5;function W7(n,e){if(Object.hasOwn)return Object.hasOwn(n,e);if(n==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(n),e)}function GD(n,e,t,r){t=t||0,r=r||V7;for(var i in e)if(W7(e,i)){var a=e[i];a!==null&&ka(a)?(ka(n[i])||(n[i]={}),t<r?GD(n[i],a,t+1,r):n[i]=e[i]):me(a)?(n[i]=[],n[i]=n[i].concat(a)):a!==void 0&&(n[i]=a)}}var Le=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)GD(n,e[r]);return n},H7=function(n,e,t,r){ft(e)||(t=e,e=n,n=function(){});var i=Object.create?function(s,o){return Object.create(s,{constructor:{value:o}})}:function(s,o){function c(){}c.prototype=s;var l=new c;return l.constructor=o,l},a=i(e.prototype,n);return n.prototype=ms(a,n.prototype),n.superclass=i(e.prototype,e),ms(a,t),ms(n,r),n};const U7=H7;var Y7=function(n,e){if(!Vn(n))return-1;var t=Array.prototype.indexOf;if(t)return t.call(n,e);for(var r=-1,i=0;i<n.length;i++)if(n[i]===e){r=i;break}return r};const K7=Y7;var X7=Object.prototype.hasOwnProperty;function cg(n){if(gt(n))return!0;if(Vn(n))return!n.length;var e=FD(n);if(e==="Map"||e==="Set")return!n.size;if(jD(n))return!Object.keys(n).length;for(var t in n)if(X7.call(n,t))return!1;return!0}var ve=function(n,e){if(n===e)return!0;if(!n||!e||At(n)||At(e))return!1;if(Vn(n)||Vn(e)){if(n.length!==e.length)return!1;for(var t=!0,r=0;r<n.length&&(t=ve(n[r],e[r]),!!t);r++);return t}if(_d(n)||_d(e)){var i=Object.keys(n),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,r=0;r<i.length&&(t=ve(n[i[r]],e[i[r]]),!!t);r++);return t}return!1};const Z7=function(n,e,t){return ft(t)?!!t(n,e):ve(n,e)};var Q7=function(n,e){if(!Vn(n))return n;for(var t=[],r=0;r<n.length;r++){var i=n[r];t.push(e(i,r))}return t};const J7=Q7;var tq=function(n){return n};const eq=function(n,e){e===void 0&&(e=tq);var t={};return ne(n)&&!gt(n)&&Object.keys(n).forEach(function(r){t[r]=e(n[r],r)}),t},ln=function(n,e,t){for(var r=0,i=At(e)?e.split("."):e;n&&r<i.length;)n=n[i[r++]];return n===void 0||r<i.length?t:n},qo=function(n,e,t){var r=n,i=At(e)?e.split("."):e;return i.forEach(function(a,s){s<i.length-1?(ne(r[a])||(r[a]=rt(i[s+1])?[]:{}),r=r[a]):r[a]=t}),n};var nq=Object.prototype.hasOwnProperty;const Os=function(n,e){if(n===null||!ka(n))return{};var t={};return $o(e,function(r){nq.call(n,r)&&(t[r]=n[r])}),t},lg=function(n,e){return ND(n,function(t,r,i){return e.includes(i)||(t[i]=r),t},{})},rq=function(n,e,t){var r,i,a,s,o=0;t||(t={});var c=function(){o=t.leading===!1?0:Date.now(),r=null,s=n.apply(i,a),r||(i=a=null)},l=function(){var u=Date.now();!o&&t.leading===!1&&(o=u);var h=e-(u-o);return i=this,a=arguments,h<=0||h>e?(r&&(clearTimeout(r),r=null),o=u,s=n.apply(i,a),r||(i=a=null)):!r&&t.trailing!==!1&&(r=setTimeout(c,h)),s};return l.cancel=function(){clearTimeout(r),o=0,r=i=a=null},l},iq=function(n){return Vn(n)?Array.prototype.slice.call(n):[]};var Zh={};const VD=function(n){return n=n||"g",Zh[n]?Zh[n]+=1:Zh[n]=1,n+Zh[n]},Jf=function(){},Od=function(n){return n};function aq(n){return gt(n)?0:Vn(n)?n.length:Object.keys(n).length}var sq=function(){function n(){this.map={}}return n.prototype.has=function(e){return this.map[e]!==void 0},n.prototype.get=function(e,t){var r=this.map[e];return r===void 0?t:r},n.prototype.set=function(e,t){this.map[e]=t},n.prototype.clear=function(){this.map={}},n.prototype.delete=function(e){delete this.map[e]},n.prototype.size=function(){return Object.keys(this.map).length},n}();const oq=sq;var cq=/rgba?\(([\s.,0-9]+)\)/;function lq(){var n=document.createElement("i");return n.title="Web Colour Picker",n.style.display="none",document.body.appendChild(n),n}var Qh;function uq(n){if(n[0]==="#"&&n.length===7)return n;Qh||(Qh=lq()),Qh.style.color=n;var e=document.defaultView.getComputedStyle(Qh,"").getPropertyValue("color"),t=cq.exec(e),r=t[1].split(/\s*,\s*/).map(function(i){return Number(i)});return e=SD(r),e}var WD=N2(uq,function(n){return n},256);function pv(n,e,t,r){return n[r]+(e[r]-n[r])*t}function hq(n,e){var t=isNaN(Number(e))||e<0?0:e>1?1:Number(e),r=n.length-1,i=Math.floor(r*t),a=r*t-i,s=n[i],o=i===r?s:n[i+1];return SD([pv(s,o,a,0),pv(s,o,a,1),pv(s,o,a,2)])}function fq(n){var e=typeof n=="string"?n.split("-"):n,t=e.map(function(r){return wD(r.indexOf("#")===-1?WD(r):r)});return function(r){return hq(t,r)}}var dq=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,pq=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,gq=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function vq(n){return/^[r,R,L,l]{1}[\s]*\(/.test(n)}function mq(n){if(vq(n)){var e,t=void 0;if(n[0]==="l"){var r=dq.exec(n),i=+r[1]+90;t=r[2],e="linear-gradient("+i+"deg, "}else if(n[0]==="r"){e="radial-gradient(";var r=pq.exec(n);t=r[4]}var a=t.match(gq);return a.forEach(function(s,o){var c=s.split(":");e+=c[1]+" "+Number(c[0])*100+"%",o!==a.length-1&&(e+=", ")}),e+=")",e}return n}function yq(n,e,t){var r=[0,0,0,0,0,0,0,0,0];return Tz(r,t),og(n,r,e)}function bq(n,e,t){var r=[0,0,0,0,0,0,0,0,0];return Az(r,t),og(n,r,e)}function Eq(n,e,t){var r=[0,0,0,0,0,0,0,0,0];return Nz(r,t),og(n,r,e)}function xq(n,e,t){return og(n,t,e)}function wq(n,e){for(var t=n?[].concat(n):[1,0,0,0,1,0,0,0,1],r=0,i=e.length;r<i;r++){var a=e[r];switch(a[0]){case"t":yq(t,t,[a[1],a[2]]);break;case"s":Eq(t,t,[a[1],a[2]]);break;case"r":bq(t,t,a[1]);break;case"m":xq(t,t,a[1]);break}}return t}function HD(n,e){return n[0]*e[1]-e[0]*n[1]}function Sq(n,e,t){var r=hj(n,e),i=HD(n,e)>=0;return t?i?Math.PI*2-r:r:i?r:Math.PI*2-r}function _q(n,e,t){return t?(n[0]=e[1],n[1]=-1*e[0]):(n[0]=-1*e[1],n[1]=e[0]),n}function Oq(n,e){if(e==="off")return[].concat(n);var t=typeof e=="number"&&e>=1?Math.pow(10,e):1;return n.map(function(r){var i=r.slice(1).map(Number).map(function(a){return e?Math.round(a*t)/t:Math.round(a)});return[r[0]].concat(i)})}function Pq(n,e){return e===void 0&&(e="off"),Oq(n,e).map(function(t){return t[0]+t.slice(1).join(" ")}).join("")}var UD={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Cq(n,e,t){if(n[t].length>7){n[t].shift();for(var r=n[t],i=t;r.length;)e[t]="A",n.splice(i+=1,0,["C"].concat(r.splice(0,6)));n.splice(t,1)}}var Ou={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function YD(n){return Array.isArray(n)&&n.every(function(e){var t=e[0].toLowerCase();return Ou[t]===e.length-1&&"achlmqstvz".includes(t)})}function KD(n){return YD(n)&&n.every(function(e){var t=e[0];return t===t.toUpperCase()})}function XD(n){return KD(n)&&n.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}function x3(n){for(var e=n.pathValue[n.segmentStart],t=e.toLowerCase(),r=n.data;r.length>=Ou[t]&&(t==="m"&&r.length>2?(n.segments.push([e].concat(r.splice(0,2))),t="l",e=e==="m"?"l":"L"):n.segments.push([e].concat(r.splice(0,Ou[t]))),!!Ou[t]););}function Mq(n){var e=n.index,t=n.pathValue,r=t.charCodeAt(e);if(r===48){n.param=0,n.index+=1;return}if(r===49){n.param=1,n.index+=1;return}n.err='[path-util]: invalid Arc flag "'+t[e]+'", expecting 0 or 1 at index '+e}function Tq(n){return n>=48&&n<=57||n===43||n===45||n===46}function eo(n){return n>=48&&n<=57}function Aq(n){var e=n.max,t=n.pathValue,r=n.index,i=r,a=!1,s=!1,o=!1,c=!1,l;if(i>=e){n.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(l=t.charCodeAt(i),(l===43||l===45)&&(i+=1,l=t.charCodeAt(i)),!eo(l)&&l!==46){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" is not a number';return}if(l!==46){if(a=l===48,i+=1,l=t.charCodeAt(i),a&&i<e&&l&&eo(l)){n.err="[path-util]: Invalid path value at index "+r+', "'+t[r]+'" illegal number';return}for(;i<e&&eo(t.charCodeAt(i));)i+=1,s=!0;l=t.charCodeAt(i)}if(l===46){for(c=!0,i+=1;eo(t.charCodeAt(i));)i+=1,o=!0;l=t.charCodeAt(i)}if(l===101||l===69){if(c&&!s&&!o){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid float exponent';return}if(i+=1,l=t.charCodeAt(i),(l===43||l===45)&&(i+=1),i<e&&eo(t.charCodeAt(i)))for(;i<e&&eo(t.charCodeAt(i));)i+=1;else{n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid integer exponent';return}}n.index=i,n.param=+n.pathValue.slice(r,i)}function Nq(n){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&e.includes(n)}function td(n){for(var e=n.pathValue,t=n.max;n.index<t&&Nq(e.charCodeAt(n.index));)n.index+=1}function Rq(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function kq(n){return(n|32)===97}function Dq(n){var e=n.max,t=n.pathValue,r=n.index,i=t.charCodeAt(r),a=Ou[t[r].toLowerCase()];if(n.segmentStart=r,!Rq(i)){n.err='[path-util]: Invalid path value "'+t[r]+'" is not a path command';return}if(n.index+=1,td(n),n.data=[],!a){x3(n);return}for(;;){for(var s=a;s>0;s-=1){if(kq(i)&&(s===3||s===4)?Mq(n):Aq(n),n.err.length)return;n.data.push(n.param),td(n),n.index<e&&t.charCodeAt(n.index)===44&&(n.index+=1,td(n))}if(n.index>=n.max||!Tq(t.charCodeAt(n.index)))break}x3(n)}var Lq=function(){function n(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return n}();function ug(n){if(YD(n))return[].concat(n);var e=new Lq(n);for(td(e);e.index<e.max&&!e.err.length;)Dq(e);return e.err?e.err:e.segments}function ZD(n){if(KD(n))return[].concat(n);var e=ug(n),t=0,r=0,i=0,a=0;return e.map(function(s){var o=s.slice(1).map(Number),c=s[0],l=c.toUpperCase();if(c==="M")return t=o[0],r=o[1],i=t,a=r,["M",t,r];var u;if(c!==l)switch(l){case"A":u=[l,o[0],o[1],o[2],o[3],o[4],o[5]+t,o[6]+r];break;case"V":u=[l,o[0]+r];break;case"H":u=[l,o[0]+t];break;default:{var h=o.map(function(d,p){return d+(p%2?r:t)});u=[l].concat(h)}}else u=[l].concat(o);var f=u.length;switch(l){case"Z":t=i,r=a;break;case"H":t=u[1];break;case"V":r=u[1];break;default:t=u[f-2],r=u[f-1],l==="M"&&(i=t,a=r)}return u})}function Iq(n,e){var t=n[0],r=e.x1,i=e.y1,a=e.x2,s=e.y2,o=n.slice(1).map(Number),c=n;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")c=["L",n[1],i];else if(t==="V")c=["L",r,n[1]];else if(t==="S"){var l=r*2-a,u=i*2-s;e.x1=l,e.y1=u,c=["C",l,u].concat(o)}else if(t==="T"){var h=r*2-e.qx,f=i*2-e.qy;e.qx=h,e.qy=f,c=["Q",h,f].concat(o)}else if(t==="Q"){var d=o[0],p=o[1];e.qx=d,e.qy=p}return c}function Go(n){if(XD(n))return[].concat(n);for(var e=ZD(n),t=G({},UD),r=0;r<e.length;r+=1){e[r]=Iq(e[r],t);var i=e[r],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function Bq(n){return XD(n)&&n.every(function(e){var t=e[0];return"MC".includes(t)})}function Jh(n,e,t){var r=n*Math.cos(t)-e*Math.sin(t),i=n*Math.sin(t)+e*Math.cos(t);return{x:r,y:i}}function hg(n,e,t,r,i,a,s,o,c,l){var u=n,h=e,f=t,d=r,p=o,g=c,v=Math.PI*120/180,m=Math.PI/180*(+i||0),y=[],b,w,x,S,_;if(l)w=l[0],x=l[1],S=l[2],_=l[3];else{b=Jh(u,h,-m),u=b.x,h=b.y,b=Jh(p,g,-m),p=b.x,g=b.y;var E=(u-p)/2,P=(h-g)/2,O=E*E/(f*f)+P*P/(d*d);O>1&&(O=Math.sqrt(O),f*=O,d*=O);var C=f*f,M=d*d,T=(a===s?-1:1)*Math.sqrt(Math.abs((C*M-C*P*P-M*E*E)/(C*P*P+M*E*E)));S=T*f*P/d+(u+p)/2,_=T*-d*E/f+(h+g)/2,w=Math.asin(((h-_)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),x=Math.asin(((g-_)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),w=u<S?Math.PI-w:w,x=p<S?Math.PI-x:x,w<0&&(w=Math.PI*2+w),x<0&&(x=Math.PI*2+x),s&&w>x&&(w-=Math.PI*2),!s&&x>w&&(x-=Math.PI*2)}var R=x-w;if(Math.abs(R)>v){var D=x,B=p,j=g;x=w+v*(s&&x>w?1:-1),p=S+f*Math.cos(x),g=_+d*Math.sin(x),y=hg(p,g,f,d,i,0,s,B,j,[x,D,S,_])}R=x-w;var L=Math.cos(w),$=Math.sin(w),V=Math.cos(x),W=Math.sin(x),Y=Math.tan(R/4),U=4/3*f*Y,J=4/3*d*Y,at=[u,h],ht=[u+U*$,h-J*L],lt=[p+U*W,g-J*V],Nt=[p,g];if(ht[0]=2*at[0]-ht[0],ht[1]=2*at[1]-ht[1],l)return ht.concat(lt,Nt,y);y=ht.concat(lt,Nt,y);for(var pe=[],Be=0,nn=y.length;Be<nn;Be+=1)pe[Be]=Be%2?Jh(y[Be-1],y[Be],m).y:Jh(y[Be],y[Be+1],m).x;return pe}function Fq(n,e,t,r,i,a){var s=.3333333333333333,o=2/3;return[s*n+o*t,s*e+o*r,s*i+o*t,s*a+o*r,i,a]}function fa(n,e,t){var r=n[0],i=n[1],a=e[0],s=e[1];return[r+(a-r)*t,i+(s-i)*t]}var w3=function(n,e,t,r){var i=.5,a=fa([n,e],[t,r],i);return Q(Q([],a,!0),[t,r,t,r],!1)};function $q(n,e){var t=n[0],r=n.slice(1).map(Number),i=r[0],a=r[1],s,o=e.x1,c=e.y1,l=e.x,u=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,n;case"A":return s=[o,c].concat(r),["C"].concat(hg(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return e.qx=i,e.qy=a,s=[o,c].concat(r),["C"].concat(Fq(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(w3(o,c,i,a));case"Z":return o===l&&c===u?["C",o,c,l,u,l,u]:["C"].concat(w3(o,c,l,u))}return n}function Pd(n,e){if(e===void 0&&(e=!1),Bq(n)){var t=[].concat(n);return e?[t,[]]:t}for(var r=Go(n),i=G({},UD),a=[],s="",o=r.length,c,l,u=[],h=0;h<o;h+=1){r[h]&&(s=r[h][0]),a[h]=s;var f=$q(r[h],i);r[h]=f,Cq(r,a,h),o=r.length,s==="Z"&&u.push(h),c=r[h],l=c.length,i.x1=+c[l-2],i.y1=+c[l-1],i.x2=+c[l-4]||i.x1,i.y2=+c[l-3]||i.y1}return e?[r,u]:r}function zq(n){return ug(n)}function QD(n){return n.map(function(e){return Array.isArray(e)?[].concat(e):e})}function JD(n){var e=n.slice(1).map(function(t,r,i){return r?i[r-1].slice(-2).concat(t.slice(1)):n[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(r,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function Mn(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}function Mx(n,e,t,r,i){var a=Mn([n,e],[t,r]),s={x:0,y:0};if(typeof i=="number")if(i<=0)s={x:n,y:e};else if(i>=a)s={x:t,y:r};else{var o=fa([n,e],[t,r],i/a),c=o[0],l=o[1];s={x:c,y:l}}return{length:a,point:s,min:{x:Math.min(n,t),y:Math.min(e,r)},max:{x:Math.max(n,t),y:Math.max(e,r)}}}function S3(n,e){var t=n.x,r=n.y,i=e.x,a=e.y,s=t*i+r*a,o=Math.sqrt((Math.pow(t,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2))),c=t*a-r*i<0?-1:1,l=c*Math.acos(s/o);return l}function jq(n,e,t,r,i,a,s,o,c,l){var u=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,g=u(t),v=u(r),m=(i%360+360)%360,y=m*(p/180);if(n===o&&e===c)return{x:n,y:e};if(g===0||v===0)return Mx(n,e,o,c,l).point;var b=(n-o)/2,w=(e-c)/2,x={x:f(y)*b+h(y)*w,y:-h(y)*b+f(y)*w},S=Math.pow(x.x,2)/Math.pow(g,2)+Math.pow(x.y,2)/Math.pow(v,2);S>1&&(g*=d(S),v*=d(S));var _=Math.pow(g,2)*Math.pow(v,2)-Math.pow(g,2)*Math.pow(x.y,2)-Math.pow(v,2)*Math.pow(x.x,2),E=Math.pow(g,2)*Math.pow(x.y,2)+Math.pow(v,2)*Math.pow(x.x,2),P=_/E;P=P<0?0:P;var O=(a!==s?1:-1)*d(P),C={x:O*(g*x.y/v),y:O*(-(v*x.x)/g)},M={x:f(y)*C.x-h(y)*C.y+(n+o)/2,y:h(y)*C.x+f(y)*C.y+(e+c)/2},T={x:(x.x-C.x)/g,y:(x.y-C.y)/v},R=S3({x:1,y:0},T),D={x:(-x.x-C.x)/g,y:(-x.y-C.y)/v},B=S3(T,D);!s&&B>0?B-=2*p:s&&B<0&&(B+=2*p),B%=2*p;var j=R+B*l,L=g*f(j),$=v*h(j),V={x:f(y)*L-h(y)*$+M.x,y:h(y)*L+f(y)*$+M.y};return V}function qq(n,e,t,r,i,a,s,o,c,l,u){var h,f=u.bbox,d=f===void 0?!0:f,p=u.length,g=p===void 0?!0:p,v=u.sampleSize,m=v===void 0?30:v,y=typeof l=="number",b=n,w=e,x=0,S=[b,w,x],_=[b,w],E=0,P={x:0,y:0},O=[{x:b,y:w}];y&&l<=0&&(P={x:b,y:w});for(var C=0;C<=m;C+=1){if(E=C/m,h=jq(n,e,t,r,i,a,s,o,c,E),b=h.x,w=h.y,d&&O.push({x:b,y:w}),g&&(x+=Mn(_,[b,w])),_=[b,w],y&&x>=l&&l>S[2]){var M=(x-l)/(x-S[2]);P={x:_[0]*(1-M)+S[0]*M,y:_[1]*(1-M)+S[1]*M}}S=[b,w,x]}return y&&l>=x&&(P={x:o,y:c}),{length:x,point:P,min:{x:Math.min.apply(null,O.map(function(T){return T.x})),y:Math.min.apply(null,O.map(function(T){return T.y}))},max:{x:Math.max.apply(null,O.map(function(T){return T.x})),y:Math.max.apply(null,O.map(function(T){return T.y}))}}}function Gq(n,e,t,r,i,a,s,o,c){var l=1-c;return{x:Math.pow(l,3)*n+3*Math.pow(l,2)*c*t+3*l*Math.pow(c,2)*i+Math.pow(c,3)*s,y:Math.pow(l,3)*e+3*Math.pow(l,2)*c*r+3*l*Math.pow(c,2)*a+Math.pow(c,3)*o}}function tL(n,e,t,r,i,a,s,o,c,l){var u,h=l.bbox,f=h===void 0?!0:h,d=l.length,p=d===void 0?!0:d,g=l.sampleSize,v=g===void 0?10:g,m=typeof c=="number",y=n,b=e,w=0,x=[y,b,w],S=[y,b],_=0,E={x:0,y:0},P=[{x:y,y:b}];m&&c<=0&&(E={x:y,y:b});for(var O=0;O<=v;O+=1){if(_=O/v,u=Gq(n,e,t,r,i,a,s,o,_),y=u.x,b=u.y,f&&P.push({x:y,y:b}),p&&(w+=Mn(S,[y,b])),S=[y,b],m&&w>=c&&c>x[2]){var C=(w-c)/(w-x[2]);E={x:S[0]*(1-C)+x[0]*C,y:S[1]*(1-C)+x[1]*C}}x=[y,b,w]}return m&&c>=w&&(E={x:s,y:o}),{length:w,point:E,min:{x:Math.min.apply(null,P.map(function(M){return M.x})),y:Math.min.apply(null,P.map(function(M){return M.y}))},max:{x:Math.max.apply(null,P.map(function(M){return M.x})),y:Math.max.apply(null,P.map(function(M){return M.y}))}}}function Vq(n,e,t,r,i,a,s){var o=1-s;return{x:Math.pow(o,2)*n+2*o*s*t+Math.pow(s,2)*i,y:Math.pow(o,2)*e+2*o*s*r+Math.pow(s,2)*a}}function Wq(n,e,t,r,i,a,s,o){var c,l=o.bbox,u=l===void 0?!0:l,h=o.length,f=h===void 0?!0:h,d=o.sampleSize,p=d===void 0?10:d,g=typeof s=="number",v=n,m=e,y=0,b=[v,m,y],w=[v,m],x=0,S={x:0,y:0},_=[{x:v,y:m}];g&&s<=0&&(S={x:v,y:m});for(var E=0;E<=p;E+=1){if(x=E/p,c=Vq(n,e,t,r,i,a,x),v=c.x,m=c.y,u&&_.push({x:v,y:m}),f&&(y+=Mn(w,[v,m])),w=[v,m],g&&y>=s&&s>b[2]){var P=(y-s)/(y-b[2]);S={x:w[0]*(1-P)+b[0]*P,y:w[1]*(1-P)+b[1]*P}}b=[v,m,y]}return g&&s>=y&&(S={x:i,y:a}),{length:y,point:S,min:{x:Math.min.apply(null,_.map(function(O){return O.x})),y:Math.min.apply(null,_.map(function(O){return O.y}))},max:{x:Math.max.apply(null,_.map(function(O){return O.x})),y:Math.max.apply(null,_.map(function(O){return O.y}))}}}function fg(n,e,t){for(var r,i,a,s,o,c,l=Go(n),u=typeof e=="number",h,f=[],d,p=0,g=0,v=0,m=0,y,b=[],w=[],x=0,S={x:0,y:0},_=S,E=S,P=S,O=0,C=0,M=l.length;C<M;C+=1)y=l[C],d=y[0],h=d==="M",f=h?f:[p,g].concat(y.slice(1)),h?(v=y[1],m=y[2],S={x:v,y:m},_=S,x=0,u&&e<.001&&(P=S)):d==="L"?(r=Mx(f[0],f[1],f[2],f[3],(e||0)-O),x=r.length,S=r.min,_=r.max,E=r.point):d==="A"?(i=qq(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(e||0)-O,t||{}),x=i.length,S=i.min,_=i.max,E=i.point):d==="C"?(a=tL(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(e||0)-O,t||{}),x=a.length,S=a.min,_=a.max,E=a.point):d==="Q"?(s=Wq(f[0],f[1],f[2],f[3],f[4],f[5],(e||0)-O,t||{}),x=s.length,S=s.min,_=s.max,E=s.point):d==="Z"&&(f=[p,g,v,m],o=Mx(f[0],f[1],f[2],f[3],(e||0)-O),x=o.length,S=o.min,_=o.max,E=o.point),u&&O<e&&O+x>=e&&(P=E),w.push(_),b.push(S),O+=x,c=d!=="Z"?y.slice(-2):[v,m],p=c[0],g=c[1];return u&&e>=O&&(P={x:p,y:g}),{length:O,point:P,min:{x:Math.min.apply(null,b.map(function(T){return T.x})),y:Math.min.apply(null,b.map(function(T){return T.y}))},max:{x:Math.max.apply(null,w.map(function(T){return T.x})),y:Math.max.apply(null,w.map(function(T){return T.y}))}}}function Hq(n,e){if(!n)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var t=fg(n,void 0,G(G({},e),{length:!1})),r=t.min,i=r.x,a=r.y,s=t.max,o=s.x,c=s.y,l=o-i,u=c-a;return{width:l,height:u,x:i,y:a,x2:o,y2:c,cx:i+l/2,cy:a+u/2,cz:Math.max(l,u)+Math.min(l,u)/2}}function Mo(n,e){return fg(n,void 0,G(G({},e),{bbox:!1,length:!0})).length}function Uq(n,e){if(!n)return{length:0,x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var t=fg(n,void 0,G(G({},e),{bbox:!0,length:!0})),r=t.length,i=t.min,a=i.x,s=i.y,o=t.max,c=o.x,l=o.y,u=c-a,h=l-s;return{length:r,width:u,height:h,x:a,y:s,x2:c,y2:l,cx:a+u/2,cy:s+h/2,cz:Math.max(u,h)+Math.min(u,h)/2}}function Yq(n){var e=n.length,t=e-1;return n.map(function(r,i){return n.map(function(a,s){var o=i+s,c;return s===0||n[o]&&n[o][0]==="M"?(c=n[o],["M"].concat(c.slice(-2))):(o>=e&&(o-=t),n[o])})})}function eL(n,e){var t=n.length-1,r=[],i=0,a=0,s=Yq(n);return s.forEach(function(o,c){n.slice(1).forEach(function(l,u){a+=Mn(n[(c+u)%t].slice(-2),e[u%t].slice(-2))}),r[c]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),s[i]}function Kq(n,e,t,r,i,a,s,o){return 3*((o-e)*(t+i)-(s-n)*(r+a)+r*(n-i)-t*(e-a)+o*(i+n/3)-s*(a+e/3))/20}function nL(n){var e=0,t=0,r=0;return Pd(n).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var s=i.slice(1),o=s[0],c=s[1],l=s[2],u=s[3],h=s[4],f=s[5];return r=Kq(e,t,o,c,l,u,h,f),a=i.slice(-2),e=a[0],t=a[1],r}}).reduce(function(i,a){return i+a},0)}function Tx(n){return nL(n)>=0}function Pu(n,e,t){return fg(n,e,G(G({},t),{bbox:!1,length:!0})).point}function Xq(n,e){var t=ug(n);if(typeof t=="string")throw TypeError(t);var r=t.slice(),i=Mo(r),a=r.length-1,s=0,o=0,c=t[0],l=c.slice(-2),u=l[0],h=l[1],f={x:u,y:h};if(a<=0||!e||!Number.isFinite(e))return{segment:c,index:0,length:o,point:f,lengthAtSegment:s};if(e>=i)return r=t.slice(0,-1),s=Mo(r),o=i-s,{segment:t[a],index:a,length:o,lengthAtSegment:s};for(var d=[];a>0;)c=r[a],r=r.slice(0,-1),s=Mo(r),o=i-s,i=s,d.push({segment:c,index:a,length:o,lengthAtSegment:s}),a-=1;return d.find(function(p){var g=p.lengthAtSegment;return g<=e})}function Zq(n,e){for(var t=ug(n),r=Go(t),i=Mo(t),a=function(x){var S=x.x-e.x,_=x.y-e.y;return S*S+_*_},s=8,o,c=0,l,u=0,h=1/0,f=0;f<=i;f+=s)o=Pu(r,f),c=a(o),c<h&&(l=o,u=f,h=c);s/=2;for(var d,p,g=0,v=0,m=0,y=0;s>.5;)g=u-s,d=Pu(r,g),m=a(d),v=u+s,p=Pu(r,v),y=a(p),g>=0&&m<h?(l=d,u=g,h=m):v<=i&&y<h?(l=p,u=v,h=y):s/=2;var b=Xq(t,u),w=Math.sqrt(h);return{closest:l,distance:w,segment:b}}function Qq(n,e){var t=Zq(n,e).distance;return Math.abs(t)<.001}function Jq(n,e){e===void 0&&(e=.5);var t=n.slice(0,2),r=n.slice(2,4),i=n.slice(4,6),a=n.slice(6,8),s=fa(t,r,e),o=fa(r,i,e),c=fa(i,a,e),l=fa(s,o,e),u=fa(o,c,e),h=fa(l,u,e);return[["C"].concat(s,l,h),["C"].concat(u,c,a)]}function _3(n){return n.map(function(e,t,r){var i=t&&r[t-1].slice(-2).concat(e.slice(1)),a=t?tL(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,s;return t?s=a?Jq(i):[e,e]:s=[e],{s:e,ss:s,l:a}})}function R2(n,e,t){var r=_3(n),i=_3(e),a=r.length,s=i.length,o=r.filter(function(v){return v.l}).length,c=i.filter(function(v){return v.l}).length,l=r.filter(function(v){return v.l}).reduce(function(v,m){var y=m.l;return v+y},0)/o||0,u=i.filter(function(v){return v.l}).reduce(function(v,m){var y=m.l;return v+y},0)/c||0,h=t||Math.max(a,s),f=[l,u],d=[h-a,h-s],p=0,g=[r,i].map(function(v,m){return v.l===h?v.map(function(y){return y.s}):v.map(function(y,b){return p=b&&d[m]&&y.l>=f[m],d[m]-=p?1:0,p?y.ss:[y.s]}).flat()});return g[0].length===g[1].length?g:R2(g[0],g[1],h)}var tG=1e-6;function gv(n){return Math.abs(n)<tG?0:n<0?-1:1}function eG(n,e,t){return(t[0]-n[0])*(e[1]-n[1])===(e[0]-n[0])*(t[1]-n[1])&&Math.min(n[0],e[0])<=t[0]&&t[0]<=Math.max(n[0],e[0])&&Math.min(n[1],e[1])<=t[1]&&t[1]<=Math.max(n[1],e[1])}function Ax(n,e,t){var r=!1,i=n.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=n[a],o=n[(a+1)%i];if(eG(s,o,[e,t]))return!0;gv(s[1]-t)>0!=gv(o[1]-t)>0&&gv(e-(t-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(r=!r)}return r}var O3=function(n,e,t){return n>=e&&n<=t};function nG(n,e,t,r){var i=.001,a={x:t.x-n.x,y:t.y-n.y},s={x:e.x-n.x,y:e.y-n.y},o={x:r.x-t.x,y:r.y-t.y},c=s.x*o.y-s.y*o.x,l=c*c,u=s.x*s.x+s.y*s.y,h=o.x*o.x+o.y*o.y,f=null;if(l>i*u*h){var d=(a.x*o.y-a.y*o.x)/c,p=(a.x*s.y-a.y*s.x)/c;O3(d,0,1)&&O3(p,0,1)&&(f={x:n.x+d*s.x,y:n.y+d*s.y})}return f}function P3(n){for(var e=[],t=n.length,r=0;r<t-1;r++){var i=n[r],a=n[r+1];e.push({from:{x:i[0],y:i[1]},to:{x:a[0],y:a[1]}})}if(e.length>1){var s=n[0],o=n[t-1];e.push({from:{x:o[0],y:o[1]},to:{x:s[0],y:s[1]}})}return e}function rG(n,e){var t=!1;return n.forEach(function(r){if(nG(r.from,r.to,e.from,e.to))return t=!0,!1}),t}function C3(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(null,e),maxX:Math.max.apply(null,e),minY:Math.min.apply(null,t),maxY:Math.max.apply(null,t)}}function iG(n,e){return!(e.minX>n.maxX||e.maxX<n.minX||e.minY>n.maxY||e.maxY<n.minY)}function aG(n,e){if(n.length<2||e.length<2)return!1;var t=C3(n),r=C3(e);if(!iG(t,r))return!1;var i=!1;if(e.forEach(function(c){if(Ax(n,c[0],c[1]))return i=!0,!1}),i||(n.forEach(function(c){if(Ax(e,c[0],c[1]))return i=!0,!1}),i))return!0;var a=P3(n),s=P3(e),o=!1;return s.forEach(function(c){if(rG(a,c))return o=!0,!1}),o}function Cd(n){var e=document.createElement("div");e.innerHTML=n;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function sG(n,e){if(n)return Object.keys(e).forEach(function(t){n.style[t]=e[t]}),n}const oG=Object.freeze(Object.defineProperty({__proto__:null,Cache:oq,angleTo:Sq,arcToCubic:hg,assign:ms,augment:q7,clamp:oe,clearAnimationFrame:z7,clone:_s,clonePath:QD,contains:Sd,createDOM:Cd,debounce:ch,deepMix:Le,difference:OD,direction:HD,distanceSquareRoot:Mn,each:$o,endsWith:jj,equalizeSegments:R2,every:Gj,extend:U7,filter:_D,find:mj,findIndex:yj,firstValue:Ej,fixedBase:Jj,flatten:wj,flattenDeep:Sj,forIn:$o,get:ln,getDrawDirection:Tx,getPathArea:nL,getPathBBox:Hq,getPathBBoxTotalLength:Uq,getPointAtLength:Pu,getRange:Oj,getRotatedCurve:eL,getTotalLength:Mo,getType:FD,getWrapBehavior:Yj,gradient:fq,group:Uj,groupBy:sh,groupToMap:RD,has:E3,hasKey:E3,hasValue:x7,head:Fj,identity:Od,includes:Sd,indexOf:K7,isArguments:T7,isArray:me,isArrayLike:Vn,isBoolean:Ru,isDate:$D,isDecimal:e7,isElement:qD,isEmpty:cg,isEqual:ve,isEqualWith:Z7,isError:N7,isEven:r7,isFinite:R7,isFunction:ft,isInteger:a7,isMatch:CD,isNegative:o7,isNil:gt,isNull:zD,isNumber:rt,isNumberEqual:Co,isObject:ne,isObjectLike:_d,isOdd:u7,isPlainObject:ka,isPointInPolygon:Ax,isPointInStroke:Qq,isPolygonsIntersect:aG,isPositive:f7,isPrototype:jD,isRegExp:B7,isString:At,isType:bi,isUndefined:mt,keys:PD,last:$j,lowerCase:S7,lowerFirst:ID,map:J7,mapValues:eq,max:zo,maxBy:kD,memoize:N2,min:jo,minBy:DD,mix:ms,mod:A2,modifyCSS:sG,noop:Jf,normalizePath:Go,number2color:Xj,omit:lg,parseRadius:Zj,path2Absolute:ZD,path2Array:zq,path2Curve:Pd,path2String:Pq,pick:Os,pull:Tj,pullAt:AD,reduce:ND,remove:kj,requestAnimationFrame:$7,reverseCurve:JD,rgb2arr:wD,set:qo,size:aq,some:Wj,sortBy:Dj,startsWith:zj,substitute:BD,throttle:rq,toArray:iq,toCSSGradient:mq,toDegree:v7,toInteger:m7,toRGB:WD,toRadian:E7,toString:oh,transform:wq,union:Ij,uniq:T2,uniqueId:VD,upperCase:O7,upperFirst:Nu,values:LD,valuesOfKey:Bj,vertical:_q,wrapBehavior:Kj},Symbol.toStringTag,{value:"Module"}));function k2(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function rL(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function lh(){}var ku=.7,Md=1/ku,To="\\s*([+-]?\\d+)\\s*",Du="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cG=/^#([0-9a-f]{3,8})$/,lG=new RegExp(`^rgb\\(${To},${To},${To}\\)$`),uG=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),hG=new RegExp(`^rgba\\(${To},${To},${To},${Du}\\)$`),fG=new RegExp(`^rgba\\(${pi},${pi},${pi},${Du}\\)$`),dG=new RegExp(`^hsl\\(${Du},${pi},${pi}\\)$`),pG=new RegExp(`^hsla\\(${Du},${pi},${pi},${Du}\\)$`),M3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};k2(lh,dg,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:T3,formatHex:T3,formatHex8:gG,formatHsl:vG,formatRgb:A3,toString:A3});function T3(){return this.rgb().formatHex()}function gG(){return this.rgb().formatHex8()}function vG(){return iL(this).formatHsl()}function A3(){return this.rgb().formatRgb()}function dg(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=cG.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?N3(e):t===3?new zn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?tf(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?tf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=lG.exec(n))?new zn(e[1],e[2],e[3],1):(e=uG.exec(n))?new zn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=hG.exec(n))?tf(e[1],e[2],e[3],e[4]):(e=fG.exec(n))?tf(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=dG.exec(n))?D3(e[1],e[2]/100,e[3]/100,1):(e=pG.exec(n))?D3(e[1],e[2]/100,e[3]/100,e[4]):M3.hasOwnProperty(n)?N3(M3[n]):n==="transparent"?new zn(NaN,NaN,NaN,0):null}function N3(n){return new zn(n>>16&255,n>>8&255,n&255,1)}function tf(n,e,t,r){return r<=0&&(n=e=t=NaN),new zn(n,e,t,r)}function mG(n){return n instanceof lh||(n=dg(n)),n?(n=n.rgb(),new zn(n.r,n.g,n.b,n.opacity)):new zn}function yG(n,e,t,r){return arguments.length===1?mG(n):new zn(n,e,t,r??1)}function zn(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}k2(zn,yG,rL(lh,{brighter(n){return n=n==null?Md:Math.pow(Md,n),new zn(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?ku:Math.pow(ku,n),new zn(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new zn(ys(this.r),ys(this.g),ys(this.b),Td(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:R3,formatHex:R3,formatHex8:bG,formatRgb:k3,toString:k3}));function R3(){return`#${cs(this.r)}${cs(this.g)}${cs(this.b)}`}function bG(){return`#${cs(this.r)}${cs(this.g)}${cs(this.b)}${cs((isNaN(this.opacity)?1:this.opacity)*255)}`}function k3(){const n=Td(this.opacity);return`${n===1?"rgb(":"rgba("}${ys(this.r)}, ${ys(this.g)}, ${ys(this.b)}${n===1?")":`, ${n})`}`}function Td(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function ys(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function cs(n){return n=ys(n),(n<16?"0":"")+n.toString(16)}function D3(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Gr(n,e,t,r)}function iL(n){if(n instanceof Gr)return new Gr(n.h,n.s,n.l,n.opacity);if(n instanceof lh||(n=dg(n)),!n)return new Gr;if(n instanceof Gr)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),a=Math.max(e,t,r),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(t-r)/o+(t<r)*6:t===a?s=(r-e)/o+2:s=(e-t)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Gr(s,o,c,n.opacity)}function EG(n,e,t,r){return arguments.length===1?iL(n):new Gr(n,e,t,r??1)}function Gr(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}k2(Gr,EG,rL(lh,{brighter(n){return n=n==null?Md:Math.pow(Md,n),new Gr(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?ku:Math.pow(ku,n),new Gr(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new zn(vv(n>=240?n-240:n+120,i,r),vv(n,i,r),vv(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new Gr(L3(this.h),ef(this.s),ef(this.l),Td(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Td(this.opacity);return`${n===1?"hsl(":"hsla("}${L3(this.h)}, ${ef(this.s)*100}%, ${ef(this.l)*100}%${n===1?")":`, ${n})`}`}}));function L3(n){return n=(n||0)%360,n<0?n+360:n}function ef(n){return Math.max(0,Math.min(1,n||0))}function vv(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}function ji(n,e,t,r){var i=n-t,a=e-r;return Math.sqrt(i*i+a*a)}function aL(n,e){var t=Math.min.apply(Math,Q([],N(n),!1)),r=Math.min.apply(Math,Q([],N(e),!1)),i=Math.max.apply(Math,Q([],N(n),!1)),a=Math.max.apply(Math,Q([],N(e),!1));return{x:t,y:r,width:i-t,height:a-r}}function xG(n,e,t){return Math.atan(-e/n*Math.tan(t))}function wG(n,e,t){return Math.atan(e/(n*Math.tan(t)))}function SG(n,e,t,r,i,a){return t*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+n}function _G(n,e,t,r,i,a){return t*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+e}function OG(n,e,t,r,i,a,s){for(var o=xG(t,r,i),c=1/0,l=-1/0,u=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var f=o+h;a<s?a<f&&f<s&&u.push(f):s<f&&f<a&&u.push(f)}for(var h=0;h<u.length;h++){var d=SG(n,e,t,r,i,u[h]);d<c&&(c=d),d>l&&(l=d)}for(var p=wG(t,r,i),g=1/0,v=-1/0,m=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var y=p+h;a<s?a<y&&y<s&&m.push(y):s<y&&y<a&&m.push(y)}for(var h=0;h<m.length;h++){var b=_G(n,e,t,r,i,m[h]);b<g&&(g=b),b>v&&(v=b)}return{x:c,y:g,width:l-c,height:v-g}}var PG=1e-4;function sL(n,e,t,r,i,a){var s=-1,o=1/0,c=[t,r],l=20;a&&a>200&&(l=a/10);for(var u=1/l,h=u/10,f=0;f<=l;f++){var d=f*u,p=[i.apply(void 0,Q([],N(n.concat([d])),!1)),i.apply(void 0,Q([],N(e.concat([d])),!1))],g=ji(c[0],c[1],p[0],p[1]);g<o&&(s=d,o=g)}if(s===0)return{x:n[0],y:e[0]};if(s===1){var v=n.length;return{x:n[v-1],y:e[v-1]}}o=1/0;for(var f=0;f<32&&!(h<PG);f++){var m=s-h,y=s+h,p=[i.apply(void 0,Q([],N(n.concat([m])),!1)),i.apply(void 0,Q([],N(e.concat([m])),!1))],g=ji(c[0],c[1],p[0],p[1]);if(m>=0&&g<o)s=m,o=g;else{var b=[i.apply(void 0,Q([],N(n.concat([y])),!1)),i.apply(void 0,Q([],N(e.concat([y])),!1))],w=ji(c[0],c[1],b[0],b[1]);y<=1&&w<o?(s=y,o=w):h*=.5}}return{x:i.apply(void 0,Q([],N(n.concat([s])),!1)),y:i.apply(void 0,Q([],N(e.concat([s])),!1))}}function oL(n,e,t,r){return ji(n,e,t,r)}function cL(n,e,t,r,i){return{x:(1-i)*n+i*t,y:(1-i)*e+i*r}}function CG(n,e,t,r,i,a){var s=[t-n,r-e];if(fj(s,[0,0]))return Math.sqrt((i-n)*(i-n)+(a-e)*(a-e));var o=[-s[1],s[0]];lj(o,o);var c=[i-n,a-e];return Math.abs(uj(c,o))}function Nx(n,e,t,r,i){var a=1-i;return a*a*a*n+3*e*i*a*a+3*t*i*i*a+r*i*i*i}function I3(n,e,t,r){var i=-3*n+9*e-9*t+3*r,a=6*n-12*e+6*t,s=3*e-3*n,o=[],c,l,u;if(Co(i,0))Co(a,0)||(c=-s/a,c>=0&&c<=1&&o.push(c));else{var h=a*a-4*i*s;Co(h,0)?o.push(-a/(2*i)):h>0&&(u=Math.sqrt(h),c=(-a+u)/(2*i),l=(-a-u)/(2*i),c>=0&&c<=1&&o.push(c),l>=0&&l<=1&&o.push(l))}return o}function MG(n,e,t,r,i,a,s,o){for(var c=[n,s],l=[e,o],u=I3(n,t,i,s),h=I3(e,r,a,o),f=0;f<u.length;f++)c.push(Nx(n,t,i,s,u[f]));for(var f=0;f<h.length;f++)l.push(Nx(e,r,a,o,h[f]));return aL(c,l)}function TG(n,e,t,r,i,a,s,o,c,l,u){return sL([n,t,i,s],[e,r,a,o],c,l,Nx,u)}function B3(n,e,t,r,i,a,s,o,c,l,u){var h=TG(n,e,t,r,i,a,s,o,c,l,u);return ji(h.x,h.y,c,l)}function AG(n){if(n.length<2)return 0;for(var e=0,t=0;t<n.length-1;t++){var r=n[t],i=n[t+1];e+=ji(r[0],r[1],i[0],i[1])}return e}function NG(n){return AG(n)}function Rx(n,e,t,r){var i=1-r;return i*i*n+2*r*i*e+r*r*t}function F3(n,e,t){var r=n+t-2*e;if(Co(r,0))return[.5];var i=(n-e)/r;return i<=1&&i>=0?[i]:[]}function RG(n,e,t,r,i,a){var s=F3(n,t,i)[0],o=F3(e,r,a)[0],c=[n,i],l=[e,a];return s!==void 0&&c.push(Rx(n,t,i,s)),o!==void 0&&l.push(Rx(e,r,a,o)),aL(c,l)}function kG(n,e,t,r,i,a,s,o){return sL([n,t,i],[e,r,a],s,o,Rx)}function DG(n,e,t,r,i,a,s,o){var c=kG(n,e,t,r,i,a,s,o);return ji(c.x,c.y,s,o)}var LG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lL={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(LG,function(){function t(x,S,_,E,P){r(x,S,_||0,E||x.length-1,P||a)}function r(x,S,_,E,P){for(;E>_;){if(E-_>600){var O=E-_+1,C=S-_+1,M=Math.log(O),T=.5*Math.exp(2*M/3),R=.5*Math.sqrt(M*T*(O-T)/O)*(C-O/2<0?-1:1),D=Math.max(_,Math.floor(S-C*T/O+R)),B=Math.min(E,Math.floor(S+(O-C)*T/O+R));r(x,S,D,B,P)}var j=x[S],L=_,$=E;for(i(x,_,S),P(x[E],j)>0&&i(x,_,E);L<$;){for(i(x,L,$),L++,$--;P(x[L],j)<0;)L++;for(;P(x[$],j)>0;)$--}P(x[_],j)===0?i(x,_,$):($++,i(x,$,E)),$<=S&&(_=$+1),S<=$&&(E=$-1)}}function i(x,S,_){var E=x[S];x[S]=x[_],x[_]=E}function a(x,S){return x<S?-1:x>S?1:0}var s=function(S){S===void 0&&(S=9),this._maxEntries=Math.max(4,S),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(S){var _=this.data,E=[];if(!y(S,_))return E;for(var P=this.toBBox,O=[];_;){for(var C=0;C<_.children.length;C++){var M=_.children[C],T=_.leaf?P(M):M;y(S,T)&&(_.leaf?E.push(M):m(S,T)?this._all(M,E):O.push(M))}_=O.pop()}return E},s.prototype.collides=function(S){var _=this.data;if(!y(S,_))return!1;for(var E=[];_;){for(var P=0;P<_.children.length;P++){var O=_.children[P],C=_.leaf?this.toBBox(O):O;if(y(S,C)){if(_.leaf||m(S,C))return!0;E.push(O)}}_=E.pop()}return!1},s.prototype.load=function(S){if(!(S&&S.length))return this;if(S.length<this._minEntries){for(var _=0;_<S.length;_++)this.insert(S[_]);return this}var E=this._build(S.slice(),0,S.length-1,0);if(!this.data.children.length)this.data=E;else if(this.data.height===E.height)this._splitRoot(this.data,E);else{if(this.data.height<E.height){var P=this.data;this.data=E,E=P}this._insert(E,this.data.height-E.height-1,!0)}return this},s.prototype.insert=function(S){return S&&this._insert(S,this.data.height-1),this},s.prototype.clear=function(){return this.data=b([]),this},s.prototype.remove=function(S,_){if(!S)return this;for(var E=this.data,P=this.toBBox(S),O=[],C=[],M,T,R;E||O.length;){if(E||(E=O.pop(),T=O[O.length-1],M=C.pop(),R=!0),E.leaf){var D=o(S,E.children,_);if(D!==-1)return E.children.splice(D,1),O.push(E),this._condense(O),this}!R&&!E.leaf&&m(E,P)?(O.push(E),C.push(M),M=0,T=E,E=E.children[0]):T?(M++,E=T.children[M],R=!1):E=null}return this},s.prototype.toBBox=function(S){return S},s.prototype.compareMinX=function(S,_){return S.minX-_.minX},s.prototype.compareMinY=function(S,_){return S.minY-_.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(S){return this.data=S,this},s.prototype._all=function(S,_){for(var E=[];S;)S.leaf?_.push.apply(_,S.children):E.push.apply(E,S.children),S=E.pop();return _},s.prototype._build=function(S,_,E,P){var O=E-_+1,C=this._maxEntries,M;if(O<=C)return M=b(S.slice(_,E+1)),c(M,this.toBBox),M;P||(P=Math.ceil(Math.log(O)/Math.log(C)),C=Math.ceil(O/Math.pow(C,P-1))),M=b([]),M.leaf=!1,M.height=P;var T=Math.ceil(O/C),R=T*Math.ceil(Math.sqrt(C));w(S,_,E,R,this.compareMinX);for(var D=_;D<=E;D+=R){var B=Math.min(D+R-1,E);w(S,D,B,T,this.compareMinY);for(var j=D;j<=B;j+=T){var L=Math.min(j+T-1,B);M.children.push(this._build(S,j,L,P-1))}}return c(M,this.toBBox),M},s.prototype._chooseSubtree=function(S,_,E,P){for(;P.push(_),!(_.leaf||P.length-1===E);){for(var O=1/0,C=1/0,M=void 0,T=0;T<_.children.length;T++){var R=_.children[T],D=d(R),B=g(S,R)-D;B<C?(C=B,O=D<O?D:O,M=R):B===C&&D<O&&(O=D,M=R)}_=M||_.children[0]}return _},s.prototype._insert=function(S,_,E){var P=E?S:this.toBBox(S),O=[],C=this._chooseSubtree(P,this.data,_,O);for(C.children.push(S),u(C,P);_>=0&&O[_].children.length>this._maxEntries;)this._split(O,_),_--;this._adjustParentBBoxes(P,O,_)},s.prototype._split=function(S,_){var E=S[_],P=E.children.length,O=this._minEntries;this._chooseSplitAxis(E,O,P);var C=this._chooseSplitIndex(E,O,P),M=b(E.children.splice(C,E.children.length-C));M.height=E.height,M.leaf=E.leaf,c(E,this.toBBox),c(M,this.toBBox),_?S[_-1].children.push(M):this._splitRoot(E,M)},s.prototype._splitRoot=function(S,_){this.data=b([S,_]),this.data.height=S.height+1,this.data.leaf=!1,c(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(S,_,E){for(var P,O=1/0,C=1/0,M=_;M<=E-_;M++){var T=l(S,0,M,this.toBBox),R=l(S,M,E,this.toBBox),D=v(T,R),B=d(T)+d(R);D<O?(O=D,P=M,C=B<C?B:C):D===O&&B<C&&(C=B,P=M)}return P||E-_},s.prototype._chooseSplitAxis=function(S,_,E){var P=S.leaf?this.compareMinX:h,O=S.leaf?this.compareMinY:f,C=this._allDistMargin(S,_,E,P),M=this._allDistMargin(S,_,E,O);C<M&&S.children.sort(P)},s.prototype._allDistMargin=function(S,_,E,P){S.children.sort(P);for(var O=this.toBBox,C=l(S,0,_,O),M=l(S,E-_,E,O),T=p(C)+p(M),R=_;R<E-_;R++){var D=S.children[R];u(C,S.leaf?O(D):D),T+=p(C)}for(var B=E-_-1;B>=_;B--){var j=S.children[B];u(M,S.leaf?O(j):j),T+=p(M)}return T},s.prototype._adjustParentBBoxes=function(S,_,E){for(var P=E;P>=0;P--)u(_[P],S)},s.prototype._condense=function(S){for(var _=S.length-1,E=void 0;_>=0;_--)S[_].children.length===0?_>0?(E=S[_-1].children,E.splice(E.indexOf(S[_]),1)):this.clear():c(S[_],this.toBBox)};function o(x,S,_){if(!_)return S.indexOf(x);for(var E=0;E<S.length;E++)if(_(x,S[E]))return E;return-1}function c(x,S){l(x,0,x.children.length,S,x)}function l(x,S,_,E,P){P||(P=b(null)),P.minX=1/0,P.minY=1/0,P.maxX=-1/0,P.maxY=-1/0;for(var O=S;O<_;O++){var C=x.children[O];u(P,x.leaf?E(C):C)}return P}function u(x,S){return x.minX=Math.min(x.minX,S.minX),x.minY=Math.min(x.minY,S.minY),x.maxX=Math.max(x.maxX,S.maxX),x.maxY=Math.max(x.maxY,S.maxY),x}function h(x,S){return x.minX-S.minX}function f(x,S){return x.minY-S.minY}function d(x){return(x.maxX-x.minX)*(x.maxY-x.minY)}function p(x){return x.maxX-x.minX+(x.maxY-x.minY)}function g(x,S){return(Math.max(S.maxX,x.maxX)-Math.min(S.minX,x.minX))*(Math.max(S.maxY,x.maxY)-Math.min(S.minY,x.minY))}function v(x,S){var _=Math.max(x.minX,S.minX),E=Math.max(x.minY,S.minY),P=Math.min(x.maxX,S.maxX),O=Math.min(x.maxY,S.maxY);return Math.max(0,P-_)*Math.max(0,O-E)}function m(x,S){return x.minX<=S.minX&&x.minY<=S.minY&&S.maxX<=x.maxX&&S.maxY<=x.maxY}function y(x,S){return S.minX<=x.maxX&&S.minY<=x.maxY&&S.maxX>=x.minX&&S.maxY>=x.minY}function b(x){return{children:x,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function w(x,S,_,E,P){for(var O=[S,_];O.length;)if(_=O.pop(),S=O.pop(),!(_-S<=E)){var C=S+Math.ceil((_-S)/E/2)*E;t(x,C,S,_,P),O.push(S,C,C,_)}}return s})})(lL);var uL=lL.exports,X;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(X||(X={}));var bs;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(bs||(bs={}));var Xi=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),hL=function(){function n(e){this.clipSpaceNearZ=bs.NEGATIVE_ONE,this.plugins=[],this.config=G({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function no(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function mv(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function ed(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function $3(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function IG(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function BG(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function Es(n){return n===void 0?0:n>360||n<-360?n%360:n}function vn(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?Ni(n):rt(n)?Wt(n,e,t):Wt(n[0],n[1]||e,n[2]||t)}function ee(n){return n*(Math.PI/180)}function Qn(n){return n*(180/Math.PI)}function FG(n){return n=n%400,n<0&&(n+=400),n/400*360}function $G(n){return n/360}function fL(n){return 360*n}function zG(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],s=t*t,o=r*r,c=i*i,l=a*a,u=s+o+c+l,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(c+l)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(o+c))),n}function jG(n,e){var t,r,i=Math.PI*.5,a=N(Fo(Ct(),e),3),s=a[0],o=a[1],c=a[2],l=Math.asin(-e[2]/s);return l<i?l>-i?(t=Math.atan2(e[6]/o,e[10]/c),r=Math.atan2(e[1]/s,e[0]/s)):(r=0,t=-Math.atan2(e[4]/o,e[5]/o)):(r=0,t=Math.atan2(e[4]/o,e[5]/o)),n[0]=t,n[1]=l,n[2]=r,n}function nd(n,e){return e.length===16?jG(n,e):zG(n,e)}function dL(n,e,t,r,i){var a=Math.cos(n),s=Math.sin(n);return Mz(r*a,i*s,0,-r*s,i*a,0,e,t,1)}function qG(n,e,t,r,i,a,s,o){o===void 0&&(o=!1);var c=2*a/(t-e),l=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return o?(f=-s/(s-a),d=-s*a/(s-a)):(f=-(s+a)/(s-a),d=-2*s*a/(s-a)),n[0]=c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function kx(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),s=Math.sqrt(r*r+i*i),o=e*i-t*r;o<0&&(e<i?a=-a:s=-s),a&&(e*=1/a,t*=1/a),s&&(r*=1/s,i*=1/s);var c=Math.atan2(t,e),l=Qn(c);return[n[6],n[7],a,s,l]}var ai=le(),$r=le(),Nc=vo(),yt=[Ct(),Ct(),Ct()],z3=Ct();function GG(n,e,t,r,i,a){if(!VG(ai,n)||(Bo($r,ai),$r[3]=0,$r[7]=0,$r[11]=0,$r[15]=1,Math.abs(sD($r))<1e-8))return!1;var s=ai[3],o=ai[7],c=ai[11],l=ai[12],u=ai[13],h=ai[14],f=ai[15];if(s!==0||o!==0||c!==0){Nc[0]=s,Nc[1]=o,Nc[2]=c,Nc[3]=f;var d=li($r,$r);if(!d)return!1;aD($r,$r),su(i,Nc,$r)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=l,e[1]=u,e[2]=h,WG(yt,ai),t[0]=Ii(yt[0]),vs(yt[0],yt[0]),r[0]=ui(yt[0],yt[1]),yv(yt[1],yt[1],yt[0],1,-r[0]),t[1]=Ii(yt[1]),vs(yt[1],yt[1]),r[0]/=t[1],r[1]=ui(yt[0],yt[2]),yv(yt[2],yt[2],yt[0],1,-r[1]),r[2]=ui(yt[1],yt[2]),yv(yt[2],yt[2],yt[1],1,-r[2]),t[2]=Ii(yt[2]),vs(yt[2],yt[2]),r[1]/=t[2],r[2]/=t[2],Qf(z3,yt[1],yt[2]),ui(yt[0],z3)<0)for(var p=0;p<3;p++)t[p]*=-1,yt[p][0]*=-1,yt[p][1]*=-1,yt[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+yt[0][0]-yt[1][1]-yt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-yt[0][0]+yt[1][1]-yt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-yt[0][0]-yt[1][1]+yt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+yt[0][0]+yt[1][1]+yt[2][2],0)),yt[2][1]>yt[1][2]&&(a[0]=-a[0]),yt[0][2]>yt[2][0]&&(a[1]=-a[1]),yt[1][0]>yt[0][1]&&(a[2]=-a[2]),!0}function VG(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function WG(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function yv(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var ue=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){no(this.center,e),no(this.halfExtents,t),mv(this.min,this.center,this.halfExtents),ed(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){ed(this.center,t,e),$3(this.center,this.center,.5),mv(this.halfExtents,t,e),$3(this.halfExtents,this.halfExtents,.5),no(this.min,e),no(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],s=this.halfExtents,o=s[0],c=s[1],l=s[2],u=r-o,h=r+o,f=i-c,d=i+c,p=a-l,g=a+l,v=e.center,m=v[0],y=v[1],b=v[2],w=e.halfExtents,x=w[0],S=w[1],_=w[2],E=m-x,P=m+x,O=y-S,C=y+S,M=b-_,T=b+_;E<u&&(u=E),P>h&&(h=P),O<f&&(f=O),C>d&&(d=C),M<p&&(p=M),T>g&&(g=T),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+g)*.5,s[0]=(h-u)*.5,s[1]=(d-f)*.5,s[2]=(g-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=g}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,s=e.halfExtents,o=t[0],c=t[4],l=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],g=t[10],v=Math.abs(o),m=Math.abs(c),y=Math.abs(l),b=Math.abs(u),w=Math.abs(h),x=Math.abs(f),S=Math.abs(d),_=Math.abs(p),E=Math.abs(g);r[0]=t[12]+o*a[0]+c*a[1]+l*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+g*a[2],i[0]=v*s[0]+m*s[1]+y*s[2],i[1]=b*s[0]+w*s[1]+x*s[2],i[2]=S*s[0]+_*s[1]+E*s[2],mv(this.min,r,i),ed(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=IG([0,0,0],this.getMin(),e.getMin()),i=BG([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?no([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?no([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),pL=function(){function n(e,t){this.distance=e||0,this.normal=t||Wt(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return ui(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/xD(this.normal);Ox(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),s=i/(i-a),o=s>=0&&s<=1;return o&&r&&Px(r,e,t,s),o},n}(),Di;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(Di||(Di={}));var gL=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new pL)}return n.prototype.extractFromVPMatrix=function(e){var t=N(e,16),r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],g=t[12],v=t[13],m=t[14],y=t[15];qr(this.planes[0].normal,s-r,u-o,p-h),this.planes[0].distance=y-g,qr(this.planes[1].normal,s+r,u+o,p+h),this.planes[1].distance=y+g,qr(this.planes[2].normal,s+i,u+c,p+f),this.planes[2].distance=y+v,qr(this.planes[3].normal,s-i,u-c,p-f),this.planes[3].distance=y-v,qr(this.planes[4].normal,s-a,u-l,p-d),this.planes[4].distance=y-m,qr(this.planes[5].normal,s+a,u+l,p+d),this.planes[5].distance=y+m,this.planes.forEach(function(b){b.normalize(),b.updatePNVertexFlag()})},n}(),tn=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),Da=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.prototype.toJSON=function(){},n}(),Jt="Method not implemented.",ro="Use document.documentElement instead.",HG="Cannot append a destroyed element.",Ut;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(Ut||(Ut={}));var Vo;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(Vo||(Vo={}));var Cn;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Cn||(Cn={}));var D2={UPDATED:"updated"},j3=2e-4,L2=function(){function n(){this.clipSpaceNearZ=bs.NEGATIVE_ONE,this.eventEmitter=new C2,this.matrix=le(),this.right=Wt(1,0,0),this.up=Wt(0,1,0),this.forward=Wt(0,0,1),this.position=Wt(0,0,1),this.focalPoint=Wt(0,0,0),this.distanceVector=Wt(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=le(),this.projectionMatrixInverse=le(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Ut.EXPLORING,this.trackingMode=Vo.DEFAULT,this.projectionMode=Cn.PERSPECTIVE,this.frustum=new gL,this.orthoMatrix=le()}return n.prototype.isOrtho=function(){return this.projectionMode===Cn.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===Ut.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Ut.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==Ut.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return li(le(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=as(le(),[e,t,0]);this.jitteredProjectionMatrix=En(le(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Cn.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Cn.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,s){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.projectionMode===Cn.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Cn.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Cn.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Cn.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,s=this.roll;this.rotate(0,0,-s),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,s);var o=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),c=o.x,l=o.y,u=Wt(c-i,l-a,0),h=ui(u,this.right)/Ii(this.right),f=ui(u,this.up)/Ii(this.up),d=N(this.getPosition(),2),p=d[0],g=d[1],v=N(this.getFocalPoint(),2),m=v[0],y=v[1];return this.setPosition(p-h,g-f),this.setFocalPoint(m-h,y-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Cn.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var s=this.near*Math.tan(ee(.5*this.fov))/this.zoom,o=2*s,c=this.aspect*o,l=-.5*c;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;l+=this.view.offsetX*c/u,s-=this.view.offsetY*o/h,c*=this.view.width/u,o*=this.view.height/h}return qG(this.projectionMatrix,l,l+c,s-o,s,e,this.far,this.clipSpaceNearZ===bs.ZERO),li(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,s){var o;this.projectionMode=Cn.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=s;var c=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-c,d=u+c,p=h+l,g=h-l;if(!((o=this.view)===null||o===void 0)&&o.enabled){var v=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=v*this.view.offsetX,d=f+v*this.view.width,p-=m*this.view.offsetY,g=p-m*this.view.height}return this.clipSpaceNearZ===bs.NEGATIVE_ONE?vD(this.projectionMatrix,f,d,p,g,a,s):mD(this.projectionMatrix,f,d,p,g,a,s),li(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=vn(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=Wt(0,1,0);if(this.focalPoint=vn(e,t,r),this.trackingMode===Vo.CINEMATIC){var a=v3(Ct(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var s=Ii(a),o=Qn(Math.asin(t/s)),c=90+Qn(Math.atan2(r,e)),l=le();lD(l,l,ee(c)),cD(l,l,ee(o)),i=Ye(Ct(),[0,1,0],l)}return li(this.matrix,yD(le(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<j3&&(this.distance=j3),this.dollyingStep=this.distance/100;var t=Ct();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=Es(e),this.computeMatrix(),this._getAxes(),this.type===Ut.ORBITING||this.type===Ut.EXPLORING?this._getPosition():this.type===Ut.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=Es(e),this.computeMatrix(),this._getAxes(),this.type===Ut.ORBITING||this.type===Ut.EXPLORING?this._getPosition():this.type===Ut.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=Es(e),this.computeMatrix(),this._getAxes(),this.type===Ut.ORBITING||this.type===Ut.EXPLORING?this._getPosition():this.type===Ut.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=ma($e(),[0,0,1],ee(this.roll));ks(this.matrix);var t=ma($e(),[1,0,0],ee((this.rotateWorld&&this.type!==Ut.TRACKING||this.type===Ut.TRACKING?1:-1)*this.elevation)),r=ma($e(),[0,1,0],ee((this.rotateWorld&&this.type!==Ut.TRACKING||this.type===Ut.TRACKING?1:-1)*this.azimuth)),i=Oa($e(),r,t);i=Oa($e(),i,e);var a=M2(le(),i);this.type===Ut.ORBITING||this.type===Ut.EXPLORING?(Oo(this.matrix,this.matrix,this.focalPoint),En(this.matrix,this.matrix,a),Oo(this.matrix,this.matrix,[0,0,this.distance])):this.type===Ut.TRACKING&&(Oo(this.matrix,this.matrix,this.position),En(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=vn(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){va(this.right,vn(su(vo(),[1,0,0,0],this.matrix))),va(this.up,vn(su(vo(),[0,1,0,0],this.matrix))),va(this.forward,vn(su(vo(),[0,0,1,0],this.matrix))),vs(this.right,this.right),vs(this.up,this.up),vs(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=Ii(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===Ut.TRACKING?(this.elevation=Qn(Math.asin(t/i)),this.azimuth=Qn(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=Qn(Math.asin(t/i)),this.azimuth=Qn(Math.atan2(-e,-r))):(this.elevation=-Qn(Math.asin(t/i)),this.azimuth=-Qn(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){va(this.position,vn(su(vo(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){tj(this.distanceVector,[0,0,-this.distance],Cz(rD(),this.matrix)),Po(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=v3(Ct(),this.focalPoint,this.position),this.distance=Ii(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Cn.ORTHOGRAPHIC){var e=this.position,t=ma($e(),[0,0,1],-this.roll*Math.PI/180);_u(this.orthoMatrix,t,Wt((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),Wt(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=En(le(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(D2.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(Jt)},n.prototype.pan=function(e,t){throw new Error(Jt)},n.prototype.dolly=function(e){throw new Error(Jt)},n.prototype.createLandmark=function(e,t){throw new Error(Jt)},n.prototype.gotoLandmark=function(e,t){throw new Error(Jt)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(Jt)},n}();function hn(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],s=t.cache;if(s.has(a))return s.get(a);var o=n.apply(this,r);return t.cache=s.set(a,o)||s,o};return t.cache=new(hn.Cache||Map),t}hn.Cache=Map;var st;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(st||(st={}));var tr;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(tr||(tr={}));var q3;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(q3||(q3={}));var Dx;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(Dx||(Dx={}));var Lx;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(Lx||(Lx={}));var UG=[{name:"em",unit_type:st.kEms},{name:"px",unit_type:st.kPixels},{name:"deg",unit_type:st.kDegrees},{name:"rad",unit_type:st.kRadians},{name:"grad",unit_type:st.kGradians},{name:"ms",unit_type:st.kMilliseconds},{name:"s",unit_type:st.kSeconds},{name:"rem",unit_type:st.kRems},{name:"turn",unit_type:st.kTurns}],La;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(La||(La={}));var YG=function(n){return UG.find(function(e){return e.name===n}).unit_type},KG=function(n){return n?n==="number"?st.kNumber:n==="percent"||n==="%"?st.kPercentage:YG(n):st.kUnknown},XG=function(n){switch(n){case st.kNumber:case st.kInteger:return tr.kUNumber;case st.kPercentage:return tr.kUPercent;case st.kPixels:return tr.kULength;case st.kMilliseconds:case st.kSeconds:return tr.kUTime;case st.kDegrees:case st.kRadians:case st.kGradians:case st.kTurns:return tr.kUAngle;default:return tr.kUOther}},ZG=function(n){switch(n){case tr.kUNumber:return st.kNumber;case tr.kULength:return st.kPixels;case tr.kUPercent:return st.kPercentage;case tr.kUTime:return st.kSeconds;case tr.kUAngle:return st.kDegrees;default:return st.kUnknown}},G3=function(n){var e=1;switch(n){case st.kPixels:case st.kDegrees:case st.kSeconds:break;case st.kMilliseconds:e=.001;break;case st.kRadians:e=180/Math.PI;break;case st.kGradians:e=.9;break;case st.kTurns:e=360;break}return e},Ix=function(n){switch(n){case st.kNumber:case st.kInteger:return"";case st.kPercentage:return"%";case st.kEms:return"em";case st.kRems:return"rem";case st.kPixels:return"px";case st.kDegrees:return"deg";case st.kRadians:return"rad";case st.kGradians:return"grad";case st.kMilliseconds:return"ms";case st.kSeconds:return"s";case st.kTurns:return"turn"}return""},uh=function(){function n(){}return n.isAngle=function(e){return e===st.kDegrees||e===st.kRadians||e===st.kGradians||e===st.kTurns},n.isLength=function(e){return e>=st.kEms&&e<st.kDegrees},n.isRelativeUnit=function(e){return e===st.kPercentage||e===st.kEms||e===st.kRems},n.isTime=function(e){return e===st.kSeconds||e===st.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(Dx.kNo,Lx.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=La.kUnitType&&this.getType()<=La.kClampType},n}(),QG=function(n){tt(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return La.kColorType},e.prototype.to=function(t){return this},e}(uh),Hr;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(Hr||(Hr={}));var ou=function(n){tt(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return La.kColorType},e}(uh),Rn=function(n){tt(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return La.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(uh),JG=hn(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),V3=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function tV(n){if(!n)throw new Error}function mo(n){return typeof n=="function"}function eV(n){return typeof n=="symbol"}var nV=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=N(e,2),r=t[1];return r!==void 0}))},rV={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},Bx=hn(function(n){var e=JG(n),t=rV[e];return e=(t==null?void 0:t.alias)||e,e}),iV=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(tV(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},Fx=function(n){return ZG(XG(n))},te=function(n){tt(e,n);function e(t,r){r===void 0&&(r=st.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=KG(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return La.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=Fx(this.unit);if(r!==Fx(t)||r===st.kUnknown)return null;var i=G3(this.unit)/G3(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case st.kUnknown:break;case st.kInteger:a=Number(this.value).toFixed(0);break;case st.kNumber:case st.kPercentage:case st.kEms:case st.kRems:case st.kPixels:case st.kDegrees:case st.kRadians:case st.kGradians:case st.kMilliseconds:case st.kSeconds:case st.kTurns:{var s=-999999,o=999999,c=this.value,l=Ix(this.unit);if(c<s||c>o){var u=Ix(this.unit);!Number.isFinite(c)||Number.isNaN(c)?a=iV(c,u):a=c+(u||"")}else a="".concat(c).concat(l)}}return i+=a,i},e}(uh),ke=new te(0,"px");new te(1,"px");var Or=new te(0,"deg"),pg=function(n){tt(e,n);function e(t,r,i,a,s){a===void 0&&(a=1),s===void 0&&(s=!1);var o=n.call(this,"rgb")||this;return o.r=t,o.g=r,o.b=i,o.alpha=a,o.isNone=s,o}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(QG),be=new Rn("unset"),aV=new Rn("initial"),sV=new Rn("inherit"),bv={"":be,unset:be,initial:aV,inherit:sV},$x=function(n){return bv[n]||(bv[n]=new Rn(n)),bv[n]},Ad=new pg(0,0,0,0,!0),vL=new pg(0,0,0,0),oV=hn(function(n,e,t,r){return new pg(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),he=function(n,e){return e===void 0&&(e=st.kNumber),new te(n,e)};new te(50,"%");var Nd;(function(n){n[n.Standard=0]="Standard"})(Nd||(Nd={}));var Ps;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(Ps||(Ps={}));var mL={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Da(0,0,0,0)},ct;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(ct||(ct={}));function cV(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var lV=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(j){throw new Error(e+": "+j)}function r(){var j=i();return e.length>0&&t("Invalid input not EOF"),j}function i(){return b(a)}function a(){return s("linear-gradient",n.linearGradient,c)||s("repeating-linear-gradient",n.repeatingLinearGradient,c)||s("radial-gradient",n.radialGradient,h)||s("repeating-radial-gradient",n.repeatingRadialGradient,h)||s("conic-gradient",n.conicGradient,h)}function s(j,L,$){return o(L,function(V){var W=$();return W&&(D(n.comma)||t("Missing comma before color stops")),{type:j,orientation:W,colorStops:b(w)}})}function o(j,L){var $=D(j);if($){D(n.startCall)||t("Missing (");var V=L($);return D(n.endCall)||t("Missing )"),V}}function c(){return l()||u()}function l(){return R("directional",n.sideOrCorner,1)}function u(){return R("angular",n.angleValue,1)}function h(){var j,L=f(),$;return L&&(j=[],j.push(L),$=e,D(n.comma)&&(L=f(),L?j.push(L):e=$)),j}function f(){var j=d()||p();if(j)j.at=v();else{var L=g();if(L){j=L;var $=v();$&&(j.at=$)}else{var V=m();V&&(j={type:"default-radial",at:V})}}return j}function d(){var j=R("shape",/^(circle)/i,0);return j&&(j.style=T()||g()),j}function p(){var j=R("shape",/^(ellipse)/i,0);return j&&(j.style=C()||g()),j}function g(){return R("extent-keyword",n.extentKeywords,1)}function v(){if(R("position",/^at/,0)){var j=m();return j||t("Missing positioning value"),j}}function m(){var j=y();if(j.x||j.y)return{type:"position",value:j}}function y(){return{x:C(),y:C()}}function b(j){var L=j(),$=[];if(L)for($.push(L);D(n.comma);)L=j(),L?$.push(L):t("One extra comma");return $}function w(){var j=x();return j||t("Expected color definition"),j.length=C(),j}function x(){return _()||P()||E()||S()}function S(){return R("literal",n.literalColor,0)}function _(){return R("hex",n.hexColor,1)}function E(){return o(n.rgbColor,function(){return{type:"rgb",value:b(O)}})}function P(){return o(n.rgbaColor,function(){return{type:"rgba",value:b(O)}})}function O(){return D(n.number)[1]}function C(){return R("%",n.percentageValue,1)||M()||T()}function M(){return R("position-keyword",n.positionKeywords,1)}function T(){return R("px",n.pixelValue,1)||R("em",n.emValue,1)}function R(j,L,$){var V=D(L);if(V)return{type:j,value:V[$]}}function D(j){var L=/^[\n\r\t\s]+/.exec(e);L&&B(L[0].length);var $=j.exec(e);return $&&B($[0].length),$}function B(j){e=e.substring(j)}return function(j){return e=j,r()}}();function yL(n,e,t,r){var i=ee(r.value),a=0,s=0,o=a+e/2,c=s+t/2,l=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+o-Math.cos(i)*l/2,h=n[1]+c-Math.sin(i)*l/2,f=n[0]+o+Math.cos(i)*l/2,d=n[1]+c+Math.sin(i)*l/2;return{x1:u,y1:h,x2:f,y2:d}}function bL(n,e,t,r,i,a){var s=r.value,o=i.value;r.unit===st.kPercentage&&(s=r.value/100*e),i.unit===st.kPercentage&&(o=i.value/100*t);var c=Math.max(Mn([0,0],[s,o]),Mn([0,t],[s,o]),Mn([e,t],[s,o]),Mn([e,0],[s,o]));return a&&(a instanceof te?c=a.value:a instanceof Rn&&(a.value==="closest-side"?c=Math.min(s,e-s,o,t-o):a.value==="farthest-side"?c=Math.max(s,e-s,o,t-o):a.value==="closest-corner"&&(c=Math.min(Mn([0,0],[s,o]),Mn([0,t],[s,o]),Mn([e,t],[s,o]),Mn([e,0],[s,o]))))),{x:s+n[0],y:o+n[1],r:c}}var uV=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,hV=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,fV=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,EL=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function dV(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,s=Number(n[0].length.value),o=1;o<i;o++){var c=(r=n[o].length)===null||r===void 0?void 0:r.value;if(!gt(c)&&!gt(s)){for(var l=1;l<o-a;l++)n[a+l].length={type:"%",value:"".concat(s+(Number(c)-s)*l/(o-a))};a=o,s=Number(c)}}}var pV={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},gV=hn(function(n){var e;return n.type==="angular"?e=Number(n.value):e=pV[n.value]||0,he(e,"deg")}),vV=hn(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,s=a.x,o=a.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?e=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?t=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(r=s==null?void 0:s.type,e=Number(s.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,t=Number(o.value))}return{cx:he(e,r),cy:he(t,i)}}),mV=hn(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=lV(n);return t.map(function(o){var c=o.type,l=o.orientation,u=o.colorStops;dV(u);var h=u.map(function(b){return{offset:he(Number(b.length.value),"%"),color:cV(b)}});if(c==="linear-gradient")return new ou(Hr.LinearGradient,{angle:l?gV(l):Or,steps:h});if(c==="radial-gradient"&&(l||(l=[{type:"shape",value:"circle"}]),l[0].type==="shape"&&l[0].value==="circle")){var f=vV(l[0].at),d=f.cx,p=f.cy,g=void 0;if(l[0].style){var v=l[0].style,m=v.type,y=v.value;m==="extent-keyword"?g=$x(y):g=he(y,m)}return new ou(Hr.RadialGradient,{cx:d,cy:p,size:g,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=uV.exec(n);if(i){var a=((e=i[2].match(EL))===null||e===void 0?void 0:e.map(function(o){return o.split(":")}))||[];return[new ou(Hr.LinearGradient,{angle:he(parseFloat(i[1]),"deg"),steps:a.map(function(o){var c=N(o,2),l=c[0],u=c[1];return{offset:he(Number(l)*100,"%"),color:u}})})]}}else if(r==="r"){var s=yV(n);if(s)if(At(s))n=s;else return[new ou(Hr.RadialGradient,s)]}else if(r==="p")return bV(n)}});function yV(n){var e,t=hV.exec(n);if(t){var r=((e=t[4].match(EL))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:he(50,"%"),cy:he(50,"%"),steps:r.map(function(i){var a=N(i,2),s=a[0],o=a[1];return{offset:he(Number(s)*100,"%"),color:o}})}}return null}function bV(n){var e=fV.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function EV(n){return!!n.type&&!!n.value}function Wo(n){return n&&!!n.image}function Lu(n){return n&&!gt(n.r)&&!gt(n.g)&&!gt(n.b)}var Pa=hn(function(n){if(Wo(n))return G({repetition:"repeat"},n);if(gt(n)&&(n=""),n==="transparent")return vL;if(n==="currentColor")n="black";else if(n==="none")return Ad;var e=mV(n);if(e)return e;var t=dg(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),oV.apply(void 0,Q([],N(r),!1))});function xL(n,e){if(!(!Lu(n)||!Lu(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(oe(r[i],0,255));return r[3]=oe(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function hh(n,e){if(gt(e))return he(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return he(Number(e),"px");if("deg".search(n)>=0)return he(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return he(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var wL=function(n){return hh(new RegExp("px","g"),n)},SL=hn(wL),xV=function(n){return hh(new RegExp("%","g"),n)};hn(xV);var Iu=function(n){return rt(n)||isFinite(Number(n))?he(Number(n)||0,"px"):hh(new RegExp("px|%|em|rem","g"),n)},Ho=hn(Iu),I2=function(n){return hh(new RegExp("deg|rad|grad|turn","g"),n)},_L=hn(I2);function wV(n,e,t,r,i){i===void 0&&(i=0);var a="",s=n.value||0,o=e.value||0,c=Fx(n.unit),l=n.convertTo(c),u=e.convertTo(c);return l&&u?(s=l.value,o=u.value,a=Ix(n.unit)):(te.isLength(n.unit)||te.isLength(e.unit))&&(s=Zn(n,i,t),o=Zn(e,i,t),a="px"),[s,o,function(h){return h+a}]}function Fn(n){var e=0;return n.unit===st.kDegrees?e=n.value:n.unit===st.kRadians?e=Qn(Number(n.value)):n.unit===st.kTurns&&(e=fL(Number(n.value))),e}function W3(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):At(n)?t=n.split(" ").map(function(r){return Number(r)}):rt(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function OL(n){return At(n)?n.split(" ").map(function(e){return Ho(e)}):n.map(function(e){return Ho(e.toString())})}function Zn(n,e,t,r){if(r===void 0&&(r=!1),n.unit===st.kPixels)return Number(n.value);if(n.unit===st.kPercentage&&t){var i=t.nodeName===X.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var SV=function(n){return hh(/deg|rad|grad|turn|px|%/g,n)},_V=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function PL(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,_V.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return SV(a)||Pa(a)})}),e.lastIndex===n.length)return t}return[]}function CL(n){return n.toString()}var sc=function(n){return typeof n=="number"?he(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?he(Number(n)):he(0)},Cs=hn(sc);hn(function(n){return At(n)?n.split(" ").map(Cs):n.map(Cs)});function B2(n,e){return[n,e,CL]}function F2(n,e){return function(t,r){return[t,r,function(i){return CL(oe(i,n,e))}]}}function ML(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function Rd(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=Mo(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function OV(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=NG(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function PV(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],s=[r[1],r[2]],o=void 0;a==="L"||a==="M"?o=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(o=[t[t.length-2],t[t.length-1]]),o&&kd(s,o)&&(n.splice(e,1),e--)}}}function CV(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function MV(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],s=a[0];s==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):s==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function kd(n,e){return n[0]===e[0]&&n[1]===e[1]}function TV(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var s=n[a],o=s.currentPoint,c=s.params,l=s.prePoint,u=void 0;switch(s.command){case"Q":u=RG(l[0],l[1],c[1],c[2],c[3],c[4]);break;case"C":u=MG(l[0],l[1],c[1],c[2],c[3],c[4],c[5],c[6]);break;case"A":var h=s.arcParams;u=OG(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(o[0]),r.push(o[1]);break}u&&(s.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height))}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=jo(t),d=jo(r),p=zo(t),g=zo(r);if(i.length===0)return{x:f,y:d,width:p-f,height:g-d};for(var a=0;a<i.length;a++){var s=i[a],o=s.currentPoint,v=void 0;o[0]===f?(v=nf(s,e),f=f-v.xExtra):o[0]===p&&(v=nf(s,e),p=p+v.xExtra),o[1]===d?(v=nf(s,e),d=d-v.yExtra):o[1]===g&&(v=nf(s,e),g=g+v.yExtra)}return{x:f,y:d,width:p-f,height:g-d}}function nf(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),s=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),o=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),c=Math.acos((a+s-o)/(2*Math.sqrt(a)*Math.sqrt(s)));if(!c||Math.sin(c)===0||Co(c,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));l=l>Math.PI/2?Math.PI-l:l,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(c/2-l)*(e/2*(1/Math.sin(c/2)))-e/2||0,yExtra:Math.cos(u-c/2)*(e/2*(1/Math.sin(c/2)))-e/2||0};return h}function H3(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var U3=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},Y3=function(n,e,t,r,i,a,s,o){e=Math.abs(e),t=Math.abs(t),r=A2(r,360);var c=ee(r);if(n.x===s.x&&n.y===s.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var l=(n.x-s.x)/2,u=(n.y-s.y)/2,h={x:Math.cos(c)*l+Math.sin(c)*u,y:-Math.sin(c)*l+Math.cos(c)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),g=d/p;g=g<0?0:g;var v=(i!==a?1:-1)*Math.sqrt(g),m={x:v*(e*h.y/t),y:v*(-(t*h.x)/e)},y={x:Math.cos(c)*m.x-Math.sin(c)*m.y+(n.x+s.x)/2,y:Math.sin(c)*m.x+Math.cos(c)*m.y+(n.y+s.y)/2},b={x:(h.x-m.x)/e,y:(h.y-m.y)/t},w=U3({x:1,y:0},b),x={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},S=U3(b,x);!a&&S>0?S-=2*Math.PI:a&&S<0&&(S+=2*Math.PI),S%=2*Math.PI;var _=w+S*o,E=e*Math.cos(_),P=t*Math.sin(_),O={x:Math.cos(c)*E-Math.sin(c)*P+y.x,y:Math.sin(c)*E+Math.cos(c)*P+y.y,ellipticalArcStartAngle:w,ellipticalArcEndAngle:w+S,ellipticalArcAngle:_,ellipticalArcCenter:y,resultantRx:e,resultantRy:t};return O};function AV(n){for(var e=[],t=null,r=null,i=null,a=0,s=n.length,o=0;o<s;o++){var c=n[o];r=n[o+1];var l=c[0],u={command:l,prePoint:t,params:c,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(l){case"M":i=[c[1],c[2]],a=o;break;case"A":var h=NV(t,c);u.arcParams=h;break}if(l==="Z")t=i,r=n[a+1];else{var f=c.length;t=[c[f-2],c[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&kd(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(l))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(l==="Q"){var g=[c[1],c[2]];u.startTangent=[p[0]-g[0],p[1]-g[1]],u.endTangent=[t[0]-g[0],t[1]-g[1]]}else if(l==="T"){var v=e[o-1],g=H3(v.currentPoint,p);v.command==="Q"?(u.command="Q",u.startTangent=[p[0]-g[0],p[1]-g[1]],u.endTangent=[t[0]-g[0],t[1]-g[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(l==="C"){var m=[c[1],c[2]],y=[c[3],c[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-y[0],t[1]-y[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-y[0],m[1]-y[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[y[0]-m[0],y[1]-m[1]])}else if(l==="S"){var v=e[o-1],m=H3(v.currentPoint,p),y=[c[1],c[2]];v.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-y[0],t[1]-y[1]]):(u.command="SQ",u.startTangent=[p[0]-y[0],p[1]-y[1]],u.endTangent=[t[0]-y[0],t[1]-y[1]])}else if(l==="A"){var b=K3(u,0),w=b.x,x=b.y,S=K3(u,1,!1),_=S.x,E=S.y;u.startTangent=[w,x],u.endTangent=[_,E]}e.push(u)}return e}function K3(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,s=r.ry,o=s===void 0?0:s,c=r.xRotation,l=r.arcFlag,u=r.sweepFlag,h=Y3({x:n.prePoint[0],y:n.prePoint[1]},a,o,c,!!l,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=Y3({x:n.prePoint[0],y:n.prePoint[1]},a,o,c,!!l,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,g=Math.sqrt(d*d+p*p);return{x:-d/g,y:-p/g}}function rf(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function zx(n,e){return rf(n)*rf(e)?(n[0]*e[0]+n[1]*e[1])/(rf(n)*rf(e)):1}function X3(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(zx(n,e))}function NV(n,e){var t=e[1],r=e[2],i=A2(ee(e[3]),Math.PI*2),a=e[4],s=e[5],o=n[0],c=n[1],l=e[6],u=e[7],h=Math.cos(i)*(o-l)/2+Math.sin(i)*(c-u)/2,f=-1*Math.sin(i)*(o-l)/2+Math.cos(i)*(c-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),g=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===s&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*t*f/r:0,m=t?g*-r*h/t:0,y=(o+l)/2+Math.cos(i)*v-Math.sin(i)*m,b=(c+u)/2+Math.sin(i)*v+Math.cos(i)*m,w=[(h-v)/t,(f-m)/r],x=[(-1*h-v)/t,(-1*f-m)/r],S=X3([1,0],w),_=X3(w,x);return zx(w,x)<=-1&&(_=Math.PI),zx(w,x)>=1&&(_=0),s===0&&_>0&&(_=_-2*Math.PI),s===1&&_<0&&(_=_+2*Math.PI),{cx:y,cy:b,rx:kd(n,[l,u])?0:t,ry:kd(n,[l,u])?0:r,startAngle:S,endAngle:S+_,xRotation:i,arcFlag:a,sweepFlag:s}}function RV(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var s=Wt(i[1],i[2],0);t&&Ye(s,s,t),a="".concat(i[0]).concat(s[0],",").concat(s[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var o=Wt(i[1],i[2],0),c=Wt(i[3],i[4],0),l=Wt(i[5],i[6],0);t&&(Ye(o,o,t),Ye(c,c,t),Ye(l,l,t)),a="".concat(i[0]).concat(o[0],",").concat(o[1],",").concat(c[0],",").concat(c[1],",").concat(l[0],",").concat(l[1])}else if(i[0]==="A"){var u=Wt(i[6],i[7],0);t&&Ye(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var o=Wt(i[1],i[2],0),c=Wt(i[3],i[4],0);t&&(Ye(o,o,t),Ye(c,c,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function kV(n,e,t,r){return[["M",n,e],["L",t,r]]}function Z3(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,s=e*i,o=t-n,c=t+n,l=r-e,u=r+e;return[["M",o,r],["C",o,r-s,t-a,l,t,l],["C",t+a,l,c,r-s,c,r],["C",c,r+s,t+a,u,t,u],["C",t-a,u,o,r+s,o,r],["Z"]]}function DV(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function LV(n,e,t,r,i){if(i){var a=N(i,4),s=a[0],o=a[1],c=a[2],l=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*s+t,r],["L",n-u*o+t,r],o?["A",o,o,0,0,f,n+t,h*o+r]:null,["L",n+t,e-h*c+r],c?["A",c,c,0,0,f,n+t-u*c,e+r]:null,["L",t+u*l,e+r],l?["A",l,l,0,0,f,t,e+r-h*l]:null,["L",t,h*s+r],s?["A",s,s,0,0,f,u*s+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function IV(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case X.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,s=r.y1,o=s===void 0?0:s,c=r.x2,l=c===void 0?0:c,u=r.y2,h=u===void 0?0:u;t=kV(a,o,l,h);break;case X.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,g=f.cx,v=g===void 0?0:g,m=f.cy,y=m===void 0?0:m;t=Z3(p,p,v,y);break}case X.ELLIPSE:{var b=n.parsedStyle,w=b.rx,x=w===void 0?0:w,S=b.ry,_=S===void 0?0:S,E=b.cx,v=E===void 0?0:E,P=b.cy,y=P===void 0?0:P;t=Z3(x,_,v,y);break}case X.POLYLINE:case X.POLYGON:var O=n.parsedStyle.points;t=DV(O.points,n.nodeName===X.POLYGON);break;case X.RECT:var C=n.parsedStyle,M=C.width,T=M===void 0?0:M,R=C.height,D=R===void 0?0:R,B=C.x,j=B===void 0?0:B,L=C.y,$=L===void 0?0:L,V=C.radius,W=V&&V.some(function(U){return U!==0});t=LV(T,D,j,$,W&&V.map(function(U){return oe(U,0,Math.min(Math.abs(T)/2,Math.abs(D)/2))}));break;case X.PATH:var Y=n.parsedStyle.d.absolutePath;t=Q([],N(Y),!1);break}if(t.length)return RV(t,n,e)}function BV(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(s,o){var c=s[0],l=n[o+1],u=o===0&&(e!==0||t!==0),h=(o===n.length-1||l&&(l[0]==="M"||l[0]==="Z"))&&r!==0&&i!==0;switch(c){case"M":return u?"M ".concat(s[1]+e,",").concat(s[2]+t," L ").concat(s[1],",").concat(s[2]):"M ".concat(s[1],",").concat(s[2]);case"L":return"L ".concat(s[1]+(h?r:0),",").concat(s[2]+(h?i:0));case"Q":return"Q ".concat(s[1]," ").concat(s[2],",").concat(s[3]," ").concat(s[4])+(h?" L ".concat(s[3]+r,",").concat(s[4]+i):"");case"C":return"C ".concat(s[1]," ").concat(s[2],",").concat(s[3]," ").concat(s[4],",").concat(s[5]," ").concat(s[6])+(h?" L ".concat(s[5]+r,",").concat(s[6]+i):"");case"A":return"A ".concat(s[1]," ").concat(s[2]," ").concat(s[3]," ").concat(s[4]," ").concat(s[5]," ").concat(s[6]," ").concat(s[7])+(h?" L ".concat(s[6]+r,",").concat(s[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var TL=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Go(n)}catch{e=Go(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}PV(e);var t=CV(e),r=MV(e),i=r.polygons,a=r.polylines,s=AV(e),o=TV(s,0),c=o.x,l=o.y,u=o.width,h=o.height;return{absolutePath:e,hasArc:t,segments:s,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(c)?c:0,y:Number.isFinite(l)?l:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},FV=hn(TL);function Dd(n){return At(n)?FV(n):TL(n)}function $V(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=Pd(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=Pd(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=R2(r,i));var s=Tx(a[0])!==Tx(a[1])?JD(a[0]):QD(a[0]);return[s,eL(a[1],s),function(o){return o}]}function AL(n,e){var t;return At(n)?t=n.split(" ").map(function(r){var i=N(r.split(","),2),a=i[0],s=i[1];return[Number(a),Number(s)]}):t=n,{points:t,totalLength:0,segments:[]}}function zV(n,e){return[n.points,e.points,function(t){return t}]}var Te=null;function In(n){return function(e){var t=0;return n.map(function(r){return r===Te?e[t++]:r})}}function Ja(n){return n}var Ld={matrix:["NNNNNN",[Te,Te,0,0,Te,Te,0,0,0,0,1,0,Te,Te,0,1],Ja],matrix3d:["NNNNNNNNNNNNNNNN",Ja],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",In([Te,Te,new te(1)]),Ja],scalex:["N",In([Te,new te(1),new te(1)]),In([Te,new te(1)])],scaley:["N",In([new te(1),Te,new te(1)]),In([new te(1),Te])],scalez:["N",In([new te(1),new te(1),Te])],scale3d:["NNN",Ja],skew:["Aa",null,Ja],skewx:["A",null,In([Te,Or])],skewy:["A",null,In([Or,Te])],translate:["Tt",In([Te,Te,ke]),Ja],translatex:["T",In([Te,ke,ke]),In([Te,ke])],translatey:["T",In([ke,Te,ke]),In([ke,Te])],translatez:["L",In([ke,ke,Te])],translate3d:["TTL",Ja]};function gg(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],s=Ld[a];if(!s)return[];var o=r[2].split(","),c=s[0];if(c.length<o.length)return[];for(var l=[],u=0;u<c.length;u++){var h=o[u],f=c[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Or:_L(p)},N:Cs,T:Ho,L:SL}[f.toUpperCase()](h):d={a:Or,n:l[0],t:ke}[f],d===void 0)return[];l.push(d)}if(t.push({t:a,d:l}),e.lastIndex===n.length)return t}return[]}function Q3(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],s=Ld[a];if(!s)return[];var o=r[2].split(","),c=s[0];if(c.length<o.length)return[];for(var l=[],u=0;u<c.length;u++){var h=o[u],f=c[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Or:I2(p)},N:sc,T:Iu,L:wL}[f.toUpperCase()](h):d={a:Or,n:l[0],t:ke}[f],d===void 0)return[];l.push(d)}if(t.push({t:a,d:l}),e.lastIndex===n.length)return t}return[]}function jV(n){var e,t,r,i;switch(n.t){case"rotatex":return i=ee(Fn(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=ee(Fn(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=ee(Fn(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=ee(Fn(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var s=Math.sqrt(a);e/=s,t/=s,r/=s}var o=Math.sin(i/2),c=o*Math.cos(i/2),l=o*o;return[1-2*(t*t+r*r)*l,2*(e*t*l+r*c),2*(e*r*l-t*c),0,2*(e*t*l-r*c),1-2*(e*e+r*r)*l,2*(t*r*l+e*c),0,2*(e*r*l+t*c),2*(t*r*l-e*c),1-2*(e*e+t*t)*l,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=ee(Fn(n.d[0])),h=ee(Fn(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=ee(Fn(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=ee(Fn(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=Zn(n.d[0],0,null)||0,t=Zn(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=Zn(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=Zn(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=Zn(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=Zn(n.d[0],0,null)||0,t=Zn(n.d[1],0,null)||0,r=Zn(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=Zn(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function qV(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function GV(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(jV).reduce(qV)}function J3(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return GG(GV(n),e,t,r,i,a),[[e,t,r,a,i]]}var VV=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var o=0;o<4;o++)for(var c=0;c<4;c++)a[s][o]+=i[s][c]*r[c][o];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,s,o){for(var c=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)c[l][3]=o[l];for(var l=0;l<3;l++)for(var u=0;u<3;u++)c[3][l]+=r[u]*c[u][l];var h=s[0],f=s[1],d=s[2],p=s[3],g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];g[0][0]=1-2*(f*f+d*d),g[0][1]=2*(h*f-d*p),g[0][2]=2*(h*d+f*p),g[1][0]=2*(h*f+d*p),g[1][1]=1-2*(h*h+d*d),g[1][2]=2*(f*d-h*p),g[2][0]=2*(h*d-f*p),g[2][1]=2*(f*d+h*p),g[2][2]=1-2*(h*h+f*f),c=n(c,g);var v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(v[2][1]=a[2],c=n(c,v)),a[1]&&(v[2][1]=0,v[2][0]=a[0],c=n(c,v)),a[0]&&(v[2][0]=0,v[1][0]=a[0],c=n(c,v));for(var l=0;l<3;l++)for(var u=0;u<3;u++)c[l][u]*=i[l];return e(c)?[c[0][0],c[0][1],c[1][0],c[1][1],c[3][0],c[3][1]]:c[0].concat(c[1],c[2],c[3])}return t}();function WV(n){return n.toFixed(6).replace(".000000","")}function Ev(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=J3(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=J3(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=UV(t[0][3],r[0][3],i[5]),s=VV(i[0],i[1],i[2],a,i[4]),o=s.map(WV).join(",");return o}])}function HV(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function UV(n,e,t){var r=HV(n,e);r=oe(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),s=Math.sin(t*a)*1/Math.sqrt(1-r*r),o=0;o<4;o++)i.push(n[o]*(Math.cos(t*a)-r*s)+e[o]*s);return i}function xv(n){return n.replace(/[xy]/,"")}function wv(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var YV=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function KV(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(S){var _=n[S],E=_.t,P=_.d,O=E.substring(0,5)==="scale"?1:0;e.push({t:E,d:P.map(function(C){return typeof C=="number"?he(O):he(O,C.unit)})})},a=0;a<n.length;a++)i(a)}var s=[],o=[],c=[];if(n.length!==e.length){var l=Ev(n,e);s=[l[0]],o=[l[1]],c=[["matrix",[l[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=Ld[u],g=Ld[h],v=void 0;if(YV(u,h)){var l=Ev([n[a]],[e[a]]);s.push(l[0]),o.push(l[1]),c.push(["matrix",[l[2]]]);continue}else if(u===h)v=u;else if(p[2]&&g[2]&&xv(u)===xv(h))v=xv(u),f=p[2](f),d=g[2](d);else if(p[1]&&g[1]&&wv(u)===wv(h))v=wv(u),f=p[1](f),d=g[1](d);else{var l=Ev(n,e);s=[l[0]],o=[l[1]],c=[["matrix",[l[2]]]];break}for(var m=[],y=[],b=[],w=0;w<f.length;w++){var l=wV(f[w],d[w],t,!1,w);m[w]=l[0],y[w]=l[1],b.push(l[2])}s.push(m),o.push(y),c.push([v,b])}if(r){var x=s;s=o,o=x}return[s,o,function(S){return S.map(function(_,E){var P=_.map(function(O,C){return c[E][1][C](O)}).join(",");return c[E][0]==="matrix"&&P.split(",").length===16&&(c[E][0]="matrix3d"),c[E][0]==="matrix3d"&&P.split(",").length===6&&(c[E][0]="matrix"),c[E][0]+"("+P+")"}).join(" ")}]}var NL=hn(function(n){if(At(n)){if(n==="text-anchor")return[he(0,"px"),he(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Ho(Id(e[0])),Ho(Id(e[1]))]}else return[he(n[0]||0,"px"),he(n[1]||0,"px")]}),XV=function(n){if(At(n)){if(n==="text-anchor")return[he(0,"px"),he(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Iu(Id(e[0])),Iu(Id(e[1]))]}else return[he(n[0]||0,"px"),he(n[1]||0,"px")]};function Id(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var vg=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:ct.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:ct.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:ct.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:ct.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:ct.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:ct.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:ct.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:ct.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:ct.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:ct.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:ct.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:ct.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:ct.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:ct.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:ct.FILTER},{n:"clipPath",syntax:ct.DEFINED_PATH},{n:"textPath",syntax:ct.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:ct.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:ct.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:ct.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ct.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:ct.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:ct.COORDINATE},{n:"y1",int:!0,l:!0,syntax:ct.COORDINATE},{n:"z1",int:!0,l:!0,syntax:ct.COORDINATE},{n:"x2",int:!0,l:!0,syntax:ct.COORDINATE},{n:"y2",int:!0,l:!0,syntax:ct.COORDINATE},{n:"z2",int:!0,l:!0,syntax:ct.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:ct.PATH,p:50},{n:"points",int:!0,l:!0,syntax:ct.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:ct.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:ct.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:ct.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:ct.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:ct.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:ct.NUMBER,d:function(n){return n===X.PATH||n===X.POLYGON||n===X.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:ct.MARKER},{n:"markerEnd",syntax:ct.MARKER},{n:"markerMid",syntax:ct.MARKER},{n:"markerStartOffset",syntax:ct.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:ct.LENGTH,l:!0,int:!0,d:"0"}],tO=vg.filter(function(n){return!!n.l}).map(function(n){return n.n}),Ri={},ho=new WeakMap,ZV=function(n,e){var t=ho.get(n);return!t||t.length===0?!0:t.includes(e)},QV=function(){function n(e){var t=this;this.runtime=e,vg.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){Q([e.n],N(e.a||[]),!1).forEach(function(t){Ri[t]=e})},n.prototype.unregisterMetadata=function(e){delete Ri[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,g=f,v=Object.keys(t);v.forEach(function(m){var y;u||(e.attributes[m]=t[m]),!g&&(!((y=Ri[m])===null||y===void 0)&&y.l)&&(g=!0)}),h||v.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(v=Array.from(new Set(v.concat(d)))),v.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),g&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),v.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,v)}),this.runtime.enableCSSParsing&&e.children.length&&v.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(y){y.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),s=e.parsedStyle.clipPath,o=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var c=!!r.forceUpdateGeometry;if(!c){for(var l=0;l<tO.length;l++)if(tO[l]in t){c=!0;break}}t.fill&&(e.parsedStyle.fill=Pa(t.fill)),t.stroke&&(e.parsedStyle.stroke=Pa(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=Pa(t.shadowColor)),t.filter&&(e.parsedStyle.filter=PL(t.filter)),gt(t.radius)||(e.parsedStyle.radius=W3(t.radius,4)),gt(t.lineDash)||(e.parsedStyle.lineDash=W3(t.lineDash,2)),t.points&&(e.parsedStyle.points=AL(t.points)),t.d===""&&(e.parsedStyle.d=G({},mL)),t.d&&(e.parsedStyle.d=Dd(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),mt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",s,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",o,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=gg(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=NL(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),gt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),gt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),c&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=Ri[e],s=t;if((t===""||gt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")s=$x(t);else if(a){var o=a.k,c=a.syntax,l=c&&this.getPropertySyntax(c);o&&o.indexOf(t)>-1?s=$x(t):l&&(!i&&l.parserUnmemoize?s=l.parserUnmemoize(t,r):l.parser&&(s=l.parser(t,r)))}return s},n.prototype.computeProperty=function(e,t,r,i){var a=Ri[e],s=r.id==="g-root",o=t;if(a){var c=a.syntax,l=a.inh,u=a.d;if(t instanceof Rn){var h=t.value;if(h==="unset"&&(l&&!s?h="inherit":h="initial"),h==="initial")gt(u)||(t=this.parseProperty(e,mo(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(gt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=c&&this.getPropertySyntax(c);if(d&&d.calculator){var p=r.parsedStyle[e];o=d.calculator(e,p,t,r,this.runtime)}else t instanceof Rn?o=t.value:o=t}return o},n.prototype.postProcessProperty=function(e,t,r){var i=Ri[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),s=a;s&&s.postProcessor&&s.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=ho.get(e);r||(ho.set(e,[]),r=ho.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&ZV(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=ho.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),ho.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new ue),i.renderBounds||(i.renderBounds=new ue);var a=e.parsedStyle,s=r.update(a,e),o=s.cx,c=o===void 0?0:o,l=s.cy,u=l===void 0?0:l,h=s.cz,f=h===void 0?0:h,d=s.hwidth,p=d===void 0?0:d,g=s.hheight,v=g===void 0?0:g,m=s.hdepth,y=m===void 0?0:m,b=[Math.abs(p),Math.abs(v),y],w=a,x=w.stroke,S=w.lineWidth,_=S===void 0?1:S,E=w.increasedLineWidthForHitTesting,P=E===void 0?0:E,O=w.shadowType,C=O===void 0?"outer":O,M=w.shadowColor,T=w.filter,R=T===void 0?[]:T,D=w.transformOrigin,B=[c,u,f];i.contentBounds.update(B,b);var j=t===X.POLYLINE||t===X.POLYGON||t===X.PATH?Math.SQRT2:.5,L=x&&!x.isNone;if(L){var $=((_||0)+(P||0))*j;b[0]+=$,b[1]+=$}if(i.renderBounds.update(B,b),M&&C&&C!=="inner"){var V=i.renderBounds,W=V.min,Y=V.max,U=a,J=U.shadowBlur,at=U.shadowOffsetX,ht=U.shadowOffsetY,lt=J||0,Nt=at||0,pe=ht||0,Be=W[0]-lt+Nt,nn=Y[0]+lt+Nt,ri=W[1]-lt+pe,Ya=Y[1]+lt+pe;W[0]=Math.min(W[0],Be),Y[0]=Math.max(Y[0],nn),W[1]=Math.min(W[1],ri),Y[1]=Math.max(Y[1],Ya),i.renderBounds.setMinMax(W,Y)}R.forEach(function(Lr){var Ir=Lr.name,ia=Lr.params;if(Ir==="blur"){var z=ia[0].value;i.renderBounds.update(i.renderBounds.center,ed(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[z,z,0]))}else if(Ir==="drop-shadow"){var dn=ia[0].value,ce=ia[1].value,Kn=ia[2].value,pr=i.renderBounds,gr=pr.min,ye=pr.max,ii=gr[0]-Kn+dn,Xa=ye[0]+Kn+dn,Za=gr[1]-Kn+ce,Ce=ye[1]+Kn+ce;gr[0]=Math.min(gr[0],ii),ye[0]=Math.max(ye[0],Xa),gr[1]=Math.min(gr[1],Za),ye[1]=Math.max(ye[1],Ce),i.renderBounds.setMinMax(gr,ye)}}),e.geometry.dirty=!1;var Ka=p<0,Ht=v<0,dr=(Ka?-1:1)*(D?Zn(D[0],0,e,!0):0),$t=(Ht?-1:1)*(D?Zn(D[1],1,e,!0):0);(dr||$t)&&e.setOrigin(dr,$t)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===X.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===X.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=Ri[e];return t?t.inh:!1},n}(),JV=function(){function n(){this.parser=_L,this.parserUnmemoize=I2,this.parserWithCSSDisabled=null,this.mixer=B2}return n.prototype.calculator=function(e,t,r,i){return Fn(r)},n}(),tW=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Rn&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(s){s.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(s)}),r},n}(),eW=function(){function n(){this.parser=Pa,this.parserWithCSSDisabled=Pa,this.mixer=xL}return n.prototype.calculator=function(e,t,r,i){return r instanceof Rn?r.value==="none"?Ad:vL:r},n}(),nW=function(){function n(){this.parser=PL}return n.prototype.calculator=function(e,t,r){return r instanceof Rn?[]:r},n}();function eO(n){var e=n.parsedStyle.fontSize;return gt(e)?null:e}var jx=function(){function n(){this.parser=Ho,this.parserUnmemoize=Iu,this.parserWithCSSDisabled=null,this.mixer=B2}return n.prototype.calculator=function(e,t,r,i,a){var s;if(rt(r))return r;if(te.isRelativeUnit(r.unit)){var o=a.styleValueRegistry;if(r.unit===st.kPercentage)return 0;if(r.unit===st.kEms){if(i.parentNode){var c=eO(i.parentNode);if(c)return c*=r.value,c;o.addUnresolveProperty(i,e)}else o.addUnresolveProperty(i,e);return 0}else if(r.unit===st.kRems){if(!((s=i==null?void 0:i.ownerDocument)===null||s===void 0)&&s.documentElement){var c=eO(i.ownerDocument.documentElement);if(c)return c*=r.value,c;o.addUnresolveProperty(i,e)}else o.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),rW=function(){function n(){this.mixer=ML}return n.prototype.parser=function(e){var t=OL(rt(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),iW=function(){function n(){this.mixer=ML}return n.prototype.parser=function(e){var t=OL(rt(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),aW=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Rn&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),sW=function(){function n(){this.mixer=B2,this.parser=Cs,this.parserUnmemoize=sc,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),oW=function(){function n(){this.parser=Cs,this.parserUnmemoize=sc,this.parserWithCSSDisabled=null,this.mixer=F2(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===X.LINE||a===X.PATH||a===X.POLYLINE){var s=r.getPoint(i);s&&e.setLocalPosition(s.x,s.y)}}},n}(),cW=function(){function n(){this.parser=Cs,this.parserUnmemoize=sc,this.parserWithCSSDisabled=null,this.mixer=F2(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),lW=function(){function n(){this.parser=Dd,this.parserWithCSSDisabled=Dd,this.mixer=$V}return n.prototype.calculator=function(e,t,r){return r instanceof Rn&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Da(0,0,0,0)}:r},n}(),uW=function(){function n(){this.parser=AL,this.mixer=zV}return n}(),hW=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.mixer=F2(0,1/0),t}return e}(jx),fW=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Rn?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),dW=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var s=a;r.value==="capitalize"?s=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?s=a.toLowerCase():r.value==="uppercase"&&(s=a.toUpperCase()),i.parsedStyle.text=s}return r.value},n}(),Sv={},pW=0;function gW(n,e){if(n){var t=typeof n=="string"?n:n.id||pW++;Sv[t]&&Sv[t].destroy(),Sv[t]=e}}var oc=typeof window<"u"&&typeof window.document<"u";function vW(n){return!!n.getAttribute}function mW(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;RL(n[i],e)<0?t=i+1:r=i}return t}function RL(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function $2(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var nO="px";function kL(n,e,t){oc&&n.style&&(n.style.width=e+nO,n.style.height=t+nO)}function DL(n,e){if(oc)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function yW(n){var e=DL(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function bW(n){var e=DL(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var EW=1,xW={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},qx=typeof performance=="object"&&performance.now?performance:Date;function qa(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,s=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=s):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var wW=1,SW=function(){return wW++},gi=typeof self=="object"&&self.self==self?self:typeof global=="object"&&global.global==global?global:{},_W=Date.now(),OW=function(){return gi.performance&&typeof gi.performance.now=="function"?gi.performance.now():Date.now()-_W},cu={},rO=Date.now(),PW=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-rO,r=t>16?0:16-t,i=SW();return cu[i]=n,Object.keys(cu).length>1||setTimeout(function(){rO=e;var a=cu;cu={},Object.keys(a).forEach(function(s){return a[s](OW())})},r),i},CW=function(n){delete cu[n]},MW=["","webkit","moz","ms","o"],LL=function(n){return typeof n!="string"?PW:n===""?gi.requestAnimationFrame:gi[n+"RequestAnimationFrame"]},TW=function(n){return typeof n!="string"?CW:n===""?gi.cancelAnimationFrame:gi[n+"CancelAnimationFrame"]||gi[n+"CancelRequestAnimationFrame"]},AW=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},IL=AW(MW,function(n){return!!LL(n)}),z2=LL(IL),BL=TW(IL);gi.requestAnimationFrame=z2;gi.cancelAnimationFrame=BL;var NW=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,Q([],N(e),!1))}))},n}(),RW=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Et(this,void 0,void 0,function(){var r,i,a,s;return Io(this,function(o){switch(o.label){case 0:return this.callbacks.length?[4,(s=this.callbacks)[0].apply(s,Q([],N(e),!1))]:[3,6];case 1:r=o.sent(),i=0,o.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=o.sent(),o.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),Pn=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),_v=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),kW=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],DW=/([\"\'])[^\'\"]+\1/;function LW(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,s=a===void 0?"normal":a,o=n.fontVariant,c=o===void 0?"normal":o,l=n.fontWeight,u=l===void 0?"normal":l,h=rt(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!DW.test(p)&&kW.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(s," ").concat(c," ").concat(u," ").concat(h," ").concat(f.join(","))}function Ov(n,e,t){return ks(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var Rc=1e-5,IW=le(),Fe=le();function j2(n,e){if(n.length){var t=ks(IW);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var s=(a==null?void 0:a.map(function(m){return Math.max(m.value,Rc)}))||[1,1];ss(Fe,[s[0],s[1],1])}else if(i==="scalex"){var s=(a==null?void 0:a.map(function(y){return Math.max(y.value,Rc)}))||[1];ss(Fe,[s[0],1,1])}else if(i==="scaley"){var s=(a==null?void 0:a.map(function(y){return Math.max(y.value,Rc)}))||[1];ss(Fe,[1,s[0],1])}else if(i==="scalez"){var s=(a==null?void 0:a.map(function(y){return Math.max(y.value,Rc)}))||[1];ss(Fe,[1,1,s[0]])}else if(i==="scale3d"){var s=(a==null?void 0:a.map(function(y){return Math.max(y.value,Rc)}))||[1,1,1];ss(Fe,[s[0],s[1],s[2]])}else if(i==="translate"){var o=a||[ke,ke];as(Fe,[o[0].value,o[1].value,0])}else if(i==="translatex"){var o=a||[ke];as(Fe,[o[0].value,0,0])}else if(i==="translatey"){var o=a||[ke];as(Fe,[0,o[0].value,0])}else if(i==="translatez"){var o=a||[ke];as(Fe,[0,0,o[0].value])}else if(i==="translate3d"){var o=a||[ke,ke,ke];as(Fe,[o[0].value,o[1].value,o[2].value])}else if(i==="rotate"){var c=a||[Or];_x(Fe,ee(Fn(c[0])))}else if(i==="rotatex"){var c=a||[Or];hD(Fe,ee(Fn(c[0])))}else if(i==="rotatey"){var c=a||[Or];fD(Fe,ee(Fn(c[0])))}else if(i==="rotatez"){var c=a||[Or];_x(Fe,ee(Fn(c[0])))}else if(i==="rotate3d"){var c=a||[ke,ke,ke,Or];uD(Fe,ee(Fn(c[3])),[c[0].value,c[1].value,c[2].value])}else if(i==="skew"){var l=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];Ov(Fe,ee(l[0]),ee(l[1]))}else if(i==="skewx"){var l=(a==null?void 0:a.map(function(y){return y.value}))||[0];Ov(Fe,ee(l[0]),0)}else if(i==="skewy"){var l=(a==null?void 0:a.map(function(y){return y.value}))||[0];Ov(Fe,0,ee(l[0]))}else if(i==="matrix"){var u=N(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],g=u[4],v=u[5];Sx(Fe,h,f,0,0,d,p,0,0,0,0,1,0,g,v,0,1)}else i==="matrix3d"&&Sx.apply(Zz,Q([Fe],N(a.map(function(m){return m.value})),!1));ED(t,t,Fe)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var BW=function(){function n(){this.parser=gg,this.parserUnmemoize=Q3,this.parserWithCSSDisabled=Q3,this.mixer=KV}return n.prototype.calculator=function(e,t,r,i){return r instanceof Rn?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;j2(t,e)},n}(),FW=function(){function n(){this.parser=NL,this.parserUnmemoize=XV}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===st.kPixels&&t[1].unit===st.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),$W=function(){function n(){this.parser=Cs,this.parserUnmemoize=sc}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=Ps.Z_INDEX_CHANGED)}},n}(),FL=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,s=a===void 0?0:a,o=e.r,c=o===void 0?0:o;return{cx:i,cy:s,hwidth:c,hheight:c}},n}(),$L=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,s=a===void 0?0:a,o=e.rx,c=o===void 0?0:o,l=e.ry,u=l===void 0?0:l;return{cx:i,cy:s,hwidth:c,hheight:u}},n}(),zL=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,s=Math.min(t,i),o=Math.max(t,i),c=Math.min(r,a),l=Math.max(r,a),u=o-s,h=l-c,f=u/2,d=h/2;return{cx:s+f,cy:c+d,hwidth:f,hheight:d}},n}(),jL=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,s=r.width,o=r.height,c=s/2,l=o/2;return{cx:i+c,cy:a+l,hwidth:c,hheight:l}},n}(),qL=function(){function n(){}return n.prototype.update=function(e){if(e.points&&me(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,Q([],N(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,Q([],N(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,Q([],N(t.map(function(h){return h[1]})),!1)),s=Math.max.apply(Math,Q([],N(t.map(function(h){return h[1]})),!1)),o=i-r,c=s-a,l=o/2,u=c/2;return{cx:r+l,cy:a+u,hwidth:l,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),GL=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,s=a===void 0?0:a,o=e.src,c=e.width,l=c===void 0?0:c,u=e.height,h=u===void 0?0:u,f=l,d=h;return o&&!At(o)&&(f||(f=o.width,e.width=f),d||(d=o.height,e.height=d)),{cx:i+f/2,cy:s+d/2,hwidth:f/2,hheight:d/2}},n}(),VL=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,s=e.fontSize,o=e.fontStyle,c=e.fontWeight,l=e.fontVariant,u=e.lineWidth;return K.enableCSSParsing?r&&s&&o&&c&&l&&i&&a&&!gt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,s=e.textAlign,o=s===void 0?"start":s,c=e.lineWidth,l=c===void 0?1:c,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,g=p===void 0?0:p,v=e.x,m=v===void 0?0:v,y=e.y,b=y===void 0?0:y;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var w=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,x=this.globalRuntime.textService.measureText(a,e,w);e.metrics=x;var S=x.width,_=x.height,E=x.lineHeight,P=x.fontProperties,O=S/2,C=_/2,M=m+O;o==="center"||o==="middle"?M+=l/2-O:(o==="right"||o==="end")&&(M+=l-O*2);var T=b-C;return h==="middle"?T+=C:h==="top"||h==="hanging"?T+=C*2:h==="alphabetic"?T+=this.globalRuntime.enableCSSParsing?E-P.ascent:0:(h==="bottom"||h==="ideographic")&&(T+=0),d&&(M+=d),g&&(T+=g),{cx:M,cy:T,hwidth:O,hheight:C}},n}(),WL=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function HL(n){return!!n.type}var fh=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tn,this.page=new tn,this.canvas=new tn,this.viewport=new tn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(Jt)},n}(),q2=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.client=new tn,t.movement=new tn,t.offset=new tn,t.global=new tn,t.screen=new tn,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(Jt)},e}(fh),Bu=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(q2),Bd=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(q2),se=function(n){tt(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(fh),iO=":",G2=function(){function n(){this.emitter=new C2}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=Ru(r)&&r||ne(r)&&r.capture,a=ne(r)&&r.once,s=mo(t)?void 0:t,o=!1,c="";if(e.indexOf(iO)>-1){var l=N(e.split(iO),2),u=l[0],h=l[1];e=h,c=u,o=!0}if(e=i?"".concat(e,"capture"):e,t=mo(t)?t:t.handleEvent,o){var f=t;t=function(){for(var d,p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];((d=p[0].target)===null||d===void 0?void 0:d.name)===c&&f.apply(void 0,Q([],N(p),!1))}}return a?this.emitter.once(e,t,s):this.emitter.on(e,t,s),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=Ru(r)&&r||ne(r)&&r.capture,a=mo(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=mo(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new se(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!HL(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Ue=function(n){tt(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===X.TEXT&&(i+=this.style.text);try{for(var a=er(this.childNodes),s=a.next();!s.done;s=a.next()){var o=s.value;o.nodeName===X.TEXT?i+=o.nodeValue:i+=o.textContent}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===X.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(Jt)},e.prototype.lookupNamespaceURI=function(t){throw new Error(Jt)},e.prototype.lookupPrefix=function(t){throw new Error(Jt)},e.prototype.normalize=function(){throw new Error(Jt)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,s=[i],o=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(s.push(i.parentNode),i.parentNode):i,a=a.parentNode?(o.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var c=s.length>o.length?s:o,l=c===s?o:s;if(c[c.length-l.length]===l[0])return c===s?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=c.length-l.length,h=l.length-1;h>=0;h--){var f=l[h],d=c[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?l===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:c===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(G2),zW=2048,UL=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new C2,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=le(),this.tmpVec3=Ct(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var s=a.button===2;r.dispatchEvent(a,s?"rightdown":"mousedown")}var o=r.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,s=qx.now(),o=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(o,"pointerup"),o.pointerType==="touch")r.dispatchEvent(o,"touchend");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var c=o.button===2;r.dispatchEvent(o,c?"rightup":"mouseup")}var l=r.trackingData(i.pointerId),u=r.findMountedTarget(l.pressTargetsByButton[i.button]),h=u;if(u&&!o.composedPath().includes(u)){for(var f=u;f&&!o.composedPath().includes(f);){if(o.currentTarget=f,r.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch")r.notifyTarget(o,"touchendoutside");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var c=o.button===2;r.notifyTarget(o,c?"rightupoutside":"mouseupoutside")}Ue.isNode(f)&&(f=f.parentNode)}delete l.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(o,"click");d.target=h,d.path=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:s});var p=l.clicksByButton[i.button];p.target===d.target&&s-p.timeStamp<200?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=s,d.detail=p.clickCount,!((a=o.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(o)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),s=a.pointerType==="mouse"||a.pointerType==="pen",o=r.trackingData(i.pointerId),c=r.findMountedTarget(o.overTargets);if(o.overTargets&&c!==a.target){var l=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,l,c||void 0);if(r.dispatchEvent(u,"pointerout"),s&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(c)){var h=r.createPointerEvent(i,"pointerleave",c||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),s&&r.notifyTarget(h,"mouseleave"),Ue.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(c!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),s&&r.dispatchEvent(d,"mouseover");for(var p=c&&Ue.isNode(c)&&c.parentNode;p&&p!==(Ue.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var g=!p||p===(Ue.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(g){var v=r.clonePointerEvent(a,"pointerenter");for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==c&&v.target!==(Ue.isNode(r.rootTarget)&&r.rootTarget.parentNode);)v.currentTarget=v.target,r.notifyTarget(v),s&&r.notifyTarget(v,"mouseenter"),Ue.isNode(v.target)&&(v.target=v.target.parentNode);r.freeEvent(v)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),s&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),o.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var s=i.pointerType==="mouse"||i.pointerType==="pen",o=r.findMountedTarget(a.overTargets),c=r.createPointerEvent(i,"pointerout",o||void 0);r.dispatchEvent(c),s&&r.dispatchEvent(c,"mouseout");var l=r.createPointerEvent(i,"pointerleave",o||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Ue.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseleave"),Ue.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=null,r.freeEvent(c),r.freeEvent(l)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),s=r.createPointerEvent(i),o=s.pointerType==="mouse"||s.pointerType==="pen";r.dispatchEvent(s,"pointerover"),o&&r.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(r.cursor=r.getCursor(s.target));var c=r.clonePointerEvent(s,"pointerenter");for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Ue.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseenter"),Ue.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=s.composedPath(),r.freeEvent(s),r.freeEvent(c)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),s=r.findMountedTarget(a.pressTargetsByButton[i.button]),o=r.createPointerEvent(i);if(s){for(var c=s;c;)o.currentTarget=c,r.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&r.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),Ue.isNode(c)&&(c=c.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(o)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,s=i.offsetHeight;a&&s&&(t=e.width/a,r=e.height/s)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new tn((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new tn((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),s=this.context.config,o=s.width,c=s.height,l=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=En(this.tmpMatrix,u,l),f=qr(this.tmpVec3,t/o*2-1,(1-r/c)*2-1,0);return Ye(f,f,h),new tn(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),s=En(this.tmpMatrix,i,a),o=qr(this.tmpVec3,e.x,e.y,0);Ye(this.tmpVec3,this.tmpVec3,s);var c=this.context.config,l=c.width,u=c.height;return new tn((o[0]+1)/2*l,(1-(o[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<zW&&e!==this.rootTarget;i++)Ue.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,s=i.height,o=i.disableHitTesting;return t<0||r<0||t>a||r>s?null:!o&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=er(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var s=a.value,o=this.nativeHTMLMap.get(s);if(o)return o}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(Bu);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var s=this.getExistedHTML(a),o=this.context.contextService.getDomElement();return a.target=r??(s||this.isNativeEventFromCanvas(o,a.nativeEvent)&&this.pickTarget(a)||i),typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(Bd);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(Bd);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(Bu);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=qx.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t??e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Ue.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=vW(t)&&t.getAttribute("cursor");if(r)return r;t=Ue.isNode(t)&&t.parentNode}},n}(),YL=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||K.offscreenCanvas)this.canvas=e||K.offscreenCanvas,this.context=this.canvas.getContext("2d",G({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",G({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",G({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),qi;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(qi||(qi={}));var KL=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Pn,initAsync:new NW,dirtycheck:new _v,cull:new _v,beginFrame:new Pn,beforeRender:new Pn,render:new Pn,afterRender:new Pn,endFrame:new Pn,destroy:new Pn,pick:new RW,pickSync:new _v,pointerDown:new Pn,pointerUp:new Pn,pointerMove:new Pn,pointerOut:new Pn,pointerOver:new Pn,pointerWheel:new Pn,pointerCancel:new Pn,click:new Pn}}return n.prototype.init=function(e){var t=this,r=G(G({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(qi.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var s=a.renderReasons.size===1&&a.renderReasons.has(qi.CAMERA_CHANGED),o=!e.disableRenderHooks||!(e.disableRenderHooks&&s);o&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),o&&a.renderListCurrentFrame.forEach(function(c){i.hooks.beforeRender.call(c),i.hooks.render.call(c),i.hooks.afterRender.call(c)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),s=a.enableDirtyCheck,o=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var c=e.renderable,l=s?c.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(l){var u=o?this.hooks.cull.call(l,this.context.camera):l;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==Ps.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var s=mW(t.sorted,r);t.sorted.splice(s,0,r)}}):t.sorted=e.childNodes.slice().sort(RL)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(qi.DISPLAY_OBJECT_CHANGED)},n}(),jW=/\[\s*(.*)=(.*)\s*\]/,XL=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(o){return((o==null?void 0:o.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(o){return o.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,s=i.value;return a?t.find(function(o){return t!==o&&(a==="name"?o.name===s:r.attributeToString(o,a)===s)}):null}else return t.find(function(o){return t!==o&&o.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(o){return t!==o&&((o==null?void 0:o.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(o){return t!==o&&o.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,s=i.value;return a?t.findAll(function(o){return t!==o&&(a==="name"?o.name===s:r.attributeToString(o,a)===s)}):[]}else return t.findAll(function(o){return t!==o&&o.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(jW),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return gt(r)?"":r.toString?r.toString():""},n}(),Hi=function(n){tt(e,n);function e(t,r,i,a,s,o,c,l){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=s,u.attrChange=o,u.prevParsedValue=c,u.newParsedValue=l,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(fh),vt;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(vt||(vt={}));function aO(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var qW=new Hi(vt.REPARENT,null,"","","",0,"",""),ZL=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new se(vt.BOUNDS_CHANGED),this.rotate=function(){var r=$e();return function(i,a,s,o,c){s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=!0),typeof a=="number"&&(a=Wt(a,s,o));var l=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=$e();Kh(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);Xh(r,f),uv(r,r),Oa(u,r,u),Oa(l.localRotation,u,h),wd(l.localRotation,l.localRotation),c&&t.dirtifyLocal(i,l)}}}(),this.rotateLocal=function(){var r=$e();return function(i,a,s,o,c){s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=!0),typeof a=="number"&&(a=Wt(a,s,o));var l=i.transformable;Kh(r,a[0],a[1],a[2]),y3(l.localRotation,l.localRotation,r),c&&t.dirtifyLocal(i,l)}}(),this.setEulerAngles=function(){var r=$e();return function(i,a,s,o,c){s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=!0),typeof a=="number"&&(a=Wt(a,s,o));var l=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{Kh(l.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);Xh(r,uv($e(),u)),y3(l.localRotation,l.localRotation,r),c&&t.dirtifyLocal(i,l)}}}(),this.translateLocal=function(){return function(r,i,a,s,o){a===void 0&&(a=0),s===void 0&&(s=0),o===void 0&&(o=!0),typeof i=="number"&&(i=Wt(i,a,s));var c=r.transformable;Ac(i,Ct())||(ej(i,i,c.localRotation),Po(c.localPosition,c.localPosition,i),o&&t.dirtifyLocal(r,c))}}(),this.setPosition=function(){var r=le(),i=Ct();return function(a,s,o){o===void 0&&(o=!0);var c=a.transformable;if(i[0]=s[0],i[1]=s[1],i[2]=s[2]||0,!Ac(t.getPosition(a),i)){if(va(c.position,i),a.parentNode===null||!a.parentNode.transformable)va(c.localPosition,i);else{var l=a.parentNode.transformable;Bo(r,l.worldTransform),li(r,r),Ye(c.localPosition,i,r)}o&&t.dirtifyLocal(a,c)}}}(),this.setLocalPosition=function(){var r=Ct();return function(i,a,s){s===void 0&&(s=!0);var o=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!Ac(o.localPosition,r)&&(va(o.localPosition,r),s&&t.dirtifyLocal(i,o))}}(),this.translate=function(){var r=Ct(),i=Ct(),a=Ct();return function(s,o,c,l,u){c===void 0&&(c=0),l===void 0&&(l=0),u===void 0&&(u=!0),typeof o=="number"&&(o=qr(i,o,c,l)),!Ac(o,r)&&(Po(a,t.getPosition(s),o),t.setPosition(s,a,u))}}(),this.setRotation=function(){var r=$e();return function(i,a,s,o,c,l){l===void 0&&(l=!0);var u=i.transformable;if(typeof a=="number"&&(a=hv(a,s,o,c)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);Xh(r,h),uv(r,r),Oa(u.localRotation,r,a),wd(u.localRotation,u.localRotation),l&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=le(),i=Ct(),a=hv(0,0,0,1);return function(s){var o=s.localSkew[0]!==0||s.localSkew[1]!==0;if(o){if(_u(s.localTransform,s.localRotation,s.localPosition,Wt(1,1,1),s.origin),s.localSkew[0]!==0||s.localSkew[1]!==0){var c=ks(r);c[4]=Math.tan(s.localSkew[0]),c[1]=Math.tan(s.localSkew[1]),En(s.localTransform,s.localTransform,c)}var l=_u(r,a,i,s.localScale,s.origin);En(s.localTransform,s.localTransform,l)}else _u(s.localTransform,s.localRotation,s.localPosition,s.localScale,s.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,gt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var s=t.sortable;(!((i=s==null?void 0:s.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(s.dirtyChildren.indexOf(e)===-1&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=Ps.ADDED);var o=e.transformable;o&&this.dirtifyWorld(e,o),o.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(qW)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=Ps.REMOVED);var s=e.parentNode.childNodes.indexOf(e);s>-1&&e.parentNode.childNodes.splice(s,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var s=a.origin;s[0]=t[0],s[1]=t[1],s[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=Wt(t,r,i));var s=e.transformable;Kh(s.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,s)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;Qz(i.localScale,i.localScale,Wt(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=Wt(t[0],t[1],t[2]||i.localScale[2]);Ac(a,i.localScale)||(va(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,s){s===void 0&&(s=!0),typeof t=="number"&&(t=hv(t,r,i,a));var o=e.transformable;Xh(o.localRotation,t),s&&this.dirtifyLocal(e,o)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=oj(t,r));var i=e.transformable;cj(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=N(i,2),s=a[0],o=a[1];o.affectChildren?s.forEach(function(c){r(c,o)}):r(s,o)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)aO(r),r=r.parentNode;t&&e.forEach(function(i){aO(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var s=a[e].indexOf(i);a[e].splice(s,1)}}if(r){var o=this.displayObjectDependencyMap.get(r);o||(this.displayObjectDependencyMap.set(r,{}),o=this.displayObjectDependencyMap.get(r)),o[e]||(o[e]=[]),o[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new Hi(vt.ATTR_MODIFIED,a,t,t,i,Hi.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return Ed(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return xd(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return Fo(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=Ed(Ct(),t),i=xd($e(),t),a=Fo(Ct(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(ue.isEmpty(i))return null;var a=r||new ue;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&K.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new ue},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,s=this.getTransformedGeometryBounds(e,t,a),o=e.childNodes;if(o.forEach(function(u){var h=r.getBounds(u,t);h&&(s?s.add(h):(s=a||new ue,s.update(h.center,h.halfExtents)))}),s||(s=new ue),t){var c=$2(e);if(c){var l=c.parsedStyle.clipPath.getBounds(t);s?l&&(s=l.intersection(s)):s.update(l.center,l.halfExtents)}}return t?(i.renderBounds=s,i.renderBoundsDirty=!1):(i.bounds=s,i.boundsDirty=!1),s},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=le();e.parentNode.transformable&&(t=li(le(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!ue.isEmpty(r)){var i=new ue;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);ue.isEmpty(a)||(i=new ue,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var s=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var o=N(i.getMin(),2),c=o[0],l=o[1],u=N(i.getMax(),2),h=u[0],f=u[1];return new Da(c+((s==null?void 0:s.left)||0),l+((s==null?void 0:s.top)||0),h-c,f-l)}return new Da((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var s=a.transformable;s.dirtyFlag||r.dirtifyWorldInternal(a,s)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?Bo(t.worldTransform,t.localTransform):En(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),ts={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},sO=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,GW=/[!%),.:;?\]}'""]/,VW=/[$('"]/,WW=/[!),.:;?\]}'""]/,HW=/[([{'"]/,UW=/[)\]'"?!:;,.]/,YW=/[(['"...]/,KW=/[!%),.:;?\]}'"]/,XW=/[$([{'"#]/,ZW=new RegExp("".concat(GW.source,"|").concat(WW.source,"|").concat(UW.source,"|").concat(KW.source)),QW=new RegExp("".concat(VW.source,"|").concat(HW.source,"|").concat(YW.source,"|").concat(XW.source)),QL=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(QW.exec(i)||ZW.exec(r)))},this.trimByKinsokuShorui=function(r){var i=Q([],N(r),!1),a=i[i.length-2];if(!a)return r;var s=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=s+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var s=ts.MetricsString+ts.BaselineSymbol,o=Math.ceil(a.measureText(s).width),c=Math.ceil(a.measureText(ts.BaselineSymbol).width),l=ts.HeightMultiplier*c;c=c*ts.BaselineMultiplier|0,i.width=o,i.height=l,a.fillStyle="#f00",a.fillRect(0,0,o,l),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(s,0,c);var u=a.getImageData(0,0,o||1,l||1).data,h=u.length,f=o*4,d=0,p=0,g=!1;for(d=0;d<c;++d){for(var v=0;v<f;v+=4)if(u[p+v]!==255){g=!0;break}if(!g)p+=f;else break}for(r.ascent=c-d,p=h-f,g=!1,d=l;d>c;--d){for(var v=0;v<f;v+=4)if(u[p+v]!==255){g=!0;break}if(!g)p-=f;else break}return r.descent=d-c,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,s=t.wordWrap,o=s===void 0?!1:s,c=t.lineHeight,l=t.lineWidth,u=l===void 0?1:l,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,g=t.letterSpacing,v=g===void 0?0:g,m=t.textPath;t.textPathSide,t.textPathStartOffset;var y=t.leading,b=y===void 0?0:y,w=LW(t),x=this.measureFont(w,r);x.fontSize===0&&(x.fontSize=a,x.ascent=a);var S=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);S.font=w,t.isOverflowing=!1;var _=o?this.wordWrap(e,t,r):e,E=_.split(/(?:\r\n|\r|\n)/),P=new Array(E.length),O=0;if(m){m.getTotalLength();for(var C=0;C<E.length;C++)var M=S.measureText(E[C]).width+(E[C].length-1)*v}else{for(var C=0;C<E.length;C++){var T=S.measureText(E[C]).width+(E[C].length-1)*v;P[C]=T,O=Math.max(O,T)}var M=O+u,R=c||x.fontSize+u,D=Math.max(R,x.fontSize+u)+(E.length-1)*(R+b);R+=b;var B=0;return f==="middle"?B=-D/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?B=-D:(f==="top"||f==="hanging")&&(B=0),{font:w,width:M,height:D,lines:E,lineWidths:P,lineHeight:R,maxLineWidth:O,fontProperties:x,lineMetrics:P.map(function(L,$){var V=0;return p==="center"||p==="middle"?V-=L/2:(p==="right"||p==="end")&&(V-=L),new Da(V-u/2,B+$*R,L+u,R)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,s=a===void 0?0:a,o=t.letterSpacing,c=o===void 0?0:o,l=t.maxLines,u=l===void 0?1/0:l,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=s+c,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var g=[],v=0,m=0,y={},b=function(B){return i.getFromCache(B,c,y,f)},w=Array.from(p).reduce(function(B,j){return B+b(j)},0),x=Array.from(e),S=0;S<x.length;S++){var _=x[S],E=e[S-1],P=e[S+1],O=b(_);if(this.isNewline(_)){if(v++,v>=u){t.isOverflowing=!0;break}m=0,g[v]="";continue}if(m>0&&m+O>d){if(v+1>=u){if(t.isOverflowing=!0,w>0&&w<=d){for(var C=g[v].length,M=0,T=C,R=0;R<C;R++){var D=b(g[v][R]);if(M+D+w>d){T=R;break}M+=D}g[v]=(g[v]||"").slice(0,T)+p}break}if(v++,m=0,g[v]="",this.isBreakingSpace(_))continue;this.canBreakInLastChar(_)||(g=this.trimToBreakable(g),m=this.sumTextWidthByCache(g[v]||"",y)),this.shouldBreakByKinsokuShorui(_,P)&&(g=this.trimByKinsokuShorui(g),m+=b(E||""))}m+=O,g[v]=(g[v]||"")+_}return g.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:ts.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:ts.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=Q([],N(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),s=this.isBreakingSpace(a),o=i+1,c=i+(s?0:1);return t[t.length-1]+=r.slice(o,r.length),t[t.length-2]=r.slice(0,c),t},n.prototype.canBreakInLastChar=function(e){return!(e&&sO.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!sO.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var s=e.length*t;a=i.measureText(e).width+s,r[e]=a}return a},n}(),K={},JW=function(){var n,e=new GL,t=new qL;return n={},n[X.CIRCLE]=new FL,n[X.ELLIPSE]=new $L,n[X.RECT]=e,n[X.IMAGE]=e,n[X.GROUP]=new WL,n[X.LINE]=new zL,n[X.TEXT]=new VL(K),n[X.POLYLINE]=t,n[X.POLYGON]=t,n[X.PATH]=new jL,n[X.HTML]=null,n[X.MESH]=null,n}(),tH=function(){var n,e=new eW,t=new jx;return n={},n[ct.PERCENTAGE]=null,n[ct.NUMBER]=new sW,n[ct.ANGLE]=new JV,n[ct.DEFINED_PATH]=new tW,n[ct.PAINT]=e,n[ct.COLOR]=e,n[ct.FILTER]=new nW,n[ct.LENGTH]=t,n[ct.LENGTH_PERCENTAGE]=t,n[ct.LENGTH_PERCENTAGE_12]=new rW,n[ct.LENGTH_PERCENTAGE_14]=new iW,n[ct.COORDINATE]=new jx,n[ct.OFFSET_DISTANCE]=new oW,n[ct.OPACITY_VALUE]=new cW,n[ct.PATH]=new lW,n[ct.LIST_OF_POINTS]=new uW,n[ct.SHADOW_BLUR]=new hW,n[ct.TEXT]=new fW,n[ct.TEXT_TRANSFORM]=new dW,n[ct.TRANSFORM]=new BW,n[ct.TRANSFORM_ORIGIN]=new FW,n[ct.Z_INDEX]=new $W,n[ct.MARKER]=new aW,n}(),eH=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};K.CameraContribution=L2;K.AnimationTimeline=null;K.EasingFunction=null;K.offscreenCanvasCreator=new YL;K.sceneGraphSelector=new XL;K.sceneGraphService=new ZL(K);K.textService=new QL(K);K.geometryUpdaterFactory=JW;K.CSSPropertySyntaxFactory=tH;K.styleValueRegistry=new QV(K);K.layoutRegistry=null;K.globalThis=eH();K.enableCSSParsing=!1;K.enableDataset=!1;K.enableStyleSyntax=!0;K.enableAttributeDashCased=!1;K.enableSizeAttenuation=!1;var JL=0;function nH(){JL=0}var oO=new Hi(vt.INSERTED,null,"","","",0,"",""),cO=new Hi(vt.REMOVED,null,"","","",0,"",""),rH=new se(vt.DESTROY),tI=function(n){tt(e,n);function e(){var t=n.call(this)||this;return t.entity=JL++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:Nd.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=K.enableCSSParsing?{opacity:be,fillOpacity:be,strokeOpacity:be,fill:be,stroke:be,transform:be,transformOrigin:be,visibility:be,pointerEvents:be,lineWidth:be,lineCap:be,lineJoin:be,increasedLineWidthForHitTesting:be,fontSize:be,fontFamily:be,fontStyle:be,fontWeight:be,fontVariant:be,textAlign:be,textBaseline:be,textTransform:be,zIndex:be,filter:be,shadowType:be}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(Jt)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(HG);return K.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(oO.relatedNode=this,t.dispatchEvent(oO)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return cO.relatedNode=this,t.dispatchEvent(cO),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),K.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return K.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return K.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return K.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return K.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return K.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return K.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return K.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(K.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(s,o){var c;return(c=t.parentNode)===null||c===void 0?void 0:c.appendChild(s,a+o+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),s=N(r),o=s[0],c=s.slice(1);this.parentNode.appendChild(o,a),(t=o).after.apply(t,Q([],N(c),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,Q([],N(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,s){return t.appendChild(a,s)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,Q([],N(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(rH),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return K.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return K.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return K.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return K.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return K.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(eV(t))return K.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(K.enableAttributeDashCased){var i=Bx(t);r=this.attributes[i]}return K.enableCSSParsing&&gt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(Jt)},e.prototype.getAttributeNode=function(t){throw new Error(Jt)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(Jt)},e.prototype.hasAttributeNS=function(t,r){throw new Error(Jt)},e.prototype.removeAttributeNS=function(t,r){throw new Error(Jt)},e.prototype.removeAttributeNode=function(t){throw new Error(Jt)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(Jt)},e.prototype.setAttributeNode=function(t){throw new Error(Jt)},e.prototype.setAttributeNodeNS=function(t){throw new Error(Jt)},e.prototype.toggleAttribute=function(t,r){throw new Error(Jt)},e}(Ue);function zt(n){return!!(n!=null&&n.nodeName)}var lO=K.globalThis.Proxy?K.globalThis.Proxy:function(){},Ti=new Hi(vt.ATTR_MODIFIED,null,null,null,null,Hi.MODIFICATION,null,null),iH={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},aH={fill:Ad,stroke:Ad,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},sH=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],oH=Q(Q([],N(sH),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),uO="data-",Sn=function(n){tt(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||X.GROUP,K.enableCSSParsing?(Object.assign(r.attributes,iH),Object.assign(r.parsedStyle,aH,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),K.enableDataset&&(r.dataset=new lO({},{get:function(i,a){var s="".concat(uO).concat(V3(a));return i[s]!==void 0?i[s]:r.getAttribute(s)},set:function(i,a,s){return r.setAttribute("".concat(uO).concat(V3(a)),s),!0}})),K.enableStyleSyntax&&(r.style=new lO({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,s){return r.setAttribute(a,s),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=G({},this.attributes);for(var a in i){var s=i[a];zt(s)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=s.cloneNode(t)),r&&(i[a]=r(a,s))}var o=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return o.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(c){if(!c.style.isMarker){var l=c.cloneNode(t);o.appendChild(l)}}),o},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};K.enableCSSParsing&&(i.usedAttributes=oH);var a=t;if(K.enableAttributeDashCased){a={};for(var s in t){var o=Bx(s);a[o]=t[s]}}K.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),K.enableAttributeDashCased&&(t=Bx(t)),!mt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var s=this.renderable,o=this.attributes[t],c=this.parsedStyle[t];K.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),s.dirty=!0;var l=this.parsedStyle[t];this.isConnected&&(Ti.relatedNode=this,Ti.prevValue=o,Ti.newValue=r,Ti.attrName=t,Ti.prevParsedValue=c,Ti.newParsedValue=l,this.isMutationObserved?this.dispatchEvent(Ti):(Ti.target=this,this.ownerDocument.defaultView.dispatchEvent(Ti,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,o,r,c,l)},e.prototype.getBBox=function(){var t=this.getBounds(),r=N(t.getMin(),2),i=r[0],a=r[1],s=N(t.getMax(),2),o=s[0],c=s[1];return new Da(i,a,o-i,c-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),K.sceneGraphService.setOrigin(this,vn(t,r,i)),this},e.prototype.getOrigin=function(){return K.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),K.sceneGraphService.setPosition(this,vn(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),K.sceneGraphService.setLocalPosition(this,vn(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),K.sceneGraphService.translate(this,vn(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),K.sceneGraphService.translateLocal(this,vn(t,r,i)),this},e.prototype.getPosition=function(){return K.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return K.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=vn(t,r,i)),K.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=vn(t,r,i)),K.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return K.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return K.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=N(nd(Ct(),K.sceneGraphService.getWorldTransform(this)),3),r=t[2];return Qn(r)},e.prototype.getLocalEulerAngles=function(){var t=N(nd(Ct(),K.sceneGraphService.getLocalRotation(this)),3),r=t[2];return Qn(r)},e.prototype.setEulerAngles=function(t){return K.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return K.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return gt(r)&&gt(i)?K.sceneGraphService.rotateLocal(this,0,0,t):K.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return gt(r)&&gt(i)?K.sceneGraphService.rotate(this,0,0,t):K.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return K.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return K.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return K.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return K.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return K.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return K.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return K.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return K.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return K.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){K.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return K.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,Q([],N(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,Q([],N(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=N(r,2),s=a[0],o=a[1];return s?ne(s)?(Object.keys(s).forEach(function(c){t.setAttribute(c,s[c])}),this):r.length===2?(this.setAttribute(s,o),this):this.attributes[s]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=N(Ed(Ct(),r),2),a=i[0],s=i[1],o=N(Fo(Ct(),r),2),c=o[0],l=o[1],u=xd($e(),r),h=N(nd(Ct(),u),3),f=h[0],d=h[2];return dL(f||d,a,s,c,l)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=N(kx(t),5),i=r[0],a=r[1],s=r[2],o=r[3],c=r[4];this.setEulerAngles(c).setPosition(i,a).setLocalScale(s,o)},e.prototype.setLocalMatrix=function(t){var r=N(kx(t),5),i=r[0],a=r[1],s=r[2],o=r[3],c=r[4];this.setLocalEulerAngles(c).setLocalPosition(i,a).setLocalScale(s,o)},e.prototype.show=function(){K.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){K.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(tI),Zi=function(n){tt(e,n);function e(t){return t===void 0&&(t={}),n.call(this,G({type:X.CIRCLE},t))||this}return e}(Sn),V2=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=ie(t,["style"]);return r=n.call(this,G({style:K.enableCSSParsing?G({},i):G({},i)},a))||this,r.isCustomElement=!0,r}return e}(Sn),mg=function(n){tt(e,n);function e(t){return t===void 0&&(t={}),n.call(this,G({type:X.ELLIPSE},t))||this}return e}(Sn),Ze=function(n){tt(e,n);function e(t){return t===void 0&&(t={}),n.call(this,G({type:X.GROUP},t))||this}return e}(Sn),yg=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=ie(t,["style"]);return r=n.call(this,G({type:X.HTML,style:K.enableCSSParsing?G({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):G({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el)return this.parsedStyle.$el.getBoundingClientRect();var t=this.parsedStyle,r=t.x,i=t.y,a=t.width,s=t.height;return new Da(r,i,a,s)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),s=new ue,o=i.left-((a==null?void 0:a.left)||0),c=i.top-((a==null?void 0:a.top)||0);return s.setMinMax([o,c,0],[o+i.width,c+i.height,0]),s},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=li(le(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!ue.isEmpty(r)){var i=new ue;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(Sn),Ds=function(n){tt(e,n);function e(t){return t===void 0&&(t={}),n.call(this,G({type:X.IMAGE},t))||this}return e}(Sn),bg=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=ie(t,["style"]);r=n.call(this,G({type:X.LINE,style:G({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var s=r.parsedStyle,o=s.markerStart,c=s.markerEnd;return o&&zt(o)&&(r.markerStartAngle=o.getLocalEulerAngles(),r.appendChild(o)),c&&zt(c)&&(r.markerEndAngle=c.getLocalEulerAngles(),r.appendChild(c)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,s){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&zt(a)&&(this.markerStartAngle=0,a.remove()),s&&zt(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"&&(a&&zt(a)&&(this.markerEndAngle=0,a.remove()),s&&zt(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,s=r.markerStartOffset,o=r.markerEndOffset,c=r.x1,l=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!zt(f))){var d=0,p,g,v,m,y,b;t?(v=c,m=u,p=l-c,g=h-u,y=s||0,b=this.markerStartAngle):(v=l,m=h,p=c-l,g=u-h,y=o||0,b=this.markerEndAngle),d=Math.atan2(g,p),f.setLocalEulerAngles(d*180/Math.PI+b),f.setLocalPosition(v+Math.cos(d)*y,m+Math.sin(d)*y)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,s=i.y1,o=i.x2,c=i.y2,l=cL(a,s,o,c,t),u=l.x,h=l.y,f=Ye(Ct(),Wt(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new tn(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,s=t.y2;return oL(r,i,a,s)},e}(Sn),Yr=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=ie(t,["style"]);r=n.call(this,G({type:X.PATH,style:K.enableCSSParsing?G({d:"",miterLimit:""},i):G({},i),initialParsedStyle:K.enableCSSParsing?null:{miterLimit:4,d:G({},mL)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var s=r.parsedStyle,o=s.markerStart,c=s.markerEnd,l=s.markerMid;return o&&zt(o)&&(r.markerStartAngle=o.getLocalEulerAngles(),r.appendChild(o)),l&&zt(l)&&r.placeMarkerMid(l),c&&zt(c)&&(r.markerEndAngle=c.getLocalEulerAngles(),r.appendChild(c)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,s){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&zt(a)&&(this.markerStartAngle=0,a.remove()),s&&zt(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(a&&zt(a)&&(this.markerEndAngle=0,a.remove()),s&&zt(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,s=r.markerStartOffset,o=r.markerEndOffset,c=t?i:a;if(!(!c||!zt(c))){var l=0,u,h,f,d,p,g;if(t){var v=N(this.getStartTangent(),2),m=v[0],y=v[1];f=y[0],d=y[1],u=m[0]-y[0],h=m[1]-y[1],p=s||0,g=this.markerStartAngle}else{var b=N(this.getEndTangent(),2),m=b[0],y=b[1];f=y[0],d=y[1],u=m[0]-y[0],h=m[1]-y[1],p=o||0,g=this.markerEndAngle}l=Math.atan2(h,u),c.setLocalEulerAngles(l*180/Math.PI+g),c.setLocalPosition(f+Math.cos(l)*p,d+Math.sin(l)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(l){l.remove()}),t&&zt(t))for(var i=1;i<r.length-1;i++){var a=N(r[i].currentPoint,2),s=a[0],o=a[1],c=i===1?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(s,o)}},e.prototype.getTotalLength=function(){return Rd(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=Pu(i,t),s=a.x,o=a.y,c=Ye(Ct(),Wt(s,o,0),r?this.getWorldTransform():this.getLocalTransform());return new tn(c[0],c[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*Rd(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,s=t[1].startTangent;r=[],s?(r.push([i[0]-s[0],i[1]-s[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,s=t[r-1].currentPoint,o=t[r-1].endTangent;i=[],o?(i.push([s[0]-o[0],s[1]-o[1]]),i.push([s[0],s[1]])):(i.push([a[0],a[1]]),i.push([s[0],s[1]]))}return i},e}(Sn),dh=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=ie(t,["style"]);r=n.call(this,G({type:X.POLYGON,style:K.enableCSSParsing?G({points:"",miterLimit:"",isClosed:!0},i):G({},i),initialParsedStyle:K.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var s=r.parsedStyle,o=s.markerStart,c=s.markerEnd,l=s.markerMid;return o&&zt(o)&&(r.markerStartAngle=o.getLocalEulerAngles(),r.appendChild(o)),l&&zt(l)&&r.placeMarkerMid(l),c&&zt(c)&&(r.markerEndAngle=c.getLocalEulerAngles(),r.appendChild(c)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,s){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&zt(a)&&(this.markerStartAngle=0,a.remove()),s&&zt(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(a&&zt(a)&&(this.markerEndAngle=0,a.remove()),s&&zt(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,s=r.markerStartOffset,o=r.markerEndOffset,c=r.points,l=(c||{}).points,u=t?i:a;if(!(!u||!zt(u)||!l)){var h=0,f,d,p,g,v,m;if(p=l[0][0],g=l[0][1],t)f=l[1][0]-l[0][0],d=l[1][1]-l[0][1],v=s||0,m=this.markerStartAngle;else{var y=l.length;this.parsedStyle.isClosed?(f=l[y-1][0]-l[0][0],d=l[y-1][1]-l[0][1]):(p=l[y-1][0],g=l[y-1][1],f=l[y-2][0]-l[y-1][0],d=l[y-2][1]-l[y-1][1]),v=o||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*v,g+Math.sin(h)*v)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(l){l.remove()}),this.markerMidList=[],t&&zt(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var s=i[a][0],o=i[a][1],c=a===1?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(s,o)}},e}(Sn),W2=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=ie(t,["style"]);return n.call(this,G({type:X.POLYLINE,style:K.enableCSSParsing?G({points:"",miterLimit:"",isClosed:!1},r):G({},r),initialParsedStyle:K.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return OV(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],s=0,o,c,l=this.getTotalLength();i.forEach(function(v,m){i[m+1]&&(o=[0,0],o[0]=s/l,c=oL(v[0],v[1],i[m+1][0],i[m+1][1]),s+=c,o[1]=s/l,a.push(o))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(v,m){t>=v[0]&&t<=v[1]&&(u=(t-v[0])/(v[1]-v[0]),h=m)});var f=cL(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,g=Ye(Ct(),Wt(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new tn(g[0],g[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(dh),kn=function(n){tt(e,n);function e(t){return t===void 0&&(t={}),n.call(this,G({type:X.RECT},t))||this}return e}(Sn),cc=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=ie(t,["style"]);return n.call(this,G({type:X.TEXT,style:K.enableCSSParsing?G({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):G({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(Sn),eI=function(){function n(){this.registry={},this.define(X.CIRCLE,Zi),this.define(X.ELLIPSE,mg),this.define(X.RECT,kn),this.define(X.IMAGE,Ds),this.define(X.LINE,bg),this.define(X.GROUP,Ze),this.define(X.PATH,Yr),this.define(X.POLYGON,dh),this.define(X.POLYLINE,W2),this.define(X.TEXT,cc),this.define(X.HTML,yg)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),cH={number:function(n){return new te(n)},percent:function(n){return new te(n,"%")},px:function(n){return new te(n,"px")},em:function(n){return new te(n,"em")},rem:function(n){return new te(n,"rem")},deg:function(n){return new te(n,"deg")},grad:function(n){return new te(n,"grad")},rad:function(n){return new te(n,"rad")},turn:function(n){return new te(n,"turn")},s:function(n){return new te(n,"s")},ms:function(n){return new te(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;K.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){K.layoutRegistry.registerLayout(n,e)}},H2=function(n){tt(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new K.AnimationTimeline(t)}catch{}var r={};return vg.forEach(function(i){var a=i.n,s=i.inh,o=i.d;s&&o&&(r[a]=mo(o)?o(X.GROUP):o)}),t.documentElement=new Ze({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?cc:Ze);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(Jt)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}},e.prototype.elementsFromBBox=function(t,r,i,a){var s=this.defaultView.context.rBushRoot,o=s.search({minX:t,minY:r,maxX:i,maxY:a}),c=[];return o.forEach(function(l){var u=l.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&c.push(u)}),c.sort(function(l,u){return u.sortable.renderOrder-l.sortable.renderOrder}),c},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,s=i.y,o=this.defaultView.getConfig(),c=o.width,l=o.height;if(a<0||s<0||a>c||s>l)return null;var u=this.defaultView.viewport2Client({x:a,y:s}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:s,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return Et(this,void 0,void 0,function(){var i,a,s,o,c,l,u,h,f,d;return Io(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,s=i.y,o=this.defaultView.getConfig(),c=o.width,l=o.height,a<0||s<0||a>c||s>l?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:s}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:s,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,s=i.y,o=this.defaultView.getConfig(),c=o.width,l=o.height;if(a<0||s<0||a>c||s>l)return[];var u=this.defaultView.viewport2Client({x:a,y:s}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:s,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return Et(this,void 0,void 0,function(){var i,a,s,o,c,l,u,h,f,d;return Io(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,s=i.y,o=this.defaultView.getConfig(),c=o.width,l=o.height,a<0||s<0||a>c||s>l?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:s}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:s,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(ro)},e.prototype.insertBefore=function(t,r){throw new Error(ro)},e.prototype.removeChild=function(t,r){throw new Error(ro)},e.prototype.replaceChild=function(t,r,i){throw new Error(ro)},e.prototype.append=function(){throw new Error(ro)},e.prototype.prepend=function(){throw new Error(ro)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Ue),lH=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(s){if(s){var o=s.cullable;return a.length===0?o.visible=i.unculledEntities.indexOf(s.entity)>-1:o.visible=a.every(function(c){return c.isVisible(t,s)}),!s.isCulled()&&s.isVisible()?s:(s.dispatchEvent(new se(vt.CULLED)),null)}return s}),r.hooks.afterRender.tap(n.tag,function(s){s.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),uH=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new Bu(null),this.rootWheelEvent=new Bd(null),this.onPointerMove=function(t){var r,i,a,s,o=(s=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||s===void 0?void 0:s.defaultView;if(!(o.supportsTouchEvents&&t.pointerType==="touch")){var c=e.normalizeToPointerEvent(t,o);try{for(var l=er(c),u=l.next();!u.done;u=l.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,o,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,s,o=(s=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||s===void 0?void 0:s.defaultView,c=e.normalizeToPointerEvent(t,o);try{for(var l=er(c),u=l.next();!u.done;u=l.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,o,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var s=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return s[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var s=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(s)}),r.hooks.pointerDown.tap(n.tag,function(a){var s,o;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var c=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&c[0].isNormalized){var l=a.cancelable||!("cancelable"in a);l&&a.preventDefault()}try{for(var u=er(c),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){s={error:p}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var s,o;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var c=t.context.contextService.getDomElement(),l=t.context.eventService.isNativeEventFromCanvas(c,a),u=l?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=er(h),d=f.next();!d.done;d=f.next()){var p=d.value,g=t.bootstrapEvent(t.rootPointerEvent,p,i,a);g.type+=u,t.context.eventService.mapEvent(g)}}catch(v){s={error:v}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var s,o,c=t.normalizeToPointerEvent(a,i);try{for(var l=er(c),u=l.next();!u.done;u=l.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){s={error:d}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),s=a.x,o=a.y;e.viewport.x=s,e.viewport.y=o;var c=this.context.eventService.viewport2Canvas(e.viewport),l=c.x,u=c.y;return e.canvas.x=l,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=xW[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var s=this.context.eventService.viewport2Canvas(t.viewport),o=s.x,c=s.y;return t.canvas.x=o,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=qx.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];mt(a.button)&&(a.button=0),mt(a.buttons)&&(a.buttons=1),mt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),mt(a.width)&&(a.width=a.radiusX||1),mt(a.height)&&(a.height=a.radiusY||1),mt(a.tiltX)&&(a.tiltX=0),mt(a.tiltY)&&(a.tiltY=0),mt(a.pointerType)&&(a.pointerType="touch"),mt(a.pointerId)&&(a.pointerId=a.identifier||0),mt(a.pressure)&&(a.pressure=a.force||.5),mt(a.twist)&&(a.twist=0),mt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var s=e;mt(s.isPrimary)&&(s.isPrimary=!0),mt(s.width)&&(s.width=1),mt(s.height)&&(s.height=1),mt(s.tiltX)&&(s.tiltX=0),mt(s.tiltY)&&(s.tiltY=0),mt(s.pointerType)&&(s.pointerType="mouse"),mt(s.pointerId)&&(s.pointerId=EW),mt(s.pressure)&&(s.pressure=.5),mt(s.twist)&&(s.twist=0),mt(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,r.push(s)}else r.push(e);return r},n.tag="Event",n}(),hH=[X.CIRCLE,X.ELLIPSE,X.IMAGE,X.RECT,X.LINE,X.POLYLINE,X.POLYGON,X.TEXT,X.PATH,X.HTML],fH=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var s=t.getRenderBounds();if(ue.isEmpty(s))return!1;var o=e.getFrustum(),c=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,s,c||Di.INDETERMINATE,o.planes),a.visible=a.visibilityPlaneMask!==Di.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===Di.OUTSIDE||r===Di.INSIDE)return r;for(var a=Di.INSIDE,s=hH.indexOf(e.nodeName)>-1,o=0,c=i.length;o<c;++o){var l=1<<o;if(r&l&&!(s&&(o===4||o===5))){var u=i[o],h=u.normal,f=u.distance;if(ui(h,t.getPositiveFarPoint(i[o]))+f<0)return Di.OUTSIDE;ui(h,t.getNegativeFarPoint(i[o]))+f<0&&(a|=l)}}return a},n}(),dH=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,s=e.rBushRoot,o=a.root.ownerDocument.defaultView;this.rBush=s;var c=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},l=function(d){var p=d.detail.affectChildren,g=d.target;p&&g.forEach(function(m){t.toSync.add(m)});for(var v=g;v;)v.renderable&&t.toSync.add(v),v=v.parentElement;i.dirtify()},u=function(d){var p=d.target;K.enableSizeAttenuation&&K.styleValueRegistry.updateSizeAttenuation(p,o.getCamera().getZoom()),K.enableCSSParsing&&K.styleValueRegistry.recalc(p),K.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,g=p.rBushNode;g.aabb&&t.rBush.remove(g.aabb),t.toSync.delete(p),K.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){o.addEventListener(vt.MOUNTED,u),o.addEventListener(vt.UNMOUNTED,h),o.addEventListener(vt.ATTR_MODIFIED,c),o.addEventListener(vt.BOUNDS_CHANGED,l)}),i.hooks.destroy.tap(n.tag,function(){o.removeEventListener(vt.MOUNTED,u),o.removeEventListener(vt.UNMOUNTED,h),o.removeEventListener(vt.ATTR_MODIFIED,c),o.removeEventListener(vt.BOUNDS_CHANGED,l),t.toSync.clear()});var f=(r=K.globalThis.requestIdleCallback)!==null&&r!==void 0?r:z2.bind(K.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var s=i.getRenderBounds();if(s){var o=i.renderable;e&&(o.dirtyRenderBounds||(o.dirtyRenderBounds=new ue),o.dirtyRenderBounds.update(s.center,s.halfExtents));var c=N(s.getMin(),2),l=c[0],u=c[1],h=N(s.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=l,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function pH(n){return!!n.document}var yn;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(yn||(yn={}));var hO=500,gH=.1,vH=1e3,Pv=new se(vt.MOUNTED),Cv=new se(vt.UNMOUNTED),fO=new se(yn.BEFORE_RENDER),mH=new se(yn.RERENDER),dO=new se(yn.AFTER_RENDER),Fd=function(n){tt(e,n);function e(t){var r=n.call(this)||this;r.Element=Sn,r.inited=!1,r.context={},r.document=new H2,r.document.defaultView=r,r.customElements=new eI;var i=t.container,a=t.canvas,s=t.offscreenCanvas,o=t.width,c=t.height,l=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,g=t.cancelAnimationFrame,v=t.createImage,m=t.supportsPointerEvents,y=t.supportsTouchEvents,b=t.supportsCSSTransform,w=t.supportsMutipleCanvasesInOneContainer,x=t.useNativeClickEvent,S=t.alwaysTriggerPointerEventOnCanvas,_=t.isTouchEvent,E=t.isMouseEvent;w||gW(i,r);var P=o,O=c,C=l;return a&&(C=l||oc&&window.devicePixelRatio||1,C=C>=1?Math.ceil(C):1,P=o||yW(a)||a.width/C,O=c||bW(a)||a.height/C),s&&(K.offscreenCanvas=s),r.devicePixelRatio=C,r.requestAnimationFrame=p??z2.bind(K.globalThis),r.cancelAnimationFrame=g??BL.bind(K.globalThis),r.supportsTouchEvents=y??"ontouchstart"in K.globalThis,r.supportsPointerEvents=m??!!K.globalThis.PointerEvent,r.isTouchEvent=_??function(M){return r.supportsTouchEvents&&M instanceof K.globalThis.TouchEvent},r.isMouseEvent=E??function(M){return!K.globalThis.MouseEvent||M instanceof K.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(M instanceof K.globalThis.PointerEvent))},r.initRenderingContext({container:i,canvas:a,width:P,height:O,renderer:u,offscreenCanvas:s,devicePixelRatio:C,cursor:f||"default",background:h||"transparent",createImage:v,document:d,supportsCSSTransform:b,useNativeClickEvent:x,alwaysTriggerPointerEventOnCanvas:S}),r.initDefaultCamera(P,O,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,s=new K.CameraContribution;s.clipSpaceNearZ=i,s.setType(Ut.EXPLORING,Vo.DEFAULT).setPosition(t/2,r/2,hO).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,gH,vH),s.canvas=this,s.eventEmitter.on(D2.UPDATED,function(){a.context.renderingContext.renderReasons.add(qi.CAMERA_CHANGED),K.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=s},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){K.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new se(yn.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new se(yn.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,s=a.getProjectionMode();a.setPosition(t/2,r/2,hO).setFocalPoint(t/2,r/2,0),s===Cn.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new se(yn.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(fO.detail=t,dO.detail=t),this.dispatchEvent(fO);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(mH)}),this.dispatchEvent(dO)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new uL,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new uH,new dH,new lH([new fH])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(G(G({},K),this.context)),this.context.renderingService=new KL(K,this.context),this.context.eventService=new UL(K,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?i?a.requestAnimationFrame(function(){a.dispatchEvent(new se(yn.READY))}):a.dispatchEvent(new se(yn.READY)):a.dispatchEvent(new se(yn.RENDERER_CHANGED)),a.readyPromise&&a.resolveReadyPromise(),r||a.getRoot().forEach(function(s){var o=s.renderable;o&&(o.renderBoundsDirty=!0,o.boundsDirty=!0,o.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(K)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),Q([],N(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(K)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(Cv):(Cv.target=t,this.dispatchEvent(Cv,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(Pv):(Pv.target=t,this.dispatchEvent(Pv,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(G2),nI=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.landmarks=[],t}return e.prototype.rotate=function(t,r,i){if(this.relElevation=Es(r),this.relAzimuth=Es(t),this.relRoll=Es(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Ut.EXPLORING){var a=ma($e(),[1,0,0],ee((this.rotateWorld?1:-1)*this.relElevation)),s=ma($e(),[0,1,0],ee((this.rotateWorld?1:-1)*this.relAzimuth)),o=ma($e(),[0,0,1],ee(this.relRoll)),c=Oa($e(),s,a);c=Oa($e(),c,o);var l=M2(le(),c);Oo(this.matrix,this.matrix,[0,0,-this.distance]),En(this.matrix,this.matrix,l),Oo(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Ut.ORBITING||this.type===Ut.EXPLORING?this._getPosition():this.type===Ut.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,r){var i=vn(t,r,0),a=Ni(this.position);return Po(a,a,Ox(Ct(),this.right,i[0])),Po(a,a,Ox(Ct(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},e.prototype.dolly=function(t){var r=this.forward,i=Ni(this.position),a=t*this.dollyingStep,s=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(s,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===Ut.ORBITING||this.type===Ut.EXPLORING?this._getDistance():this.type===Ut.TRACKING&&Po(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,r){var i,a,s,o;r===void 0&&(r={});var c=r.position,l=c===void 0?this.position:c,u=r.focalPoint,h=u===void 0?this.focalPoint:u,f=r.roll,d=r.zoom,p=new K.CameraContribution;p.setType(this.type,void 0),p.setPosition(l[0],(i=l[1])!==null&&i!==void 0?i:this.position[1],(a=l[2])!==null&&a!==void 0?a:this.position[2]),p.setFocalPoint(h[0],(s=h[1])!==null&&s!==void 0?s:this.focalPoint[1],(o=h[2])!==null&&o!==void 0?o:this.focalPoint[2]),p.setRoll(f??this.roll),p.setZoom(d??this.zoom);var g={name:t,matrix:iD(p.getWorldTransform()),right:Ni(p.right),up:Ni(p.up),forward:Ni(p.forward),position:Ni(p.getPosition()),focalPoint:Ni(p.getFocalPoint()),distanceVector:Ni(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(g),g},e.prototype.gotoLandmark=function(t,r){var i=this;r===void 0&&(r={});var a=At(t)?this.landmarks.find(function(O){return O.name===t}):t;if(a){var s=rt(r)?{duration:r}:r,o=s.easing,c=o===void 0?"linear":o,l=s.duration,u=l===void 0?100:l,h=s.easingFunction,f=h===void 0?void 0:h,d=s.onfinish,p=d===void 0?void 0:d,g=s.onframe,v=g===void 0?void 0:g,m=.01;this.cancelLandmarkAnimation();var y=a.position,b=a.focalPoint,w=a.zoom,x=a.roll,S=f||K.EasingFunction(c),_,E=function(){i.setFocalPoint(b),i.setPosition(y),i.setRoll(x),i.setZoom(w),i.computeMatrix(),i.triggerUpdate(),p==null||p()};if(u===0)return E();var P=function(O){_===void 0&&(_=O);var C=O-_;if(C>=u){E();return}var M=S(C/u),T=Ct(),R=Ct(),D=1,B=0;Px(T,i.focalPoint,b,M),Px(R,i.position,y,M),B=i.roll*(1-M)+x*M,D=i.zoom*(1-M)+w*M,i.setFocalPoint(T),i.setPosition(R),i.setRoll(B),i.setZoom(D);var j=m3(T,b)+m3(R,y);if(j<=m&&w==null&&x==null)return E();i.computeMatrix(),i.triggerUpdate(),C<u&&(v==null||v(M),i.landmarkAnimationID=i.canvas.requestAnimationFrame(P))};this.canvas.requestAnimationFrame(P)}},e}(L2);K.CameraContribution=nI;var U2=function(){function n(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return n.copy=function(e){var t=new n(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t},n}(),yH=0,Ao=new WeakMap,rI=function(){function n(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}return n.prototype.enqueue=function(e){var t=this.observer.records,r=t.length;if(t.length>0){var i=t[r-1],a=SH(i,e);if(a){t[r-1]=a;return}}else OH(this.observer);t[r]=e},n.prototype.addListeners=function(){this.addListeners_(this.target)},n.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(vt.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(vt.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(vt.REMOVED,this,!0)},n.prototype.removeListeners=function(){this.removeListeners_(this.target)},n.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(vt.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(vt.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(vt.REMOVED,this,!0)},n.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(t){this.removeListeners_(t);for(var r=Ao.get(t),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},n.prototype.handleEvent=function(e){e.stopImmediatePropagation();var t,r;switch(e.type){case vt.ATTR_MODIFIED:var i=e.attrName,a=e.relatedNode.namespaceURI;r=e.target,t=pO("attributes",r),t.attributeName=i,t.attributeNamespace=a;var s=e.attrChange===Hi.ADDITION?null:e.prevValue;gO(r,function(f){if(f.attributes&&!(f.attributeFilter&&f.attributeFilter.length&&f.attributeFilter.indexOf(i)===-1&&f.attributeFilter.indexOf(a)===-1))return f.attributeOldValue?EH(s):t});break;case vt.REMOVED:case vt.INSERTED:r=e.relatedNode;var o=e.target,c=void 0,l=void 0;e.type===vt.INSERTED?(c=[o],l=[]):(c=[],l=[o]);var u=o.previousSibling,h=o.nextSibling;t=pO("childList",r),t.addedNodes=c,t.removedNodes=l,t.previousSibling=u,t.nextSibling=h,gO(r,function(f){if(f.childList)return t})}xH()},n}(),bH=function(){function n(e){this.callback=e,this.nodes=[],this.records=[],this.uid=yH++}return n.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=Ao.get(e);r||Ao.set(e,r=[]);for(var i,a=0;a<r.length;a++)if(r[a].observer===this){i=r[a],i.removeListeners(),i.options=t;break}i||(i=new rI(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},n.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(t){for(var r=Ao.get(t),i=0;i<r.length;i++){var a=r[i];if(a.observer===e){a.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},n.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},n}(),Eg,Bi;function pO(n,e){return Eg=new U2(n,e)}function EH(n){return Bi||(Bi=U2.copy(Eg),Bi.oldValue=n,Bi)}function xH(){Eg=Bi=void 0}function wH(n){return n===Bi||n===Eg}function SH(n,e){return n===e?n:Bi&&wH(n)?Bi:null}function _H(n){n.nodes.forEach(function(e){var t=Ao.get(e);t&&t.forEach(function(r){r.observer===n&&r.removeTransientObservers()})})}function gO(n,e){for(var t=n;t;t=t.parentNode){var r=Ao.get(t);if(r)for(var i=0;i<r.length;i++){var a=r[i],s=a.options;if(!(t!==n&&!s.subtree)){var o=e(s);o&&a.enqueue(o)}}}}var Gx=!1,Vx=[];function OH(n){Vx.push(n),Gx||(Gx=!0,typeof K.globalThis<"u"?K.globalThis.setTimeout(Wx):Wx())}function Wx(){Gx=!1;var n=Vx;Vx=[],n.sort(function(t,r){return t.uid-r.uid});var e=!1;n.forEach(function(t){var r=t.takeRecords();_H(t),r.length&&(t.callback(r,t),e=!0)}),e&&Wx()}var rd=function(n){tt(e,n);function e(t,r,i,a){var s=n.call(this,t)||this;return s.currentTime=i,s.timelineTime=a,s.target=r,s.type="finish",s.bubbles=!1,s.currentTarget=r,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=i,s.timelineTime=a,s}return e}(fh),PH=0,iI=function(){function n(e,t){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(PH++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(n.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,r){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,r){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((t=this.timeline)===null||t===void 0?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),n.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&(t==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():t==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&(t==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):t==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},n.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},n.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},n.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},n.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new rd(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}},n.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},n.prototype.updatePlaybackRate=function(e){this.playbackRate=e},n.prototype.targetAnimations=function(){var e,t=(e=this.effect)===null||e===void 0?void 0:e.target;return t.getAnimations()},n.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},n.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)},n.prototype.tick=function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},n.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},n.prototype.persist=function(){throw new Error(Jt)},n.prototype.addEventListener=function(e,t,r){throw new Error(Jt)},n.prototype.removeEventListener=function(e,t,r){throw new Error(Jt)},n.prototype.dispatchEvent=function(e){throw new Error(Jt)},n.prototype.commitStyles=function(){throw new Error(Jt)},n.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},n.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},n.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new rd(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new rd(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},n}(),CH=4,MH=.001,TH=1e-7,AH=10,lu=11,af=1/(lu-1),NH=typeof Float32Array=="function",aI=function(n,e){return 1-3*e+3*n},sI=function(n,e){return 3*e-6*n},oI=function(n){return 3*n},$d=function(n,e,t){return((aI(e,t)*n+sI(e,t))*n+oI(e))*n},cI=function(n,e,t){return 3*aI(e,t)*n*n+2*sI(e,t)*n+oI(e)},RH=function(n,e,t,r,i){var a,s,o=0;do s=e+(t-e)/2,a=$d(s,r,i)-n,a>0?t=s:e=s;while(Math.abs(a)>TH&&++o<AH);return s},kH=function(n,e,t,r){for(var i=0;i<CH;++i){var a=cI(e,t,r);if(a===0)return e;var s=$d(e,t,r)-n;e-=s/a}return e},Y2=function(n,e,t,r){if(!(0<=n&&n<=1&&0<=t&&t<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===e&&t===r)return function(o){return o};for(var i=NH?new Float32Array(lu):new Array(lu),a=0;a<lu;++a)i[a]=$d(a*af,n,t);var s=function(o){for(var c=0,l=1,u=lu-1;l!==u&&i[l]<=o;++l)c+=af;--l;var h=(o-i[l])/(i[l+1]-i[l]),f=c+h*af,d=cI(f,n,t);return d>=MH?kH(o,f,n,t):d===0?f:RH(o,c,c+af,n,t)};return function(o){return o===0||o===1?o:$d(s(o),e,r)}},DH=function(n){return n=n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},sf=function(n){return Math.pow(n,2)},of=function(n){return Math.pow(n,3)},cf=function(n){return Math.pow(n,4)},lf=function(n){return Math.pow(n,5)},uf=function(n){return Math.pow(n,6)},hf=function(n){return 1-Math.cos(n*Math.PI/2)},ff=function(n){return 1-Math.sqrt(1-n*n)},df=function(n){return n*n*(3*n-2)},pf=function(n){for(var e,t=4;n<((e=Math.pow(2,--t))-1)/11;);return 1/Math.pow(4,3-t)-7.5625*Math.pow((e*3-2)/22-n,2)},gf=function(n,e){e===void 0&&(e=[]);var t=N(e,2),r=t[0],i=r===void 0?1:r,a=t[1],s=a===void 0?.5:a,o=oe(Number(i),1,10),c=oe(Number(s),.1,2);return n===0||n===1?n:-o*Math.pow(2,10*(n-1))*Math.sin((n-1-c/(Math.PI*2)*Math.asin(1/o))*(Math.PI*2)/c)},kc=function(n,e,t){e===void 0&&(e=[]);var r=N(e,4),i=r[0],a=i===void 0?1:i,s=r[1],o=s===void 0?100:s,c=r[2],l=c===void 0?10:c,u=r[3],h=u===void 0?0:u;a=oe(a,.1,1e3),o=oe(o,.1,1e3),l=oe(l,.1,1e3),h=oe(h,.1,1e3);var f=Math.sqrt(o/a),d=l/(2*Math.sqrt(o*a)),p=d<1?f*Math.sqrt(1-d*d):0,g=1,v=d<1?(d*f+-h)/p:-h+f,m=t?t*n/1e3:n;return d<1?m=Math.exp(-m*d*f)*(g*Math.cos(p*m)+v*Math.sin(p*m)):m=(g+v*m)*Math.exp(-m*f),n===0||n===1?n:1-m},Mv=function(n,e){e===void 0&&(e=[]);var t=N(e,2),r=t[0],i=r===void 0?10:r,a=t[1],s=a=="start"?Math.ceil:Math.floor;return s(oe(n,0,1)*i)/i},vO=function(n,e){e===void 0&&(e=[]);var t=N(e,4),r=t[0],i=t[1],a=t[2],s=t[3];return Y2(r,i,a,s)(n)},vf=Y2(.42,0,1,1),vr=function(n){return function(e,t,r){return t===void 0&&(t=[]),1-n(1-e,t,r)}},mr=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?n(e*2,t,r)/2:1-n(e*-2+2,t,r)/2}},yr=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?(1-n(1-e*2,t,r))/2:(n(e*2-1,t,r)+1)/2}},Hx={steps:Mv,"step-start":function(n){return Mv(n,[1,"start"])},"step-end":function(n){return Mv(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":vO,ease:function(n){return vO(n,[.25,.1,.25,1])},in:vf,out:vr(vf),"in-out":mr(vf),"out-in":yr(vf),"in-quad":sf,"out-quad":vr(sf),"in-out-quad":mr(sf),"out-in-quad":yr(sf),"in-cubic":of,"out-cubic":vr(of),"in-out-cubic":mr(of),"out-in-cubic":yr(of),"in-quart":cf,"out-quart":vr(cf),"in-out-quart":mr(cf),"out-in-quart":yr(cf),"in-quint":lf,"out-quint":vr(lf),"in-out-quint":mr(lf),"out-in-quint":yr(lf),"in-expo":uf,"out-expo":vr(uf),"in-out-expo":mr(uf),"out-in-expo":yr(uf),"in-sine":hf,"out-sine":vr(hf),"in-out-sine":mr(hf),"out-in-sine":yr(hf),"in-circ":ff,"out-circ":vr(ff),"in-out-circ":mr(ff),"out-in-circ":yr(ff),"in-back":df,"out-back":vr(df),"in-out-back":mr(df),"out-in-back":yr(df),"in-bounce":pf,"out-bounce":vr(pf),"in-out-bounce":mr(pf),"out-in-bounce":yr(pf),"in-elastic":gf,"out-elastic":vr(gf),"in-out-elastic":mr(gf),"out-in-elastic":yr(gf),spring:kc,"spring-in":kc,"spring-out":vr(kc),"spring-in-out":mr(kc),"spring-out-in":yr(kc)},LH=function(n){return DH(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},IH=function(n){return Hx[LH(n)]||Hx.linear},BH=function(n){return n},FH=1,$H=.5,mO=0;function yO(n,e){return function(t){if(t>=1)return 1;var r=1/n;return t+=e*r,t-t%r}}var mf="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",zH=new RegExp("cubic-bezier\\("+mf+","+mf+","+mf+","+mf+"\\)"),jH=/steps\(\s*(\d+)\s*\)/,qH=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function K2(n){var e=zH.exec(n);if(e)return Y2.apply(void 0,Q([],N(e.slice(1).map(Number)),!1));var t=jH.exec(n);if(t)return yO(Number(t[1]),mO);var r=qH.exec(n);return r?yO(Number(r[1]),{start:FH,middle:$H,end:mO}[r[2]]):IH(n)}function GH(n){return Math.abs(VH(n)/(n.playbackRate||1))}function VH(n){var e;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((e=n.iterations)!==null&&e!==void 0?e:1)}var lI=0,X2=1,xg=2,uI=3;function WH(n,e,t){if(e===null)return lI;var r=t.endTime;return e<Math.min(t.delay,r)?X2:e>=Math.min(t.delay+n+t.endDelay,r)?xg:uI}function HH(n,e,t,r,i){switch(r){case X2:return e==="backwards"||e==="both"?0:null;case uI:return t-i;case xg:return e==="forwards"||e==="both"?n:null;case lI:return null}}function UH(n,e,t,r,i){var a=i;return n===0?e!==X2&&(a+=t):a+=r/n,a}function YH(n,e,t,r,i,a){var s=n===1/0?e%1:n%1;return s===0&&t===xg&&r!==0&&(i!==0||a===0)&&(s=1),s}function KH(n,e,t,r){return n===xg&&e===1/0?1/0:t===1?Math.floor(r)-1:Math.floor(r)}function XH(n,e,t){var r=n;if(n!=="normal"&&n!=="reverse"){var i=e;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?t:1-t}function ZH(n,e,t){var r=WH(n,e,t),i=HH(n,t.fill,e,r,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,s=UH(a,r,t.iterations,i,t.iterationStart),o=YH(s,t.iterationStart,r,t.iterations,i,a),c=KH(r,t.iterations,o,s),l=XH(t.direction,c,o);return t.currentIteration=c,t.progress=l,t.easingFunction(l)}function QH(n,e,t){var r=JH(n,e),i=tU(r,t);return function(a,s){if(s!==null)i.filter(function(c){return s>=c.applyFrom&&s<c.applyTo}).forEach(function(c){var l=s-c.startOffset,u=c.endOffset-c.startOffset,h=u===0?0:l/u;a.setAttribute(c.property,c.interpolation(h),!1,!1)});else for(var o in r)hI(o)&&a.setAttribute(o,null)}}function hI(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function JH(n,e){for(var t={},r=0;r<n.length;r++)for(var i in n[r])if(hI(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:K2(n[r].easing)||e.easingFunction,value:n[r][i]};t[i]=t[i]||[],t[i].push(a)}return t}function tU(n,e){var t=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var s=a,o=a+1,c=i[s].computedOffset,l=i[o].computedOffset,u=c,h=l;a===0&&(u=-1/0,l===0&&(o=s)),a===i.length-2&&(h=1/0,c===1&&(s=o)),t.push({applyFrom:u,applyTo:h,startOffset:i[s].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[s].easingFunction,property:r,interpolation:eU(r,i[s].value,i[o].value,e)})}return t.sort(function(f,d){return f.startOffset-d.startOffset}),t}var bO=function(n,e,t){return function(r){var i=fI(n,e,r);return!K.enableCSSParsing&&rt(i)?i:t(i)}};function eU(n,e,t,r){var i=Ri[n];if(i&&i.syntax&&i.int){var a=K.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var s=void 0,o=void 0;if(K.enableCSSParsing){var c=K.styleValueRegistry.parseProperty(n,e,r,!1),l=K.styleValueRegistry.parseProperty(n,t,r,!1);s=K.styleValueRegistry.computeProperty(n,c,r,!1),o=K.styleValueRegistry.computeProperty(n,l,r,!1)}else{var u=a.parserWithCSSDisabled;s=u?u(e,r):e,o=u?u(t,r):t}var h=a.mixer(s,o,r);if(h){var f=bO.apply(void 0,Q([],N(h),!1));return function(d){return d===0?e:d===1?t:f(d)}}}}return bO(!1,!0,function(d){return d?t:e})}function fI(n,e,t){if(typeof n=="number"&&typeof e=="number")return n*(1-t)+e*t;if(typeof n=="boolean"&&typeof e=="boolean"||typeof n=="string"&&typeof e=="string")return t<.5?n:e;if(Array.isArray(n)&&Array.isArray(e)){for(var r=n.length,i=e.length,a=Math.max(r,i),s=[],o=0;o<a;o++)s.push(fI(n[o<r?o:r-1],e[o<i?o:i-1],t));return s}throw new Error("Mismatched interpolation arguments "+n+":"+e)}var nU=function(){function n(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=BH,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(n.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=K2(e),this._easing=e},enumerable:!1,configurable:!0}),n}();function rU(n){var e=[];for(var t in n)if(!(t in["easing","offset","composite"])){var r=n[t];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var s={};"offset"in n&&(s.offset=Number(n.offset)),"easing"in n&&(s.easing=n.easing),"composite"in n&&(s.composite=n.composite),e[a]=s}r[a]!==void 0&&r[a]!==null&&(e[a][t]=r[a])}}return e.sort(function(o,c){return(o.computedOffset||0)-(c.computedOffset||0)}),e}function Ux(n,e){if(n===null)return[];Array.isArray(n)||(n=rU(n));for(var t=n.map(function(c){var l={};e!=null&&e.composite&&(l.composite="auto");for(var u in c){var h=c[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");l.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));l[u]=h}return l.offset===void 0&&(l.offset=null),l.easing===void 0&&(l.easing=(e==null?void 0:e.easing)||"linear"),l.composite===void 0&&(l.composite="auto"),l}),r=!0,i=-1/0,a=0;a<t.length;a++){var s=t[a].offset;if(gt(s))r=!1;else{if(s<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=s}}t=t.filter(function(c){return Number(c.offset)>=0&&Number(c.offset)<=1});function o(){var c,l,u=t.length;t[u-1].computedOffset=Number((c=t[u-1].offset)!==null&&c!==void 0?c:1),u>1&&(t[0].computedOffset=Number((l=t[0].offset)!==null&&l!==void 0?l:0));for(var h=0,f=Number(t[0].computedOffset),d=1;d<u;d++){var p=t[d].computedOffset;if(!gt(p)&&!gt(f)){for(var g=1;g<d-h;g++)t[h+g].computedOffset=f+(Number(p)-f)*g/(d-h);h=d,f=Number(p)}}}return r||o(),t}var iU="backwards|forwards|both|none".split("|"),aU="reverse|alternate|alternate-reverse".split("|");function dI(n,e){var t=new nU;return e&&(t.fill="both",t.duration="auto"),typeof n=="number"&&!isNaN(n)?t.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof t[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&iU.indexOf(n[r])===-1||r==="direction"&&aU.indexOf(n[r])===-1)return;t[r]=n[r]}}),t}function pI(n,e){return n=gI(n??{duration:"auto"}),dI(n,e)}function gI(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var vI=function(){function n(e,t,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=pI(r,!1),this.timing.effect=this,this.timing.activeDuration=GH(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Ux(t,this.timing),this.interpolations=QH(this.normalizedKeyframes,this.timing,this.target);var a=K.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(s,o){return o==="duration"?s.duration==="auto"?0:s.duration:o==="fill"?s.fill==="auto"?"none":s.fill:o==="localTime"?i.animation&&i.animation.currentTime||null:o==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:s.currentIteration||0:o==="progress"?!i.animation||i.animation.playState!=="running"?null:s.progress||0:s[o]},set:function(){return!0}}):this.timing}return n.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},n.prototype.update=function(e){return e===null?!1:(this.timeFraction=ZH(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},n.prototype.getKeyframes=function(){return this.normalizedKeyframes},n.prototype.setKeyframes=function(e){this.normalizedKeyframes=Ux(e)},n.prototype.getComputedTiming=function(){return this.computedTiming},n.prototype.getTiming=function(){return this.timing},n.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach(function(r){t.timing[r]=e[r]})},n}();function Yx(n,e){return Number(n.id)-Number(e.id)}var mI=function(){function n(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){t.currentTime=r,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=t.rafCallbacks;t.rafCallbacks=[],r<Number(t.currentTime)&&(r=Number(t.currentTime)),t.animations.sort(Yx),t.animations=t.tick(r,!0,t.animations)[0],i.forEach(function(a){a[1](r)}),t.applyPendingEffects()}}return n.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},n.prototype.isTicking=function(){return this.inTick},n.prototype.play=function(e,t,r){var i=new vI(e,t,r),a=new iI(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},n.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(Yx);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(a){var s=t.animations.indexOf(a);s!==-1&&t.animations.splice(s,1)}),this.applyPendingEffects()}},n.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},n.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},n.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},n.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},n.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},n.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},n.prototype.rAF=function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},n.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF(function(r){t.updateAnimationsPromises(),e(r),t.updateAnimationsPromises()})},n.prototype.tick=function(e,t,r){var i,a,s=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var o=[],c=[],l=[],u=[];return r.forEach(function(h){h.tick(e,t),h._inEffect?(c.push(h.effect),h.markTarget()):(o.push(h.effect),h.unmarkTarget()),h._needsTick&&(s.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?l.push(h):u.push(h)}),(i=this.pendingEffects).push.apply(i,Q([],N(o),!1)),(a=this.pendingEffects).push.apply(a,Q([],N(c),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[l,u]},n}();K.EasingFunction=K2;K.AnimationTimeline=mI;const sU=Object.freeze(Object.defineProperty({__proto__:null,AABB:ue,AbstractRenderer:hL,AbstractRendererPlugin:Xi,AdvancedCamera:nI,Animation:iI,AnimationEvent:rd,AnimationTimeline:mI,BUILT_IN_PROPERTIES:vg,CSS:cH,CSSGradientValue:ou,CSSKeywordValue:Rn,CSSRGB:pg,CSSStyleValue:uh,CSSUnitValue:te,Camera:L2,CameraEvent:D2,get CameraProjectionMode(){return Cn},get CameraTrackingMode(){return Vo},get CameraType(){return Ut},Canvas:Fd,get CanvasEvent(){return yn},Circle:Zi,CircleUpdater:FL,get ClipSpaceNearZ(){return bs},CustomElement:V2,CustomElementRegistry:eI,CustomEvent:se,DefaultSceneGraphSelector:XL,DefaultSceneGraphService:ZL,DisplayObject:Sn,Document:H2,ERROR_MSG_METHOD_NOT_IMPLEMENTED:Jt,EasingFunctions:Hx,Element:tI,get ElementEvent(){return vt},Ellipse:mg,EllipseUpdater:$L,EventService:UL,EventTarget:G2,FederatedEvent:fh,FederatedMouseEvent:q2,FederatedPointerEvent:Bu,FederatedWheelEvent:Bd,Frustum:gL,get GradientType(){return Hr},Group:Ze,GroupUpdater:WL,HTML:yg,Image:Ds,KeyframeEffect:vI,Line:bg,LineUpdater:zL,get Mask(){return Di},MutationEvent:Hi,MutationObserver:bH,MutationRecord:U2,Node:Ue,OffscreenCanvasCreator:YL,Path:Yr,PathUpdater:jL,Plane:pL,Point:tn,Polygon:dh,Polyline:W2,PolylineUpdater:qL,get PropertySyntax(){return ct},RBush:uL,Rect:kn,RectUpdater:GL,Rectangle:Da,Registration:rI,get RenderReason(){return qi},RenderingService:KL,get Shape(){return X},get SortReason(){return Ps},get Strategy(){return Nd},Text:cc,TextService:QL,TextUpdater:VL,get UnitType(){return st},compareAnimations:Yx,computeLinearGradient:yL,computeRadialGradient:bL,convertToPath:IV,createVec3:vn,decompose:kx,definedProps:nV,deg2rad:ee,deg2turn:$G,findClosestClipPathTarget:$2,fromRotationTranslationScale:dL,getAngle:Es,getEuler:nd,getOrCalculatePathTotalLength:Rd,grad2deg:FG,isBrowser:oc,isCSSGradientValue:EV,isCSSRGB:Lu,isCanvas:pH,isDisplayObject:zt,isFederatedEvent:HL,isFillOrStrokeAffected:qa,isPattern:Wo,makeTiming:dI,mergeColors:xL,normalizeKeyframes:Ux,normalizeTimingInput:pI,numericTimingToObject:gI,parseColor:Pa,parseLength:SL,parsePath:Dd,parseTransform:gg,parsedTransformToMat4:j2,propertyMetadataCache:Ri,rad2deg:Qn,resetEntityCounter:nH,runtime:K,setDOMSize:kL,translatePathToString:BV,turn2deg:fL},Symbol.toStringTag,{value:"Module"})),oU="5.0.10",cU="G6";function ya(n){return`[${cU} v${oU}] ${n}`}const Qi={mute:!1,debug:n=>{console.debug(ya(n))},info:n=>{console.info(ya(n))},warn:n=>{console.warn(ya(n))},error:n=>{console.error(ya(n))}},lU={duration:500},uU={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Se;(function(n){n.NodeAdded="NodeAdded",n.NodeUpdated="NodeUpdated",n.NodeRemoved="NodeRemoved",n.EdgeAdded="EdgeAdded",n.EdgeUpdated="EdgeUpdated",n.EdgeRemoved="EdgeRemoved",n.ComboAdded="ComboAdded",n.ComboUpdated="ComboUpdated",n.ComboRemoved="ComboRemoved"})(Se||(Se={}));var Bn;(function(n){n.DRAW="draw",n.COLLAPSE="collapse",n.EXPAND="expand",n.TRANSFORM="transform"})(Bn||(Bn={}));var Tn;(function(n){n.CLICK="canvas:click",n.DBLCLICK="canvas:dblclick",n.POINTER_OVER="canvas:canvas:pointerover",n.POINTER_LEAVE="canvas:pointerleave",n.POINTER_ENTER="canvas:pointerenter",n.POINTER_MOVE="canvas:pointermove",n.POINTER_OUT="canvas:pointerout",n.POINTER_DOWN="canvas:pointerdown",n.POINTER_UP="canvas:pointerup",n.CONTEXT_MENU="canvas:contextmenu",n.DRAG_START="canvas:dragstart",n.DRAG="canvas:drag",n.DRAG_END="canvas:dragend",n.DRAG_ENTER="canvas:dragenter",n.DRAG_OVER="canvas:dragover",n.DRAG_LEAVE="canvas:dragleave",n.DROP="canvas:drop",n.WHEEL="canvas:wheel"})(Tn||(Tn={}));var ls;(function(n){n.CLICK="combo:click",n.DBLCLICK="combo:dblclick",n.POINTER_OVER="combo:pointerover",n.POINTER_LEAVE="combo:pointerleave",n.POINTER_ENTER="combo:pointerenter",n.POINTER_MOVE="combo:pointermove",n.POINTER_OUT="combo:pointerout",n.POINTER_DOWN="combo:pointerdown",n.POINTER_UP="combo:pointerup",n.CONTEXT_MENU="combo:contextmenu",n.DRAG_START="combo:dragstart",n.DRAG="combo:drag",n.DRAG_END="combo:dragend",n.DRAG_ENTER="combo:dragenter",n.DRAG_OVER="combo:dragover",n.DRAG_LEAVE="combo:dragleave",n.DROP="combo:drop"})(ls||(ls={}));var nt;(function(n){n.CLICK="click",n.DBLCLICK="dblclick",n.POINTER_OVER="pointerover",n.POINTER_LEAVE="pointerleave",n.POINTER_ENTER="pointerenter",n.POINTER_MOVE="pointermove",n.POINTER_OUT="pointerout",n.POINTER_DOWN="pointerdown",n.POINTER_UP="pointerup",n.CONTEXT_MENU="contextmenu",n.DRAG_START="dragstart",n.DRAG="drag",n.DRAG_END="dragend",n.DRAG_ENTER="dragenter",n.DRAG_OVER="dragover",n.DRAG_LEAVE="dragleave",n.DROP="drop",n.KEY_DOWN="keydown",n.KEY_UP="keyup",n.WHEEL="wheel"})(nt||(nt={}));var yo;(function(n){n.KEY_DOWN="keydown",n.KEY_UP="keyup"})(yo||(yo={}));var zd;(function(n){n.CLICK="edge:click",n.DBLCLICK="edge:dblclick",n.POINTER_OVER="edge:pointerover",n.POINTER_LEAVE="edge:pointerleave",n.POINTER_ENTER="edge:pointerenter",n.POINTER_MOVE="edge:pointermove",n.POINTER_OUT="edge:pointerout",n.POINTER_DOWN="edge:pointerdown",n.POINTER_UP="edge:pointerup",n.CONTEXT_MENU="edge:contextmenu",n.DRAG_ENTER="edge:dragenter",n.DRAG_OVER="edge:dragover",n.DRAG_LEAVE="edge:dragleave",n.DROP="edge:drop"})(zd||(zd={}));var dt;(function(n){n.BEFORE_CANVAS_INIT="beforecanvasinit",n.AFTER_CANVAS_INIT="aftercanvasinit",n.BEFORE_SIZE_CHANGE="beforesizechange",n.AFTER_SIZE_CHANGE="aftersizechange",n.BEFORE_ELEMENT_CREATE="beforeelementcreate",n.AFTER_ELEMENT_CREATE="afterelementcreate",n.BEFORE_ELEMENT_UPDATE="beforeelementupdate",n.AFTER_ELEMENT_UPDATE="afterelementupdate",n.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",n.AFTER_ELEMENT_DESTROY="afterelementdestroy",n.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",n.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",n.BEFORE_DRAW="beforedraw",n.AFTER_DRAW="afterdraw",n.BEFORE_RENDER="beforerender",n.AFTER_RENDER="afterrender",n.BEFORE_ANIMATE="beforeanimate",n.AFTER_ANIMATE="afteranimate",n.BEFORE_LAYOUT="beforelayout",n.AFTER_LAYOUT="afterlayout",n.BEFORE_STAGE_LAYOUT="beforestagelayout",n.AFTER_STAGE_LAYOUT="afterstagelayout",n.BEFORE_TRANSFORM="beforetransform",n.AFTER_TRANSFORM="aftertransform",n.BATCH_START="batchstart",n.BATCH_END="batchend",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.BEFORE_RENDERER_CHANGE="beforerendererchange",n.AFTER_RENDERER_CHANGE="afterrendererchange"})(dt||(dt={}));var da;(function(n){n.UNDO="undo",n.REDO="redo",n.CANCEL="cancel",n.ADD="add",n.CLEAR="clear",n.CHANGE="change"})(da||(da={}));var bo;(function(n){n.CLICK="node:click",n.DBLCLICK="node:dblclick",n.POINTER_OVER="node:pointerover",n.POINTER_LEAVE="node:pointerleave",n.POINTER_ENTER="node:pointerenter",n.POINTER_MOVE="node:pointermove",n.POINTER_OUT="node:pointerout",n.POINTER_DOWN="node:pointerdown",n.POINTER_UP="node:pointerup",n.CONTEXT_MENU="node:contextmenu",n.DRAG_START="node:dragstart",n.DRAG="node:drag",n.DRAG_END="node:dragend",n.DRAG_ENTER="node:dragenter",n.DRAG_OVER="node:dragover",n.DRAG_LEAVE="node:dragleave",n.DROP="node:drop"})(bo||(bo={}));const Oe="combo",Ca="tree";var Uo;(function(n){n.NODE="node",n.EDGE="edge",n.COMBO="combo",n.THEME="theme",n.PALETTE="palette",n.LAYOUT="layout",n.BEHAVIOR="behavior",n.PLUGIN="plugin",n.ANIMATION="animation",n.TRANSFORM="transform"})(Uo||(Uo={}));function yI(n){const{theme:e}=n;if(!e)return{};const t=$a(Uo.THEME,e);return t||(Qi.warn(`The theme of ${e} is not registered.`),{})}function Z2(n,e){if(Array.isArray(n)&&n.length===0)return null;const t=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n.slice(1):e||[];return new Proxy(t,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...s)=>{i[a](...s),r.forEach(o=>{var c;return(c=o[a])==null?void 0:c.call(o,...s)})}:a==="finished"?Promise.all([t.finished,...r.map(s=>s.finished)]):Reflect.get(i,a)},set(i,a,s){return["onframe","onfinish"].includes(a)||r.forEach(o=>{o[a]=s}),Reflect.set(i,a,s)}})}function Kx(n){const e=n.reduce((r,i)=>(Object.entries(i).forEach(([a,s])=>{r[a]===void 0?r[a]=[s]:r[a].push(s)}),r),{});Object.entries(e).forEach(([r,i])=>{(i.length!==n.length||i.some(a=>gt(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(r)&&ve(a,i[0])))&&delete e[r]});const t=Object.entries(e).reduce((r,[i,a])=>(a.forEach((s,o)=>{r[o]?r[o][i]=s:r[o]={[i]:s}}),r),[]);return n.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function jd(n){switch(n){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function bI(n,e){const{animation:t}=n;if(t===!1||e===!1)return!1;const r={...lU};return ne(t)&&Object.assign(r,t),ne(e)&&Object.assign(r,e),r}function hU(n){if(typeof n=="string"){const e=$a(Uo.ANIMATION,n);return e||(Qi.warn(`The animation of ${n} is not registered.`),[])}return n}function fU(n,e,t,r){var u,h;const{animation:i}=n,a=(u=n==null?void 0:n[e])==null?void 0:u.animation;if(a===!1)return[];const s=a==null?void 0:a[t];if(s===!1)return[];if(i===!1||r===!1)return[];const o=(h=yI(n)[e])==null?void 0:h.animation,c=(f=[])=>hU(f).map(d=>({...uU,...ne(i)&&i,...d,...ne(r)&&r}));if(s)return c(s);if(!o)return[];const l=o[t];return l===!1?[]:c(l)}function Z(n){if(n.id!==void 0)return n.id;if(n.source!==void 0&&n.target!==void 0)return`${n.source}-${n.target}`;throw new Error(ya("The datum does not have available id."))}function Tv(n){return n.combo}function EI(n,e){const t={nodes:(n.nodes||[]).map(Z),edges:(n.edges||[]).map(Z),combos:(n.combos||[]).map(Z)};return e?Object.values(t).flat():t}function Xx(n,e,t,r){const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${n}, ${e})${i}`:`translate3d(${n}, ${e}, ${t})${i}`}const Dc=(n,e,t,r,i=!1)=>{const a=Z(r),s=`${t}s`,o=n.add[s].get(a)||n.update[s].get(a)||n.remove[s].get(a)||r;Object.entries(n).forEach(([c,l])=>{e===c?l[s].set(a,i?Le(o,r):o):l[s].delete(a)})},dU=(n,e,t)=>{if(!t.length)return null;const[r,i]=e,a=l=>{var u;if(l){const h=n.getShape(l);if(!h)return null;const f=`get${Nu(l)}Style`,d=((u=n==null?void 0:n[f])==null?void 0:u.bind(n))||(v=>v),p=(d==null?void 0:d(r))||{},g=(d==null?void 0:d(i))||{};return{shape:h,fromStyle:p,toStyle:g}}else return{shape:n,fromStyle:r,toStyle:i}};let s;const o=t.map(({fields:l,shape:u,states:h,...f})=>{const d=a(u);if(!d)return null;const{shape:p,fromStyle:g,toStyle:v}=d,m=[{},{}];if(l.forEach(b=>{Object.assign(m[0],{[b]:g[b]??jd(b)}),Object.assign(m[1],{[b]:v[b]??jd(b)})}),m.some(b=>Object.keys(b).some(w=>["x","y","z"].includes(w)))){const{x:b=0,y:w=0,z:x=0,transform:S=""}=p.attributes||{};m.forEach(_=>{_.transform=Xx(_.x||b,_.y||w,_.z||x,S)})}const y=p.animate(Kx(m),f);return u===void 0&&(s=y),y}).filter(Boolean),c=s||(o==null?void 0:o[0]);return c?Z2(c,o.filter(l=>l!==l)):null},pU=[{fields:["opacity"]}],gU=[{fields:["x","y"]}],xI=[{fields:["x","y"]}],vU=xI,wI=[{fields:["sourceNode","targetNode"]}],mU=wI,SI=[{fields:["childrenNode","x","y"]}],yU=SI;function No(n,e,t){const r=new Map(n.map(h=>[t(h),h])),i=new Map(e.map(h=>[t(h),h])),a=new Set(r.keys()),s=new Set(i.keys()),o=[],c=[],l=[],u=[];return s.forEach(h=>{a.has(h)?ve(r.get(h),i.get(h))?u.push(i.get(h)):c.push(i.get(h)):o.push(i.get(h))}),a.forEach(h=>{s.has(h)||l.push(r.get(h))}),{enter:o,exit:l,keep:u,update:c}}function bU(n,e,t){const r={},i=a=>(a in r||(r[a]=0),`${e}-${a}-${r[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(n):a.key?a:{...a,key:i(a.type)})}class Q2{constructor(e){A(this,"context");A(this,"extensions",[]);A(this,"extensionMap",{});this.context=e}setExtensions(e){const t=bU(this.context.graph,this.category,e),{enter:r,update:i,exit:a,keep:s}=No(this.extensions,t,o=>o.key);this.createExtensions(r),this.updateExtensions([...i,...s]),this.destroyExtensions(a),this.extensions=t}createExtension(e){const{category:t}=this,{key:r,type:i}=e,a=$a(t,i);if(!a)return Qi.warn(`The extension ${i} of ${t} is not registered.`);const s=new a(this.context,e);this.extensionMap[r]=s}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,r=this.extensionMap[t];r&&r.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class J2{constructor(e,t){A(this,"context");A(this,"options");A(this,"events",[]);A(this,"destroyed",!1);this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class Ar extends J2{}function EU(n){return"source"in n&&"target"in n}function xU(n){return n.length===2}function Fu(n){return n instanceof Float32Array?!0:Array.isArray(n)&&(n.length===2||n.length===3)?n.every(e=>typeof e=="number"):!1}function vi(n,e,t){return n>=e&&n<=t}function ph(n=0){if(Array.isArray(n)){const[e=0,t=e,r=e,i=t]=n;return[e,t,r,i]}return[n,n,n,n]}function Ei(n){return n.max[0]-n.min[0]}function xi(n){return n.max[1]-n.min[1]}function Ls(n){return[Ei(n),xi(n)]}function Ma(n,e){const t=Fu(n)?wU(n):n.getShape("key").getBounds();return e?_I(t,e):t}function wU(n){const[e,t,r=0]=n,i=new ue;return i.setMinMax([e,t,r],[e,t,r]),i}function _I(n,e){const[t,r,i,a]=ph(e),[s,o,c]=n.min,[l,u,h]=n.max,f=new ue;return f.setMinMax([s-a,o-t,c],[l+r,u+i,h]),f}function gh(n){if(n.length===0)return new ue;if(n.length===1)return n[0];const e=new ue;e.setMinMax(n[0].min,n[0].max);for(let t=1;t<n.length;t++){const r=n[t];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function Ms(n,e){return vi(n[0],e.min[0],e.max[0])&&vi(n[1],e.min[1],e.max[1])}function SU(n,e,t=!1){const{min:[r,i],max:[a,s]}=e,o=(n[1]===i||n[1]===s)&&(t||vi(n[0],r,a)),c=(n[0]===r||n[0]===a)&&(t||vi(n[1],i,s));return o||c}function _U(n,e){return!Ms(n,e)}function id(n,e){const[t,r]=e,[i,a]=n.min,[s,o]=n.max,c=t-i,l=s-t,u=r-a,h=o-r,f=Math.min(c,l,u,h);return f===c?"left":f===l?"right":f===u?"top":f===h?"bottom":"left"}function Av(n,e){const t=_s(e);if(Ms(e,n))switch(id(n,e)){case"left":t[0]=n.min[0];break;case"right":t[0]=n.max[0];break;case"top":t[1]=n.min[1];break;case"bottom":t[1]=n.max[1];break}else{const[r,i]=e,[a,s]=n.min,[o,c]=n.max;t[0]=vi(r,a,o)?r:r<a?a:o,t[1]=vi(i,s,c)?i:i<s?s:c}return t}function OU(n,e){const{center:t}=n,[r,i]=Ls(n),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-r/6:t[0]+r/6,s=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,s]}function PU(n,e){let[t,r]=Ls(n);return[t,r]=e==="up"||e==="down"?[t,r]:[r,t],(r**2-(Math.sqrt((t/2)**2+r**2)-t/2)**2)/(2*r)}const EO=[0,0,0];function qt(n,e){return n.map((t,r)=>t+e[r])}function We(n,e){return n.map((t,r)=>t-e[r])}function tS(n,e){return typeof e=="number"?n.map(t=>t*e):n.map((t,r)=>t*e[r])}function $u(n,e){return typeof e=="number"?n.map(t=>t/e):n.map((t,r)=>t/e[r])}function CU(n,e){const t=zu(n),r=zu(e);return[t[1]*r[2]-t[2]*r[1],t[2]*r[0]-t[0]*r[2],t[0]*r[1]-t[1]*r[0]]}function ba(n,e){return n.map(t=>t*e)}function Ui(n,e){return Math.sqrt(n.reduce((t,r,i)=>t+(r-e[i]||0)**2,0))}function xO(n,e){return n.reduce((t,r,i)=>t+Math.abs(r-e[i]),0)}function Gi(n){const e=n.reduce((t,r)=>t+r**2,0);return n.map(t=>t/Math.sqrt(e))}function eS(n,e,t=!1){const r=n[0]*e[1]-n[1]*e[0];let i=Math.acos(tS(n,e).reduce((a,s)=>a+s,0)/(Ui(n,EO)*Ui(e,EO)));return t&&r<0&&(i=2*Math.PI-i),i}function wg(n,e=!0){return e?[-n[1],n[0]]:[n[1],-n[0]]}function MU(n,e){return n.map(t=>t%e)}function Zx(n){return[n[0],n[1]]}function zu(n){return xU(n)?[n[0],n[1],0]:n}function OI(n,e){const[t,r]=n,[i,a]=e,s=We(t,r),o=We(i,a);return CU(s,o).every(c=>c===0)}function PI(n,e,t=!1){if(OI(n,e))return;const[r,i]=n,[a,s]=e,o=((r[0]-a[0])*(a[1]-s[1])-(r[1]-a[1])*(a[0]-s[0]))/((r[0]-i[0])*(a[1]-s[1])-(r[1]-i[1])*(a[0]-s[0])),c=s[0]-a[0]?(r[0]-a[0]+o*(i[0]-r[0]))/(s[0]-a[0]):(r[1]-a[1]+o*(i[1]-r[1]))/(s[1]-a[1]);if(!(!t&&(!vi(o,0,1)||!vi(c,0,1))))return[r[0]+o*(i[0]-r[0]),r[1]+o*(i[1]-r[1])]}function TU(n){if(Array.isArray(n))return vi(n[0],0,1)&&vi(n[1],0,1)?n:[.5,.5];const e=n.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,r=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,r]}function hi(n){const{x:e=0,y:t=0,z:r=0}=n.style||{};return[+e,+t,+r]}function AU(n,e){const[t,r]=e,{min:i,max:a}=n;return[i[0]+t*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function Fi(n,e="center"){const t=TU(e);return AU(n,t)}function Vr(n){return[n.x,n.y,n.z??0]}function Lc(n){return{x:n[0],y:n[1],z:n[2]??0}}function Ic(n,e=0){return n.map(t=>parseFloat(t.toFixed(e)))}function Ta(n,e,t,r=!1){const i=r?We(n,e):We(e,n),a=Gi(i),s=[a[0]*t,a[1]*t];return qt(Zx(n),s)}function CI(n,e){return n[1]===e[1]}function NU(n,e){return n[0]===e[0]}function RU(n,e){return CI(n,e)||NU(n,e)}function kU(n,e,t){return OI([n,e],[e,t])}function MI(n,e,t,r=!0){for(let i=0;i<t.length;i++){let a=t[i],s=t[(i+1)%t.length];r&&(a=qt(e,a),s=qt(e,s));const o=PI([e,n],[a,s]);if(o)return{point:o,line:[a,s]}}return{point:e,line:void 0}}function DU(n,e,t,r){const i=n[0],a=n[1];let s=!1;t===void 0&&(t=0),r===void 0&&(r=e.length);const o=r-t;for(let c=0,l=o-1;c<o;l=c++){const u=e[c+t][0],h=e[c+t][1],f=e[l+t][0],d=e[l+t][1];h>a!=d>a&&i<(f-u)*(a-h)/(d-h)+u&&(s=!s)}return s}function LU(n,e){const t=Fi(e,"center"),r=[Fi(e,"left-top"),Fi(e,"right-top"),Fi(e,"right-bottom"),Fi(e,"left-bottom")];return MI(n,t,r,!1).point}function Sg(n,e){const t=e.center,r=We(n,e.center),i=Math.atan2(r[1],r[0]);if(isNaN(i))return t;const a=Ei(e)/2,s=xi(e)/2,o=t[0]+a*Math.cos(i),c=t[1]+s*Math.sin(i);return[o,c]}function IU(n,e){let t=1/0,r=[n[0],e[0]];return n.forEach(i=>{e.forEach(a=>{const s=Ui(i,a);s<t&&(t=s,r=[i,a])})}),r}function BU(n,e){let t=1/0,r=[[0,0],[0,0]];return e.forEach(i=>{const a=FU(n,i);a<t&&(t=a,r=i)}),r}function FU(n,e){const t=TI(n,e);return Ui(n,t)}function TI(n,e){const[t,r]=e[0],[i,a]=e[1],[s,o]=n,c=i-t,l=a-r;if(c===0&&l===0)return[t,r];let u=((s-t)*c+(o-r)*l)/(c*c+l*l);u>1?u=1:u<0&&(u=0);const h=t+u*c,f=r+u*l;return[h,f]}function $U(n){const e=n.reduce((t,r)=>qt(t,r),[0,0]);return $u(e,n.length)}function AI(n,e=!0){const t=$U(n);return n.sort(([r,i],[a,s])=>{const o=Math.atan2(i-t[1],r-t[0]),c=Math.atan2(s-t[1],a-t[0]);return e?c-o:o-c})}function wO(n,e){return[n,[n[0],e[1]],e,[e[0],n[1]]]}const SO=n=>n.map(e=>At(e)?e.toLocaleLowerCase():e);let lc=class{constructor(e){A(this,"map",new Map);A(this,"emitter");A(this,"recordKey",new Set);A(this,"onKeyDown",e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))});A(this,"onKeyUp",e=>{e!=null&&e.key&&this.recordKey.delete(e.key)});A(this,"onWheel",e=>{this.triggerExtendKey(nt.WHEEL,e)});A(this,"onDrag",e=>{this.triggerExtendKey(nt.DRAG,e)});A(this,"onFocus",()=>{this.recordKey.clear()});this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&this.map.set(e,t)}unbind(e,t){this.map.forEach((r,i)=>{ve(i,e)&&(!t||t===r)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=SO(Array.from(this.recordKey)).sort(),r=SO(e).sort();return ve(t,r)}bindEvents(){const{emitter:e}=this;e.on(nt.KEY_DOWN,this.onKeyDown),e.on(nt.KEY_UP,this.onKeyUp),e.on(nt.WHEEL,this.onWheel),e.on(nt.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(e){this.map.forEach((t,r)=>{this.match(r)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((r,i)=>{i.includes(e)&&ve(Array.from(this.recordKey),i.filter(a=>a!==e))&&r(t)})}destroy(){this.unbindAll(),this.emitter.off(nt.KEY_DOWN,this.onKeyDown),this.emitter.off(nt.KEY_UP,this.onKeyUp),this.emitter.off(nt.WHEEL,this.onWheel),this.emitter.off(nt.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}};const vp=class vp extends Ar{constructor(t,r){super(t,Le({},vp.defaultOptions,r));A(this,"startPoint");A(this,"endPoint");A(this,"rectShape");A(this,"shortcut");this.shortcut=new lc(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:r}=this.context;this.rectShape=new kn({id:"g6-brush-select",style:this.options.style}),r.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var a;if(!this.startPoint)return;const{immediately:r,mode:i}=this.options;this.endPoint=Gd(t),(a=this.rectShape)==null||a.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&i==="default"&&this.updateElementsStates(wO(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Gd(t),this.updateElementsStates(wO(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,r=Object.values(t.getData()).reduce((i,a)=>Object.assign({},i,a.reduce((s,o)=>(s[Z(o)]=[],s),{})),{});t.setElementState(r,this.options.animation)}updateElementsStates(t){const{graph:r}=this.context,{enableElements:i,state:a,mode:s,onSelect:o}=this.options,c=this.selector(r,t,i);let l={};switch(s){case"union":c.forEach(u=>{l[u]=[...r.getElementState(u),a]});break;case"diff":c.forEach(u=>{const h=r.getElementState(u);l[u]=h.includes(a)?h.filter(f=>f!==a):[...h,a]});break;case"intersect":c.forEach(u=>{const h=r.getElementState(u);l[u]=h.includes(a)?[a]:[]});break;case"default":default:c.forEach(u=>{l[u]=[a]});break}ft(o)&&(l=o(l)),r.setElementState(l,this.options.animation)}selector(t,r,i){if(!i||i.length===0)return[];const a=[],s=t.getData();if(i.forEach(o=>{s[`${o}s`].forEach(c=>{const l=Z(c);t.getElementVisibility(l)!=="hidden"&&DU(t.getElementPosition(l),r)&&a.push(l)})}),i.includes("edge")){const o=s.edges;o==null||o.forEach(c=>{const{source:l,target:u}=c;a.includes(l)&&a.includes(u)&&a.push(Z(c))})}return a}clearBrush(){var t;(t=this.rectShape)==null||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,r=Array.isArray(t)?t:[t];return!t||r.includes("drag")?!0:this.shortcut.match(r)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),t.on(nt.POINTER_DOWN,this.onPointerDown),t.on(nt.POINTER_MOVE,this.onPointerMove),t.on(nt.POINTER_UP,this.onPointerUp),t.on(Tn.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(nt.POINTER_DOWN,this.onPointerDown),t.off(nt.POINTER_MOVE,this.onPointerMove),t.off(nt.POINTER_UP,this.onPointerUp),t.off(Tn.CLICK,this.clearStates)}update(t){this.options=Le(this.options,t)}destroy(){this.unbindEvents(),super.destroy()}};A(vp,"defaultOptions",{animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}});let qd=vp;const Gd=n=>[n.canvas.x,n.canvas.y],Yi=.8,Ts=["node","edge","combo"];function Ro(n,e,t,r,i=0){r==="TB"&&e(n,i);const a=t(n);if(a)for(const s of a)Ro(s,e,t,r,i+1);r==="BT"&&e(n,i)}function zU(n,e,t){const r=[[n,0]];for(;r.length;){const[i,a]=r.shift();e(i,a);const s=t(i);if(s)for(const o of s)r.push([o,a+1])}}function NI(n,e,t,r){if(e==="combo"||e==="node")return Nv(n,t,r);const i=n.getEdgeData(t);if(!i)return[];const a=Nv(n,i.source,r-1),s=Nv(n,i.target,r-1);return Array.from(new Set([...a,...s,t]))}function Nv(n,e,t){const r=new Set,i=new Set,a=new Set;return zU(e,(s,o)=>{o>t||(a.add(s),n.getRelatedEdgesData(s).forEach(c=>{const l=Z(c);!i.has(l)&&o<t&&(a.add(l),i.add(l))}))},s=>n.getRelatedEdgesData(s).map(o=>o.source===s?o.target:o.source).filter(o=>r.has(o)?!1:(r.add(o),!0))),Array.from(a)}function yf(n){return n.states||[]}const mp=class mp extends Ar{constructor(t,r){super(t,Object.assign({},mp.defaultOptions,r));A(this,"shortcut");A(this,"onClickSelect",async t=>{var r,i;this.validate(t)&&(await this.updateState(t),(i=(r=this.options).onClick)==null||i.call(r,t))});A(this,"onClickCanvas",async t=>{var r,i;this.validate(t)&&(await this.clearState(),(i=(r=this.options).onClick)==null||i.call(r,t))});this.shortcut=new lc(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ts.forEach(r=>{t.on(`${r}:${nt.CLICK}`,this.onClickSelect)}),t.on(Tn.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:r}=this.options;return t&&this.shortcut.match(r)}getNeighborIds(t){const{target:r,targetType:i}=t,{graph:a}=this.context,{degree:s}=this.options;return NI(a,i,r.id,typeof s=="function"?s(t):s).filter(o=>o!==r.id)}async updateState(t){const{state:r,unselectedState:i,neighborState:a,animation:s}=this.options;if(!r&&!a&&!i)return;const{target:o}=t,{graph:c}=this.context,l=c.getElementData(o.id),u=yf(l).includes(r)?"unselect":"select",h={},f=this.isMultipleSelect,d=[o.id],p=this.getNeighborIds(t);if(f)if(Object.assign(h,this.getDataStates()),u==="select"){const g=(v,m)=>{v.forEach(y=>{const b=c.getElementData(y),w=new Set(yf(b));w.add(m),w.delete(i),h[y]=Array.from(w)})};g(d,r),g(p,a),i&&Object.keys(h).forEach(v=>{const m=h[v];!m.includes(r)&&!m.includes(a)&&!m.includes(i)&&h[v].push(i)})}else{const g=h[o.id];h[o.id]=g.filter(v=>v!==r&&v!==a),g.includes(i)||h[o.id].push(i),p.forEach(v=>{h[v]=h[v].filter(m=>m!==a),h[v].includes(r)||h[v].push(i)})}else if(u==="select"){Object.assign(h,this.getClearStates(!!i));const g=(v,m)=>{v.forEach(y=>{h[y]||(h[y]=[]),h[y].push(m)})};g(d,r),g(p,a),i&&Object.keys(h).forEach(v=>{!d.includes(v)&&!p.includes(v)&&h[v].push(i)})}else Object.assign(h,this.getClearStates());await c.setElementState(h,s)}getDataStates(){const{graph:t}=this.context,{nodes:r,edges:i,combos:a}=t.getData(),s={};return[...r,...i,...a].forEach(o=>{s[Z(o)]=yf(o)}),s}getClearStates(t=!1){const{graph:r}=this.context,{state:i,unselectedState:a,neighborState:s}=this.options,o=new Set([i,a,s]),{nodes:c,edges:l,combos:u}=r.getData(),h={};return[...c,...l,...u].forEach(f=>{const d=yf(f),p=d.filter(g=>!o.has(g));(t||p.length!==d.length)&&(h[Z(f)]=p)}),h}async clearState(){const{graph:t}=this.context;await t.setElementState(this.getClearStates(),this.options.animation)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Ts.forEach(r=>{t.off(`${r}:${nt.CLICK}`,this.onClickSelect)}),t.off(Tn.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}};A(mp,"defaultOptions",{animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0});let Qx=mp;function nr(n){var e;return!!((e=n.style)!=null&&e.collapsed)}function Vd(n,e){if(!n.startsWith(e))return!1;const t=n[e.length];return t>="A"&&t<="Z"}function jU(n,e){return`${e}${Nu(n)}`}function qU(n,e,t=!0){if(!e||!Vd(n,e))return n;const r=n.slice(e.length);return t?ID(r):r}function ze(n,e){const t=Object.entries(n).reduce((r,[i,a])=>(i==="className"||i==="class"||Vd(i,e)&&Object.assign(r,{[qU(i,e)]:a}),r),{});if("opacity"in n){const r=jU("opacity",e),i=n.opacity;if(r in n){const a=n[r];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function Jx(n,e){const t=e.length;return Object.keys(n).reduce((r,i)=>{if(i.startsWith(e)){const a=i.slice(t);r[a]=n[i]}return r},{})}function nS(n,e){const t=typeof e=="string"?[e]:e,r={};return Object.keys(n).forEach(i=>{t.find(a=>i.startsWith(a))||(r[i]=n[i])}),r}function Vi(n=0){if(typeof n=="number")return[n,n,n];const[e,t=e,r=e]=n;return[e,t,r]}function _O(n,e){const{datum:t,graph:r}=e;return typeof n=="function"?n.call(r,t):Object.fromEntries(Object.entries(n).map(([i,a])=>typeof a=="function"?[i,a.call(r,t)]:[i,a]))}function fn(n,e){const t=(n==null?void 0:n.style)||{},r=(e==null?void 0:e.style)||{};return Object.assign({},n,e,{style:Object.assign({},t,r)})}function GU(n){const{x:e,y:t,z:r,class:i,className:a,transform:s,transformOrigin:o,context:c,zIndex:l,...u}=n;return u}const ko="cachedStyle",_g=n=>`__${n}__`;function rS(n,e){const t=Array.isArray(e)?e:[e];ln(n,ko)||qo(n,ko,{}),t.forEach(r=>{qo(ln(n,ko),_g(r),n.attributes[r])})}function Yo(n,e){return ln(n,[ko,_g(e)])}function iS(n,e){return _g(e)in(ln(n,ko)||{})}function tw(n,e,t){qo(n,[ko,_g(e)],t)}function lr(n){return function(e,t,r){const i=r.value;return r.value=function(a,...s){const o=`${t}_invoke`;if(!Yo(this,o))return tw(this,o,!0),i.call(this,a,...s);const c=`${t}_style`,l=Yo(this,c),u=n(this,a);return tw(this,c,u),RI(l,u)?null:i.call(this,a,...s)},r}}const RI=(n,e,t=2)=>{if(typeof n!="object"||typeof e!="object")return n===e;const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r){const s=n[a],o=e[a];if(t>1&&typeof s=="object"&&typeof o=="object"){if(!RI(s,o,t-1))return!1}else if(s!==o)return!1}return!0};function VU(n,e){const t=Vi(n);let r={};return e.text&&!e.fontSize&&(r={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(r={width:t[0]*.5,height:t[1]*.5}),r}function OO(n){if(n)return typeof n=="string"||typeof n=="function"||Array.isArray(n)?{type:"group",field:e=>e.id,color:n,invert:!1}:n}function WU(n,e){if(!e)return{};const{type:t,color:r,field:i,invert:a}=e,s=c=>{const l=typeof r=="string"?$a("palette",r):r;if(typeof l=="function"){const u={};return c.forEach(([h,f])=>{u[h]=l(a?1-f:f)}),u}else if(Array.isArray(l)){const u=a?[...l].reverse():l,h={};return c.forEach(([f,d])=>{h[f]=u[d%l.length]}),h}return{}},o=(c,l)=>{var u;return typeof c=="string"?(u=l.data)==null?void 0:u[c]:c==null?void 0:c(l)};if(t==="group"){const c=sh(n,f=>{if(!i)return"default";const d=o(i,f);return d?String(d):"default"}),l=Object.keys(c),u=s(l.map((f,d)=>[f,d])),h={};return Object.entries(c).forEach(([f,d])=>{d.forEach(p=>{h[Z(p)]=u[f]})}),h}else if(t==="value"){const[c,l]=n.reduce(([h,f],d)=>{const p=o(i,d);if(typeof p!="number")throw new Error(ya(`Palette field ${i} is not a number`));return[Math.min(h,p),Math.max(f,p)]},[1/0,-1/0]),u=l-c;return s(n.map(h=>[h.id,(o(i,h)-c)/u]))}}function kI(n){const e=typeof n=="string"?$a("palette",n):n;if(typeof e!="function")return e}function DI(n,e){let t=2*n;return typeof e=="string"?t=n*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*n),t}function LI(n,e,t=1,r=!1){const i=r?t:1,a=(n.max[0]-n.min[0])*i;return DI(a,e)}function HU(n,e,t=1){const r=Ui(n[0],n[1])*t;return DI(r,e)}function II(n){const e=[],t=r=>{r!=null&&r.children.length&&r.children.forEach(i=>{e.push(i),t(i)})};return t(n),e}const Rv="visibility";function BI(n,e,t){let r=[n,...II(n)];t&&(r=t==null?void 0:t(r)),r.forEach(i=>{iS(i,Rv)||rS(i,Rv);const a=Yo(i,Rv);n!==i&&a==="hidden"||(i.style.visibility=e)})}class vh extends V2{constructor(t){super(t);A(this,"shapeMap",{});A(this,"animateMap",{});this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,r,i,a){const s=this.shapeMap[t];if(i===!1){s&&(a.removeChild(s),delete this.shapeMap[t]);return}if(!s||s.destroyed){const o=new r({className:t,style:i});return a.appendChild(o),this.shapeMap[t]=o,o}return uu(s,i),s}transformPosition(t){const{x:r=0,y:i=0,z:a=0,transform:s}=t;(r!==0||i!==0||a!==0)&&(this.style.transform=Xx(+r,+i,+a,s))}update(t={}){const r=Object.assign({},this.attributes,t);this.attr(r),this.render(r,this),this.transformPosition(r),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return GU(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,r){if(t.length===0)return null;const i=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:s=0,y:o=0,z:c=0}=this.attributes;t.forEach(l=>{const{x:u=s,y:h=o,z:f=c}=l;Object.assign(l,{transform:Xx(+u,+h,+f)})})}const a=super.animate(t,r);if(a&&(kv(this,a),i.push(a)),Array.isArray(t)&&t.length>0){const s=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(o=>!s.includes(o))){Object.entries(this.shapeMap).forEach(([c,l])=>{const u=`get${Nu(c)}Style`,h=this[u];if(ft(h)){const f=t.map(p=>h.call(this,{...this.attributes,...p})),d=l.animate(Kx(f),r);d&&(kv(l,d),i.push(d))}});const o=(c,l)=>{if(!cg(c)){const u=`get${Nu(l)}Style`,h=this[u];if(ft(h)){const f=t.map(d=>h.call(this,{...this.attributes,...d}));Object.entries(f[0]).map(([d])=>{const p=f.map(v=>v[d]),g=c[d];if(g){const v=g.animate(Kx(p),r);v&&(kv(g,v),i.push(v))}})}}};this.compositeShapes.forEach(([c,l])=>{const u=Jx(this.shapeMap,l);o(u,c)})}}return Z2(i)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;BI(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function kv(n,e){e.oncancel=()=>console.log("cancel"),e==null||e.finished.then(()=>{const t=n.activeAnimations.findIndex(r=>r===e);t>-1&&n.activeAnimations.splice(t,1)})}const yp=class yp extends vh{constructor(e){super(fn({style:yp.defaultStyleProps},e))}isTextStyle(e){return Vd(e,"label")}isBackgroundStyle(e){return Vd(e,"background")}getTextStyle(e){const{padding:t,...r}=this.getGraphicStyle(e);return nS(r,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:r,wordWrapWidth:i,padding:a}=t,s=ze(t,"background"),{min:[o,c],center:[l,u],halfExtents:[h,f]}=this.shapeMap.text.getGeometryBounds(),[d,p,g,v]=ph(a),m=h*2+v+p,{width:y,height:b}=s;y&&b?Object.assign(s,{x:l-Number(y)/2,y:u-Number(b)/2}):Object.assign(s,{x:o-v,y:c-d,width:r?Math.min(m,i+v+p):m,height:f*2+d+g});const{radius:w}=s;if(typeof w=="string"&&w.endsWith("%")){const x=Number(w.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*x}return s}render(e=this.parsedAttributes,t=this){this.upsert("text",cc,this.getTextStyle(e),t),this.upsert("background",kn,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}};A(yp,"defaultStyleProps",{padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0});let Ko=yp;const bp=class bp extends vh{constructor(e){super(fn({style:bp.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",Ko,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}};A(bp,"defaultStyleProps",{padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1});let Wd=bp;function UU(n,e=!0){const t=[];return n.forEach((r,i)=>{t.push([i===0?"M":"L",...r])}),e&&t.push(["Z"]),t}const PO={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function YU(n){const e=n.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let r="",i={};for(;e.length>0;){let a=e.shift();a in PO?r=a:e.unshift(a),i={type:r},PO[r].forEach(c=>{a=e.shift(),i[c]=a}),r==="M"?r="L":r==="m"&&(r="l");const[s,...o]=Object.values(i);t.push([s,...o.map(Number)])}return t}function KU(n){const e=[];return(typeof n=="string"?YU(n):n).forEach(r=>{const i=r[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<r.length;a=a+2)e.push([r[a],r[a+1],0]);else{const a=r.length;e.push([r[a-2],r[a-1],0])}}),e}const FI=n=>{if(n.length<2)return[["M",0,0],["L",0,0]];const e=n[0],t=n[1],r=n[n.length-1],i=n[n.length-2];n.unshift(i,r),n.push(e,t);const a=[["M",r[0],r[1]]];for(let s=1;s<n.length-2;s+=1){const[o,c]=n[s-1],[l,u]=n[s],[h,f]=n[s+1],[d,p]=s!==n.length-2?n[s+2]:[h,f],g=l+(h-o)/6,v=u+(f-c)/6,m=h-(d-l)/6,y=f-(p-u)/6;a.push(["C",g,v,m,y,h,f])}return a};function XU(n,e,t,r,i,a,s){const[o,c]=Fi(n,e),l={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:`translate(${o+t}, ${c+r})`};if(e==="center"||!i)return l;const u=KU(a);if(!u||u.length<=3)return l;const h=u.map((p,g)=>{const v=p,m=u[(g+1)%u.length];return ve(v,m)?null:[v,m]}).filter(Boolean),f=BU([o,c],h),d=TI([o,c],f);if(d&&f&&(l.transform=`translate(${d[0]+t}, ${d[1]+r})`,s)){const p=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));l.transform+=`rotate(${p/Math.PI*180}deg)`,l.textAlign="center",(e==="right"||e==="left")&&(p>0?l.textBaseline=e==="right"?"bottom":"top":l.textBaseline=e==="right"?"top":"bottom")}return l}const Ep=class Ep extends vh{constructor(e){super(fn({style:Ep.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const{maxWidth:t,offsetX:r,offsetY:i,autoRotate:a,placement:s,closeToPath:o,...c}=ze(this.getGraphicStyle(e),"label"),l=this.shapeMap.key,u=l==null?void 0:l.getRenderBounds();return Object.assign(XU(u,s,r,i,o,e.d,a),{wordWrapWidth:LI(u,t)},c)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",Yr,this.getKeyStyle(e),t),this.upsert("label",Ko,this.getLabelStyle(e),t)}};A(Ep,"defaultStyleProps",{label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0});let Hd=Ep;class $I extends vh{constructor(e){super(e)}isGImage(){return!!this.getAttribute("src")}getIconStyle(e=this.attributes){const{width:t=0,height:r=0}=e,i=this.getGraphicStyle(e);return this.isGImage()?{x:-t/2,y:-r/2,...i}:{textBaseline:"middle",textAlign:"center",...i}}render(e=this.attributes,t=this){this.upsert("icon",this.isGImage()?Ds:cc,this.getIconStyle(e),t)}}class zI extends vh{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const r=super.animate(e,t);return r&&(r.onframe=()=>this.onframe(),r.finished.then(()=>this.onframe())),r}}var uc=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const xp=class xp extends zI{constructor(t){super(fn({style:xp.defaultStyleProps},t));A(this,"type","node")}getSize(t=this.attributes){const{size:r}=t;return Vi(r)}getKeyStyle(t){const r=this.getGraphicStyle(t);return Object.assign(nS(r,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const{placement:r,maxWidth:i,offsetX:a,offsetY:s,...o}=ze(this.getGraphicStyle(t),"label"),c=this.getShape("key").getLocalBounds();return Object.assign(RO(c,r,a,s),{wordWrapWidth:LI(c,i)},o)}getHaloStyle(t){if(t.halo===!1)return!1;const{fill:r,...i}=this.getKeyStyle(t),a=ze(this.getGraphicStyle(t),"halo");return{...i,stroke:r,...a}}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const r=ze(this.getGraphicStyle(t),"icon");return Object.assign(VU(t.size,r),r)}getBadgesStyle(t){var h;const r=Jx(this.shapeMap,"badge-"),i={};if(Object.keys(r).forEach(f=>{i[f]=!1}),t.badge===!1||!((h=t.badges)!=null&&h.length))return i;const{badges:a=[],badgePalette:s,opacity:o=1,...c}=t,l=kI(s),u=ze(this.getGraphicStyle(c),"badge");return a.forEach((f,d)=>{i[d]={backgroundFill:l?l[d%(l==null?void 0:l.length)]:void 0,opacity:o,...u,...this.getBadgeStyle(f)}}),i}getBadgeStyle(t){const r=this.getShape("key"),{placement:i="top",offsetX:a,offsetY:s,...o}=t;return{...RO(r.getLocalBounds(),i,a,s,!0),...o}}getPortsStyle(t){var o;const r=this.getPorts(),i={};if(Object.keys(r).forEach(c=>{i[c]=!1}),t.port===!1||!((o=t.ports)!=null&&o.length))return i;const a=ze(this.getGraphicStyle(t),"port"),{ports:s=[]}=t;return s.forEach((c,l)=>{const u=c.key||l,h={...a,...c};if(KI(h))i[u]=!1;else{const[f,d]=this.getPortXY(t,c);i[u]={transform:`translate(${f}, ${d})`,...h}}}),i}getPortXY(t,r){const{placement:i="left"}=r,a=this.getShape("key").getLocalBounds();return sS(a,i)}getPorts(){return Jx(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t){const r=this.getShape("key").getBounds();return LU(t,r)}drawHaloShape(t,r){const i=this.getShape("key");this.upsert("halo",i.constructor,this.getHaloStyle(t),r)}drawIconShape(t,r){this.upsert("icon",$I,this.getIconStyle(t),r)}drawBadgeShapes(t,r){const i=this.getBadgesStyle(t);Object.keys(i).forEach(a=>{this.upsert(`badge-${a}`,Wd,i[a],r)})}drawPortShapes(t,r){const i=this.getPortsStyle(t);Object.keys(i).forEach(a=>{this.upsert(`port-${a}`,Zi,i[a],r)})}drawLabelShape(t,r){this.upsert("label",Ko,this.getLabelStyle(t),r)}_drawKeyShape(t,r){return this.drawKeyShape(t,r)}render(t=this.parsedAttributes,r=this){this._drawKeyShape(t,r),this.getShape("key")&&(this.drawHaloShape(t,r),this.drawIconShape(t,r),this.drawBadgeShapes(t,r),this.drawLabelShape(t,r),this.drawPortShapes(t,r))}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}};A(xp,"defaultStyleProps",{x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0});let un=xp;uc([lr((n,e)=>n.getHaloStyle(e))],un.prototype,"drawHaloShape",null);uc([lr((n,e)=>n.getIconStyle(e))],un.prototype,"drawIconShape",null);uc([lr((n,e)=>n.getBadgesStyle(e))],un.prototype,"drawBadgeShapes",null);uc([lr((n,e)=>n.getPortsStyle(e))],un.prototype,"drawPortShapes",null);uc([lr((n,e)=>n.getLabelStyle(e))],un.prototype,"drawLabelShape",null);uc([lr((n,e)=>n.getKeyStyle(e))],un.prototype,"_drawKeyShape",null);var ds;let jI=(ds=class extends un{constructor(e){super(fn({style:ds.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Zi,this.getKeyStyle(e),t)}getKeyStyle(e){return{...super.getKeyStyle(e),r:Math.min(...this.getSize(e))/2}}getIconStyle(e){const t=super.getIconStyle(e),{r}=this.getShape("key").attributes,i=r*2*Yi;return t?{width:i,height:i,...t}:!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Sg(e,t)}},A(ds,"defaultStyleProps",{size:32}),ds);class Og extends un{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",dh,this.getKeyStyle(e),t)}getKeyStyle(e){return{...super.getKeyStyle(e),points:this.getPoints(e)}}getIntersectPoint(e){var i,a;const{points:t}=this.getShape("key").attributes,r=[+(((i=this.attributes)==null?void 0:i.x)||0),+(((a=this.attributes)==null?void 0:a.y)||0)];return MI(e,r,t).point}}class ZU extends Og{constructor(e){super(e)}getPoints(e){const[t,r]=this.getSize(e);return $Y(t,r)}}const wp=class wp extends jI{constructor(e){super(fn({style:wp.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...Vi(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return At(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:r}=e;if(!(r!=null&&r.length))return;const i=r.map(h=>rt(h)?{value:h}:h),a=ze(this.getGraphicStyle(e),"donut"),s=kI(e.donutPalette);if(!s)return;const o=i.reduce((h,f)=>h+(f.value??0),0),c=this.parseOuterR(),l=this.parseInnerR();let u=0;i.forEach((h,f)=>{const{value:d=0,color:p=s[f%s.length],...g}=h,v=(o===0?1/i.length:d/o)*360;this.upsert(`round${f}`,Yr,{...a,d:tY(c,l,u,u+v),fill:p,...g},t),u+=v})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}};A(wp,"defaultStyleProps",{innerR:"50%",donuts:[],donutPalette:"tableau"});let ew=wp;const bf=(n,e,t,r)=>[n+Math.sin(r)*t,e-Math.cos(r)*t],QU=(n,e,t,r)=>r<=0||t<=r?[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"]]:[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"],["M",n+r,e],["A",r,r,0,1,0,n-r,e],["A",r,r,0,1,0,n+r,e],["Z"]],JU=(n,e,t,r,i,a)=>{const[s,o]=[i/360*2*Math.PI,a/360*2*Math.PI],c=[bf(n,e,r,s),bf(n,e,t,s),bf(n,e,t,o),bf(n,e,r,o)],l=o-s>Math.PI?1:0;return[["M",c[0][0],c[0][1]],["L",c[1][0],c[1][1]],["A",t,t,0,l,1,c[2][0],c[2][1]],["L",c[3][0],c[3][1]],["A",r,r,0,l,0,c[0][0],c[0][1]],["Z"]]},tY=(n=0,e=0,t,r)=>{const[i,a]=[0,0];return Math.abs(t-r)%360<1e-6?QU(i,a,n,e):JU(i,a,n,e,t,r)},Sp=class Sp extends un{constructor(e){super(fn({style:Sp.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",mg,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getSize(e);return{...t,rx:r/2,ry:i/2}}getIconStyle(e){const t=super.getIconStyle(e),{rx:r,ry:i}=this.getShape("key").attributes,a=Math.min(+r,+i)*2*Yi;return t?{width:a,height:a,...t}:!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Sg(e,t)}};A(Sp,"defaultStyleProps",{size:[45,35]});let nw=Sp;class eY extends Og{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return zY(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getOuterR(e)*Yi;return t?{width:r,height:r,...t}:!1}}const _p=class _p extends un{constructor(t){super({...t,style:Object.assign({},_p.defaultStyleProps,t.style)});A(this,"rootPointerEvent",new Bu(null));A(this,"forwardEvents",t=>{const r=this.context.canvas,i=r.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(s=>{const o=this.bootstrapEvent(this.rootPointerEvent,s,i,t);r.context.eventService.mapEvent(o)})})}get eventService(){return this.context.canvas.context.eventService}get events(){return[nt.CLICK,nt.POINTER_DOWN,nt.POINTER_MOVE,nt.POINTER_UP,nt.POINTER_OVER,nt.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){const r=Os(t,["innerHTML","pointerEvents","cursor"]),[i,a]=this.getSize(t);return{...r,width:i,height:a}}drawKeyShape(t,r){const i=this.getKeyStyle(t),{width:a=0,height:s=0}=i,o=this.upsert("key-container",kn,{width:a,height:s,opacity:0},r);return this.upsert("key",yg,i,o)}connectedCallback(){const t=this.getDomElement();this.events.forEach(r=>{t.addEventListener(r,this.forwardEvents)})}attributeChangedCallback(t,r,i){t==="zIndex"&&r!==i&&(this.getDomElement().style.zIndex=i)}destroy(){const t=this.getDomElement();this.events.forEach(r=>{t.removeEventListener(r,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,r){const i=[];if(r.isTouchEvent(t))for(let a=0;a<t.changedTouches.length;a++){const s=t.changedTouches[a];mt(s.button)&&(s.button=0),mt(s.buttons)&&(s.buttons=1),mt(s.isPrimary)&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),mt(s.width)&&(s.width=s.radiusX||1),mt(s.height)&&(s.height=s.radiusY||1),mt(s.tiltX)&&(s.tiltX=0),mt(s.tiltY)&&(s.tiltY=0),mt(s.pointerType)&&(s.pointerType="touch"),mt(s.pointerId)&&(s.pointerId=s.identifier||0),mt(s.pressure)&&(s.pressure=s.force||.5),mt(s.twist)&&(s.twist=0),mt(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=t.type,i.push(s)}else if(r.isMouseEvent(t)){const a=t;mt(a.isPrimary)&&(a.isPrimary=!0),mt(a.width)&&(a.width=1),mt(a.height)&&(a.height=1),mt(a.tiltX)&&(a.tiltX=0),mt(a.tiltY)&&(a.tiltY=0),mt(a.pointerType)&&(a.pointerType="mouse"),mt(a.pointerId)&&(a.pointerId=1),mt(a.pressure)&&(a.pressure=.5),mt(a.twist)&&(a.twist=0),mt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(t);return i}transferMouseData(t,r){t.isTrusted=r.isTrusted,t.srcElement=r.srcElement,t.timeStamp=performance.now(),t.type=r.type,t.altKey=r.altKey,t.metaKey=r.metaKey,t.shiftKey=r.shiftKey,t.ctrlKey=r.ctrlKey,t.button=r.button,t.buttons=r.buttons,t.client.x=r.clientX,t.client.y=r.clientY,t.movement.x=r.movementX,t.movement.y=r.movementY,t.page.x=r.pageX,t.page.y=r.pageY,t.screen.x=r.screenX,t.screen.y=r.screenY,t.relatedTarget=null}bootstrapEvent(t,r,i,a){t.view=i,t.originalEvent=null,t.nativeEvent=a,t.pointerId=r.pointerId,t.width=r.width,t.height=r.height,t.isPrimary=r.isPrimary,t.pointerType=r.pointerType,t.pressure=r.pressure,t.tangentialPressure=r.tangentialPressure,t.tiltX=r.tiltX,t.tiltY=r.tiltY,t.twist=r.twist,this.transferMouseData(t,r);const{x:s,y:o}=this.getViewportXY(r);t.viewport.x=s,t.viewport.y=o;const[c,l]=this.context.canvas.getCanvasByViewport([s,o]);return t.canvas.x=c,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=a.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let r,i;const{offsetX:a,offsetY:s,clientX:o,clientY:c}=t;if(this.context.canvas.context.config.supportsCSSTransform&&!gt(a)&&!gt(s))r=a,i=s;else{const l=this.eventService.client2Viewport({x:o,y:c});r=l.x,i=l.y}return{x:r,y:i}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}};A(_p,"defaultStyleProps",{size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"});let rw=_p;var ps;let nY=(ps=class extends un{constructor(e){super(fn({style:ps.defaultStyleProps},e))}getKeyStyle(e){const[t,r]=this.getSize(e),{fillOpacity:i,opacity:a=i,...s}=super.getKeyStyle(e);return{opacity:a,...s,width:t,height:r,x:-t/2,y:-r/2}}getHaloStyle(e){if(e.halo===!1)return!1;this.getShape("key").attributes;const t=ze(this.getGraphicStyle(e),"halo"),r=Number(t.lineWidth),[i,a]=qt(this.getSize(e),[r,r]);return{...t,width:i,height:a,fill:"transparent",x:-i/2,y:-a/2}}getIconStyle(e){const t=super.getIconStyle(e),[r,i]=this.getSize(e);return t?{width:r*Yi,height:i*Yi,...t}:!1}drawKeyShape(e,t){return this.upsert("key",Ds,this.getKeyStyle(e),t)}drawHaloShape(e,t){this.upsert("halo",kn,this.getHaloStyle(e),t)}},A(ps,"defaultStyleProps",{size:32}),ps);class rY extends un{constructor(e){super(e)}getKeyStyle(e){const[t,r]=this.getSize(e);return{...super.getKeyStyle(e),width:t,height:r,x:-t/2,y:-r/2}}getIconStyle(e){const t=super.getIconStyle(e),{width:r,height:i}=this.getShape("key").attributes;return t?{width:r*Yi,height:i*Yi,...t}:!1}drawKeyShape(e,t){return this.upsert("key",kn,this.getKeyStyle(e),t)}}class iY extends Og{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return LY(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getInnerR(e)*2*Yi;return t?{width:r,height:r,...t}:!1}getPortXY(e,t){const{placement:r="top"}=t,i=this.getShape("key").getLocalBounds(),a=IY(this.getOuterR(e),this.getInnerR(e));return sS(i,r,a,!1)}}const Op=class Op extends Og{constructor(e){super(fn({style:Op.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[r,i]=this.getSize(e);return BY(r,i,t)}getPortXY(e,t){const{direction:r}=e,{placement:i="top"}=t,a=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(e),c=FY(s,o,r);return sS(a,i,c,!1)}getIconStyle(e){const{icon:t,iconText:r,iconSrc:i,direction:a}=e;if(t===!1||cg(r||i))return!1;const s=ze(this.getGraphicStyle(e),"icon"),o=this.getShape("key").getLocalBounds(),[c,l]=OU(o,a),u=PU(o,a)*2*Yi;return{x:c,y:l,width:u,height:u,...s}}};A(Op,"defaultStyleProps",{size:40,direction:"up"});let iw=Op;var aY=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Pp=class Pp extends un{constructor(t){super(fn({style:Pp.defaultStyleProps},t));A(this,"type","combo");this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:r,childrenNode:i=[]}=t;return i.length===0?this.getEmptyKeySize(t):r?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:r,collapsedSize:i}=t,[a,s,o,c]=ph(r);return qt(Vi(i),[c+s,a+o,0])}getCollapsedKeySize(t){return Vi(t.collapsedSize)}getExpandedKeySize(t){const r=this.getContentBBox(t);return[Ei(r),xi(r),0]}getContentBBox(t){const{context:r,childrenNode:i=[],padding:a}=t,s=i.map(c=>r.element.getElement(c)).filter(Boolean);if(s.length===0){const c=new ue,{x:l=0,y:u=0,size:h}=t,[f,d]=Vi(h);return c.setMinMax([l-f/2,u-d/2,0],[l+f/2,u+d/2,0]),c}const o=gh(s.map(c=>c.getBounds()));return a?_I(o,a):o}drawCollapsedMarkerShape(t,r){this.upsert("collapsed-marker",$I,this.getCollapsedMarkerStyle(t),r)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const{type:r,...i}=ze(this.getGraphicStyle(t),"collapsedMarker"),a=this.getShape("key"),[s,o]=Fi(a.getLocalBounds(),"center"),c={...i,x:s,y:o};if(r){const l=this.getCollapsedMarkerText(r,t);Object.assign(c,{text:l})}return c}getCollapsedMarkerText(t,r){const{context:i,childrenData:a=[]}=r,{model:s}=i;return t==="descendant-count"?s.getDescendantsData(this.id).length.toString():t==="child-count"?a.length.toString():t==="node-count"?s.getDescendantsData(this.id).filter(o=>s.getElementType(Z(o))==="node").length.toString():ft(t)?t(a):""}getComboZIndex(t){return(this.context.model.getAncestorsData(this.id,Oe)||[]).length}getComboPosition(t){const{x:r=0,y:i=0,collapsed:a,context:s,childrenData:o=[]}=t;if(o.length===0)return[+r,+i,0];if(a){const{model:c}=s,l=c.getDescendantsData(this.id).filter(u=>!c.isCombo(Z(u)));if(l.length>0){const u=l.reduce((h,f)=>qt(h,hi(f)),[0,0,0]);return $u(u,l.length)}return[+r,+i,0]}return this.getContentBBox(t).center}getComboStyle(t){const{zIndex:r=this.getComboZIndex(t)}=t,[i,a]=this.getComboPosition(t);return{x:i,y:a,transform:`translate(${i}, ${a})`,zIndex:r}}updateComboPosition(t){const r=this.getComboStyle(t);Object.assign(this.style,r);const{x:i,y:a}=r;this.context.model.syncComboDatum({id:this.id,style:{x:i,y:a}})}render(t,r=this){super.render(t,r),this.drawCollapsedMarkerShape(t,r)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(this.attributes.collapsed?t:t.map(({x:a,y:s,z:o,transform:c,...l})=>l),r);return i&&new Proxy(i,{set:(a,s,o)=>(s==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,s,o))})}};A(Pp,"defaultStyleProps",{childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"});let Xo=Pp;aY([lr((n,e)=>n.getCollapsedMarkerStyle(e))],Xo.prototype,"drawCollapsedMarkerShape",null);class sY extends Xo{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Zi,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,r=super.getKeyStyle(e),[i]=this.getKeySize(e);return{...r,...t&&ze(r,"collapsed"),r:i/2}}getCollapsedKeySize(e){const[t,r]=Vi(e.collapsedSize),i=Math.max(t,r)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[r,i]=Ls(t),a=Math.sqrt(r**2+i**2)/2;return[a*2,a*2,0]}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Sg(e,t)}}class oY extends Xo{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",kn,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getKeySize(e);return{...t,...e.collapsed&&ze(t,"collapsed"),width:r,height:i,x:-r/2,y:-i/2}}}function cY(n,e,t,r,i,a){const s=[n,...i,e];let o=null;const c=[];for(let l=0,u=s.length;l<u-1;l++){const h=l+1,f=s[l],d=s[h],p=RU(f,d);let g=null;l===0?h===u-1?t.intersects(r)?g=Dv(f,d,t,r):p||(g=hY(f,d,t,r)):Ms(d,t)?g=Dv(f,d,t,Ma(d,a),o):p||(g=ad(f,d,t)):h===u-1?Ms(f,r)?g=Dv(f,d,Ma(f,a),r,o):p||(g=qI(f,d,r,o)):p||(g=uY(f,d,o)),g?(c.push(...g.points),o=g.direction):o=rr(f,d),h<u-1&&c.push(d)}return c}const lY={N:"S",S:"N",W:"E",E:"W"},CO={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function rr(n,e){const[t,r]=n,[i,a]=e;return t===i?r>a?"N":"S":r===a?t>i?"W":"E":null}function aw(n,e){return e==="N"||e==="S"?xi(n):Ei(n)}function uY(n,e,t){const r=[n[0],e[1]],i=[e[0],n[1]],a=rr(n,r),s=rr(n,i),o=t?lY[t]:null,c=a===t||a!==o&&s!==t?r:i;return{points:[c],direction:rr(c,e)}}function ad(n,e,t){const r=ju(n,e,t);return{points:[r],direction:rr(r,e)}}function qI(n,e,t,r){const i=[[e[0],n[1]],[n[0],e[1]]],a=i.filter(o=>_U(o,t)&&!SU(o,t,!0)),s=a.filter(o=>rr(o,n)!==r);if(s.length>0){const o=s.find(c=>rr(n,c)===r)||s[0];return{points:[o],direction:rr(o,e)}}else{const o=OD(i,a)[0],c=Ta(e,o,aw(t,r)/2);return{points:[ju(c,n,t),c],direction:rr(c,e)}}}function hY(n,e,t,r){let i=ad(n,e,t);const a=zu(i.points[0]);if(Ms(a,r)){i=ad(e,n,r);const s=zu(i.points[0]);if(Ms(s,t)){const o=Ta(n,a,aw(t,rr(n,a))/2),c=Ta(e,s,aw(r,rr(e,s))/2),l=[(o[0]+c[0])/2,(o[1]+c[1])/2],u=ad(n,l,t),h=qI(l,e,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function Dv(n,e,t,r,i){const s=gh([t,r]),o=Ui(e,s.center)>Ui(n,s.center),[c,l]=o?[e,n]:[n,e],u=xi(s)+Ei(s);let h;if(i){const p=[c[0]+u*Math.cos(CO[i]),c[1]+u*Math.sin(CO[i])];h=Ta(Av(s,p),p,.01)}else h=Ta(Av(s,c),c,-.01);let f=ju(h,l,s),d=[Ic(h,2),Ic(f,2)];if(ve(Ic(h),Ic(f))){const p=eS(We(h,c),[1,0,0])+Math.PI/2;f=[l[0]+u*Math.cos(p),l[1]+u*Math.sin(p),0],f=Ic(Ta(Av(s,f),l,-.01),2);const g=ju(h,f,s);d=[h,g,f]}return{points:o?d.reverse():d,direction:rr(o?h:f,e)}}function ju(n,e,t){let r=[n[0],e[1]];return Ms(r,t)&&(r=[e[0],n[1]]),r}function GI(n,e,t,r,i){let c=typeof e=="number"?e:.5;e==="start"&&(c=0),e==="end"&&(c=.99);const l=Vr(n.getPoint(c)),u=Vr(n.getPoint(c+.01));let h=e==="start"?"left":e==="end"?"right":"center";if(CI(l,u)||!t){const[m,y]=MO(n,c,r,i);return{transform:`translate(${m}, ${y})`,textAlign:h}}let f=Math.atan2(u[1]-l[1],u[0]-l[0]);u[0]<l[0]&&(h=h==="center"?h:h==="left"?"right":"left",r*=-1,f+=Math.PI);const[p,g]=MO(n,c,r,i,f),v=`translate(${p}, ${g}) rotate(${f/Math.PI*180}deg)`;return{textAlign:h,transform:v}}function fY(n,e,t,r,i){var o,c;const a=((o=n.badge)==null?void 0:o.getGeometryBounds().halfExtents[0])*2||0,s=((c=n.label)==null?void 0:c.getGeometryBounds().halfExtents[0])*2||0;return GI(n.key,t,!0,(s?(s/2+a/2)*(e==="suffix"?1:-1):0)+r,i)}function MO(n,e,t,r,i){const[a,s]=Vr(n.getPoint(e));let o=t,c=r;return i&&(o=t*Math.cos(i)-r*Math.sin(i),c=t*Math.sin(i)+r*Math.cos(i)),[a+o,s+c]}function sw(n,e,t,r){if(ve(n,e))return n;const i=We(e,n),a=[n[0]+t*i[0],n[1]+t*i[1]],s=Gi(wg(i,!1));return a[0]+=r*s[0],a[1]+=r*s[1],a}function dY(n){return rt(n)?[n,-n]:n}function pY(n){return rt(n)?[n,1-n]:n}function gY(n,e,t){return[["M",n[0],n[1]],["Q",t[0],t[1],e[0],e[1]]]}function VI(n,e,t){return[["M",n[0],n[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function WI(n,e=0,t=!1){const r=n[0],i=n[n.length-1],a=n.slice(1,n.length-1),s=[["M",r[0],r[1]]];return a.forEach((o,c)=>{const l=a[c-1]||r,u=a[c+1]||i;if(!kU(l,o,u)&&e){const[h,f]=vY(l,o,u,e);s.push(["L",h[0],h[1]],["Q",o[0],o[1],f[0],f[1]],["L",f[0],f[1]])}else s.push(["L",o[0],o[1]])}),s.push(["L",i[0],i[1]]),t&&s.push(["Z"]),s}function vY(n,e,t,r){const i=xO(n,e),a=xO(t,e),s=Math.min(r,Math.min(i,a)/2),o=[e[0]-s/i*(e[0]-n[0]),e[1]-s/i*(e[1]-n[1])],c=[e[0]-s/a*(e[0]-t[0]),e[1]-s/a*(e[1]-t[1])];return[o,c]}const mY=n=>{const e=Math.PI/2,t=xi(n)/2,r=Ei(n)/2,i=Math.atan2(t,r)/2,a=Math.atan2(r,t)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function HI(n,e,t,r,i){const a=Ma(n),s=n.getCenter();let o=r&&Ia(r),c=i&&Ia(i);if(!o||!c){const l=mY(a),u=l[e][0],h=l[e][1],[f,d]=Ls(a),p=Math.max(f,d),g=qt(s,[p*Math.cos(u),p*Math.sin(u),0]),v=qt(s,[p*Math.cos(h),p*Math.sin(h),0]);o=hw(n,g),c=hw(n,v),t||([o,c]=[c,o])}return[o,c]}function yY(n,e,t,r,i,a){const s=n.getPorts()[i||a],o=n.getPorts()[a||i];let[c,l]=HI(n,e,t,s,o);const u=bY(n,c,l,r);return s&&(c=Gu(s,u[0])),o&&(l=Gu(o,u[u.length-1])),VI(c,l,u)}function bY(n,e,t,r){const i=n.getCenter();if(ve(e,t)){const a=We(e,i),s=[r*Math.sign(a[0])||r/2,r*Math.sign(a[1])||-r/2,0];return[qt(e,s),qt(t,tS(s,[1,-1,1]))]}return[Ta(i,e,Ui(i,e)+r),Ta(i,t,Ui(i,t)+r)]}function EY(n,e,t,r,i,a,s){const o=oS(n),c=o[a||s],l=o[s||a];let[u,h]=HI(n,t,r,c,l);const f=xY(n,u,h,i);return c&&(u=Gu(c,f[0])),l&&(h=Gu(l,f[f.length-1])),WI([u,...f,h],e)}function xY(n,e,t,r){const i=[],a=Ma(n);if(ve(e,t))switch(id(a,e)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]]);break}else{const s=id(a,e),o=id(a,t);if(s===o){const c=s;let l,u;switch(c){case"left":l=Math.min(e[0],t[0])-r,i.push([l,e[1]]),i.push([l,t[1]]);break;case"right":l=Math.max(e[0],t[0])+r,i.push([l,e[1]]),i.push([l,t[1]]);break;case"top":u=Math.min(e[1],t[1])-r,i.push([e[0],u]),i.push([t[0],u]);break;case"bottom":u=Math.max(e[1],t[1])+r,i.push([e[0],u]),i.push([t[0],u]);break}}else{const c=(f,d)=>({left:[d[0]-r,d[1]],right:[d[0]+r,d[1]],top:[d[0],d[1]-r],bottom:[d[0],d[1]+r]})[f],l=c(s,e),u=c(o,t),h=ju(l,u,a);i.push(l,h,u)}}return i}function TO(n,e){const t=new Set,r=new Set,i=new Set;return n.forEach(a=>{e(a).forEach(o=>{t.add(o),n.includes(o.source)&&n.includes(o.target)?r.add(o):i.add(o)})}),{edges:Array.from(t),internal:Array.from(r),external:Array.from(i)}}function AO(n,e){const t=[];let r=n;for(;r;){t.push(r);const i=e(Z(r));if(i)r=i;else break}if(t.some(i=>{var a;return(a=i.style)==null?void 0:a.collapsed})){const i=t.reverse().findIndex(nr);return t[i]||t.at(-1)}return n}function wY(n,e){return e||(n<4?10:n===4?12:n*2.5)}const SY=(n,e)=>{const t=Math.max(n,e)/2;return[["M",-n/2,0],["A",t,t,0,1,0,2*t-n/2,0],["A",t,t,0,1,0,-n/2,0],["Z"]]},UI=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",n/2,e/2],["Z"]],_Y=(n,e)=>[["M",-n/2,0],["L",0,-e/2],["L",n/2,0],["L",0,e/2],["Z"]],OY=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",4*n/5-n/2,0],["L",n/2,e/2],["Z"]],PY=(n,e)=>[["M",-n/2,-e/2],["L",n/2,-e/2],["L",n/2,e/2],["L",-n/2,e/2],["Z"]],CY=(n,e)=>{const t=n/2,r=n/7,i=n-r;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+r-t,-e/2],["L",i+r-t,e/2],["L",i-t,e/2],["Z"]]},MY=(n,e)=>[["M",n/2,-e/2],["L",-n/2,0],["L",n/2,0],["L",-n/2,0],["L",n/2,e/2]],TY=Object.freeze(Object.defineProperty({__proto__:null,circle:SY,diamond:_Y,rect:PY,simple:MY,triangle:UI,triangleRect:CY,vee:OY},Symbol.toStringTag,{value:"Module"}));var hc=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Cp=class Cp extends zI{constructor(t){super(fn({style:Cp.defaultStyleProps},t));A(this,"type","edge")}get sourceNode(){const{context:t,sourceNode:r}=this.parsedAttributes;return t.element.getElement(r)}get targetNode(){const{context:t,targetNode:r}=this.parsedAttributes;return t.element.getElement(r)}getKeyStyle(t){const{loop:r,...i}=this.getGraphicStyle(t),{sourceNode:a,targetNode:s}=this;return{d:r&&RY(a,s)?this.getLoopPath(t):this.getKeyPath(t),...nS(i,["halo","label","startArrow","endArrow"])}}getLoopPath(t){const{sourcePort:r,targetPort:i}=t,a=this.sourceNode,s=Ma(a),o=Math.max(Ei(s),xi(s)),{placement:c,clockwise:l,dist:u=o}=ze(this.getGraphicStyle(t),"loop");return yY(a,c,l,u,r,i)}getEndpoints(t){const{sourcePort:r,targetPort:i}=t,{sourceNode:a,targetNode:s}=this,[o,c]=XI(a,s,r,i),l=Ud(o||a,c||s),u=Ud(c||s,o||a);return[l,u]}getHaloStyle(t){if(t.halo===!1)return!1;const r=this.getKeyStyle(t),i=ze(this.getGraphicStyle(t),"halo");return{...r,...i}}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const r=ze(this.getGraphicStyle(t),"label"),{placement:i,offsetX:a,offsetY:s,autoRotate:o,maxWidth:c,...l}=r,u=GI(this.shapeMap.key,i,o,a,s),h=this.shapeMap.key.getLocalBounds(),f=HU([h.min,h.max],c);return Object.assign({wordWrapWidth:f},u,l)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const{offsetX:r,offsetY:i,placement:a,...s}=ze(t,"badge");return Object.assign(s,fY(this.shapeMap,a,t.labelPlacement,r,i))}drawArrow(t,r){var c;const i=r==="start",s=t[r==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){const l=this.getArrowStyle(t,i),[u,h,f]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],d=o.parsedStyle[u];if(d)d.attr(l);else{const p=l.src?Ds:Yr,g=new p({style:l});o.style[u]=g}o.style[h]=t[f]||l.width/2+ +l.lineWidth}else{const l=i?"markerStart":"markerEnd";(c=o.style[l])==null||c.destroy(),o.style[l]=null}}getArrowStyle(t,r){const i=this.getShape("key").attributes,a=r?"startArrow":"endArrow",{size:s,type:o,...c}=ze(this.getGraphicStyle(t),a),[l,u]=Vi(wY(i.lineWidth,s)),f=(ft(o)?o:TY[o]||UI)(l,u);return Object.assign(Os(i,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:u},{...f&&{d:f,fill:o==="simple"?"":i.stroke}},c)}drawLabelShape(t,r){this.upsert("label",Ko,this.getLabelStyle(t),r)}drawHaloShape(t,r){this.upsert("halo",Yr,this.getHaloStyle(t),r)}drawBadgeShape(t,r){this.upsert("badge",Wd,this.getBadgeStyle(t),r)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,r){return this.upsert("key",Yr,this.getKeyStyle(t),r)}render(t=this.parsedAttributes,r=this){this.drawKeyShape(t,r),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,r),this.drawHaloShape(t,r),this.drawBadgeShape(t,r))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(t,r);return i&&new Proxy(i,{set:(a,s,o)=>(s==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,s,o))})}};A(Cp,"defaultStyleProps",{badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0});let sr=Cp;hc([lr((n,e)=>n.getLabelStyle(e))],sr.prototype,"drawLabelShape",null);hc([lr((n,e)=>n.getHaloStyle(e))],sr.prototype,"drawHaloShape",null);hc([lr((n,e)=>n.getBadgeStyle(e))],sr.prototype,"drawBadgeShape",null);hc([lr((n,e)=>n.getArrowStyle(e,"start"))],sr.prototype,"drawSourceArrow",null);hc([lr((n,e)=>n.getArrowStyle(e,"end"))],sr.prototype,"drawTargetArrow",null);hc([lr((n,e)=>n.getKeyStyle(e))],sr.prototype,"drawKeyShape",null);const Mp=class Mp extends sr{constructor(e){super(fn({style:Mp.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e),{controlPoints:i,curvePosition:a,curveOffset:s}=e,o=this.getControlPoints(t,r,pY(a),dY(s),i);return VI(t,r,o)}getControlPoints(e,t,r,i,a){return(a==null?void 0:a.length)===2?a:[sw(e,t,r[0],i[0]),sw(e,t,r[1],i[1])]}};A(Mp,"defaultStyleProps",{curvePosition:.5,curveOffset:20});let qu=Mp;const Tp=class Tp extends qu{constructor(e){super(fn({style:Tp.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[0]-e[0];return[[e[0]+a*r[0]+i[0],e[1]],[t[0]-a*r[1]+i[1],t[1]]]}};A(Tp,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});let ow=Tp;const Ap=class Ap extends qu{constructor(e){super(fn({style:Ap.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[1]-e[1];return[[e[0],e[1]+a*r[0]+i[0]],[t[0],t[1]-a*r[1]+i[1]]]}};A(Ap,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});let cw=Ap;var gs;let AY=(gs=class extends sr{constructor(e){super(fn({style:gs.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",r[0],r[1]]]}},A(gs,"defaultStyleProps",{}),gs);const Np=class Np extends sr{constructor(e){super(fn({style:Np.defaultStyleProps},e))}getKeyPath(e){const{radius:t}=e,{sourceNode:r,targetNode:i}=this,{sourcePoint:a,targetPoint:s,sourcePort:o,targetPort:c}=this.getEndpointsAndPorts(e),l=this.getControlPoints(e,a,s),u=Ud(o||r,l[0]||c||i),h=Ud(c||i,l[l.length-1]||o||r);return WI([u,...l,h],t)}getEndpointsAndPorts(e){const{sourcePort:t,targetPort:r}=e,{sourceNode:i,targetNode:a}=this,[s,o]=XI(i,a,t,r);return{sourcePoint:s?Ia(s):i.getCenter(),targetPoint:o?Ia(o):a.getCenter(),sourcePort:s,targetPort:o}}getControlPoints(e,t,r){const{controlPoints:i,router:a,routerPadding:s}=e,{sourceNode:o,targetNode:c}=this;if(!a)return[...i];const l=Ma(o,s),u=Ma(c,s);return cY(t,r,l,u,i,s)}getLoopPath(e){const{sourcePort:t,targetPort:r,radius:i}=e,a=this.sourceNode,s=Ma(a),o=Math.max(Ei(s),xi(s))/4,{placement:c,clockwise:l,dist:u=o}=ze(this.getGraphicStyle(e),"loop");return EY(a,i,c,l,u,t,r)}};A(Np,"defaultStyleProps",{radius:0,controlPoints:[],router:!1,routerName:"orth",routerPadding:10});let lw=Np;const Rp=class Rp extends sr{constructor(e){super(fn({style:Rp.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:r}=e,[i,a]=this.getEndpoints(e),s=e.controlPoint||sw(i,a,t,r);return gY(i,a,s)}};A(Rp,"defaultStyleProps",{curvePosition:.5,curveOffset:30});let uw=Rp;function mh(n){return n instanceof un&&n.type==="node"}function YI(n){return n instanceof sr}function aS(n){return n instanceof Xo}function NY(n){return mh(n)||YI(n)||aS(n)}function RY(n,e){return!n||!e?!1:n===e}const kY={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function sS(n,e,t=kY,r=!0){const i=[.5,.5],a=At(e)?ln(t,e.toLocaleLowerCase(),i):e;if(!r&&At(e))return a;const[s,o]=a||i;return[n.min[0]+Ei(n)*s,n.min[1]+xi(n)*o]}function oS(n){if(!n)return{};const e=n.getPorts();return(n.attributes.ports||[]).forEach((r,i)=>{var o;const{key:a,placement:s}=r;KI(r)&&(e[o=a||i]||(e[o]=Fi(n.getShape("key").getBounds(),s)))}),e}function KI(n){const{r:e}=n;return!e||Number(e)===0}function Ia(n){return Fu(n)?n:n.getPosition()}function XI(n,e,t,r){const i=NO(n,e,t,r),a=NO(e,n,r,t);return[i,a]}function NO(n,e,t,r){const i=oS(n);if(t)return i[t];const a=Object.values(i);if(a.length===0)return;const s=a.map(l=>Ia(l)),o=DY(e,r),[c]=IU(s,o);return a.find(l=>Ia(l)===c)}function DY(n,e){const t=oS(n);if(e)return[Ia(t[e])];const r=Object.values(t);return r.length>0?r.map(i=>Ia(i)):[n.getCenter()]}function Ud(n,e){return aS(n)||mh(n)?hw(n,e):Gu(n,e)}function Gu(n,e){if(!n||!e)return[0,0,0];if(Fu(n))return n;if(n.attributes.linkToCenter)return n.getPosition();const t=Fu(e)?e:mh(e)?e.getCenter():e.getPosition();return Sg(t,n.getBounds())}function hw(n,e){if(!n||!e)return[0,0,0];const t=Fu(e)?e:mh(e)?e.getCenter():e.getPosition();return n.getIntersectPoint(t)||n.getCenter()}function RO(n,e="bottom",t=0,r=0,i=!1){const a=e.split("-"),[s,o]=Fi(n,e),c=a.includes("left")?"right":a.includes("right")?"left":"center";let l=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(l=l==="top"?"bottom":l==="bottom"?"top":l),{transform:`translate(${s+t}, ${o+r})`,textBaseline:l,textAlign:c}}function LY(n,e){return[[0,-n],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[0,e],[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function IY(n,e){const t={};return t.top=[0,-n],t.left=[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t["left-bottom"]=[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.right=t.default=[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t}function BY(n,e,t){const r=e/2,i=n/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[t]||a.up}function FY(n,e,t){const r=e/2,i=n/2,a={};return t==="down"?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):t==="left"?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):t==="right"?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}function $Y(n,e){return[[0,-e/2],[n/2,0],[0,e/2],[-n/2,0]]}function uu(n,e){"update"in n?n.update(e):n.attr(e)}function zY(n){return[[0,n],[n*Math.sqrt(3)/2,n/2],[n*Math.sqrt(3)/2,-n/2],[0,-n],[-n*Math.sqrt(3)/2,-n/2],[-n*Math.sqrt(3)/2,n/2]]}function jY(n){qo(n,"__to_be_destroyed__",!0)}function ZI(n){return ln(n,"__to_be_destroyed__",!1)}const kp=class kp extends Ar{constructor(t,r){super(t,Object.assign({},kp.defaultOptions,r));A(this,"onCollapseExpand",async t=>{if(!this.validate(t))return;const{target:r}=t;if(!NY(r))return;const i=r.id,{model:a,graph:s}=this.context,o=a.getElementDataById(i);if(!o)return!1;const{onCollapse:c,onExpand:l,animation:u}=this.options;nr(o)?(await s.expandElement(i,u),l==null||l(i)):(await s.collapseElement(i,u),c==null||c(i))});this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`node:${r}`,this.onCollapseExpand),t.on(`combo:${r}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`node:${r}`,this.onCollapseExpand),t.off(`combo:${r}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};A(kp,"defaultOptions",{enable:!0,animation:!0,trigger:nt.DBLCLICK});let fw=kp;const qY="g6-create-edge-assist-edge-id",Ef="g6-create-edge-assist-node-id",Dp=class Dp extends Ar{constructor(t,r){super(t,Object.assign({},Dp.defaultOptions,r));A(this,"source");A(this,"drop",async t=>{const{targetType:r}=t;["combo","node"].includes(r)&&this.source?await this.handleCreateEdge(t):await this.cancelEdge()});A(this,"handleCreateEdge",async t=>{var c;if(!this.validate(t))return;const{graph:r,canvas:i,batch:a,element:s}=this.context,{style:o}=this.options;if(this.source){this.createEdge(t),await this.cancelEdge();return}a.startBatch(),i.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],r.addNodeData([{id:Ef,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),r.addEdgeData([{id:qY,source:this.source,target:Ef,style:{pointerEvents:"none",...o}}]),await((c=s.draw({animation:!1}))==null?void 0:c.finished)});A(this,"updateAssistEdge",async t=>{var a;if(!this.source)return;const{model:r,element:i}=this.context;r.translateNodeTo(Ef,[t.canvas.x,t.canvas.y]),await((a=i.draw({animation:!1,silence:!0}))==null?void 0:a.finished)});A(this,"createEdge",t=>{var h,f;const{graph:r}=this.context,{style:i,onFinish:a,onCreate:s}=this.options;if(((h=t.target)==null?void 0:h.id)===void 0||this.source===void 0)return;const c=(f=this.getSelectedNodeIDs([t.target.id]))==null?void 0:f[0],l=`${this.source}-${c}-${VD()}`,u=s({id:l,source:this.source,target:c,style:i});r.addEdgeData([u]),a(u)});A(this,"cancelEdge",async()=>{var a;if(!this.source)return;const{graph:t,element:r,batch:i}=this.context;t.removeNodeData([Ef]),this.source=void 0,await((a=r.draw({animation:!1}))==null?void 0:a.finished),i.endBatch()});this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;this.unbindEvents(),r==="click"?(t.on(bo.CLICK,this.handleCreateEdge),t.on(ls.CLICK,this.handleCreateEdge),t.on(Tn.CLICK,this.cancelEdge),t.on(zd.CLICK,this.cancelEdge)):(t.on(bo.DRAG_START,this.handleCreateEdge),t.on(ls.DRAG_START,this.handleCreateEdge),t.on(nt.POINTER_UP,this.drop)),t.on(nt.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;t.off(bo.CLICK,this.handleCreateEdge),t.off(ls.CLICK,this.handleCreateEdge),t.off(Tn.CLICK,this.cancelEdge),t.off(zd.CLICK,this.cancelEdge),t.off(bo.DRAG_START,this.handleCreateEdge),t.off(ls.DRAG_START,this.handleCreateEdge),t.off(nt.POINTER_UP,this.drop),t.off(nt.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}};A(Dp,"defaultOptions",{animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}});let dw=Dp;const Lp=class Lp extends Ar{constructor(t,r){super(t,Object.assign({},Lp.defaultOptions,r));A(this,"shortcut");A(this,"defaultCursor");A(this,"isDragging",!1);A(this,"onDragStart",t=>{this.validate(t)&&t.targetType==="canvas"&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))});A(this,"onDrag",t=>{if(!this.isDragging)return;const{x:r,y:i}=t.movement;r|i&&this.translate([r,i],!1)});A(this,"onDragEnd",()=>{var t,r;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(r=(t=this.options).onFinish)==null||r.call(t)});A(this,"invokeOnFinish",ch(()=>{var t,r;(r=(t=this.options).onFinish)==null||r.call(t)},300));this.shortcut=new lc(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options,{graph:r}=this.context;if(ne(t)){const{up:i=[],down:a=[],left:s=[],right:o=[]}=t;this.shortcut.bind(i,c=>this.onTranslate([0,1],c)),this.shortcut.bind(a,c=>this.onTranslate([0,-1],c)),this.shortcut.bind(s,c=>this.onTranslate([1,0],c)),this.shortcut.bind(o,c=>this.onTranslate([-1,0],c))}else r.on(Tn.DRAG_START,this.onDragStart),r.on(Tn.DRAG,this.onDrag),r.on(Tn.DRAG_END,this.onDragEnd)}async onTranslate(t,r){if(!this.validate(r))return;const{sensitivity:i}=this.options,a=i*-1;await this.translate(tS(t,a),this.options.animation),this.invokeOnFinish()}async translate(t,r){await this.context.graph.translateBy(t,r)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(Tn.DRAG_START,this.onDragStart),t.off(Tn.DRAG,this.onDrag),t.off(Tn.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}};A(Lp,"defaultOptions",{enable:!0,sensitivity:10});let pw=Lp;const Ip=class Ip extends Ar{constructor(t,r){super(t,Object.assign({},Ip.defaultOptions,r));A(this,"enable",!1);A(this,"enableElements",["node","combo"]);A(this,"target",[]);A(this,"shadow");A(this,"shadowOrigin",[0,0]);A(this,"hiddenEdges",[]);A(this,"isDragging",!1);A(this,"onDrop",async t=>{var s;if(this.options.dropEffect!=="link")return;const{model:r,element:i}=this.context,a=t.target.id;this.target.forEach(o=>{const c=r.getParentData(o,Oe);c&&Z(c)===a&&r.refreshComboData(a),r.setParent(o,a,Oe)}),await((s=i==null?void 0:i.draw({animation:!0}))==null?void 0:s.finished)});A(this,"setCursor",t=>{if(this.isDragging)return;const{type:r}=t,{canvas:i}=this.context,{cursor:a}=this.options;r===nt.POINTER_ENTER?i.setCursor((a==null?void 0:a.grab)||"grab"):i.setCursor((a==null?void 0:a.default)||"default")});this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}get animation(){return this.options.shadow?this.options.animation:!1}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.on(`${r}:${nt.DRAG_START}`,this.onDragStart),t.on(`${r}:${nt.DRAG}`,this.onDrag),t.on(`${r}:${nt.DRAG_END}`,this.onDragEnd),t.on(`${r}:${nt.POINTER_ENTER}`,this.setCursor),t.on(`${r}:${nt.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(ls.DROP,this.onDrop),t.on(Tn.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}getDelta(t){const r=this.context.graph.getZoom();return $u([t.dx,t.dy],r)}onDragStart(t){var a;if(this.enable=this.validate(t),!this.enable)return;const{batch:r,canvas:i}=this.context;i.setCursor(((a=this.options.cursor)==null?void 0:a.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const r=this.getDelta(t);this.options.shadow?this.moveShadow(r):this.moveElement(this.target,r)}onDragEnd(){var i,a,s;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:o=0,y:c=0}=this.shadow.attributes,[l,u]=We([+o,+c],this.shadowOrigin);this.moveElement(this.target,[l,u])}this.showEdges(),(a=(i=this.options).onFinish)==null||a.call(i,this.target);const{batch:t,canvas:r}=this.context;t.endBatch(),r.setCursor(((s=this.options.cursor)==null?void 0:s.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}async moveElement(t,r){const{graph:i,model:a}=this.context,{dropEffect:s}=this.options;s==="move"&&t.forEach(o=>a.refreshComboData(o)),i.translateElementBy(Object.fromEntries(t.map(o=>[o,r])),!1)}moveShadow(t){if(!this.shadow)return;const{x:r=0,y:i=0}=this.shadow.attributes,[a,s]=t;this.shadow.attr({x:+r+a,y:+i+s})}createShadow(t){const r=ze(this.options,"shadow"),i=gh(t.map(u=>this.context.element.getElement(u).getBounds())),[a,s]=i.min;this.shadowOrigin=[a,s];const[o,c]=Ls(i),l={width:o,height:c,x:a,y:s};this.shadow?this.shadow.attr({...r,...l,visibility:"visible"}):(this.shadow=new kn({style:{$layer:"transient",...r,...l,pointerEvents:"none"}}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:r}=this.options;if(t==="none"||r)return;const{graph:i}=this.context;t==="all"?this.hiddenEdges=i.getEdgeData().map(Z):this.hiddenEdges=Array.from(new Set(this.target.map(a=>i.getRelatedEdgesData(a,t).map(Z)).flat())),i.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.off(`${r}:${nt.DRAG_START}`,this.onDragStart),t.off(`${r}:${nt.DRAG}`,this.onDrag),t.off(`${r}:${nt.DRAG_END}`,this.onDragEnd),t.off(`${r}:${nt.POINTER_ENTER}`,this.setCursor),t.off(`${r}:${nt.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${nt.DROP}`,this.onDrop),t.off(`canvas:${nt.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)==null||t.destroy(),super.destroy()}};A(Ip,"defaultOptions",{animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}});let Yd=Ip;var GY="*",yh=function(){function n(){this._events={}}return n.prototype.on=function(e,t,r){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!r}),this},n.prototype.once=function(e,t){return this.on(e,t,!0)},n.prototype.emit=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=this._events[e]||[],s=this._events[GY]||[],o=function(c){for(var l=c.length,u=0;u<l;u++)if(c[u]){var h=c[u],f=h.callback,d=h.once;d&&(c.splice(u,1),c.length===0&&delete t._events[e],l--,u--),f.apply(t,r)}};o(a),o(s)},n.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var r=this._events[e]||[],i=r.length,a=0;a<i;a++)r[a].callback===t&&(r.splice(a,1),i--,a--);r.length===0&&delete this._events[e]}return this},n.prototype.getEvents=function(){return this._events},n}();const VY=Object.freeze(Object.defineProperty({__proto__:null,default:yh},Symbol.toStringTag,{value:"Module"}));function gw(n,e,t,r){for(;n.length;){const i=n.shift();if(t(i))return!0;e.add(i.id),r(i.id).forEach(s=>{e.has(s.id)||(e.add(s.id),n.push(s))})}return!1}function Kd(n,e,t,r){if(t(n))return!0;e.add(n.id);for(const a of r(n.id))if(!e.has(a.id)&&Kd(a,e,t,r))return!0;return!1}const kO=()=>!0;class QI{constructor(e){A(this,"graph");A(this,"nodeFilter");A(this,"edgeFilter");A(this,"cacheEnabled");A(this,"inEdgesMap",new Map);A(this,"outEdgesMap",new Map);A(this,"bothEdgesMap",new Map);A(this,"allNodesMap",new Map);A(this,"allEdgesMap",new Map);A(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});A(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id))});A(this,"updateCache",e=>{const t=new Set;e.forEach(r=>{const i=this.bothEdgesMap.get(r);if(i&&i.forEach(a=>t.add(a.id)),!this.hasNode(r))this.inEdgesMap.delete(r),this.outEdgesMap.delete(r),this.bothEdgesMap.delete(r),this.allNodesMap.delete(r);else{const a=this.graph.getRelatedEdges(r,"in").filter(this.edgeFilter),s=this.graph.getRelatedEdges(r,"out").filter(this.edgeFilter),o=Array.from(new Set([...a,...s]));o.forEach(c=>t.add(c.id)),this.inEdgesMap.set(r,a),this.outEdgesMap.set(r,s),this.bothEdgesMap.set(r,o),this.allNodesMap.set(r,this.graph.getNode(r))}}),t.forEach(r=>{this.hasEdge(r)?this.allEdgesMap.set(r,this.graph.getEdge(r)):this.allEdgesMap.delete(r)})});A(this,"handleGraphChanged",e=>{const t=new Set;e.changes.forEach(r=>{switch(r.type){case"NodeAdded":t.add(r.value.id);break;case"NodeDataUpdated":t.add(r.id);break;case"EdgeAdded":t.add(r.value.source),t.add(r.value.target);break;case"EdgeUpdated":(r.propertyName==="source"||r.propertyName==="target")&&(t.add(r.oldValue),t.add(r.newValue));break;case"EdgeDataUpdated":if(e.graph.hasEdge(r.id)){const i=e.graph.getEdge(r.id);t.add(i.source),t.add(i.target)}break;case"EdgeRemoved":t.add(r.value.source),t.add(r.value.target);break;case"NodeRemoved":t.add(r.value.id);break}}),this.updateCache(t)});this.graph=e.graph;const t=e.nodeFilter||kO,r=e.edgeFilter||kO;this.nodeFilter=t,this.edgeFilter=i=>{const{source:a,target:s}=this.graph.getEdgeDetail(i.id);return!t(a)||!t(s)?!1:r(i,a,s)},e.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):e.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(e){this.getNode(e)}hasNode(e){if(!this.graph.hasNode(e))return!1;const t=this.graph.getNode(e);return this.nodeFilter(t)}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(r=>r.id===e)}getNode(e){const t=this.graph.getNode(e);if(!this.nodeFilter(t))throw new Error("Node not found for id: "+e);return t}getRelatedEdges(e,t){return this.checkNodeExistence(e),this.cacheEnabled?t==="in"?this.inEdgesMap.get(e):t==="out"?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter)}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){const r=this.getRelatedEdges(e,"out").map(i=>this.getNode(i.target));return Array.from(new Set(r))}getPredecessors(e){const r=this.getRelatedEdges(e,"in").map(i=>this.getNode(i.source));return Array.from(new Set(r))}getNeighbors(e){const t=this.getPredecessors(e),r=this.getSuccessors(e);return Array.from(new Set([...t,...r]))}hasEdge(e){if(!this.graph.hasEdge(e))return!1;const t=this.graph.getEdge(e);return this.edgeFilter(t)}getEdge(e){const t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw new Error("Edge not found for id: "+e);return t}getEdgeDetail(e){const t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}hasTreeStructure(e){return this.graph.hasTreeStructure(e)}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter)}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter)}getParent(e,t){this.checkNodeExistence(e);const r=this.graph.getParent(e,t);return!r||!this.nodeFilter(r)?null:r}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(e,t,r="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];gw([this.getNode(e)],new Set,t,i)}dfs(e,t,r="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];Kd(this.getNode(e),new Set,t,i)}}let qe=class JI extends yh{constructor(t){super();A(this,"nodeMap",new Map);A(this,"edgeMap",new Map);A(this,"inEdgesMap",new Map);A(this,"outEdgesMap",new Map);A(this,"bothEdgesMap",new Map);A(this,"treeIndices",new Map);A(this,"changes",[]);A(this,"batchCount",0);A(this,"onChanged",()=>{});A(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const r={graph:this,changes:t};this.emit("changed",r),this.onChanged(r)}reduceChanges(t){let r=[];return t.forEach(i=>{switch(i.type){case"NodeRemoved":{let a=!1;r=r.filter(s=>{if(s.type==="NodeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else{if(s.type==="NodeDataUpdated")return s.id!==i.value.id;if(s.type==="TreeStructureChanged")return s.nodeId!==i.value.id}return!0}),a||r.push(i);break}case"EdgeRemoved":{let a=!1;r=r.filter(s=>{if(s.type==="EdgeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else if(s.type==="EdgeDataUpdated"||s.type==="EdgeUpdated")return s.id!==i.value.id;return!0}),a||r.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const a=r.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),s=r[a];s?i.propertyName!==void 0?s.newValue=i.newValue:(r.splice(a,1),r.push(i)):r.push(i);break}case"TreeStructureDetached":{r=r.filter(a=>a.type==="TreeStructureAttached"||a.type==="TreeStructureChanged"?a.treeKey!==i.treeKey:!0),r.push(i);break}case"TreeStructureChanged":{const a=r.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===i.treeKey&&s.nodeId===i.nodeId);a?a.newParentId=i.newParentId:r.push(i);break}default:r.push(i);break}}),r}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,r){return this.getNeighbors(r).some(i=>i.id===t)}getNode(t){const r=this.nodeMap.get(t);if(!r)throw new Error("Node not found for id: "+t);return r}getRelatedEdges(t,r){if(this.checkNodeExistence(t),r==="in"){const i=this.inEdgesMap.get(t);return Array.from(i)}else if(r==="out"){const i=this.outEdgesMap.get(t);return Array.from(i)}else{const i=this.bothEdgesMap.get(t);return Array.from(i)}}getDegree(t,r){return this.getRelatedEdges(t,r).length}getSuccessors(t){const i=this.getRelatedEdges(t,"out").map(a=>this.getNode(a.target));return Array.from(new Set(i))}getPredecessors(t){const i=this.getRelatedEdges(t,"in").map(a=>this.getNode(a.source));return Array.from(new Set(i))}getNeighbors(t){const r=this.getPredecessors(t),i=this.getSuccessors(t);return Array.from(new Set([...r,...i]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(r=>{r.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const r of t)this.doAddNode(r)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const r=this.getNode(t),i=this.bothEdgesMap.get(t);i==null||i.forEach(a=>this.doRemoveEdge(a.id)),this.nodeMap.delete(t),this.treeIndices.forEach(a=>{var o,c;(o=a.childrenMap.get(t))==null||o.forEach(l=>{a.parentMap.delete(l.id)});const s=a.parentMap.get(t);s&&((c=a.childrenMap.get(s.id))==null||c.delete(r)),a.parentMap.delete(t),a.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:r})}removeNodes(t){this.batch(()=>{t.forEach(r=>this.doRemoveNode(r))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,r,i){const a=this.getNode(t);this.batch(()=>{const s=a.data[r],o=i;a.data[r]=o,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:r,oldValue:s,newValue:o})})}mergeNodeData(t,r){this.batch(()=>{Object.entries(r).forEach(([i,a])=>{this.updateNodeDataProperty(t,i,a)})})}updateNodeData(...t){const r=t[0],i=this.getNode(r);if(typeof t[1]=="string"){this.updateNodeDataProperty(r,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"NodeDataUpdated",id:r,oldValue:s,newValue:o})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const r=this.getEdge(t);return{edge:r,source:this.getNode(r.source),target:this.getNode(r.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const r=this.inEdgesMap.get(t.target),i=this.outEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.target);r.add(t),i.add(t),a.add(t),s.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const r of t)this.doAddEdge(r)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const r=this.getEdge(t),i=this.outEdgesMap.get(r.source),a=this.inEdgesMap.get(r.target),s=this.bothEdgesMap.get(r.source),o=this.bothEdgesMap.get(r.target);i.delete(r),a.delete(r),s.delete(r),o.delete(r),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:r})}removeEdges(t){this.batch(()=>{t.forEach(r=>this.doRemoveEdge(r))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,r){const i=this.getEdge(t);this.checkNodeExistence(r);const a=i.source,s=r;this.outEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.outEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.source=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:a,newValue:s})})}updateEdgeTarget(t,r){const i=this.getEdge(t);this.checkNodeExistence(r);const a=i.target,s=r;this.inEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.inEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.target=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:a,newValue:s})})}updateEdgeDataProperty(t,r,i){const a=this.getEdge(t);this.batch(()=>{const s=a.data[r],o=i;a.data[r]=o,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:r,oldValue:s,newValue:o})})}updateEdgeData(...t){const r=t[0],i=this.getEdge(r);if(typeof t[1]=="string"){this.updateEdgeDataProperty(r,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"EdgeDataUpdated",id:r,oldValue:s,newValue:o})})}mergeEdgeData(t,r){this.batch(()=>{Object.entries(r).forEach(([i,a])=>{this.updateEdgeDataProperty(t,i,a)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,r){this.batch(()=>{this.attachTreeStructure(r);const i=[],a=Array.isArray(t)?t:[t];for(;a.length;){const s=a.shift();i.push(s),s.children&&a.push(...s.children)}this.addNodes(i),i.forEach(s=>{var o;(o=s.children)==null||o.forEach(c=>{this.setParent(c.id,s.id,r)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(r=>!this.getParent(r.id,t))}getChildren(t,r){this.checkNodeExistence(t),this.checkTreeExistence(r);const a=this.treeIndices.get(r).childrenMap.get(t);return Array.from(a||[])}getParent(t,r){return this.checkNodeExistence(t),this.checkTreeExistence(r),this.treeIndices.get(r).parentMap.get(t)||null}getAncestors(t,r){const i=[];let a=this.getNode(t),s;for(;s=this.getParent(a.id,r);)i.push(s),a=s;return i}setParent(t,r,i){var u,h;this.checkTreeExistence(i);const a=this.treeIndices.get(i),s=this.getNode(t),o=a.parentMap.get(t);if((o==null?void 0:o.id)===r)return;if(r===void 0){o&&((u=a.childrenMap.get(o.id))==null||u.delete(s)),a.parentMap.delete(t);return}const c=this.getNode(r);a.parentMap.set(t,c),o&&((h=a.childrenMap.get(o.id))==null||h.delete(s));let l=a.childrenMap.get(c.id);l||(l=new Set,a.childrenMap.set(c.id,l)),l.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:t,oldParentId:o==null?void 0:o.id,newParentId:c.id})})}dfsTree(t,r,i){const a=s=>this.getChildren(s,i);return Kd(this.getNode(t),new Set,r,a)}bfsTree(t,r,i){const a=s=>this.getChildren(s,i);return gw([this.getNode(t)],new Set,r,a)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,r,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return gw([this.getNode(t)],new Set,r,a)}dfs(t,r,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Kd(this.getNode(t),new Set,r,a)}clone(){const t=this.getAllNodes().map(a=>({...a,data:{...a.data}})),r=this.getAllEdges().map(a=>({...a,data:{...a.data}})),i=new JI({nodes:t,edges:r});return this.treeIndices.forEach(({parentMap:a,childrenMap:s},o)=>{const c=new Map;a.forEach((u,h)=>{c.set(h,i.getNode(u.id))});const l=new Map;s.forEach((u,h)=>{l.set(h,new Set(Array.from(u).map(f=>i.getNode(f.id))))}),i.treeIndices.set(o,{parentMap:c,childrenMap:l})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new QI({graph:this,...t})}};const WY=Object.freeze(Object.defineProperty({__proto__:null,Graph:qe,GraphView:QI},Symbol.toStringTag,{value:"Module"}));let t5=class{constructor(e,t){A(this,"options");A(this,"context");A(this,"stop");A(this,"tick");this.context=e,this.options=t||{}}};function HY(n){const{type:e}=n;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function sd(n){const{nodes:e,edges:t}=n,r={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?r.combos:r.nodes,{x:s,y:o,z:c=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:c}})}),t.forEach(i=>{const{id:a,source:s,target:o,data:{points:c=[],controlPoints:l=c.slice(1,c.length-1)}}=i;r.edges.push({id:a,source:s,target:o,style:{...l!=null&&l.length?{controlPoints:l.map(Vr)}:{}}})}),r}function UY(n,e){class t extends t5{constructor(a,s){super(a,s);A(this,"instance");A(this,"id");if(this.instance=new n({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const o=this.instance;this.stop=o.stop.bind(o),this.tick=c=>{const l=o.tick(c);return sd(l)}}}async execute(a,s){return sd(await this.instance.execute(this.graphData2LayoutModel(a),this.transformOptions(Le({},this.options,s))))}transformOptions(a){const{onTick:s}=a;return s&&(a.onTick=o=>s(sd(o))),a}graphData2LayoutModel(a){const{nodes:s=[],edges:o=[],combos:c=[]}=a,l=s.map(p=>{const g=Z(p),{data:v,style:m,combo:y}=p,b={id:g,data:{...v,...y?{parentId:y}:{}},style:{...m}};return m!=null&&m.x&&Object.assign(b.data,{x:m.x}),m!=null&&m.y&&Object.assign(b.data,{y:m.y}),m!=null&&m.z&&Object.assign(b.data,{z:m.z}),b}),u=new Map(l.map(p=>[p.id,p])),h=o.filter(p=>{const{source:g,target:v}=p;return u.has(g)&&u.has(v)}).map(p=>{const{source:g,target:v,data:m,style:y}=p;return{id:Z(p),source:g,target:v,data:{...m},style:{...y}}}),f=c.map(p=>({id:Z(p),data:{_isCombo:!0,...p.data},style:{...p.style}})),d=new qe({nodes:[...l,...f],edges:h});return e.model.model.hasTreeStructure(Oe)&&(d.attachTreeStructure(Oe),l.forEach(p=>{const g=e.model.model.getParent(p.id,Oe);g&&d.hasNode(g.id)&&d.setParent(p.id,g.id,Oe)})),d}}return t}function Lv(n,e,...t){if(e in n)return n[e](...t);if("instance"in n){const r=n.instance;if(e in r)return r[e](...t)}return null}function DO(n,e){if(e in n)return n[e];if("instance"in n){const t=n.instance;if(e in t)return t[e]}return null}class YY extends Yd{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(Qi.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}async moveElement(e,t){const r=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,a)=>{const{x:s=0,y:o=0}=i.style||{};r&&Lv(r,"setFixedPosition",e[a],[...qt([+s,+o],t)])})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&DO(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(r=>{const{x:i=0,y:a=0}=r.style||{};t&&Lv(t,"setFixedPosition",Z(r),[+i,+a])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&DO(e,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(t=>{e&&Lv(e,"setFixedPosition",Z(t),[null,null,null])})}}const Bp=class Bp extends Ar{constructor(t,r){super(t,Object.assign({},Bp.defaultOptions,r));A(this,"elementCache",new Map);A(this,"isZoomEvent",t=>"scale"in t.data);A(this,"fixElementSize",async t=>{if(!this.isZoomEvent(t)||!this.validate(t))return;const{graph:r,element:i}=this.context,{node:a,edge:s,state:o}=this.options,c=[...r.getElementDataByState("node",o),...r.getElementDataByState("edge",o)];if(!c.length)return;const l=t.data.scale||r.getZoom();c.forEach(u=>{const h=Z(u),f=i==null?void 0:i.getElement(h),d=r.getElementType(h),p=d==="edge"?s:a;if(!p){this.elementCache.set(h,f),d==="edge"&&(f.style.transformOrigin="center"),f.setLocalScale(1/l);return}const g=II(f);(Array.isArray(p)?p:[p]).forEach(m=>{const{shape:y,fields:b}=m,w=y(g);b.forEach(x=>{iS(w,x)||rS(w,x);const S=Yo(w,x);rt(S)&&(w.style[x]=S/l)})})})});A(this,"resetTransform",async()=>{this.elementCache&&(this.elementCache.forEach(t=>t.setLocalScale(1)),this.elementCache.clear())});this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(dt.AFTER_TRANSFORM,this.fixElementSize),t.on(dt.BEFORE_DRAW,this.resetTransform)}unbindEvents(){const{graph:t}=this.context;t.off(dt.AFTER_TRANSFORM,this.fixElementSize),t.off(dt.BEFORE_DRAW,this.resetTransform)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};A(Bp,"defaultOptions",{enable:t=>t.data.scale<1,state:"selected",edge:[{shape:t=>t.find(r=>r.className==="key"),fields:["lineWidth"]},{shape:t=>t.find(r=>{var i;return((i=r.parentElement)==null?void 0:i.className)==="label"&&r.className==="text"}),fields:["fontSize"]}]});let vw=Bp;const Fp=class Fp extends Ar{constructor(t,r){super(t,Object.assign({},Fp.defaultOptions,r));A(this,"focus",async t=>{if(!this.validate(t))return;const{graph:r}=this.context;await r.focusElement(t.target.id,this.options.animation)});this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ts.forEach(r=>{t.on(`${r}:${nt.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Ts.forEach(r=>{t.off(`${r}:${nt.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}};A(Fp,"defaultOptions",{animation:{easing:"ease-in",duration:500},enable:!0});let mw=Fp;const $p=class $p extends Ar{constructor(t,r){super(t,Object.assign({},$p.defaultOptions,r));A(this,"isFrozen",!1);A(this,"toggleFrozen",t=>{this.isFrozen=t.type==="dragstart"});A(this,"hoverElement",t=>{if(!this.validate(t))return;const r=t.type===nt.POINTER_OVER;this.updateElementsState(t,r);const{onHover:i,onHoverEnd:a}=this.options;r?i==null||i(t):a==null||a(t)});A(this,"updateElementsState",(t,r)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:i}=this.context,{state:a,degree:s,animation:o,inactiveState:c}=this.options,{targetType:l,target:u}=t,h=s?NI(i,l,u.id,s):[u.id],f={};if(a&&Object.assign(f,this.getElementsState(h,a,r)),c){const d=EI(i.getData(),!0).filter(p=>!h.includes(p));Object.assign(f,this.getElementsState(d,c,r))}i.setElementState(f,o)});A(this,"getElementsState",(t,r,i)=>{const{graph:a}=this.context,s={};return t.forEach(o=>{const c=a.getElementState(o),l=i?[...c,r]:c.filter(u=>u!==r);s[o]=l}),s});this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ts.forEach(i=>{t.on(`${i}:${nt.POINTER_OVER}`,this.hoverElement),t.on(`${i}:${nt.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.addEventListener(`${nt.DRAG_START}`,this.toggleFrozen),r.addEventListener(`${nt.DRAG_END}`,this.toggleFrozen)}validate(t){if(this.destroyed||this.isFrozen)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Ts.forEach(i=>{t.off(`${i}:${nt.POINTER_OVER}`,this.hoverElement),t.off(`${i}:${nt.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.removeEventListener(`${nt.DRAG_START}`,this.toggleFrozen),r.removeEventListener(`${nt.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}};A($p,"defaultOptions",{animation:!1,enable:!0,degree:0,state:"active",inactiveState:void 0});let yw=$p;class KY extends qd{constructor(){super(...arguments);A(this,"points");A(this,"pathShape")}onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:r}=this.context;this.pathShape=new Yr({id:"g6-lasso-select",style:this.options.style}),r.appendChild(this.pathShape),this.points=[Gd(t)]}onPointerMove(t){var a;if(!this.points)return;const{immediately:r,mode:i}=this.options;this.points.push(Gd(t)),(a=this.pathShape)==null||a.setAttribute("d",UU(this.points)),r&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)==null||t.remove(),this.pathShape=void 0,this.points=void 0}}const zp=class zp extends Ar{constructor(t,r){super(t,Object.assign({},zp.defaultOptions,r));A(this,"isVisible",!0);A(this,"filterShapes",(t,r)=>t.filter(i=>i.className&&!(r!=null&&r.includes(i.className))));A(this,"setElementsVisibility",(t,r,i)=>{t.forEach(a=>{BI(a,r,i&&(s=>this.filterShapes(s,i)))})});A(this,"hideShapes",t=>{if(!this.validate(t)||!this.isVisible)return;const{element:r}=this.context,{shapes:i={}}=this.options;this.setElementsVisibility(r.getNodes(),"hidden",i.node),this.setElementsVisibility(r.getEdges(),"hidden",i.edge),this.setElementsVisibility(r.getCombos(),"hidden",i.combo),this.isVisible=!1});A(this,"showShapes",ch(t=>{if(!this.validate(t)||this.isVisible)return;const{element:r}=this.context;this.setElementsVisibility(r.getNodes(),"visible"),this.setElementsVisibility(r.getEdges(),"visible"),this.setElementsVisibility(r.getCombos(),"visible"),this.isVisible=!0},this.options.debounce));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(dt.BEFORE_TRANSFORM,this.hideShapes),t.on(dt.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(dt.BEFORE_TRANSFORM,this.hideShapes),t.off(dt.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};A(zp,"defaultOptions",{enable:!0,debounce:200,shapes:{node:["key"]}});let bw=zp;const jp=class jp extends Ar{constructor(t,r){super(t,Object.assign({},jp.defaultOptions,r));A(this,"shortcut");A(this,"onWheel",async t=>{t.preventDefault();const r=t.deltaX,i=t.deltaY;await this.scroll([-r,-i],t)});this.shortcut=new lc(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var r,i;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),ne(t)){(r=this.graphDom)==null||r.removeEventListener(nt.WHEEL,this.onWheel);const{up:a=[],down:s=[],left:o=[],right:c=[]}=t;this.shortcut.bind(a,l=>this.scroll([0,-10],l)),this.shortcut.bind(s,l=>this.scroll([0,10],l)),this.shortcut.bind(o,l=>this.scroll([-10,0],l)),this.shortcut.bind(c,l=>this.scroll([10,0],l))}else(i=this.graphDom)==null||i.addEventListener(nt.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement([t,r]){const{direction:i,sensitivity:a}=this.options;return t=t*a,r=r*a,i==="x"?r=0:i==="y"&&(t=0),[t,r]}async scroll(t,r){if(!this.validate(r))return;const{onFinish:i}=this.options,a=this.context.graph,s=this.formatDisplacement(t);await a.translateBy(s,!1),i==null||i()}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)==null||t.removeEventListener(nt.WHEEL,this.onWheel),super.destroy()}};A(jp,"defaultOptions",{enable:!0,sensitivity:1});let Ew=jp;const qp=class qp extends Ar{constructor(t,r){super(t,Object.assign({},qp.defaultOptions,r));A(this,"shortcut");A(this,"zoom",async(t,r,i)=>{if(!this.validate(r))return;const{graph:a}=this.context;let s;"viewport"in r&&(s=Vr(r.viewport));const{sensitivity:o,onFinish:c}=this.options,l=1+oe(t,-50,50)*o/100,u=a.getZoom();await a.zoomTo(u*l,i,s),c==null||c()});A(this,"onReset",async()=>{await this.context.graph.zoomTo(1,this.options.animation)});this.shortcut=new lc(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(this.shortcut.unbindAll(),me(t)&&(this.preventDefault(nt.WHEEL),this.shortcut.bind([...t,nt.WHEEL],r=>{const{deltaX:i,deltaY:a}=r;this.zoom(-(a??i),r,!1)})),ne(t)){const{zoomIn:r=[],zoomOut:i=[],reset:a=[]}=t;this.shortcut.bind(r,s=>this.zoom(10,s,this.options.animation)),this.shortcut.bind(i,s=>this.zoom(-10,s,this.options.animation)),this.shortcut.bind(a,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return ft(r)?r(t):!!r}preventDefault(t){const r=a=>a.preventDefault(),i=this.context.canvas.getContainer();i&&i.addEventListener(t,r)}destroy(){this.shortcut.destroy(),super.destroy()}};A(qp,"defaultOptions",{animation:{duration:200},enable:!0,sensitivity:1,trigger:[]});let xw=qp;function XY(n,e,t,r){return r===void 0&&(r="height"),t==="center"?(n[r]+e[r])/2:n.height}var Ga={assign:Object.assign,getHeight:XY},e5=Ga,cS=18,ZY=cS*2,LO=cS,QY={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||LO},getVGap:function(e){return e.vgap||LO},getChildren:function(e){return e.children},getHeight:function(e){return e.height||ZY},getWidth:function(e){var t=e.label||" ";return e.width||t.split("").length*cS}};function Xd(n,e){var t=this;if(t.vgap=t.hgap=0,n instanceof Xd)return n;t.data=n;var r=e.getHGap(n),i=e.getVGap(n);return t.preH=e.getPreH(n),t.preV=e.getPreV(n),t.width=e.getWidth(n),t.height=e.getHeight(n),t.width+=t.preH,t.height+=t.preV,t.id=e.getId(n),t.x=t.y=0,t.depth=0,t.children||(t.children=[]),t.addGap(r,i),t}e5.assign(Xd.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(e,t){var r=this;r.hgap+=e,r.vgap+=t,r.width+=2*e,r.height+=2*t},eachNode:function(e){for(var t=this,r=[t],i;i=r.shift();)e(i),r=i.children.concat(r)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t=this,r=[t],i;i=r.shift();)e(i),r=r.concat(i.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)}),e},translate:function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.eachNode(function(r){r.x+=e,r.y+=t,r.x+=r.preH,r.y+=r.preV})},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(r){r.x=r.x-(r.x-t.left)*2-r.width}),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(r){r.y=r.y-(r.y-t.top)*2-r.height}),e.translate(0,t.height)}});function JY(n,e,t){e===void 0&&(e={}),e=e5.assign({},QY,e);var r=new Xd(n,e),i=[r],a;if(!t&&!n.collapsed){for(;a=i.shift();)if(!a.data.collapsed){var s=e.getChildren(a.data),o=s?s.length:0;if(a.children=new Array(o),s&&o)for(var c=0;c<o;c++){var l=new Xd(s[c],e);a.children[c]=l,i.push(l),l.parent=a,l.depth=a.depth+1}}}return r}var n5=JY,tK=n5,eK=function(){function n(t,r){r===void 0&&(r={});var i=this;i.options=r,i.rootNode=tK(t,r)}var e=n.prototype;return e.execute=function(){throw new Error("please override this method")},n}(),Pg=eK;function hu(n,e,t,r){r===void 0&&(r=[]);var i=this;i.w=n||0,i.h=e||0,i.y=t||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}hu.fromNode=function(n,e){if(!n)return null;var t=[];return n.children.forEach(function(r){t.push(hu.fromNode(r,e))}),e?new hu(n.height,n.width,n.x,t):new hu(n.width,n.height,n.y,t)};function r5(n,e,t){t?n.y+=e:n.x+=e,n.children.forEach(function(r){r5(r,e,t)})}function i5(n,e){var t=e?n.y:n.x;return n.children.forEach(function(r){t=Math.min(i5(r,e),t)}),t}function nK(n,e){var t=i5(n,e);r5(n,-t,e)}function a5(n,e,t){t?e.y=n.x:e.x=n.x,n.c.forEach(function(r,i){a5(r,e.children[i],t)})}function s5(n,e,t){t===void 0&&(t=0),e?(n.x=t,t+=n.width):(n.y=t,t+=n.height),n.children.forEach(function(r){s5(r,e,t)})}var rK=function(n,e){e===void 0&&(e={});var t=e.isHorizontal;function r(y){if(y.cs===0){i(y);return}r(y.c[0]);for(var b=v(l(y.c[0].el),0,null),w=1;w<y.cs;++w){r(y.c[w]);var x=l(y.c[w].er);a(y,w,b),b=v(x,w,b)}f(y),i(y)}function i(y){y.cs===0?(y.el=y,y.er=y,y.msel=y.mser=0):(y.el=y.c[0].el,y.msel=y.c[0].msel,y.er=y.c[y.cs-1].er,y.mser=y.c[y.cs-1].mser)}function a(y,b,w){for(var x=y.c[b-1],S=x.mod,_=y.c[b],E=_.mod;x!==null&&_!==null;){l(x)>w.low&&(w=w.nxt);var P=S+x.prelim+x.w-(E+_.prelim);P>0&&(E+=P,s(y,b,w.index,P));var O=l(x),C=l(_);O<=C&&(x=c(x),x!==null&&(S+=x.mod)),O>=C&&(_=o(_),_!==null&&(E+=_.mod))}!x&&_?u(y,b,_,E):x&&!_&&h(y,b,x,S)}function s(y,b,w,x){y.c[b].mod+=x,y.c[b].msel+=x,y.c[b].mser+=x,p(y,b,w,x)}function o(y){return y.cs===0?y.tl:y.c[0]}function c(y){return y.cs===0?y.tr:y.c[y.cs-1]}function l(y){return y.y+y.h}function u(y,b,w,x){var S=y.c[0].el;S.tl=w;var _=x-w.mod-y.c[0].msel;S.mod+=_,S.prelim-=_,y.c[0].el=y.c[b].el,y.c[0].msel=y.c[b].msel}function h(y,b,w,x){var S=y.c[b].er;S.tr=w;var _=x-w.mod-y.c[b].mser;S.mod+=_,S.prelim-=_,y.c[b].er=y.c[b-1].er,y.c[b].mser=y.c[b-1].mser}function f(y){y.prelim=(y.c[0].prelim+y.c[0].mod+y.c[y.cs-1].mod+y.c[y.cs-1].prelim+y.c[y.cs-1].w)/2-y.w/2}function d(y,b){b+=y.mod,y.x=y.prelim+b,g(y);for(var w=0;w<y.cs;w++)d(y.c[w],b)}function p(y,b,w,x){if(w!==b-1){var S=b-w;y.c[w+1].shift+=x/S,y.c[b].shift-=x/S,y.c[b].change-=x-x/S}}function g(y){for(var b=0,w=0,x=0;x<y.cs;x++)b+=y.c[x].shift,w+=b+y.c[x].change,y.c[x].mod+=w}function v(y,b,w){for(;w!==null&&y>=w.low;)w=w.nxt;return{low:y,index:b,nxt:w}}s5(n,t);var m=hu.fromNode(n,t);return r(m),d(m,0),a5(m,n,t),nK(n,t),n},IO=n5,o5=function(n,e){for(var t=IO(n.data,e,!0),r=IO(n.data,e,!0),i=n.children.length,a=Math.round(i/2),s=e.getSide||function(u,h){return h<a?"right":"left"},o=0;o<i;o++){var c=n.children[o],l=s(c,o);l==="right"?r.children.push(c):t.children.push(c)}return t.eachNode(function(u){u.isRoot()||(u.side="left")}),r.eachNode(function(u){u.isRoot()||(u.side="right")}),{left:t,right:r}},iK=o5,la=["LR","RL","TB","BT","H","V"],aK=["LR","RL","H"],sK=function(e){return aK.indexOf(e)>-1},oK=la[0],lS=function(n,e,t){var r=e.direction||oK;if(e.isHorizontal=sK(r),r&&la.indexOf(r)===-1)throw new TypeError("Invalid direction: "+r);if(r===la[0])t(n,e);else if(r===la[1])t(n,e),n.right2left();else if(r===la[2])t(n,e);else if(r===la[3])t(n,e),n.bottom2top();else if(r===la[4]||r===la[5]){var i=iK(n,e),a=i.left,s=i.right;t(a,e),t(s,e),e.isHorizontal?a.right2left():a.bottom2top(),s.translate(a.x-s.x,a.y-s.y),n.x=a.x,n.y=s.y;var o=n.getBoundingBox();e.isHorizontal?o.top<0&&n.translate(0,-o.top):o.left<0&&n.translate(-o.left,0)}var c=e.fixedRoot;return c===void 0&&(c=!0),c&&n.translate(-(n.x+n.width/2+n.hgap),-(n.y+n.height/2+n.vgap)),n};function cK(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,ww(n,e)}function ww(n,e){return ww=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ww(n,e)}var lK=Pg,uK=rK,hK=lS,fK=Ga,dK=function(n){function e(){return n.apply(this,arguments)||this}cK(e,n);var t=e.prototype;return t.execute=function(){var i=this;return hK(i.rootNode,i.options,uK)},e}(lK),pK={};function gK(n,e){return e=fK.assign({},pK,e),new dK(n,e).execute()}var vK=gK,mK=Ga;function yK(n,e){e===void 0&&(e=[]);var t=this;t.x=t.y=0,t.leftChild=t.rightChild=null,t.height=0,t.children=e}var bK={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function c5(n,e,t){t?(e.x=n.x,e.y=n.y):(e.x=n.y,e.y=n.x),n.children.forEach(function(r,i){c5(r,e.children[i],t)})}var EK=function(n,e){e===void 0&&(e={}),e=mK.assign({},bK,e);var t=0;function r(c){if(!c)return null;c.width=0,c.depth&&c.depth>t&&(t=c.depth);var l=c.children,u=l.length,h=new yK(c.height,[]);return l.forEach(function(f,d){var p=r(f);h.children.push(p),d===0&&(h.leftChild=p),d===u-1&&(h.rightChild=p)}),h.originNode=c,h.isLeaf=c.isLeaf(),h}function i(c){if(c.isLeaf||c.children.length===0)c.drawingDepth=t;else{var l=c.children.map(function(h){return i(h)}),u=Math.min.apply(null,l);c.drawingDepth=u-1}return c.drawingDepth}var a;function s(c){c.x=c.drawingDepth*e.rankSep,c.isLeaf?(c.y=0,a&&(c.y=a.y+a.height+e.nodeSep,c.originNode.parent!==a.originNode.parent&&(c.y+=e.subTreeSep)),a=c):(c.children.forEach(function(l){s(l)}),c.y=(c.leftChild.y+c.rightChild.y)/2)}var o=r(n);return i(o),s(o),c5(o,n,e.isHorizontal),n};function xK(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Sw(n,e)}function Sw(n,e){return Sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Sw(n,e)}var wK=Pg,SK=EK,_K=lS,OK=Ga,PK=function(n){function e(){return n.apply(this,arguments)||this}xK(e,n);var t=e.prototype;return t.execute=function(){var i=this;return i.rootNode.width=0,_K(i.rootNode,i.options,SK)},e}(wK),CK={};function MK(n,e){return e=OK.assign({},CK,e),new PK(n,e).execute()}var TK=MK,BO=Ga;function AK(n,e,t,r,i){var a=typeof t=="function"?t(n):t*n.depth;if(!r)try{if(n.id===n.parent.children[0].id){n.x+=a,n.y=e?e.y:0;return}}catch{}if(n.x+=a,e){if(n.y=e.y+BO.getHeight(e,n,i),e.parent&&n.parent.id!==e.parent.id){var s=e.parent,o=s.y+BO.getHeight(s,n,i);n.y=o>n.y?o:n.y}}else n.y=0}var NK=function(n,e,t,r){var i=null;n.eachNode(function(a){AK(a,i,e,t,r),i=a})};function RK(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,_w(n,e)}function _w(n,e){return _w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},_w(n,e)}var kK=Pg,xf=NK,DK=o5,LK=Ga,fu=["LR","RL","H"],IK=fu[0],BK=function(n){function e(){return n.apply(this,arguments)||this}RK(e,n);var t=e.prototype;return t.execute=function(){var i=this,a=i.options,s=i.rootNode;a.isHorizontal=!0;var o=a.indent,c=o===void 0?20:o,l=a.dropCap,u=l===void 0?!0:l,h=a.direction,f=h===void 0?IK:h,d=a.align;if(f&&fu.indexOf(f)===-1)throw new TypeError("Invalid direction: "+f);if(f===fu[0])xf(s,c,u,d);else if(f===fu[1])xf(s,c,u,d),s.right2left();else if(f===fu[2]){var p=DK(s,a),g=p.left,v=p.right;xf(g,c,u,d),g.right2left(),xf(v,c,u,d);var m=g.getBoundingBox();v.translate(m.width,0),s.x=v.x-s.width/2}return s},e}(kK),FK={};function $K(n,e){return e=LK.assign({},FK,e),new BK(n,e).execute()}var zK=$K,jK=Ga;function l5(n,e){var t=0;return n.children.length?n.children.forEach(function(r){t+=l5(r,e)}):t=n.height,n._subTreeSep=e.getSubTreeSep(n.data),n.totalHeight=Math.max(n.height,t)+2*n._subTreeSep,n.totalHeight}function u5(n){var e=n.children,t=e.length;if(t){e.forEach(function(c){u5(c)});var r=e[0],i=e[t-1],a=i.y-r.y+i.height,s=0;if(e.forEach(function(c){s+=c.totalHeight}),a>n.height)n.y=r.y+a/2-n.height/2;else if(e.length!==1||n.height>s){var o=n.y+(n.height-a)/2-r.y;e.forEach(function(c){c.translate(0,o)})}else n.y=(r.y+r.height/2+i.y+i.height/2)/2-n.height/2}}var qK={getSubTreeSep:function(){return 0}},GK=function(n,e){e===void 0&&(e={}),e=jK.assign({},qK,e),n.parent={x:0,width:0,height:0,y:0},n.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),n.parent=null,l5(n,e),n.startY=0,n.y=n.totalHeight/2-n.height/2,n.eachNode(function(t){var r=t.children,i=r.length;if(i){var a=r[0];if(a.startY=t.startY+t._subTreeSep,i===1)a.y=t.y+t.height/2-a.height/2;else{a.y=a.startY+a.totalHeight/2-a.height/2;for(var s=1;s<i;s++){var o=r[s];o.startY=r[s-1].startY+r[s-1].totalHeight,o.y=o.startY+o.totalHeight/2-o.height/2}}}}),u5(n)};function VK(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Ow(n,e)}function Ow(n,e){return Ow=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Ow(n,e)}var WK=Pg,HK=GK,UK=lS,YK=Ga,KK=function(n){function e(){return n.apply(this,arguments)||this}VK(e,n);var t=e.prototype;return t.execute=function(){var i=this;return UK(i.rootNode,i.options,HK)},e}(WK),XK={};function ZK(n,e){return e=YK.assign({},XK,e),new KK(n,e).execute()}var QK=ZK,JK={compactBox:vK,dendrogram:TK,indented:zK,mindmap:QK},du=JK;const tX=(n,e)=>{if(n!=="next"&&n!=="prev")return e},FO=n=>{n.prev.next=n.next,n.next.prev=n.prev,delete n.next,delete n.prev};let eX=class{constructor(){const e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){const e=this.shortcut,t=e.prev;if(t&&t!==e)return FO(t),t}enqueue(e){const t=this.shortcut;e.prev&&e.next&&FO(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){const e=[],t=this.shortcut;let r=t.prev;for(;r!==t;)e.push(JSON.stringify(r,tX)),r=r==null?void 0:r.prev;return`[${e.join(", ")}]`}},nX=class extends eX{};const rX=()=>1,iX=(n,e)=>{var t;if(n.getAllNodes().length<=1)return[];const r=sX(n,e||rX);return(t=aX(r.graph,r.buckets,r.zeroIdx).map(a=>n.getRelatedEdges(a.v,"out").filter(({target:s})=>s===a.w)))===null||t===void 0?void 0:t.flat()},aX=(n,e,t)=>{let r=[];const i=e[e.length-1],a=e[0];let s;for(;n.getAllNodes().length;){for(;s=a.dequeue();)Iv(n,e,t,s);for(;s=i.dequeue();)Iv(n,e,t,s);if(n.getAllNodes().length){for(let o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){r=r.concat(Iv(n,e,t,s,!0));break}}}return r},Iv=(n,e,t,r,i)=>{var a,s;const o=[];return n.hasNode(r.v)&&((a=n.getRelatedEdges(r.v,"in"))===null||a===void 0||a.forEach(c=>{const l=c.data.weight,u=n.getNode(c.source);i&&o.push({v:c.source,w:c.target,in:0,out:0}),u.data.out===void 0&&(u.data.out=0),u.data.out-=l,Pw(e,t,Object.assign({v:u.id},u.data))}),(s=n.getRelatedEdges(r.v,"out"))===null||s===void 0||s.forEach(c=>{const l=c.data.weight,u=c.target,h=n.getNode(u);h.data.in===void 0&&(h.data.in=0),h.data.in-=l,Pw(e,t,Object.assign({v:h.id},h.data))}),n.removeNode(r.v)),i?o:void 0},sX=(n,e)=>{const t=new qe;let r=0,i=0;n.getAllNodes().forEach(c=>{t.addNode({id:c.id,data:{v:c.id,in:0,out:0}})}),n.getAllEdges().forEach(c=>{const l=t.getRelatedEdges(c.source,"out").find(h=>h.target===c.target),u=(e==null?void 0:e(c))||1;l?t.updateEdgeData(l==null?void 0:l.id,Object.assign(Object.assign({},l.data),{weight:l.data.weight+u})):t.addEdge({id:c.id,source:c.source,target:c.target,data:{weight:u}}),i=Math.max(i,t.getNode(c.source).data.out+=u),r=Math.max(r,t.getNode(c.target).data.in+=u)});const a=[],s=i+r+3;for(let c=0;c<s;c++)a.push(new nX);const o=r+1;return t.getAllNodes().forEach(c=>{Pw(a,o,Object.assign({v:c.id},t.getNode(c.id).data))}),{buckets:a,zeroIdx:o,graph:t}},Pw=(n,e,t)=>{t.out?t.in?n[t.out-t.in+e].enqueue(t):n[n.length-1].enqueue(t):n[0].enqueue(t)},oX=(n,e)=>{const r=e==="greedy"?iX(n,(i=>a=>a.data.weight||1)()):cX(n);r==null||r.forEach(i=>{const a=i.data;n.removeEdge(i.id),a.forwardName=i.data.name,a.reversed=!0,n.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},a)})})},cX=n=>{const e=[],t={},r={},i=a=>{r[a]||(r[a]=!0,t[a]=!0,n.getRelatedEdges(a,"out").forEach(s=>{t[s.target]?e.push(s):i(s.target)}),delete t[a])};return n.getAllNodes().forEach(a=>i(a.id)),e},lX=n=>{n.getAllEdges().forEach(e=>{const t=e.data;if(t.reversed){n.removeEdge(e.id);const r=t.forwardName;delete t.reversed,delete t.forwardName,n.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},t),{forwardName:r})})}})},uX=(n,e)=>Number(n)-Number(e),fc=(n,e,t,r)=>{let i;do i=`${r}${Math.random()}`;while(n.hasNode(i));return t.dummy=e,n.addNode({id:i,data:t}),i},hX=n=>{const e=new qe;return n.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),n.getAllEdges().forEach(t=>{const r=e.getRelatedEdges(t.source,"out").find(i=>i.target===t.target);r?e.updateEdgeData(r==null?void 0:r.id,Object.assign(Object.assign({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e},h5=n=>{const e=new qe;return n.getAllNodes().forEach(t=>{n.getChildren(t.id).length||e.addNode(Object.assign({},t))}),n.getAllEdges().forEach(t=>{e.addEdge(t)}),e},fX=(n,e)=>n==null?void 0:n.reduce((t,r,i)=>(t[r]=e[i],t),{}),$O=(n,e)=>{const t=Number(n.x),r=Number(n.y),i=Number(e.x)-t,a=Number(e.y)-r;let s=Number(n.width)/2,o=Number(n.height)/2;if(!i&&!a)return{x:0,y:0};let c,l;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),c=o*i/a,l=o):(i<0&&(s=-s),c=s,l=s*a/i),{x:t+c,y:r+l}},Vu=n=>{const e=[],t=f5(n)+1;for(let r=0;r<t;r++)e.push([]);n.getAllNodes().forEach(r=>{const i=r.data.rank;i!==void 0&&e[i]&&e[i].push(r.id)});for(let r=0;r<t;r++)e[r]=e[r].sort((i,a)=>uX(n.getNode(i).data.order,n.getNode(a).data.order));return e},dX=n=>{const e=n.getAllNodes().filter(r=>r.data.rank!==void 0).map(r=>r.data.rank),t=Math.min(...e);n.getAllNodes().forEach(r=>{r.data.hasOwnProperty("rank")&&t!==1/0&&(r.data.rank-=t)})},pX=(n,e=0)=>{const t=n.getAllNodes(),r=t.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...r),a=[];t.forEach(o=>{const c=(o.data.rank||0)-i;a[c]||(a[c]=[]),a[c].push(o.id)});let s=0;for(let o=0;o<a.length;o++){const c=a[o];c===void 0?o%e!==0&&(s-=1):s&&(c==null||c.forEach(l=>{const u=n.getNode(l);u&&(u.data.rank=u.data.rank||0,u.data.rank+=s)}))}},zO=(n,e,t,r)=>{const i={width:0,height:0};return rt(t)&&rt(r)&&(i.rank=t,i.order=r),fc(n,"border",i,e)},f5=n=>{let e;return n.getAllNodes().forEach(t=>{const r=t.data.rank;r!==void 0&&(e===void 0||r>e)&&(e=r)}),e||(e=0),e},gX=(n,e)=>{const t={lhs:[],rhs:[]};return n==null||n.forEach(r=>{e(r)?t.lhs.push(r):t.rhs.push(r)}),t},uS=(n,e)=>n.reduce((t,r)=>{const i=e(t),a=e(r);return i>a?r:t}),d5=(n,e,t,r,i,a)=>{r.includes(e.id)||(r.push(e.id),t||a.push(e.id),i(e.id).forEach(s=>d5(n,s,t,r,i,a)),t&&a.push(e.id))},p5=(n,e,t,r)=>{const i=Array.isArray(e)?e:[e],a=c=>n.getNeighbors(c),s=[],o=[];return i.forEach(c=>{if(n.hasNode(c.id))d5(n,c,t==="post",o,a,s);else throw new Error(`Graph does not have node: ${c}`)}),s},vX=n=>{const e=t=>{const r=n.getChildren(t),i=n.getNode(t);if(r!=null&&r.length&&r.forEach(a=>e(a.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let a=i.data.minRank,s=i.data.maxRank+1;a<s;a+=1)jO(n,"borderLeft","_bl",t,i,a),jO(n,"borderRight","_br",t,i,a)}};n.getRoots().forEach(t=>e(t.id))},jO=(n,e,t,r,i,a)=>{const s={rank:a,borderType:e,width:0,height:0},o=i.data[e][a-1],c=fc(n,"border",s,t);i.data[e][a]=c,n.setParent(c,r),o&&n.addEdge({id:`e${Math.random()}`,source:o,target:c,data:{weight:1}})},mX=(n,e)=>{const t=e.toLowerCase();(t==="lr"||t==="rl")&&g5(n)},yX=(n,e)=>{const t=e.toLowerCase();(t==="bt"||t==="rl")&&bX(n),(t==="lr"||t==="rl")&&(EX(n),g5(n))},g5=n=>{n.getAllNodes().forEach(e=>{qO(e)}),n.getAllEdges().forEach(e=>{qO(e)})},qO=n=>{const e=n.data.width;n.data.width=n.data.height,n.data.height=e},bX=n=>{n.getAllNodes().forEach(e=>{Bv(e.data)}),n.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(r=>Bv(r)),e.data.hasOwnProperty("y")&&Bv(e.data)})},Bv=n=>{n!=null&&n.y&&(n.y=-n.y)},EX=n=>{n.getAllNodes().forEach(e=>{Fv(e.data)}),n.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(r=>Fv(r)),e.data.hasOwnProperty("x")&&Fv(e.data)})},Fv=n=>{const e=n.x;n.x=n.y,n.y=e},xX=n=>{const e=fc(n,"root",{},"_root"),t=wX(n);let r=Math.max(...Object.values(t));Math.abs(r)===1/0&&(r=1);const i=r-1,a=2*i+1;n.getAllEdges().forEach(o=>{o.data.minlen*=a});const s=SX(n)+1;return n.getRoots().forEach(o=>{v5(n,e,a,s,i,t,o.id)}),{nestingRoot:e,nodeRankFactor:a}},v5=(n,e,t,r,i,a,s)=>{const o=n.getChildren(s);if(!(o!=null&&o.length)){s!==e&&n.addEdge({id:`e${Math.random()}`,source:e,target:s,data:{weight:0,minlen:t}});return}const c=zO(n,"_bt"),l=zO(n,"_bb"),u=n.getNode(s);n.setParent(c,s),u.data.borderTop=c,n.setParent(l,s),u.data.borderBottom=l,o==null||o.forEach(h=>{v5(n,e,t,r,i,a,h.id);const f=h.data.borderTop?h.data.borderTop:h.id,d=h.data.borderBottom?h.data.borderBottom:h.id,p=h.data.borderTop?r:2*r,g=f!==d?1:i-a[s]+1;n.addEdge({id:`e${Math.random()}`,source:c,target:f,data:{minlen:g,weight:p,nestingEdge:!0}}),n.addEdge({id:`e${Math.random()}`,source:d,target:l,data:{minlen:g,weight:p,nestingEdge:!0}})}),n.getParent(s)||n.addEdge({id:`e${Math.random()}`,source:e,target:c,data:{weight:0,minlen:i+a[s]}})},wX=n=>{const e={},t=(r,i)=>{const a=n.getChildren(r);a==null||a.forEach(s=>t(s.id,i+1)),e[r]=i};return n.getRoots().forEach(r=>t(r.id,1)),e},SX=n=>{let e=0;return n.getAllEdges().forEach(t=>{e+=t.data.weight}),e},_X=(n,e)=>{e&&n.removeNode(e),n.getAllEdges().forEach(t=>{t.data.nestingEdge&&n.removeEdge(t.id)})},OX="edge",m5="edge-label",PX=(n,e)=>{n.getAllEdges().forEach(t=>CX(n,t,e))},CX=(n,e,t)=>{let r=e.source,i=n.getNode(r).data.rank;const a=e.target,s=n.getNode(a).data.rank,o=e.data.labelRank;if(s===i+1)return;n.removeEdge(e.id);let c,l,u;for(u=0,++i;i<s;++u,++i)e.data.points=[],l={originalEdge:e,width:0,height:0,rank:i},c=fc(n,OX,l,"_d"),i===o&&(l.width=e.data.width,l.height=e.data.height,l.dummy=m5,l.labelpos=e.data.labelpos),n.addEdge({id:`e${Math.random()}`,source:r,target:c,data:{weight:e.data.weight}}),u===0&&t.push(c),r=c;n.addEdge({id:`e${Math.random()}`,source:r,target:a,data:{weight:e.data.weight}})},MX=(n,e)=>{e.forEach(t=>{let r=n.getNode(t);const{data:i}=r,a=i.originalEdge;let s;a&&n.addEdge(a);let o=t;for(;r.data.dummy;)s=n.getSuccessors(o)[0],n.removeNode(o),a.data.points.push({x:r.data.x,y:r.data.y}),r.data.dummy===m5&&(a.data.x=r.data.x,a.data.y=r.data.y,a.data.width=r.data.width,a.data.height=r.data.height),o=s.id,r=n.getNode(o)})},TX=(n,e,t)=>{const r={};let i;t==null||t.forEach(a=>{let s=n.getParent(a),o,c;for(;s;){if(o=n.getParent(s.id),o?(c=r[o.id],r[o.id]=s.id):(c=i,i=s.id),c&&c!==s.id){e.hasNode(c)||e.addNode({id:c,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),e.hasEdge(`e${c}-${s.id}`)||e.addEdge({id:`e${c}-${s.id}`,source:c,target:s.id,data:{}});return}s=o}})},AX=(n,e,t)=>{const r=NX(n),i=new qe({tree:[{id:r,children:[],data:{}}]});return n.getAllNodes().forEach(a=>{const s=n.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),s!=null&&s.id&&!i.hasNode(s==null?void 0:s.id)&&i.addNode(Object.assign({},s)),i.setParent(a.id,(s==null?void 0:s.id)||r),n.getRelatedEdges(a.id,t).forEach(o=>{const c=o.source===a.id?o.target:o.source;i.hasNode(c)||i.addNode(Object.assign({},n.getNode(c)));const l=i.getRelatedEdges(c,"out").find(({target:h})=>h===a.id),u=l!==void 0?l.data.weight:0;l?i.updateEdgeData(l.id,Object.assign(Object.assign({},l.data),{weight:o.data.weight+u})):i.addEdge({id:o.id,source:c,target:a.id,data:{weight:o.data.weight+u}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))}),i},NX=n=>{let e;for(;n.hasNode(e=`_root${Math.random()}`););return e},RX=(n,e,t)=>{const r=fX(t,t.map((u,h)=>h)),a=e.map(u=>{const h=n.getRelatedEdges(u,"out").map(f=>({pos:r[f.target]||0,weight:f.data.weight}));return h==null?void 0:h.sort((f,d)=>f.pos-d.pos)}).flat().filter(u=>u!==void 0);let s=1;for(;s<t.length;)s<<=1;const o=2*s-1;s-=1;const c=Array(o).fill(0,0,o);let l=0;return a==null||a.forEach(u=>{if(u){let h=u.pos+s;c[h]+=u.weight;let f=0;for(;h>0;)h%2&&(f+=c[h+1]),h=h-1>>1,c[h]+=u.weight;l+=u.weight*f}}),l},GO=(n,e)=>{let t=0;for(let r=1;r<(e==null?void 0:e.length);r+=1)t+=RX(n,e[r-1],e[r]);return t},VO=n=>{const e={},t=n.getAllNodes(),r=t.map(l=>{var u;return(u=l.data.rank)!==null&&u!==void 0?u:-1/0}),i=Math.max(...r),a=[];for(let l=0;l<i+1;l++)a.push([]);const s=t.sort((l,u)=>n.getNode(l.id).data.rank-n.getNode(u.id).data.rank),c=s.filter(l=>n.getNode(l.id).data.fixorder!==void 0).sort((l,u)=>n.getNode(l.id).data.fixorder-n.getNode(u.id).data.fixorder);return c==null||c.forEach(l=>{isNaN(n.getNode(l.id).data.rank)||a[n.getNode(l.id).data.rank].push(l.id),e[l.id]=!0}),s==null||s.forEach(l=>n.dfsTree(l.id,u=>{if(e.hasOwnProperty(u.id))return!0;e[u.id]=!0,isNaN(u.data.rank)||a[u.data.rank].push(u.id)})),a},kX=(n,e)=>e.map(t=>{const r=n.getRelatedEdges(t,"in");if(!(r!=null&&r.length))return{v:t};const i={sum:0,weight:0};return r==null||r.forEach(a=>{const s=n.getNode(a.source);i.sum+=a.data.weight*s.data.order,i.weight+=a.data.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}),DX=(n,e)=>{var t,r,i;const a={};n==null||n.forEach((o,c)=>{a[o.v]={i:c,indegree:0,in:[],out:[],vs:[o.v]};const l=a[o.v];o.barycenter!==void 0&&(l.barycenter=o.barycenter,l.weight=o.weight)}),(t=e.getAllEdges())===null||t===void 0||t.forEach(o=>{const c=a[o.source],l=a[o.target];c!==void 0&&l!==void 0&&(l.indegree++,c.out.push(a[o.target]))});const s=(i=(r=Object.values(a)).filter)===null||i===void 0?void 0:i.call(r,o=>!o.indegree);return LX(s)},LX=n=>{var e,t;const r=[],i=c=>l=>{l.merged||(l.barycenter===void 0||c.barycenter===void 0||l.barycenter>=c.barycenter)&&IX(c,l)},a=c=>l=>{l.in.push(c),--l.indegree===0&&n.push(l)};for(;n!=null&&n.length;){const c=n.pop();r.push(c),(e=c.in.reverse())===null||e===void 0||e.forEach(l=>i(c)(l)),(t=c.out)===null||t===void 0||t.forEach(l=>a(c)(l))}const s=r.filter(c=>!c.merged),o=["vs","i","barycenter","weight"];return s.map(c=>{const l={};return o==null||o.forEach(u=>{c[u]!==void 0&&(l[u]=c[u])}),l})},IX=(n,e)=>{var t;let r=0,i=0;n.weight&&(r+=n.barycenter*n.weight,i+=n.weight),e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),n.vs=(t=e.vs)===null||t===void 0?void 0:t.concat(n.vs),n.barycenter=r/i,n.weight=i,n.i=Math.min(e.i,n.i),e.merged=!0},BX=(n,e,t,r)=>{const i=gX(n,f=>{const d=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return r?!d&&f.hasOwnProperty("barycenter"):d||f.hasOwnProperty("barycenter")}),a=i.lhs,s=i.rhs.sort((f,d)=>-f.i- -d.i),o=[];let c=0,l=0,u=0;a==null||a.sort(FX(!!e,!!t)),u=WO(o,s,u),a==null||a.forEach(f=>{var d;u+=(d=f.vs)===null||d===void 0?void 0:d.length,o.push(f.vs),c+=f.barycenter*f.weight,l+=f.weight,u=WO(o,s,u)});const h={vs:o.flat()};return l&&(h.barycenter=c/l,h.weight=l),h},WO=(n,e,t)=>{let r=t,i;for(;e.length&&(i=e[e.length-1]).i<=r;)e.pop(),n==null||n.push(i.vs),r++;return r},FX=(n,e)=>(t,r)=>{if(t.fixorder!==void 0&&r.fixorder!==void 0)return t.fixorder-r.fixorder;if(t.barycenter<r.barycenter)return-1;if(t.barycenter>r.barycenter)return 1;if(e&&t.order!==void 0&&r.order!==void 0){if(t.order<r.order)return-1;if(t.order>r.order)return 1}return n?r.i-t.i:t.i-r.i},y5=(n,e,t,r,i,a)=>{var s,o,c,l;let u=n.getChildren(e).map(y=>y.id);const h=n.getNode(e),f=h?h.data.borderLeft:void 0,d=h?h.data.borderRight:void 0,p={};f&&(u=u==null?void 0:u.filter(y=>y!==f&&y!==d));const g=kX(n,u||[]);g==null||g.forEach(y=>{var b;if(!((b=n.getChildren(y.v))===null||b===void 0)&&b.length){const w=y5(n,y.v,t,r,a);p[y.v]=w,w.hasOwnProperty("barycenter")&&zX(y,w)}});const v=DX(g,t);$X(v,p),(s=v.filter(y=>y.vs.length>0))===null||s===void 0||s.forEach(y=>{const b=n.getNode(y.vs[0]);b&&(y.fixorder=b.data.fixorder,y.order=b.data.order)});const m=BX(v,r,i,a);if(f&&(m.vs=[f,m.vs,d].flat(),!((o=n.getPredecessors(f))===null||o===void 0)&&o.length)){const y=n.getNode(((c=n.getPredecessors(f))===null||c===void 0?void 0:c[0].id)||""),b=n.getNode(((l=n.getPredecessors(d))===null||l===void 0?void 0:l[0].id)||"");m.hasOwnProperty("barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+y.data.order+b.data.order)/(m.weight+2),m.weight+=2}return m},$X=(n,e)=>{n==null||n.forEach(t=>{var r;const i=(r=t.vs)===null||r===void 0?void 0:r.map(a=>e[a]?e[a].vs:a);t.vs=i.flat()})},zX=(n,e)=>{n.barycenter!==void 0?(n.barycenter=(n.barycenter*n.weight+e.barycenter*e.weight)/(n.weight+e.weight),n.weight+=e.weight):(n.barycenter=e.barycenter,n.weight=e.weight)},jX=(n,e)=>{const t=f5(n),r=[],i=[];for(let u=1;u<t+1;u++)r.push(u);for(let u=t-1;u>-1;u--)i.push(u);const a=HO(n,r,"in"),s=HO(n,i,"out");let o=VO(n);$v(n,o);let c=Number.POSITIVE_INFINITY,l;for(let u=0,h=0;h<4;++u,++h){UO(u%2?a:s,u%4>=2,!1,e),o=Vu(n);const f=GO(n,o);f<c&&(h=0,l=_s(o),c=f)}o=VO(n),$v(n,o);for(let u=0,h=0;h<4;++u,++h){UO(u%2?a:s,u%4>=2,!0,e),o=Vu(n);const f=GO(n,o);f<c&&(h=0,l=_s(o),c=f)}$v(n,l)},HO=(n,e,t)=>e.map(r=>AX(n,r,t)),UO=(n,e,t,r)=>{const i=new qe;n==null||n.forEach(a=>{var s;const o=a.getRoots()[0].id,c=y5(a,o,i,e,t,r);for(let l=0;l<((s=c.vs)===null||s===void 0?void 0:s.length);l++){const u=a.getNode(c.vs[l]);u&&(u.data.order=l)}TX(a,i,c.vs)})},$v=(n,e)=>{e==null||e.forEach(t=>{t==null||t.forEach((r,i)=>{n.getNode(r).data.order=i})})},qX=(n,e)=>{const r=n.getAllNodes().filter(s=>{var o;return!(!((o=n.getChildren(s.id))===null||o===void 0)&&o.length)}).map(s=>s.data.rank),i=Math.max(...r),a=[];for(let s=0;s<i+1;s++)a[s]=[];e==null||e.forEach(s=>{const o=n.getNode(s);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=a[o.data.rank].length,a[o.data.rank].push(s))})},GX=n=>{const e={};let t=0;const r=i=>{const a=t;n.getChildren(i).forEach(s=>r(s.id)),e[i]={low:a,lim:t++}};return n.getRoots().forEach(i=>r(i.id)),e},VX=(n,e,t,r)=>{var i,a;const s=[],o=[],c=Math.min(e[t].low,e[r].low),l=Math.max(e[t].lim,e[r].lim);let u,h;u=t;do u=(i=n.getParent(u))===null||i===void 0?void 0:i.id,s.push(u);while(u&&(e[u].low>c||l>e[u].lim));for(h=u,u=r;u&&u!==h;)o.push(u),u=(a=n.getParent(u))===null||a===void 0?void 0:a.id;return{lca:h,path:s.concat(o.reverse())}},WX=(n,e)=>{const t=GX(n);e.forEach(r=>{var i,a;let s=r,o=n.getNode(s);const c=o.data.originalEdge;if(!c)return;const l=VX(n,t,c.source,c.target),u=l.path,h=l.lca;let f=0,d=u[f],p=!0;for(;s!==c.target;){if(o=n.getNode(s),p){for(;d!==h&&((i=n.getNode(d))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)f++,d=u[f];d===h&&(p=!1)}if(!p){for(;f<u.length-1&&((a=n.getNode(u[f+1]))===null||a===void 0?void 0:a.data.minRank)<=o.data.rank;)f++;d=u[f]}n.hasNode(d)&&n.setParent(s,d),s=n.getSuccessors(s)[0].id}})},HX=(n,e)=>{const t={},r=(i,a)=>{let s=0,o=0;const c=i.length,l=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((u,h)=>{var f;const d=YX(n,u),p=d?n.getNode(d.id).data.order:c;(d||u===l)&&((f=a.slice(o,h+1))===null||f===void 0||f.forEach(g=>{var v;(v=n.getPredecessors(g))===null||v===void 0||v.forEach(m=>{var y;const b=n.getNode(m.id),w=b.data.order;(w<s||p<w)&&!(b.data.dummy&&(!((y=n.getNode(g))===null||y===void 0)&&y.data.dummy))&&b5(t,m.id,g)})}),o=h+1,s=p)}),a};return e!=null&&e.length&&e.reduce(r),t},UX=(n,e)=>{const t={};function r(o,c,l,u,h){var f,d;let p;for(let g=c;g<l;g++)p=o[g],!((f=n.getNode(p))===null||f===void 0)&&f.data.dummy&&((d=n.getPredecessors(p))===null||d===void 0||d.forEach(v=>{const m=n.getNode(v.id);m.data.dummy&&(m.data.order<u||m.data.order>h)&&b5(t,v.id,p)}))}function i(o){return JSON.stringify(o.slice(1))}function a(o,c){const l=i(o);c.get(l)||(r(...o),c.set(l,!0))}const s=(o,c)=>{let l=-1,u,h=0;const f=new Map;return c==null||c.forEach((d,p)=>{var g;if(((g=n.getNode(d))===null||g===void 0?void 0:g.data.dummy)==="border"){const v=n.getPredecessors(d)||[];v.length&&(u=n.getNode(v[0].id).data.order,a([c,h,p,l,u],f),h=p,l=u)}a([c,h,c.length,u,o.length],f)}),c};return e!=null&&e.length&&e.reduce(s),t},YX=(n,e)=>{var t,r;if(!((t=n.getNode(e))===null||t===void 0)&&t.data.dummy)return(r=n.getPredecessors(e))===null||r===void 0?void 0:r.find(i=>n.getNode(i.id).data.dummy)},b5=(n,e,t)=>{let r=e,i=t;if(r>i){const s=r;r=i,i=s}let a=n[r];a||(n[r]=a={}),a[i]=!0},KX=(n,e,t)=>{let r=e,i=t;if(r>i){const a=e;r=i,i=a}return!!n[r]},XX=(n,e,t,r)=>{const i={},a={},s={};return e==null||e.forEach(o=>{o==null||o.forEach((c,l)=>{i[c]=c,a[c]=c,s[c]=l})}),e==null||e.forEach(o=>{let c=-1;o==null||o.forEach(l=>{let u=r(l).map(h=>h.id);if(u.length){u=u.sort((f,d)=>s[f]-s[d]);const h=(u.length-1)/2;for(let f=Math.floor(h),d=Math.ceil(h);f<=d;++f){const p=u[f];a[l]===l&&c<s[p]&&!KX(t,l,p)&&(a[p]=l,a[l]=i[l]=i[p],c=s[p])}}})}),{root:i,align:a}},ZX=(n,e,t,r,i,a,s)=>{var o;const c={},l=QX(n,e,t,i,a,s),u=s?"borderLeft":"borderRight",h=(p,g)=>{let v=l.getAllNodes(),m=v.pop();const y={};for(;m;)y[m.id]?p(m.id):(y[m.id]=!0,v.push(m),v=v.concat(g(m.id))),m=v.pop()},f=p=>{c[p]=(l.getRelatedEdges(p,"in")||[]).reduce((g,v)=>Math.max(g,(c[v.source]||0)+v.data.weight),0)},d=p=>{const g=(l.getRelatedEdges(p,"out")||[]).reduce((m,y)=>Math.min(m,(c[y.target]||0)-y.data.weight),Number.POSITIVE_INFINITY),v=n.getNode(p);g!==Number.POSITIVE_INFINITY&&v.data.borderType!==u&&(c[p]=Math.max(c[p],g))};return h(f,l.getPredecessors.bind(l)),h(d,l.getSuccessors.bind(l)),(o=Object.values(r))===null||o===void 0||o.forEach(p=>{c[p]=c[t[p]]}),c},QX=(n,e,t,r,i,a)=>{const s=new qe,o=nZ(r,i,a);return e==null||e.forEach(c=>{let l;c==null||c.forEach(u=>{const h=t[u];if(s.hasNode(h)||s.addNode({id:h,data:{}}),l){const f=t[l],d=s.getRelatedEdges(f,"out").find(p=>p.target===h);d?s.updateEdgeData(d.id,Object.assign(Object.assign({},d.data),{weight:Math.max(o(n,u,l),d.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:f,target:h,data:{weight:Math.max(o(n,u,l),0)}})}l=u})}),s},JX=(n,e)=>uS(Object.values(e),t=>{var r;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(r=Object.keys(t))===null||r===void 0||r.forEach(s=>{const o=t[s],c=rZ(n,s)/2;i=Math.max(o+c,i),a=Math.min(o-c,a)}),i-a});function tZ(n,e){const t=Object.values(e),r=Math.min(...t),i=Math.max(...t);["u","d"].forEach(a=>{["l","r"].forEach(s=>{const o=a+s,c=n[o];let l;if(c===e)return;const u=Object.values(c);l=s==="l"?r-Math.min(...u):i-Math.max(...u),l&&(n[o]={},Object.keys(c).forEach(h=>{n[o][h]=c[h]+l}))})})}const eZ=(n,e)=>{const t={};return Object.keys(n.ul).forEach(r=>{if(e)t[r]=n[e.toLowerCase()][r];else{const i=Object.values(n).map(a=>a[r]);t[r]=(i[0]+i[1])/2}}),t},nZ=(n,e,t)=>(r,i,a)=>{const s=r.getNode(i),o=r.getNode(a);let c=0,l=0;if(c+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":l=-s.data.width/2;break;case"r":l=s.data.width/2;break}if(l&&(c+=t?l:-l),l=0,c+=(s.data.dummy?e:n)/2,c+=(o.data.dummy?e:n)/2,c+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":l=o.data.width/2;break;case"r":l=-o.data.width/2;break}return l&&(c+=t?l:-l),l=0,c},rZ=(n,e)=>n.getNode(e).data.width||0,iZ=(n,e)=>{const{ranksep:t=0}=e||{},r=Vu(n);let i=0;r==null||r.forEach(a=>{const s=a.map(c=>n.getNode(c).data.height),o=Math.max(...s,0);a==null||a.forEach(c=>{n.getNode(c).data.y=i+o/2}),i+=o+t})},aZ=(n,e)=>{const{align:t,nodesep:r=0,edgesep:i=0}=e||{},a=Vu(n),s=Object.assign(HX(n,a),UX(n,a)),o={};let c=[];["u","d"].forEach(u=>{c=u==="u"?a:Object.values(a).reverse(),["l","r"].forEach(h=>{h==="r"&&(c=c.map(g=>Object.values(g).reverse()));const f=(u==="u"?n.getPredecessors:n.getSuccessors).bind(n),d=XX(n,c,s,f),p=ZX(n,c,d.root,d.align,r,i,h==="r");h==="r"&&Object.keys(p).forEach(g=>p[g]=-p[g]),o[u+h]=p})});const l=JX(n,o);return l&&tZ(o,l),eZ(o,t)},sZ=(n,e)=>{var t;const r=h5(n);iZ(r,e);const i=aZ(r,e);(t=Object.keys(i))===null||t===void 0||t.forEach(a=>{r.getNode(a).data.x=i[a]})},E5=n=>{const e={},t=r=>{var i;const a=n.getNode(r);if(!a)return 0;if(e[r])return a.data.rank;e[r]=!0;let s;return(i=n.getRelatedEdges(r,"out"))===null||i===void 0||i.forEach(o=>{const c=t(o.target),l=o.data.minlen,u=c-l;u&&(s===void 0||u<s)&&(s=u)}),s||(s=0),a.data.rank=s,s};n.getAllNodes().filter(r=>n.getRelatedEdges(r.id,"in").length===0).forEach(r=>t(r.id))},oZ=n=>{const e={};let t;const r=s=>{var o;const c=n.getNode(s);if(!c)return 0;if(e[s])return c.data.rank;e[s]=!0;let l;return(o=n.getRelatedEdges(s,"out"))===null||o===void 0||o.forEach(u=>{const h=r(u.target),f=u.data.minlen,d=h-f;d&&(l===void 0||d<l)&&(l=d)}),l||(l=0),(t===void 0||l<t)&&(t=l),c.data.rank=l,l};n.getAllNodes().filter(s=>n.getRelatedEdges(s.id,"in").length===0).forEach(s=>{s&&r(s.id)}),t===void 0&&(t=0);const i={},a=(s,o)=>{var c;const l=n.getNode(s),u=isNaN(l.data.layer)?o:l.data.layer;(l.data.rank===void 0||l.data.rank<u)&&(l.data.rank=u),!i[s]&&(i[s]=!0,(c=n.getRelatedEdges(s,"out"))===null||c===void 0||c.forEach(h=>{a(h.target,u+h.data.minlen)}))};n.getAllNodes().forEach(s=>{const o=s.data;o&&(isNaN(o.layer)?o.rank-=t:a(s.id,o.layer))})},Ba=(n,e)=>n.getNode(e.target).data.rank-n.getNode(e.source).data.rank-e.data.minlen,cZ=n=>{const e=new qe({tree:[]}),t=n.getAllNodes()[0],r=n.getAllNodes().length;e.addNode(t);let i,a;for(;lZ(e,n)<r;)i=x5(e,n),a=e.hasNode(i.source)?Ba(n,i):-Ba(n,i),w5(e,n,a);return e},lZ=(n,e)=>{const t=r=>{e.getRelatedEdges(r,"both").forEach(i=>{const a=i.source,s=r===a?i.target:a;!n.hasNode(s)&&!Ba(e,i)&&(n.addNode({id:s,data:{}}),n.addEdge({id:i.id,source:r,target:s,data:{}}),t(s))})};return n.getAllNodes().forEach(r=>t(r.id)),n.getAllNodes().length},uZ=n=>{const e=new qe({tree:[]}),t=n.getAllNodes()[0],r=n.getAllNodes().length;e.addNode(t);let i,a;for(;hZ(e,n)<r;)i=x5(e,n),a=e.hasNode(i.source)?Ba(n,i):-Ba(n,i),w5(e,n,a);return e},hZ=(n,e)=>{const t=r=>{var i;(i=e.getRelatedEdges(r,"both"))===null||i===void 0||i.forEach(a=>{const s=a.source,o=r===s?a.target:s;!n.hasNode(o)&&(e.getNode(o).data.layer!==void 0||!Ba(e,a))&&(n.addNode({id:o,data:{}}),n.addEdge({id:a.id,source:r,target:o,data:{}}),t(o))})};return n.getAllNodes().forEach(r=>t(r.id)),n.getAllNodes().length},x5=(n,e)=>uS(e.getAllEdges(),t=>n.hasNode(t.source)!==n.hasNode(t.target)?Ba(e,t):1/0),w5=(n,e,t)=>{n.getAllNodes().forEach(r=>{const i=e.getNode(r.id);i.data.rank||(i.data.rank=0),i.data.rank+=t})},fZ=n=>{const e=hX(n);E5(e);const t=cZ(e);_5(t),S5(t,e);let r,i;for(;r=gZ(t);)i=vZ(t,e,r),mZ(t,e,r,i)},S5=(n,e)=>{let t=p5(n,n.getAllNodes(),"post");t=t.slice(0,(t==null?void 0:t.length)-1),t.forEach(r=>{dZ(n,e,r)})},dZ=(n,e,t)=>{const i=n.getNode(t).data.parent,a=n.getRelatedEdges(t,"both").find(s=>s.target===i||s.source===i);a.data.cutvalue=pZ(n,e,t)},pZ=(n,e,t)=>{const i=n.getNode(t).data.parent;let a=!0,s=e.getRelatedEdges(t,"out").find(c=>c.target===i),o=0;return s||(a=!1,s=e.getRelatedEdges(i,"out").find(c=>c.target===t)),o=s.data.weight,e.getRelatedEdges(t,"both").forEach(c=>{const l=c.source===t,u=l?c.target:c.source;if(u!==i){const h=l===a,f=c.data.weight;if(o+=h?f:-f,bZ(n,t,u)){const d=n.getRelatedEdges(t,"both").find(p=>p.source===u||p.target===u).data.cutvalue;o+=h?-d:d}}}),o},_5=(n,e=n.getAllNodes()[0].id)=>{O5(n,{},1,e)},O5=(n,e,t,r,i)=>{var a;const s=t;let o=t;const c=n.getNode(r);return e[r]=!0,(a=n.getNeighbors(r))===null||a===void 0||a.forEach(l=>{e[l.id]||(o=O5(n,e,o,l.id,r))}),c.data.low=s,c.data.lim=o++,i?c.data.parent=i:delete c.data.parent,o},gZ=n=>n.getAllEdges().find(e=>e.data.cutvalue<0),vZ=(n,e,t)=>{let r=t.source,i=t.target;e.getRelatedEdges(r,"out").find(u=>u.target===i)||(r=t.target,i=t.source);const a=n.getNode(r),s=n.getNode(i);let o=a,c=!1;a.data.lim>s.data.lim&&(o=s,c=!0);const l=e.getAllEdges().filter(u=>c===YO(n.getNode(u.source),o)&&c!==YO(n.getNode(u.target),o));return uS(l,u=>Ba(e,u))},mZ=(n,e,t,r)=>{const i=n.getRelatedEdges(t.source,"both").find(a=>a.source===t.target||a.target===t.target);i&&n.removeEdge(i.id),n.addEdge({id:`e${Math.random()}`,source:r.source,target:r.target,data:{}}),_5(n),S5(n,e),yZ(n,e)},yZ=(n,e)=>{const t=n.getAllNodes().find(i=>!i.data.parent);let r=p5(n,t,"pre");r=r.slice(1),r.forEach(i=>{const a=n.getNode(i).data.parent;let s=e.getRelatedEdges(i,"out").find(c=>c.target===a),o=!1;!s&&e.hasNode(a)&&(s=e.getRelatedEdges(a,"out").find(c=>c.target===i),o=!0),e.getNode(i).data.rank=(e.hasNode(a)&&e.getNode(a).data.rank||0)+(o?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},bZ=(n,e,t)=>n.getRelatedEdges(e,"both").find(r=>r.source===t||r.target===t),YO=(n,e)=>e.data.low<=n.data.lim&&n.data.lim<=e.data.lim,EZ=(n,e)=>{switch(e){case"network-simplex":wZ(n);break;case"tight-tree":KO(n);break;case"longest-path":xZ(n);break;default:KO(n)}},xZ=E5,KO=n=>{oZ(n),uZ(n)},wZ=n=>{fZ(n)},SZ=(n,e)=>{const{edgeLabelSpace:t,keepNodeOrder:r,prevGraph:i,rankdir:a,ranksep:s}=e;!r&&i&&OZ(n,i);const o=NZ(n);t&&(e.ranksep=RZ(o,{rankdir:a,ranksep:s}));let c;try{c=_Z(o,e)}catch(l){if(l.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,l);return}throw l}return PZ(n,o),c},_Z=(n,e)=>{const{acyclicer:t,ranker:r,rankdir:i="tb",nodeOrder:a,keepNodeOrder:s,align:o,nodesep:c=50,edgesep:l=20,ranksep:u=50}=e;jZ(n),oX(n,t);const{nestingRoot:h,nodeRankFactor:f}=xX(n);EZ(h5(n),r),kZ(n),pX(n,f),_X(n,h),dX(n),DZ(n),LZ(n);const d=[];PX(n,d),WX(n,d),vX(n),s&&qX(n,a),jX(n,s),qZ(n),mX(n,i),sZ(n,{align:o,nodesep:c,edgesep:l,ranksep:u}),GZ(n),zZ(n),MX(n,d),FZ(n),yX(n,i);const{width:p,height:g}=IZ(n);return BZ(n),$Z(n),lX(n),{width:p,height:g}},OZ=(n,e)=>{n.getAllNodes().forEach(t=>{const r=n.getNode(t.id);if(e.hasNode(t.id)){const i=e.getNode(t.id);r.data.fixorder=i.data._order,delete i.data._order}else delete r.data.fixorder})},PZ=(n,e)=>{n.getAllNodes().forEach(t=>{var r;const i=n.getNode(t.id);if(i){const a=e.getNode(t.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,!((r=e.getChildren(t.id))===null||r===void 0)&&r.length&&(i.data.width=a.data.width,i.data.height=a.data.height)}}),n.getAllEdges().forEach(t=>{const r=n.getEdge(t.id),i=e.getEdge(t.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(r.data.x=i.data.x,r.data.y=i.data.y)})},CZ=["width","height","layer","fixorder"],MZ={width:0,height:0},TZ=["minlen","weight","width","height","labeloffset"],AZ={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},zv=["labelpos"],NZ=n=>{const e=new qe({tree:[]});return n.getAllNodes().forEach(t=>{const r=ZO(n.getNode(t.id).data),i=Object.assign(Object.assign({},MZ),r),a=XO(i,CZ);e.hasNode(t.id)||e.addNode({id:t.id,data:Object.assign({},a)});const s=n.hasTreeStructure("combo")?n.getParent(t.id,"combo"):n.getParent(t.id);gt(s)||(e.hasNode(s.id)||e.addNode(Object.assign({},s)),e.setParent(t.id,s.id))}),n.getAllEdges().forEach(t=>{const r=ZO(n.getEdge(t.id).data),i={};zv==null||zv.forEach(a=>{r[a]!==void 0&&(i[a]=r[a])}),e.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},AZ,XO(r,TZ),i)})}),e},RZ=(n,e)=>{const{ranksep:t=0,rankdir:r}=e;return n.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),n.getAllEdges().forEach(i=>{var a;i.data.minlen*=2,((a=i.data.labelpos)===null||a===void 0?void 0:a.toLowerCase())!=="c"&&(r==="TB"||r==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),t/2},kZ=n=>{n.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){const t=n.getNode(e.source),r=n.getNode(e.target),i={e,rank:(r.data.rank-t.data.rank)/2+t.data.rank};fc(n,"edge-proxy",i,"_ep")}})},DZ=n=>{let e=0;return n.getAllNodes().forEach(t=>{var r,i;t.data.borderTop&&(t.data.minRank=(r=n.getNode(t.data.borderTop))===null||r===void 0?void 0:r.data.rank,t.data.maxRank=(i=n.getNode(t.data.borderBottom))===null||i===void 0?void 0:i.data.rank,e=Math.max(e,t.data.maxRank||-1/0))}),e},LZ=n=>{n.getAllNodes().forEach(e=>{e.data.dummy==="edge-proxy"&&(n.getEdge(e.data.e.id).data.labelRank=e.data.rank,n.removeNode(e.id))})},IZ=(n,e)=>{let t,r=0,i,a=0;const{marginx:s=0,marginy:o=0}={},c=l=>{if(!l.data)return;const u=l.data.x,h=l.data.y,f=l.data.width,d=l.data.height;!isNaN(u)&&!isNaN(f)&&(t===void 0&&(t=u-f/2),t=Math.min(t,u-f/2),r=Math.max(r,u+f/2)),!isNaN(h)&&!isNaN(d)&&(i===void 0&&(i=h-d/2),i=Math.min(i,h-d/2),a=Math.max(a,h+d/2))};return n.getAllNodes().forEach(l=>{c(l)}),n.getAllEdges().forEach(l=>{l!=null&&l.data.hasOwnProperty("x")&&c(l)}),t-=s,i-=o,n.getAllNodes().forEach(l=>{l.data.x-=t,l.data.y-=i}),n.getAllEdges().forEach(l=>{var u;(u=l.data.points)===null||u===void 0||u.forEach(h=>{h.x-=t,h.y-=i}),l.data.hasOwnProperty("x")&&(l.data.x-=t),l.data.hasOwnProperty("y")&&(l.data.y-=i)}),{width:r-t+s,height:a-i+o}},BZ=n=>{n.getAllEdges().forEach(e=>{const t=n.getNode(e.source),r=n.getNode(e.target);let i,a;e.data.points?(i=e.data.points[0],a=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:r.data.x,y:r.data.y},a={x:t.data.x,y:t.data.y}),e.data.points.unshift($O(t.data,i)),e.data.points.push($O(r.data,a))})},FZ=n=>{n.getAllEdges().forEach(e=>{if(e.data.hasOwnProperty("x"))switch((e.data.labelpos==="l"||e.data.labelpos==="r")&&(e.data.width-=e.data.labeloffset),e.data.labelpos){case"l":e.data.x-=e.data.width/2+e.data.labeloffset;break;case"r":e.data.x+=e.data.width/2+e.data.labeloffset;break}})},$Z=n=>{n.getAllEdges().forEach(e=>{var t;e.data.reversed&&((t=e.data.points)===null||t===void 0||t.reverse())})},zZ=n=>{n.getAllNodes().forEach(e=>{var t,r,i;if(!((t=n.getChildren(e.id))===null||t===void 0)&&t.length){const a=n.getNode(e.id),s=n.getNode(a.data.borderTop),o=n.getNode(a.data.borderBottom),c=n.getNode(a.data.borderLeft[((r=a.data.borderLeft)===null||r===void 0?void 0:r.length)-1]),l=n.getNode(a.data.borderRight[((i=a.data.borderRight)===null||i===void 0?void 0:i.length)-1]);a.data.width=Math.abs((l==null?void 0:l.data.x)-(c==null?void 0:c.data.x))||10,a.data.height=Math.abs((o==null?void 0:o.data.y)-(s==null?void 0:s.data.y))||10,a.data.x=((c==null?void 0:c.data.x)||0)+a.data.width/2,a.data.y=((s==null?void 0:s.data.y)||0)+a.data.height/2}}),n.getAllNodes().forEach(e=>{e.data.dummy==="border"&&n.removeNode(e.id)})},jZ=n=>{n.getAllEdges().forEach(e=>{if(e.source===e.target){const t=n.getNode(e.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(e),n.removeEdge(e.id)}})},qZ=n=>{const e=Vu(n);e==null||e.forEach(t=>{let r=0;t==null||t.forEach((i,a)=>{var s;const o=n.getNode(i);o.data.order=a+r,(s=o.data.selfEdges)===null||s===void 0||s.forEach(c=>{fc(n,"selfedge",{width:c.data.width,height:c.data.height,rank:o.data.rank,order:a+ ++r,e:c},"_se")}),delete o.data.selfEdges})})},GZ=n=>{n.getAllNodes().forEach(e=>{const t=n.getNode(e.id);if(t.data.dummy==="selfedge"){const r=n.getNode(t.data.e.source),i=r.data.x+r.data.width/2,a=r.data.y,s=t.data.x-i,o=r.data.height/2;n.hasEdge(t.data.e.id)?n.updateEdgeData(t.data.e.id,t.data.e.data):n.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),n.removeNode(e.id),t.data.e.data.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{y:a,x:i+s},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},XO=(n,e)=>{const t={};return e==null||e.forEach(r=>{n[r]!==void 0&&(t[r]=+n[r])}),t},ZO=(n={})=>{const e={};return Object.keys(n).forEach(t=>{e[t.toLowerCase()]=n[t]}),e},en=Array.isArray,hS=n=>{const e=[],t=n.length;for(let r=0;r<t;r+=1){e[r]=[];for(let i=0;i<t;i+=1)r===i?e[r][i]=0:n[r][i]===0||!n[r][i]?e[r][i]=1/0:e[r][i]=n[r][i]}for(let r=0;r<t;r+=1)for(let i=0;i<t;i+=1)for(let a=0;a<t;a+=1)e[i][a]>e[i][r]+e[r][a]&&(e[i][a]=e[i][r]+e[r][a]);return e},fS=(n,e)=>{const{nodes:t,edges:r}=n,i=[],a={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((s,o)=>{a[s.id]=o;const c=[];i.push(c)}),r==null||r.forEach(s=>{const{source:o,target:c}=s,l=a[o],u=a[c];l===void 0||u===void 0||(i[l][u]=1,e||(i[u][l]=1))}),i},P5=(n,e)=>{const t=[];return n.forEach(r=>{const i=[];r.forEach(a=>{i.push(a*e)}),t.push(i)}),t},C5=n=>{let e=1/0,t=1/0,r=-1/0,i=-1/0;return n.forEach(a=>{let s=a.data.size;en(s)?s.length===1&&(s=[s[0],s[0]]):rt(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);const o=[s[0]/2,s[1]/2],c=a.data.x-o[0],l=a.data.x+o[0],u=a.data.y-o[1],h=a.data.y+o[1];e>c&&(e=c),t>u&&(t=u),r<l&&(r=l),i<h&&(i=h)}),{minX:e,minY:t,maxX:r,maxY:i}},Cw=(n,e)=>Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)),Zd=(n,e,t,r="TB",i,a={})=>{if(!(e!=null&&e.length))return;const{stopBranchFn:s,stopAllFn:o}=a;for(let c=0;c<e.length;c++){const l=e[c];if(n.hasNode(l.id)&&!(s!=null&&s(l))){if(o!=null&&o(l))return;r==="TB"&&t(l),Zd(n,n.getChildren(l.id,i),t,r,i,a),r!=="TB"&&t(l)}}},Qd=n=>{if(n===null)return n;if(n instanceof Date)return new Date(n.getTime());if(n instanceof Array){const e=[];return n.forEach(t=>{e.push(t)}),e.map(t=>Qd(t))}if(typeof n=="object"){const e={};return Object.keys(n).forEach(t=>{e[t]=Qd(n[t])}),e}return n},jn=(n,e)=>{const t=Qd(n);return t.data=t.data||{},e&&(rt(t.data.x)||(t.data.x=Math.random()*e[0]),rt(t.data.y)||(t.data.y=Math.random()*e[1])),t};function ir(n,e){let t;return ft(e)?t=e:rt(e)?t=()=>e:t=()=>n,t}function dS(n,e,t=!0){return!e&&e!==0?r=>{const{size:i}=r.data||{};return i?Array.isArray(i)?i[0]>i[1]?i[0]:i[1]:ne(i)?i.width>i.height?i.width:i.height:i:n}:ft(e)?e:rt(e)?()=>e:Array.isArray(e)?()=>{if(t){const r=Math.max(...e);return isNaN(r)?n:r}return e}:ne(e)?()=>{if(t){const r=Math.max(e.width,e.height);return isNaN(r)?n:r}return[e.width,e.height]}:()=>n}const pS=(n,e)=>{let t,r;return rt(e)?r=()=>e:ft(e)?r=e:r=()=>0,n?Array.isArray(n)?t=i=>(n[0]>n[1]?n[0]:n[1])+r(i):ft(n)?t=n:t=i=>n+r(i):t=i=>{var a,s;if(!((a=i.data)===null||a===void 0)&&a.bboxSize)return Math.max(i.data.bboxSize[0],i.data.bboxSize[1])+r(i);if(!((s=i.data)===null||s===void 0)&&s.size){if(Array.isArray(i.data.size))return Math.max(i.data.size[0],i.data.size[1])+r(i);const o=i.data.size;return ne(o)?(o.width>o.height?o.width:o.height)+r(i):o+r(i)}return 10+r(i)},t},VZ={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class gS{constructor(e={}){this.options=e,this.id="antv-dagre",this.options=Object.assign(Object.assign({},VZ),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,t)})}genericDagreLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{nodeSize:a,align:s,rankdir:o="TB",ranksep:c,nodesep:l,ranksepFunc:u,nodesepFunc:h,edgeLabelSpace:f,ranker:d,nodeOrder:p,begin:g,controlPoints:v,radial:m,sortByCombo:y,preset:b}=i,w=new qe({tree:[]}),x=ir(c||50,u),S=ir(l||50,h);let _=S,E=x;(o==="LR"||o==="RL")&&(_=x,E=S);const P=pS(a,void 0),O=t.getAllNodes(),C=t.getAllEdges();O.forEach(L=>{const $=P(L),V=E(L),W=_(L),Y=$+2*W,U=$+2*V,J=L.data.layer;rt(J)?w.addNode({id:L.id,data:{width:Y,height:U,layer:J}}):w.addNode({id:L.id,data:{width:Y,height:U}})}),y&&(w.attachTreeStructure("combo"),O.forEach(L=>{const{parentId:$}=L.data;$!==void 0&&w.hasNode($)&&w.setParent(L.id,$,"combo")})),C.forEach(L=>{w.addEdge({id:L.id,source:L.source,target:L.target,data:{weight:L.data.weight||1}})});let M;b!=null&&b.length&&(M=new qe({nodes:b})),SZ(w,{prevGraph:M,edgeLabelSpace:f,keepNodeOrder:!!p,nodeOrder:p||[],acyclicer:"greedy",ranker:d,rankdir:o,nodesep:l,align:s});const T=[0,0];if(g){let L=1/0,$=1/0;w.getAllNodes().forEach(V=>{L>V.data.x&&(L=V.data.x),$>V.data.y&&($=V.data.y)}),w.getAllEdges().forEach(V=>{var W;(W=V.data.points)===null||W===void 0||W.forEach(Y=>{L>Y.x&&(L=Y.x),$>Y.y&&($=Y.y)})}),T[0]=g[0]-L,T[1]=g[1]-$}const R=o==="LR"||o==="RL";if(!m){const L=new Set,V=o==="BT"||o==="RL"?(J,at)=>at-J:(J,at)=>J-at;w.getAllNodes().forEach(J=>{J.data.x=J.data.x+T[0],J.data.y=J.data.y+T[1],L.add(R?J.data.x:J.data.y)});const W=Array.from(L).sort(V),Y=R?(J,at)=>J.x!==at.x:(J,at)=>J.y!==at.y,U=R?(J,at,ht)=>{const lt=Math.max(at.y,ht.y),Nt=Math.min(at.y,ht.y);return J.filter(pe=>pe.y<=lt&&pe.y>=Nt)}:(J,at,ht)=>{const lt=Math.max(at.x,ht.x),Nt=Math.min(at.x,ht.x);return J.filter(pe=>pe.x<=lt&&pe.x>=Nt)};w.getAllEdges().forEach((J,at)=>{var ht;f&&v&&J.data.type!=="loop"&&(J.data.controlPoints=WZ((ht=J.data.points)===null||ht===void 0?void 0:ht.map(({x:lt,y:Nt})=>({x:lt+T[0],y:Nt+T[1]})),w.getNode(J.source),w.getNode(J.target),W,R,Y,U))})}let D=[];D=w.getAllNodes().map(L=>jn(L));const B=w.getAllEdges();return e&&(D.forEach(L=>{t.mergeNodeData(L.id,{x:L.data.x,y:L.data.y})}),B.forEach(L=>{t.mergeEdgeData(L.id,{controlPoints:L.data.controlPoints})})),{nodes:D,edges:B}})}}const WZ=(n,e,t,r,i,a,s)=>{let o=(n==null?void 0:n.slice(1,n.length-1))||[];if(e&&t){let{x:c,y:l}=e.data,{x:u,y:h}=t.data;if(i&&(c=e.data.y,l=e.data.x,u=t.data.y,h=t.data.x),h!==l&&c!==u){const f=r.indexOf(l),d=r[f+1];if(d){const v=o[0],m=i?{x:(l+d)/2,y:(v==null?void 0:v.y)||u}:{x:(v==null?void 0:v.x)||u,y:(l+d)/2};(!v||a(v,m))&&o.unshift(m)}const p=r.indexOf(h),g=Math.abs(p-f);if(g===1)o=s(o,e.data,t.data),o.length||o.push(i?{x:(l+h)/2,y:c}:{x:c,y:(l+h)/2});else if(g>1){const v=r[p-1];if(v){const m=o[o.length-1],y=i?{x:(h+v)/2,y:(m==null?void 0:m.y)||u}:{x:(m==null?void 0:m.x)||c,y:(h+v)/2};(!m||a(m,y))&&o.push(y)}}}}return o},Is=(n,e,t)=>{const r=n.getAllNodes(),i=n.getAllEdges();if(!(r!=null&&r.length))return{nodes:[],edges:i};if(r.length===1)return e&&n.mergeNodeData(r[0].id,{x:t[0],y:t[1]}),{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:t[0],y:t[1]})})],edges:i}},HZ={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class vS{constructor(e={}){this.options=e,this.id="circular",this.options=Object.assign(Object.assign({},HZ),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,e,t)})}genericCircularLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{width:a,height:s,center:o,divisions:c,startAngle:l=0,endAngle:u=2*Math.PI,angleRatio:h,ordering:f,clockwise:d,nodeSpacing:p,nodeSize:g}=i,v=t.getAllNodes(),m=t.getAllEdges(),[y,b,w]=YZ(a,s,o),x=v==null?void 0:v.length;if(!x||x===1)return Is(t,e,w);const S=(u-l)/x;let{radius:_,startRadius:E,endRadius:P}=i;if(p){const R=ir(10,p),D=dS(10,g);let B=-1/0;v.forEach(L=>{const $=D(L);B<$&&(B=$)});let j=0;v.forEach((L,$)=>{$===0?j+=B||10:j+=(R(L)||0)+(B||10)}),_=j/(2*Math.PI)}else!_&&!E&&!P?_=Math.min(b,y)/2:!E&&P?E=P:E&&!P&&(P=E);const O=S*h;let C=[];f==="topology"?C=QO(t,v):f==="topology-directed"?C=QO(t,v,!0):f==="degree"?C=UZ(t,v):C=v.map(R=>jn(R));const M=Math.ceil(x/c);for(let R=0;R<x;++R){let D=_;!D&&E!==null&&P!==null&&(D=E+R*(P-E)/(x-1)),D||(D=10+R*100/(x-1));let B=l+R%M*O+2*Math.PI/c*Math.floor(R/M);d||(B=u-R%M*O-2*Math.PI/c*Math.floor(R/M)),C[R].data.x=w[0]+Math.cos(B)*D,C[R].data.y=w[1]+Math.sin(B)*D}return e&&C.forEach(R=>{t.mergeNodeData(R.id,{x:R.data.x,y:R.data.y})}),{nodes:C,edges:m}})}}const QO=(n,e,t=!1)=>{const r=[jn(e[0])],i={},a=e.length;i[e[0].id]=!0;let s=0;return e.forEach((o,c)=>{if(c!==0)if((c===a-1||n.getDegree(o.id,"both")!==n.getDegree(e[c+1].id,"both")||n.areNeighbors(r[s].id,o.id))&&!i[o.id])r.push(jn(o)),i[o.id]=!0,s++;else{const l=t?n.getSuccessors(r[s].id):n.getNeighbors(r[s].id);let u=!1;for(let f=0;f<l.length;f++){const d=l[f];if(n.getDegree(d.id)===n.getDegree(o.id)&&!i[d.id]){r.push(jn(d)),i[d.id]=!0,u=!0;break}}let h=0;for(;!u&&(i[e[h].id]||(r.push(jn(e[h])),i[e[h].id]=!0,u=!0),h++,h!==a););}}),r};function UZ(n,e){const t=[];return e.forEach((r,i)=>{t.push(jn(r))}),t.sort((r,i)=>n.getDegree(r.id,"both")-n.getDegree(i.id,"both")),t}const YZ=(n,e,t)=>{let r=n,i=e,a=t;return!r&&typeof window<"u"&&(r=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),a||(a=[r/2,i/2]),[r,i,a]},KZ={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Wu{constructor(e={}){this.options=e,this.id="concentric",this.options=Object.assign(Object.assign({},KZ),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,e,t)})}genericConcentricLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a,width:s,height:o,sortBy:c,maxLevelDiff:l,sweep:u,clockwise:h,equidistant:f,preventOverlap:d,startAngle:p=3/2*Math.PI,nodeSize:g,nodeSpacing:v}=i,m=t.getAllNodes(),y=t.getAllEdges(),b=!s&&typeof window<"u"?window.innerWidth:s,w=!o&&typeof window<"u"?window.innerHeight:o,x=a||[b/2,w/2];if(!(m!=null&&m.length)||m.length===1)return Is(t,e,x);const S=[];let _,E=0;en(g)?_=Math.max(g[0],g[1]):ft(g)?(_=-1/0,m.forEach(L=>{const $=g(L);$>_&&(_=$)})):_=g,en(v)?E=Math.max(v[0],v[1]):rt(v)&&(E=v),m.forEach(L=>{const $=jn(L);S.push($);let V=_;const{data:W}=$;en(W.size)?V=Math.max(W.size[0],W.size[1]):rt(W.size)?V=W.size:ne(W.size)&&(V=Math.max(W.size.width,W.size.height)),_=Math.max(_,V),ft(v)&&(E=Math.max(v(L),E))});const P={};S.forEach((L,$)=>{P[L.id]=$});let O=c;(!At(O)||S[0].data[O]===void 0)&&(O="degree"),O==="degree"?S.sort((L,$)=>t.getDegree($.id,"both")-t.getDegree(L.id,"both")):S.sort((L,$)=>$.data[O]-L.data[O]);const C=S[0],M=(l||(O==="degree"?t.getDegree(C.id,"both"):C.data[O]))/4,T=[{nodes:[]}];let R=T[0];S.forEach(L=>{if(R.nodes.length>0){const $=Math.abs(O==="degree"?t.getDegree(R.nodes[0].id,"both")-t.getDegree(L.id,"both"):R.nodes[0].data[O]-L.data[O]);M&&$>=M&&(R={nodes:[]},T.push(R))}R.nodes.push(L)});let D=_+E;if(!d){const L=T.length>0&&T[0].nodes.length>1,V=(Math.min(b,w)/2-D)/(T.length+(L?1:0));D=Math.min(D,V)}let B=0;if(T.forEach(L=>{const $=u===void 0?2*Math.PI-2*Math.PI/L.nodes.length:u;if(L.dTheta=$/Math.max(1,L.nodes.length-1),L.nodes.length>1&&d){const V=Math.cos(L.dTheta)-Math.cos(0),W=Math.sin(L.dTheta)-Math.sin(0),Y=Math.sqrt(D*D/(V*V+W*W));B=Math.max(Y,B)}L.r=B,B+=D}),f){let L=0,$=0;for(let V=0;V<T.length;V++){const Y=(T[V].r||0)-$;L=Math.max(L,Y)}$=0,T.forEach((V,W)=>{W===0&&($=V.r||0),V.r=$,$+=L})}return T.forEach(L=>{const $=L.dTheta||0,V=L.r||0;L.nodes.forEach((W,Y)=>{const U=p+(h?1:-1)*$*Y;W.data.x=x[0]+V*Math.cos(U),W.data.y=x[1]+V*Math.sin(U)})}),e&&S.forEach(L=>t.mergeNodeData(L.id,{x:L.data.x,y:L.data.y})),{nodes:S,edges:y}})}}function XZ(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return M5(this.cover(e,t),e,t,n)}function M5(n,e,t,r){if(isNaN(e)||isNaN(t))return n;var i,a=n._root,s={data:r},o=n._x0,c=n._y0,l=n._x1,u=n._y1,h,f,d,p,g,v,m,y;if(!a)return n._root=s,n;for(;a.length;)if((g=e>=(h=(o+l)/2))?o=h:l=h,(v=t>=(f=(c+u)/2))?c=f:u=f,i=a,!(a=a[m=v<<1|g]))return i[m]=s,n;if(d=+n._x.call(null,a.data),p=+n._y.call(null,a.data),e===d&&t===p)return s.next=a,i?i[m]=s:n._root=s,n;do i=i?i[m]=new Array(4):n._root=new Array(4),(g=e>=(h=(o+l)/2))?o=h:l=h,(v=t>=(f=(c+u)/2))?c=f:u=f;while((m=v<<1|g)===(y=(p>=f)<<1|d>=h));return i[y]=a,i[m]=s,n}function ZZ(n){var e,t,r=n.length,i,a,s=new Array(r),o=new Array(r),c=1/0,l=1/0,u=-1/0,h=-1/0;for(t=0;t<r;++t)isNaN(i=+this._x.call(null,e=n[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,o[t]=a,i<c&&(c=i),i>u&&(u=i),a<l&&(l=a),a>h&&(h=a));if(c>u||l>h)return this;for(this.cover(c,l).cover(u,h),t=0;t<r;++t)M5(this,s[t],o[t],n[t]);return this}function QZ(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(n))+1,a=(r=Math.floor(e))+1;else{for(var s=i-t||1,o=this._root,c,l;t>n||n>=i||r>e||e>=a;)switch(l=(e<r)<<1|n<t,c=new Array(4),c[l]=o,o=c,s*=2,l){case 0:i=t+s,a=r+s;break;case 1:t=i-s,a=r+s;break;case 2:i=t+s,r=a-s;break;case 3:t=i-s,r=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=r,this._x1=i,this._y1=a,this}function JZ(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function tQ(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function An(n,e,t,r,i){this.node=n,this.x0=e,this.y0=t,this.x1=r,this.y1=i}function eQ(n,e,t){var r,i=this._x0,a=this._y0,s,o,c,l,u=this._x1,h=this._y1,f=[],d=this._root,p,g;for(d&&f.push(new An(d,i,a,u,h)),t==null?t=1/0:(i=n-t,a=e-t,u=n+t,h=e+t,t*=t);p=f.pop();)if(!(!(d=p.node)||(s=p.x0)>u||(o=p.y0)>h||(c=p.x1)<i||(l=p.y1)<a))if(d.length){var v=(s+c)/2,m=(o+l)/2;f.push(new An(d[3],v,m,c,l),new An(d[2],s,m,v,l),new An(d[1],v,o,c,m),new An(d[0],s,o,v,m)),(g=(e>=m)<<1|n>=v)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=p)}else{var y=n-+this._x.call(null,d.data),b=e-+this._y.call(null,d.data),w=y*y+b*b;if(w<t){var x=Math.sqrt(t=w);i=n-x,a=e-x,u=n+x,h=e+x,r=d.data}}return r}function nQ(n){if(isNaN(u=+this._x.call(null,n))||isNaN(h=+this._y.call(null,n)))return this;var e,t=this._root,r,i,a,s=this._x0,o=this._y0,c=this._x1,l=this._y1,u,h,f,d,p,g,v,m;if(!t)return this;if(t.length)for(;;){if((p=u>=(f=(s+c)/2))?s=f:c=f,(g=h>=(d=(o+l)/2))?o=d:l=d,e=t,!(t=t[v=g<<1|p]))return this;if(!t.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(r=e,m=v)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[v]=a:delete e[v],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[m]=t:this._root=t),this):(this._root=a,this)}function rQ(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function iQ(){return this._root}function aQ(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function sQ(n){var e=[],t,r=this._root,i,a,s,o,c;for(r&&e.push(new An(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(r=t.node,a=t.x0,s=t.y0,o=t.x1,c=t.y1)&&r.length){var l=(a+o)/2,u=(s+c)/2;(i=r[3])&&e.push(new An(i,l,u,o,c)),(i=r[2])&&e.push(new An(i,a,u,l,c)),(i=r[1])&&e.push(new An(i,l,s,o,u)),(i=r[0])&&e.push(new An(i,a,s,l,u))}return this}function oQ(n){var e=[],t=[],r;for(this._root&&e.push(new An(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,c=r.x1,l=r.y1,u=(s+c)/2,h=(o+l)/2;(a=i[0])&&e.push(new An(a,s,o,u,h)),(a=i[1])&&e.push(new An(a,u,o,c,h)),(a=i[2])&&e.push(new An(a,s,h,u,l)),(a=i[3])&&e.push(new An(a,u,h,c,l))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function cQ(n){return n[0]}function lQ(n){return arguments.length?(this._x=n,this):this._x}function uQ(n){return n[1]}function hQ(n){return arguments.length?(this._y=n,this):this._y}function dc(n,e,t){var r=new mS(e??cQ,t??uQ,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function mS(n,e,t,r,i,a){this._x=n,this._y=e,this._x0=t,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function JO(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Dn=dc.prototype=mS.prototype;Dn.copy=function(){var n=new mS(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=JO(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=JO(r));return n};Dn.add=XZ;Dn.addAll=ZZ;Dn.cover=QZ;Dn.data=JZ;Dn.extent=tQ;Dn.find=eQ;Dn.remove=nQ;Dn.removeAll=rQ;Dn.root=iQ;Dn.size=aQ;Dn.visit=sQ;Dn.visitAfter=oQ;Dn.x=lQ;Dn.y=hQ;function fQ(n){const e=+this._x.call(null,n),t=+this._y.call(null,n),r=+this._z.call(null,n);return T5(this.cover(e,t,r),e,t,r,n)}function T5(n,e,t,r,i){if(isNaN(e)||isNaN(t)||isNaN(r))return n;var a,s=n._root,o={data:i},c=n._x0,l=n._y0,u=n._z0,h=n._x1,f=n._y1,d=n._z1,p,g,v,m,y,b,w,x,S,_,E;if(!s)return n._root=o,n;for(;s.length;)if((w=e>=(p=(c+h)/2))?c=p:h=p,(x=t>=(g=(l+f)/2))?l=g:f=g,(S=r>=(v=(u+d)/2))?u=v:d=v,a=s,!(s=s[_=S<<2|x<<1|w]))return a[_]=o,n;if(m=+n._x.call(null,s.data),y=+n._y.call(null,s.data),b=+n._z.call(null,s.data),e===m&&t===y&&r===b)return o.next=s,a?a[_]=o:n._root=o,n;do a=a?a[_]=new Array(8):n._root=new Array(8),(w=e>=(p=(c+h)/2))?c=p:h=p,(x=t>=(g=(l+f)/2))?l=g:f=g,(S=r>=(v=(u+d)/2))?u=v:d=v;while((_=S<<2|x<<1|w)===(E=(b>=v)<<2|(y>=g)<<1|m>=p));return a[E]=s,a[_]=o,n}function dQ(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e),r=new Float64Array(e),i=new Float64Array(e);let a=1/0,s=1/0,o=1/0,c=-1/0,l=-1/0,u=-1/0;for(let h=0,f,d,p,g;h<e;++h)isNaN(d=+this._x.call(null,f=n[h]))||isNaN(p=+this._y.call(null,f))||isNaN(g=+this._z.call(null,f))||(t[h]=d,r[h]=p,i[h]=g,d<a&&(a=d),d>c&&(c=d),p<s&&(s=p),p>l&&(l=p),g<o&&(o=g),g>u&&(u=g));if(a>c||s>l||o>u)return this;this.cover(a,s,o).cover(c,l,u);for(let h=0;h<e;++h)T5(this,t[h],r[h],i[h],n[h]);return this}function pQ(n,e,t){if(isNaN(n=+n)||isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,c=this._z1;if(isNaN(r))s=(r=Math.floor(n))+1,o=(i=Math.floor(e))+1,c=(a=Math.floor(t))+1;else{for(var l=s-r||1,u=this._root,h,f;r>n||n>=s||i>e||e>=o||a>t||t>=c;)switch(f=(t<a)<<2|(e<i)<<1|n<r,h=new Array(8),h[f]=u,u=h,l*=2,f){case 0:s=r+l,o=i+l,c=a+l;break;case 1:r=s-l,o=i+l,c=a+l;break;case 2:s=r+l,i=o-l,c=a+l;break;case 3:r=s-l,i=o-l,c=a+l;break;case 4:s=r+l,o=i+l,a=c-l;break;case 5:r=s-l,o=i+l,a=c-l;break;case 6:s=r+l,i=o-l,a=c-l;break;case 7:r=s-l,i=o-l,a=c-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=c,this}function gQ(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function vQ(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function ge(n,e,t,r,i,a,s){this.node=n,this.x0=e,this.y0=t,this.z0=r,this.x1=i,this.y1=a,this.z1=s}function mQ(n,e,t,r){var i,a=this._x0,s=this._y0,o=this._z0,c,l,u,h,f,d,p=this._x1,g=this._y1,v=this._z1,m=[],y=this._root,b,w;for(y&&m.push(new ge(y,a,s,o,p,g,v)),r==null?r=1/0:(a=n-r,s=e-r,o=t-r,p=n+r,g=e+r,v=t+r,r*=r);b=m.pop();)if(!(!(y=b.node)||(c=b.x0)>p||(l=b.y0)>g||(u=b.z0)>v||(h=b.x1)<a||(f=b.y1)<s||(d=b.z1)<o))if(y.length){var x=(c+h)/2,S=(l+f)/2,_=(u+d)/2;m.push(new ge(y[7],x,S,_,h,f,d),new ge(y[6],c,S,_,x,f,d),new ge(y[5],x,l,_,h,S,d),new ge(y[4],c,l,_,x,S,d),new ge(y[3],x,S,u,h,f,_),new ge(y[2],c,S,u,x,f,_),new ge(y[1],x,l,u,h,S,_),new ge(y[0],c,l,u,x,S,_)),(w=(t>=_)<<2|(e>=S)<<1|n>=x)&&(b=m[m.length-1],m[m.length-1]=m[m.length-1-w],m[m.length-1-w]=b)}else{var E=n-+this._x.call(null,y.data),P=e-+this._y.call(null,y.data),O=t-+this._z.call(null,y.data),C=E*E+P*P+O*O;if(C<r){var M=Math.sqrt(r=C);a=n-M,s=e-M,o=t-M,p=n+M,g=e+M,v=t+M,i=y.data}}return i}function yQ(n){if(isNaN(f=+this._x.call(null,n))||isNaN(d=+this._y.call(null,n))||isNaN(p=+this._z.call(null,n)))return this;var e,t=this._root,r,i,a,s=this._x0,o=this._y0,c=this._z0,l=this._x1,u=this._y1,h=this._z1,f,d,p,g,v,m,y,b,w,x,S;if(!t)return this;if(t.length)for(;;){if((y=f>=(g=(s+l)/2))?s=g:l=g,(b=d>=(v=(o+u)/2))?o=v:u=v,(w=p>=(m=(c+h)/2))?c=m:h=m,e=t,!(t=t[x=w<<2|b<<1|y]))return this;if(!t.length)break;(e[x+1&7]||e[x+2&7]||e[x+3&7]||e[x+4&7]||e[x+5&7]||e[x+6&7]||e[x+7&7])&&(r=e,S=x)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[x]=a:delete e[x],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[S]=t:this._root=t),this):(this._root=a,this)}function bQ(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function EQ(){return this._root}function xQ(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function wQ(n){var e=[],t,r=this._root,i,a,s,o,c,l,u;for(r&&e.push(new ge(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!n(r=t.node,a=t.x0,s=t.y0,o=t.z0,c=t.x1,l=t.y1,u=t.z1)&&r.length){var h=(a+c)/2,f=(s+l)/2,d=(o+u)/2;(i=r[7])&&e.push(new ge(i,h,f,d,c,l,u)),(i=r[6])&&e.push(new ge(i,a,f,d,h,l,u)),(i=r[5])&&e.push(new ge(i,h,s,d,c,f,u)),(i=r[4])&&e.push(new ge(i,a,s,d,h,f,u)),(i=r[3])&&e.push(new ge(i,h,f,o,c,l,d)),(i=r[2])&&e.push(new ge(i,a,f,o,h,l,d)),(i=r[1])&&e.push(new ge(i,h,s,o,c,f,d)),(i=r[0])&&e.push(new ge(i,a,s,o,h,f,d))}return this}function SQ(n){var e=[],t=[],r;for(this._root&&e.push(new ge(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=e.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,c=r.z0,l=r.x1,u=r.y1,h=r.z1,f=(s+l)/2,d=(o+u)/2,p=(c+h)/2;(a=i[0])&&e.push(new ge(a,s,o,c,f,d,p)),(a=i[1])&&e.push(new ge(a,f,o,c,l,d,p)),(a=i[2])&&e.push(new ge(a,s,d,c,f,u,p)),(a=i[3])&&e.push(new ge(a,f,d,c,l,u,p)),(a=i[4])&&e.push(new ge(a,s,o,p,f,d,h)),(a=i[5])&&e.push(new ge(a,f,o,p,l,d,h)),(a=i[6])&&e.push(new ge(a,s,d,p,f,u,h)),(a=i[7])&&e.push(new ge(a,f,d,p,l,u,h))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function _Q(n){return n[0]}function OQ(n){return arguments.length?(this._x=n,this):this._x}function PQ(n){return n[1]}function CQ(n){return arguments.length?(this._y=n,this):this._y}function MQ(n){return n[2]}function TQ(n){return arguments.length?(this._z=n,this):this._z}function Cg(n,e,t,r){var i=new yS(e??_Q,t??PQ,r??MQ,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?i:i.addAll(n)}function yS(n,e,t,r,i,a,s,o,c){this._x=n,this._y=e,this._z=t,this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=c,this._root=void 0}function tP(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var _n=Cg.prototype=yS.prototype;_n.copy=function(){var n=new yS(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=tP(e),n;for(t=[{source:e,target:n._root=new Array(8)}];e=t.pop();)for(var i=0;i<8;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(8)}):e.target[i]=tP(r));return n};_n.add=fQ;_n.addAll=dQ;_n.cover=pQ;_n.data=gQ;_n.extent=vQ;_n.find=mQ;_n.remove=yQ;_n.removeAll=bQ;_n.root=EQ;_n.size=xQ;_n.visit=wQ;_n.visitAfter=SQ;_n.x=OQ;_n.y=CQ;_n.z=TQ;const AQ=.81,jv=.1;function A5(n,e,t,r,i=2){const a=e/t,s=n.getAllNodes(),o=s.map((u,h)=>{const{nodeStrength:f,x:d,y:p,z:g,size:v}=u.data;return{x:d,y:p,z:g,size:v,index:h,id:u.id,vx:0,vy:0,vz:0,weight:a*f}}),c=(i===2?dc(o,u=>u.x,u=>u.y):Cg(o,u=>u.x,u=>u.y,u=>u.z)).visitAfter(NQ),l=new Map;return o.forEach(u=>{l.set(u.id,u),kQ(u,c,i)}),o.map((u,h)=>{const{id:f,data:d}=s[h],{mass:p=1}=d;r[f]={x:u.vx/p,y:u.vy/p,z:u.vz/p}}),r}function NQ(n){let e=0,t=0,r=0,i=0,a=0;const s=n.length;if(s){for(let o=0;o<s;o++){const c=n[o];c&&c.weight&&(e+=c.weight,t+=c.x*c.weight,r+=c.y*c.weight,i+=c.z*c.weight,a+=c.size*c.weight)}n.x=t/e,n.y=r/e,n.z=i/e,n.size=a/e,n.weight=e}else{const o=n;n.x=o.data.x,n.y=o.data.y,n.z=o.data.z,n.size=o.data.size,n.weight=o.data.weight}}const RQ=(n,e,t,r,i,a,s)=>{var o;if(((o=n.data)===null||o===void 0?void 0:o.id)===a.id)return;const c=[t,r,i][s-1],l=a.x-n.x||jv,u=a.y-n.y||jv,h=a.z-n.z||jv,f=[l,u,h],d=c-e;let p=0;for(let m=0;m<s;m++)p+=f[m]*f[m];const v=Math.sqrt(p)*p;if(d*d*AQ<p){const m=n.weight/v;return a.vx+=l*m,a.vy+=u*m,a.vz+=h*m,!0}if(n.length)return!1;if(n.data!==a){const m=n.data.weight/v;a.vx+=l*m,a.vy+=u*m,a.vz+=h*m}};function kQ(n,e,t){e.visit((r,i,a,s,o)=>RQ(r,i,a,s,o,n,t))}const DQ={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class Mg{constructor(e={}){this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},DQ),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericForceLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<e;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(r=>this.lastGraph.mergeNodeData(r.id,{x:r.data.x,y:r.data.y,z:this.options.dimensions===3?r.data.z:void 0})),t}genericForceLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),a=t.getAllNodes(),s=t.getAllEdges(),o=this.formatOptions(i,t),{dimensions:c,width:l,height:u,nodeSize:h,getMass:f,nodeStrength:d,edgeStrength:p,linkDistance:g}=o,v=a.map((E,P)=>Object.assign(Object.assign({},E),{data:Object.assign(Object.assign({},E.data),{x:rt(E.data.x)?E.data.x:Math.random()*l,y:rt(E.data.y)?E.data.y:Math.random()*u,z:rt(E.data.z)?E.data.z:Math.random()*Math.sqrt(l*u),size:h(E)||30,mass:f(E),nodeStrength:d(E)})})),m=s.map(E=>Object.assign(Object.assign({},E),{data:Object.assign(Object.assign({},E.data),{edgeStrength:p(E),linkDistance:g(E,t.getNode(E.source),t.getNode(E.target))})}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const y={};a.forEach((E,P)=>{y[E.id]={x:0,y:0,z:0}});const b=new qe({nodes:v,edges:m});this.formatCentripetal(o,b);const{maxIteration:w,minMovement:x,onTick:S}=o;if(this.lastLayoutNodes=v,this.lastLayoutEdges=m,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=b,this.lastOptions=o,this.lastVelMap=y,typeof window>"u")return;let _=0;return new Promise(E=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&E({nodes:qv(t,v),edges:s}),this.runOneStep(b,t,_,y,o),this.updatePosition(t,b,y,o),e&&v.forEach(P=>t.mergeNodeData(P.id,{x:P.data.x,y:P.data.y,z:c===3?P.data.z:void 0})),S==null||S({nodes:qv(t,v),edges:s}),_++,(_>=w||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),E({nodes:qv(t,v),edges:s}))},0),this.running=!0})})}formatOptions(e,t){const r=Object.assign({},e),{width:i,height:a,getMass:s,nodeSize:o}=e;r.width=!i&&typeof window<"u"?window.innerWidth:i,r.height=!a&&typeof window<"u"?window.innerHeight:a,e.center||(r.center=[r.width/2,r.height/2]),s||(r.getMass=h=>{let f=1;rt(h==null?void 0:h.data.mass)&&(f=h==null?void 0:h.data.mass);const d=t.getDegree(h.id,"both");return!d||d<5?f:d*5*f});const c=ir(0,e.nodeSpacing);let l;o?ft(o)?l=h=>o(h)+c(h):en(o)?l=h=>{const f=o;return Math.max(f[0],f[1])+c(h)}:l=h=>o+c(h):l=h=>{const{size:f}=(h==null?void 0:h.data)||{};return f?en(f)?Math.max(f[0],f[1])+c(h):ne(f)?Math.max(f.width,f.height)+c(h):f+c(h):10+c(h)},r.nodeSize=l;const u=e.linkDistance?ir(1,e.linkDistance):h=>1+r.nodeSize(t.getNode(h.source))+r.nodeSize(t.getNode(h.target));return r.linkDistance=u,r.nodeStrength=ir(1,e.nodeStrength),r.edgeStrength=ir(1,e.edgeStrength),r}formatCentripetal(e,t){const{dimensions:r,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:c,nodeClusterBy:l}=e,u=t.getAllNodes(),h=i||{leaf:2,single:2,others:1,center:m=>({x:a[0],y:a[1],z:r===3?a[2]:void 0})};typeof s!="function"&&(e.clusterNodeStrength=m=>s);let f,d;if(o&&l&&(f=eP(t,l),d=Array.from(new Set(u==null?void 0:u.map(m=>m.data[l])))||[],e.centripetalOptions=Object.assign(h,{single:100,leaf:m=>{const{siblingLeaves:y,sameTypeLeaves:b}=f[m.id]||{};return(b==null?void 0:b.length)===(y==null?void 0:y.length)||(d==null?void 0:d.length)===1?1:e.clusterNodeStrength(m)},others:1,center:m=>{const y=t.getDegree(m.id,"both");if(!y)return{x:100,y:100,z:0};let b;if(y===1){const{sameTypeLeaves:w=[]}=f[m.id]||{};w.length===1?b=void 0:w.length>1&&(b=nP(w))}else b=void 0;return{x:b==null?void 0:b.x,y:b==null?void 0:b.y,z:b==null?void 0:b.z}}})),c&&l){f||(f=eP(t,l)),d||(d=Array.from(new Set(u.map(y=>y.data[l])))),d=d.filter(y=>y!==void 0);const m={};d.forEach(y=>{const b=u.filter(w=>w.data[l]===y).map(w=>t.getNode(w.id));m[y]=nP(b)}),e.centripetalOptions=Object.assign(h,{single:y=>e.clusterNodeStrength(y),leaf:y=>e.clusterNodeStrength(y),others:y=>e.clusterNodeStrength(y),center:y=>{const b=m[y.data[l]];return{x:b==null?void 0:b.x,y:b==null?void 0:b.y,z:b==null?void 0:b.z}}})}const{leaf:p,single:g,others:v}=e.centripetalOptions||{};p&&typeof p!="function"&&(e.centripetalOptions.leaf=()=>p),g&&typeof g!="function"&&(e.centripetalOptions.single=()=>g),v&&typeof v!="function"&&(e.centripetalOptions.others=()=>v)}runOneStep(e,t,r,i,a){const s={},o=e.getAllNodes(),c=e.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:l}=a;if(this.calRepulsive(e,s,a),c&&this.calAttractive(e,s,a),this.calGravity(e,t,s,a),this.updateVelocity(e,s,i,a),l){const u=this.calTotalEnergy(s,o);l({energy:u,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:r})}}calTotalEnergy(e,t){if(!(t!=null&&t.length))return 0;let r=0;return t.forEach((i,a)=>{const s=e[i.id].x,o=e[i.id].y,c=this.options.dimensions===3?e[i.id].z:0,l=s*s+o*o+c*c,{mass:u=1}=i.data;r+=u*l*.5}),r}calRepulsive(e,t,r){const{dimensions:i,factor:a,coulombDisScale:s}=r;A5(e,a,s*s,t,i)}calAttractive(e,t,r){const{dimensions:i,nodeSize:a}=r;e.getAllEdges().forEach((s,o)=>{const{source:c,target:l}=s,u=e.getNode(c),h=e.getNode(l);if(!u||!h)return;let f=h.data.x-u.data.x,d=h.data.y-u.data.y,p=i===3?h.data.z-u.data.z:0;!f&&!d&&(f=Math.random()*.01,d=Math.random()*.01,i===3&&!p&&(p=Math.random()*.01));const g=Math.sqrt(f*f+d*d+p*p);if(g<a(u)+a(h))return;const v=f/g,m=d/g,y=p/g,{linkDistance:b=200,edgeStrength:w=200}=s.data||{},S=(b-g)*w,_=u.data.mass||1,E=h.data.mass||1,P=1/_,O=1/E,C=v*S,M=m*S,T=y*S;t[c].x-=C*P,t[c].y-=M*P,t[c].z-=T*P,t[l].x+=C*O,t[l].y+=M*O,t[l].z+=T*O})}calGravity(e,t,r,i){const{getCenter:a}=i,s=e.getAllNodes(),o=t.getAllNodes(),c=t.getAllEdges(),{width:l,height:u,center:h,gravity:f,centripetalOptions:d}=i;s&&s.forEach(p=>{const{id:g,data:v}=p,{mass:m,x:y,y:b,z:w}=v,x=t.getNode(g);let S=0,_=0,E=0,P=f;const O=e.getDegree(g,"in"),C=e.getDegree(g,"out"),M=e.getDegree(g,"both"),T=a==null?void 0:a(x,M);if(T){const[R,D,B]=T;S=y-R,_=b-D,P=B}else S=y-h[0],_=b-h[1],E=w-h[2];if(P&&(r[g].x-=P*S/m,r[g].y-=P*_/m,r[g].z-=P*E/m),d){const{leaf:R,single:D,others:B,center:j}=d,{x:L,y:$,z:V,centerStrength:W}=(j==null?void 0:j(x,o,c,l,u))||{x:0,y:0,z:0,centerStrength:0};if(!rt(L)||!rt($))return;const Y=(y-L)/m,U=(b-$)/m,J=(w-V)/m;if(W&&(r[g].x-=W*Y,r[g].y-=W*U,r[g].z-=W*J),M===0){const ht=D(x);if(!ht)return;r[g].x-=ht*Y,r[g].y-=ht*U,r[g].z-=ht*J;return}if(O===0||C===0){const ht=R(x,o,c);if(!ht)return;r[g].x-=ht*Y,r[g].y-=ht*U,r[g].z-=ht*J;return}const at=B(x);if(!at)return;r[g].x-=at*Y,r[g].y-=at*U,r[g].z-=at*J}})}updateVelocity(e,t,r,i){const{damping:a,maxSpeed:s,interval:o,dimensions:c}=i,l=e.getAllNodes();l!=null&&l.length&&l.forEach(u=>{const{id:h}=u;let f=(r[h].x+t[h].x*o)*a||.01,d=(r[h].y+t[h].y*o)*a||.01,p=c===3?(r[h].z+t[h].z*o)*a||.01:0;const g=Math.sqrt(f*f+d*d+p*p);if(g>s){const v=s/g;f=v*f,d=v*d,p=v*p}r[h]={x:f,y:d,z:p}})}updatePosition(e,t,r,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,c=t.getAllNodes();if(!(c!=null&&c.length)){this.judgingDistance=0;return}let l=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),c.forEach(u=>{const{id:h}=u,f=e.getNode(h);if(rt(f.data.fx)&&rt(f.data.fy)){t.mergeNodeData(h,{x:f.data.fx,y:f.data.fy,z:o===3?f.data.fz:void 0});return}const d=r[h].x*s,p=r[h].y*s,g=o===3?r[h].z*s:0;t.mergeNodeData(h,{x:u.data.x+d,y:u.data.y+p,z:u.data.z+g});const v=Math.sqrt(d*d+p*p+g*g);switch(a){case"max":this.judgingDistance<v&&(this.judgingDistance=v);break;case"min":this.judgingDistance>v&&(this.judgingDistance=v);break;default:l=l+v;break}}),(!a||a==="mean")&&(this.judgingDistance=l/c.length)}}const eP=(n,e)=>{const t=n.getAllNodes();if(!(t!=null&&t.length))return{};const r={};return t.forEach((i,a)=>{n.getDegree(i.id,"both")===1&&(r[i.id]=LQ(n,"leaf",i,e))}),r},LQ=(n,e,t,r)=>{const i=n.getDegree(t.id,"in"),a=n.getDegree(t.id,"out");let s=t,o=[];i===0?(s=n.getSuccessors(t.id)[0],o=n.getNeighbors(s.id)):a===0&&(s=n.getPredecessors(t.id)[0],o=n.getNeighbors(s.id)),o=o.filter(l=>n.getDegree(l.id,"in")===0||n.getDegree(l.id,"out")===0);const c=IQ(n,e,r,t,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:c}},IQ=(n,e,t,r,i)=>{const a=r.data[t]||"";let s=(i==null?void 0:i.filter(o=>o.data[t]===a))||[];return s=s.filter(o=>n.getDegree(o.id,"in")===0||n.getDegree(o.id,"out")===0),s},nP=n=>{const e={x:0,y:0};n.forEach(r=>{const{x:i,y:a}=r.data;e.x+=i||0,e.y+=a||0});const t=n.length||1;return{x:e.x/t,y:e.y/t}},qv=(n,e)=>e.map(t=>{const{id:r,data:i}=t,a=n.getNode(r);return Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},a.data),{x:i.x,y:i.y,z:i.z})})});var Lt={};const BQ=Object.prototype.toString;function Hu(n){const e=BQ.call(n);return e.endsWith("Array]")&&!e.includes("Big")}const FQ=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:Hu},Symbol.toStringTag,{value:"Module"})),$Q=Zr(FQ);function zQ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Hu(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,r=t===void 0?0:t,i=e.toIndex,a=i===void 0?n.length:i;if(r<0||r>=n.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>n.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=n[r],o=r+1;o<a;o++)n[o]>s&&(s=n[o]);return s}function jQ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Hu(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,r=t===void 0?0:t,i=e.toIndex,a=i===void 0?n.length:i;if(r<0||r>=n.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>n.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=n[r],o=r+1;o<a;o++)n[o]<s&&(s=n[o]);return s}function qQ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hu(n)){if(n.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!Hu(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(n.length);var r=jQ(n),i=zQ(n);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=e.min,s=a===void 0?e.autoMinMax?r:0:a,o=e.max,c=o===void 0?e.autoMinMax?i:1:o;if(s>=c)throw new RangeError("min option must be smaller than max option");for(var l=(c-s)/(i-r),u=0;u<n.length;u++)t[u]=(n[u]-r)*l+s;return t}const GQ=Object.freeze(Object.defineProperty({__proto__:null,default:qQ},Symbol.toStringTag,{value:"Module"})),VQ=Zr(GQ);Object.defineProperty(Lt,"__esModule",{value:!0});var $n=$Q,rP=VQ;const wf=" ".repeat(2),N5=" ".repeat(4);function WQ(){return R5(this)}function R5(n,e={}){const{maxRows:t=15,maxColumns:r=10,maxNumSize:i=8,padMinus:a="auto"}=e;return`${n.constructor.name} {
${wf}[
${N5}${HQ(n,t,r,i,a)}
${wf}]
${wf}rows: ${n.rows}
${wf}columns: ${n.columns}
}`}function HQ(n,e,t,r,i){const{rows:a,columns:s}=n,o=Math.min(a,e),c=Math.min(s,t),l=[];if(i==="auto"){i=!1;t:for(let u=0;u<o;u++)for(let h=0;h<c;h++)if(n.get(u,h)<0){i=!0;break t}}for(let u=0;u<o;u++){let h=[];for(let f=0;f<c;f++)h.push(UQ(n.get(u,f),r,i));l.push(`${h.join(" ")}`)}return c!==s&&(l[l.length-1]+=` ... ${s-t} more columns`),o!==a&&l.push(`... ${a-e} more rows`),l.join(`
${N5}`)}function UQ(n,e,t){return(n>=0&&t?` ${iP(n,e-1)}`:iP(n,e)).padEnd(e)}function iP(n,e){let t=n.toString();if(t.length<=e)return t;let r=n.toFixed(e);if(r.length>e&&(r=n.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=n.toExponential(e);return i.length>e&&(i=n.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function YQ(n,e){n.prototype.add=function(r){return typeof r=="number"?this.addS(r):this.addM(r)},n.prototype.addS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r);return this},n.prototype.addM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r.get(i,a));return this},n.add=function(r,i){return new e(r).add(i)},n.prototype.sub=function(r){return typeof r=="number"?this.subS(r):this.subM(r)},n.prototype.subS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r);return this},n.prototype.subM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r.get(i,a));return this},n.sub=function(r,i){return new e(r).sub(i)},n.prototype.subtract=n.prototype.sub,n.prototype.subtractS=n.prototype.subS,n.prototype.subtractM=n.prototype.subM,n.subtract=n.sub,n.prototype.mul=function(r){return typeof r=="number"?this.mulS(r):this.mulM(r)},n.prototype.mulS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r);return this},n.prototype.mulM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r.get(i,a));return this},n.mul=function(r,i){return new e(r).mul(i)},n.prototype.multiply=n.prototype.mul,n.prototype.multiplyS=n.prototype.mulS,n.prototype.multiplyM=n.prototype.mulM,n.multiply=n.mul,n.prototype.div=function(r){return typeof r=="number"?this.divS(r):this.divM(r)},n.prototype.divS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r);return this},n.prototype.divM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r.get(i,a));return this},n.div=function(r,i){return new e(r).div(i)},n.prototype.divide=n.prototype.div,n.prototype.divideS=n.prototype.divS,n.prototype.divideM=n.prototype.divM,n.divide=n.div,n.prototype.mod=function(r){return typeof r=="number"?this.modS(r):this.modM(r)},n.prototype.modS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r);return this},n.prototype.modM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r.get(i,a));return this},n.mod=function(r,i){return new e(r).mod(i)},n.prototype.modulus=n.prototype.mod,n.prototype.modulusS=n.prototype.modS,n.prototype.modulusM=n.prototype.modM,n.modulus=n.mod,n.prototype.and=function(r){return typeof r=="number"?this.andS(r):this.andM(r)},n.prototype.andS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r);return this},n.prototype.andM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r.get(i,a));return this},n.and=function(r,i){return new e(r).and(i)},n.prototype.or=function(r){return typeof r=="number"?this.orS(r):this.orM(r)},n.prototype.orS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r);return this},n.prototype.orM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r.get(i,a));return this},n.or=function(r,i){return new e(r).or(i)},n.prototype.xor=function(r){return typeof r=="number"?this.xorS(r):this.xorM(r)},n.prototype.xorS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r);return this},n.prototype.xorM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r.get(i,a));return this},n.xor=function(r,i){return new e(r).xor(i)},n.prototype.leftShift=function(r){return typeof r=="number"?this.leftShiftS(r):this.leftShiftM(r)},n.prototype.leftShiftS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r);return this},n.prototype.leftShiftM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r.get(i,a));return this},n.leftShift=function(r,i){return new e(r).leftShift(i)},n.prototype.signPropagatingRightShift=function(r){return typeof r=="number"?this.signPropagatingRightShiftS(r):this.signPropagatingRightShiftM(r)},n.prototype.signPropagatingRightShiftS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r);return this},n.prototype.signPropagatingRightShiftM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r.get(i,a));return this},n.signPropagatingRightShift=function(r,i){return new e(r).signPropagatingRightShift(i)},n.prototype.rightShift=function(r){return typeof r=="number"?this.rightShiftS(r):this.rightShiftM(r)},n.prototype.rightShiftS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r);return this},n.prototype.rightShiftM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r.get(i,a));return this},n.rightShift=function(r,i){return new e(r).rightShift(i)},n.prototype.zeroFillRightShift=n.prototype.rightShift,n.prototype.zeroFillRightShiftS=n.prototype.rightShiftS,n.prototype.zeroFillRightShiftM=n.prototype.rightShiftM,n.zeroFillRightShift=n.rightShift,n.prototype.not=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,~this.get(r,i));return this},n.not=function(r){return new e(r).not()},n.prototype.abs=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.abs(this.get(r,i)));return this},n.abs=function(r){return new e(r).abs()},n.prototype.acos=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.acos(this.get(r,i)));return this},n.acos=function(r){return new e(r).acos()},n.prototype.acosh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.acosh(this.get(r,i)));return this},n.acosh=function(r){return new e(r).acosh()},n.prototype.asin=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.asin(this.get(r,i)));return this},n.asin=function(r){return new e(r).asin()},n.prototype.asinh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.asinh(this.get(r,i)));return this},n.asinh=function(r){return new e(r).asinh()},n.prototype.atan=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.atan(this.get(r,i)));return this},n.atan=function(r){return new e(r).atan()},n.prototype.atanh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.atanh(this.get(r,i)));return this},n.atanh=function(r){return new e(r).atanh()},n.prototype.cbrt=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.cbrt(this.get(r,i)));return this},n.cbrt=function(r){return new e(r).cbrt()},n.prototype.ceil=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.ceil(this.get(r,i)));return this},n.ceil=function(r){return new e(r).ceil()},n.prototype.clz32=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.clz32(this.get(r,i)));return this},n.clz32=function(r){return new e(r).clz32()},n.prototype.cos=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.cos(this.get(r,i)));return this},n.cos=function(r){return new e(r).cos()},n.prototype.cosh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.cosh(this.get(r,i)));return this},n.cosh=function(r){return new e(r).cosh()},n.prototype.exp=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.exp(this.get(r,i)));return this},n.exp=function(r){return new e(r).exp()},n.prototype.expm1=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.expm1(this.get(r,i)));return this},n.expm1=function(r){return new e(r).expm1()},n.prototype.floor=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.floor(this.get(r,i)));return this},n.floor=function(r){return new e(r).floor()},n.prototype.fround=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.fround(this.get(r,i)));return this},n.fround=function(r){return new e(r).fround()},n.prototype.log=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.log(this.get(r,i)));return this},n.log=function(r){return new e(r).log()},n.prototype.log1p=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.log1p(this.get(r,i)));return this},n.log1p=function(r){return new e(r).log1p()},n.prototype.log10=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.log10(this.get(r,i)));return this},n.log10=function(r){return new e(r).log10()},n.prototype.log2=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.log2(this.get(r,i)));return this},n.log2=function(r){return new e(r).log2()},n.prototype.round=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.round(this.get(r,i)));return this},n.round=function(r){return new e(r).round()},n.prototype.sign=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.sign(this.get(r,i)));return this},n.sign=function(r){return new e(r).sign()},n.prototype.sin=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.sin(this.get(r,i)));return this},n.sin=function(r){return new e(r).sin()},n.prototype.sinh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.sinh(this.get(r,i)));return this},n.sinh=function(r){return new e(r).sinh()},n.prototype.sqrt=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.sqrt(this.get(r,i)));return this},n.sqrt=function(r){return new e(r).sqrt()},n.prototype.tan=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.tan(this.get(r,i)));return this},n.tan=function(r){return new e(r).tan()},n.prototype.tanh=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.tanh(this.get(r,i)));return this},n.tanh=function(r){return new e(r).tanh()},n.prototype.trunc=function(){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.trunc(this.get(r,i)));return this},n.trunc=function(r){return new e(r).trunc()},n.pow=function(r,i){return new e(r).pow(i)},n.prototype.pow=function(r){return typeof r=="number"?this.powS(r):this.powM(r)},n.prototype.powS=function(r){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)**r);return this},n.prototype.powM=function(r){if(r=e.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)**r.get(i,a));return this}}function xr(n,e,t){let r=t?n.rows:n.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function wr(n,e,t){let r=t?n.columns:n.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function fo(n,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==n.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function po(n,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==n.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function bS(n,e){if(!$n.isAnyArray(e))throw new TypeError("row indices must be an array");for(let t=0;t<e.length;t++)if(e[t]<0||e[t]>=n.rows)throw new RangeError("row indices are out of range")}function ES(n,e){if(!$n.isAnyArray(e))throw new TypeError("column indices must be an array");for(let t=0;t<e.length;t++)if(e[t]<0||e[t]>=n.columns)throw new RangeError("column indices are out of range")}function Mw(n,e,t,r,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Sf("startRow",e),Sf("endRow",t),Sf("startColumn",r),Sf("endColumn",i),e>t||r>i||e<0||e>=n.rows||t<0||t>=n.rows||r<0||r>=n.columns||i<0||i>=n.columns)throw new RangeError("Submatrix indices are out of range")}function Tg(n,e=0){let t=[];for(let r=0;r<n;r++)t.push(e);return t}function Sf(n,e){if(typeof e!="number")throw new TypeError(`${n} must be a number`)}function io(n){if(n.isEmpty())throw new Error("Empty matrix has no elements to index")}function KQ(n){let e=Tg(n.rows);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[t]+=n.get(t,r);return e}function XQ(n){let e=Tg(n.columns);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[r]+=n.get(t,r);return e}function ZQ(n){let e=0;for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)e+=n.get(t,r);return e}function QQ(n){let e=Tg(n.rows,1);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[t]*=n.get(t,r);return e}function JQ(n){let e=Tg(n.columns,1);for(let t=0;t<n.rows;++t)for(let r=0;r<n.columns;++r)e[r]*=n.get(t,r);return e}function tJ(n){let e=1;for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)e*=n.get(t,r);return e}function eJ(n,e,t){const r=n.rows,i=n.columns,a=[];for(let s=0;s<r;s++){let o=0,c=0,l=0;for(let u=0;u<i;u++)l=n.get(s,u)-t[s],o+=l,c+=l*l;e?a.push((c-o*o/i)/(i-1)):a.push((c-o*o/i)/i)}return a}function nJ(n,e,t){const r=n.rows,i=n.columns,a=[];for(let s=0;s<i;s++){let o=0,c=0,l=0;for(let u=0;u<r;u++)l=n.get(u,s)-t[s],o+=l,c+=l*l;e?a.push((c-o*o/r)/(r-1)):a.push((c-o*o/r)/r)}return a}function rJ(n,e,t){const r=n.rows,i=n.columns,a=r*i;let s=0,o=0,c=0;for(let l=0;l<r;l++)for(let u=0;u<i;u++)c=n.get(l,u)-t,s+=c,o+=c*c;return e?(o-s*s/a)/(a-1):(o-s*s/a)/a}function iJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e[t])}function aJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e[r])}function sJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)-e)}function oJ(n){const e=[];for(let t=0;t<n.rows;t++){let r=0;for(let i=0;i<n.columns;i++)r+=n.get(t,i)**2/(n.columns-1);e.push(Math.sqrt(r))}return e}function cJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e[t])}function lJ(n){const e=[];for(let t=0;t<n.columns;t++){let r=0;for(let i=0;i<n.rows;i++)r+=n.get(i,t)**2/(n.rows-1);e.push(Math.sqrt(r))}return e}function uJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e[r])}function hJ(n){const e=n.size-1;let t=0;for(let r=0;r<n.columns;r++)for(let i=0;i<n.rows;i++)t+=n.get(i,r)**2/e;return Math.sqrt(t)}function fJ(n,e){for(let t=0;t<n.rows;t++)for(let r=0;r<n.columns;r++)n.set(t,r,n.get(t,r)/e)}class Ot{static from1DArray(e,t,r){if(e*t!==r.length)throw new RangeError("data length does not match given dimensions");let a=new ut(e,t);for(let s=0;s<e;s++)for(let o=0;o<t;o++)a.set(s,o,r[s*t+o]);return a}static rowVector(e){let t=new ut(1,e.length);for(let r=0;r<e.length;r++)t.set(0,r,e[r]);return t}static columnVector(e){let t=new ut(e.length,1);for(let r=0;r<e.length;r++)t.set(r,0,e[r]);return t}static zeros(e,t){return new ut(e,t)}static ones(e,t){return new ut(e,t).fill(1)}static rand(e,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{random:i=Math.random}=r;let a=new ut(e,t);for(let s=0;s<e;s++)for(let o=0;o<t;o++)a.set(s,o,i());return a}static randInt(e,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:i=0,max:a=1e3,random:s=Math.random}=r;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(a))throw new TypeError("max must be an integer");if(i>=a)throw new RangeError("min must be smaller than max");let o=a-i,c=new ut(e,t);for(let l=0;l<e;l++)for(let u=0;u<t;u++){let h=i+Math.round(s()*o);c.set(l,u,h)}return c}static eye(e,t,r){t===void 0&&(t=e),r===void 0&&(r=1);let i=Math.min(e,t),a=this.zeros(e,t);for(let s=0;s<i;s++)a.set(s,s,r);return a}static diag(e,t,r){let i=e.length;t===void 0&&(t=i),r===void 0&&(r=t);let a=Math.min(i,t,r),s=this.zeros(t,r);for(let o=0;o<a;o++)s.set(o,o,e[o]);return s}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let r=e.rows,i=e.columns,a=new ut(r,i);for(let s=0;s<r;s++)for(let o=0;o<i;o++)a.set(s,o,Math.min(e.get(s,o),t.get(s,o)));return a}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let r=e.rows,i=e.columns,a=new this(r,i);for(let s=0;s<r;s++)for(let o=0;o<i;o++)a.set(s,o,Math.max(e.get(s,o),t.get(s,o)));return a}static checkMatrix(e){return Ot.isMatrix(e)?e:new ut(e)}static isMatrix(e){return e!=null&&e.klass==="Matrix"}get size(){return this.rows*this.columns}apply(e){if(typeof e!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.call(this,t,r);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let r=0;r<this.columns;r++)e[t].push(this.get(t,r))}return e}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let e=0;e<this.rows;e++)if(this.get(e,e)!==0)return!1;return!0}isEchelonForm(){let e=0,t=0,r=-1,i=!0,a=!1;for(;e<this.rows&&i;){for(t=0,a=!1;t<this.columns&&a===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>r?(a=!0,r=t):(i=!1,a=!0);e++}return i}isReducedEchelonForm(){let e=0,t=0,r=-1,i=!0,a=!1;for(;e<this.rows&&i;){for(t=0,a=!1;t<this.columns&&a===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>r?(a=!0,r=t):(i=!1,a=!0);for(let s=t+1;s<this.rows;s++)this.get(e,s)!==0&&(i=!1);e++}return i}echelonForm(){let e=this.clone(),t=0,r=0;for(;t<e.rows&&r<e.columns;){let i=t;for(let a=t;a<e.rows;a++)e.get(a,r)>e.get(i,r)&&(i=a);if(e.get(i,r)===0)r++;else{e.swapRows(t,i);let a=e.get(t,r);for(let s=r;s<e.columns;s++)e.set(t,s,e.get(t,s)/a);for(let s=t+1;s<e.rows;s++){let o=e.get(s,r)/e.get(t,r);e.set(s,r,0);for(let c=r+1;c<e.columns;c++)e.set(s,c,e.get(s,c)-e.get(t,c)*o)}t++,r++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,r=e.rows,i=r-1;for(;i>=0;)if(e.maxRow(i)===0)i--;else{let a=0,s=!1;for(;a<r&&s===!1;)e.get(i,a)===1?s=!0:a++;for(let o=0;o<i;o++){let c=e.get(o,a);for(let l=a;l<t;l++){let u=e.get(o,l)-c*e.get(i,l);e.set(o,l,u)}}i--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:r=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let i=new ut(this.rows*t,this.columns*r);for(let a=0;a<t;a++)for(let s=0;s<r;s++)i.setSubMatrix(this,this.rows*a,this.columns*s);return i}fill(e){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,e);return this}neg(){return this.mulS(-1)}getRow(e){xr(this,e);let t=[];for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}getRowVector(e){return ut.rowVector(this.getRow(e))}setRow(e,t){xr(this,e),t=fo(this,t);for(let r=0;r<this.columns;r++)this.set(e,r,t[r]);return this}swapRows(e,t){xr(this,e),xr(this,t);for(let r=0;r<this.columns;r++){let i=this.get(e,r);this.set(e,r,this.get(t,r)),this.set(t,r,i)}return this}getColumn(e){wr(this,e);let t=[];for(let r=0;r<this.rows;r++)t.push(this.get(r,e));return t}getColumnVector(e){return ut.columnVector(this.getColumn(e))}setColumn(e,t){wr(this,e),t=po(this,t);for(let r=0;r<this.rows;r++)this.set(r,e,t[r]);return this}swapColumns(e,t){wr(this,e),wr(this,t);for(let r=0;r<this.rows;r++){let i=this.get(r,e);this.set(r,e,this.get(r,t)),this.set(r,t,i)}return this}addRowVector(e){e=fo(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+e[r]);return this}subRowVector(e){e=fo(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-e[r]);return this}mulRowVector(e){e=fo(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e[r]);return this}divRowVector(e){e=fo(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/e[r]);return this}addColumnVector(e){e=po(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+e[t]);return this}subColumnVector(e){e=po(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-e[t]);return this}mulColumnVector(e){e=po(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e[t]);return this}divColumnVector(e){e=po(this,e);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/e[t]);return this}mulRow(e,t){xr(this,e);for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this}mulColumn(e,t){wr(this,e);for(let r=0;r<this.rows;r++)this.set(r,e,this.get(r,e)*t);return this}max(e){if(this.isEmpty())return NaN;switch(e){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>t[r]&&(t[r]=this.get(r,i));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>t[i]&&(t[i]=this.get(r,i));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>t&&(t=this.get(r,i));return t}default:throw new Error(`invalid option: ${e}`)}}maxIndex(){io(this);let e=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>e&&(e=this.get(r,i),t[0]=r,t[1]=i);return t}min(e){if(this.isEmpty())return NaN;switch(e){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<t[r]&&(t[r]=this.get(r,i));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<t[i]&&(t[i]=this.get(r,i));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<t&&(t=this.get(r,i));return t}default:throw new Error(`invalid option: ${e}`)}}minIndex(){io(this);let e=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<e&&(e=this.get(r,i),t[0]=r,t[1]=i);return t}maxRow(e){if(xr(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxRowIndex(e){xr(this,e),io(this);let t=this.get(e,0),r=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i),r[1]=i);return r}minRow(e){if(xr(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minRowIndex(e){xr(this,e),io(this);let t=this.get(e,0),r=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i),r[1]=i);return r}maxColumn(e){if(wr(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxColumnIndex(e){wr(this,e),io(this);let t=this.get(0,e),r=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)>t&&(t=this.get(i,e),r[0]=i);return r}minColumn(e){if(wr(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e));return t}minColumnIndex(e){wr(this,e),io(this);let t=this.get(0,e),r=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)<t&&(t=this.get(i,e),r[0]=i);return r}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let r=0;r<e;r++)t.push(this.get(r,r));return t}norm(e="frobenius"){switch(e){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${e}`)}}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r),this.set(t,r,e);return this}dot(e){Ot.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let r=0;for(let i=0;i<t.length;i++)r+=t[i]*e[i];return r}mmul(e){e=ut.checkMatrix(e);let t=this.rows,r=this.columns,i=e.columns,a=new ut(t,i),s=new Float64Array(r);for(let o=0;o<i;o++){for(let c=0;c<r;c++)s[c]=e.get(c,o);for(let c=0;c<t;c++){let l=0;for(let u=0;u<r;u++)l+=this.get(c,u)*s[u];a.set(c,o,l)}}return a}strassen2x2(e){e=ut.checkMatrix(e);let t=new ut(2,2);const r=this.get(0,0),i=e.get(0,0),a=this.get(0,1),s=e.get(0,1),o=this.get(1,0),c=e.get(1,0),l=this.get(1,1),u=e.get(1,1),h=(r+l)*(i+u),f=(o+l)*i,d=r*(s-u),p=l*(c-i),g=(r+a)*u,v=(o-r)*(i+s),m=(a-l)*(c+u),y=h+p-g+m,b=d+g,w=f+p,x=h-f+d+v;return t.set(0,0,y),t.set(0,1,b),t.set(1,0,w),t.set(1,1,x),t}strassen3x3(e){e=ut.checkMatrix(e);let t=new ut(3,3);const r=this.get(0,0),i=this.get(0,1),a=this.get(0,2),s=this.get(1,0),o=this.get(1,1),c=this.get(1,2),l=this.get(2,0),u=this.get(2,1),h=this.get(2,2),f=e.get(0,0),d=e.get(0,1),p=e.get(0,2),g=e.get(1,0),v=e.get(1,1),m=e.get(1,2),y=e.get(2,0),b=e.get(2,1),w=e.get(2,2),x=(r+i+a-s-o-u-h)*v,S=(r-s)*(-d+v),_=o*(-f+d+g-v-m-y+w),E=(-r+s+o)*(f-d+v),P=(s+o)*(-f+d),O=r*f,C=(-r+l+u)*(f-p+m),M=(-r+l)*(p-m),T=(l+u)*(-f+p),R=(r+i+a-o-c-l-u)*m,D=u*(-f+p+g-v-m-y+b),B=(-a+u+h)*(v+y-b),j=(a-h)*(v-b),L=a*y,$=(u+h)*(-y+b),V=(-a+o+c)*(m+y-w),W=(a-c)*(m-w),Y=(o+c)*(-y+w),U=i*g,J=c*b,at=s*p,ht=l*d,lt=h*w,Nt=O+L+U,pe=x+E+P+O+B+L+$,Be=O+C+T+R+L+V+Y,nn=S+_+E+O+L+V+W,ri=S+E+P+O+J,Ya=L+V+W+Y+at,Ka=O+C+M+D+B+j+L,Ht=B+j+L+$+ht,dr=O+C+M+T+lt;return t.set(0,0,Nt),t.set(0,1,pe),t.set(0,2,Be),t.set(1,0,nn),t.set(1,1,ri),t.set(1,2,Ya),t.set(2,0,Ka),t.set(2,1,Ht),t.set(2,2,dr),t}mmulStrassen(e){e=ut.checkMatrix(e);let t=this.clone(),r=t.rows,i=t.columns,a=e.rows,s=e.columns;i!==a&&console.warn(`Multiplying ${r} x ${i} and ${a} x ${s} matrix: dimensions do not match.`);function o(h,f,d){let p=h.rows,g=h.columns;if(p===f&&g===d)return h;{let v=Ot.zeros(f,d);return v=v.setSubMatrix(h,0,0),v}}let c=Math.max(r,a),l=Math.max(i,s);t=o(t,c,l),e=o(e,c,l);function u(h,f,d,p){if(d<=512||p<=512)return h.mmul(f);d%2===1&&p%2===1?(h=o(h,d+1,p+1),f=o(f,d+1,p+1)):d%2===1?(h=o(h,d+1,p),f=o(f,d+1,p)):p%2===1&&(h=o(h,d,p+1),f=o(f,d,p+1));let g=parseInt(h.rows/2,10),v=parseInt(h.columns/2,10),m=h.subMatrix(0,g-1,0,v-1),y=f.subMatrix(0,g-1,0,v-1),b=h.subMatrix(0,g-1,v,h.columns-1),w=f.subMatrix(0,g-1,v,f.columns-1),x=h.subMatrix(g,h.rows-1,0,v-1),S=f.subMatrix(g,f.rows-1,0,v-1),_=h.subMatrix(g,h.rows-1,v,h.columns-1),E=f.subMatrix(g,f.rows-1,v,f.columns-1),P=u(Ot.add(m,_),Ot.add(y,E),g,v),O=u(Ot.add(x,_),y,g,v),C=u(m,Ot.sub(w,E),g,v),M=u(_,Ot.sub(S,y),g,v),T=u(Ot.add(m,b),E,g,v),R=u(Ot.sub(x,m),Ot.add(y,w),g,v),D=u(Ot.sub(b,_),Ot.add(S,E),g,v),B=Ot.add(P,M);B.sub(T),B.add(D);let j=Ot.add(C,T),L=Ot.add(O,M),$=Ot.sub(P,O);$.add(C),$.add(R);let V=Ot.zeros(2*B.rows,2*B.columns);return V=V.setSubMatrix(B,0,0),V=V.setSubMatrix(j,B.rows,0),V=V.setSubMatrix(L,0,B.columns),V=V.setSubMatrix($,B.rows,B.columns),V.subMatrix(0,d-1,0,p-1)}return u(t,e,c,l)}scaleRows(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let i=new ut(this.rows,this.columns);for(let a=0;a<this.rows;a++){const s=this.getRow(a);s.length>0&&rP(s,{min:t,max:r,output:s}),i.setRow(a,s)}return i}scaleColumns(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let i=new ut(this.rows,this.columns);for(let a=0;a<this.columns;a++){const s=this.getColumn(a);s.length&&rP(s,{min:t,max:r,output:s}),i.setColumn(a,s)}return i}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let r=0;r<e;r++){let i=this.get(t,r),a=this.get(t,this.columns-1-r);this.set(t,r,a),this.set(t,this.columns-1-r,i)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let r=0;r<e;r++){let i=this.get(r,t),a=this.get(this.rows-1-r,t);this.set(r,t,a),this.set(this.rows-1-r,t,i)}return this}kroneckerProduct(e){e=ut.checkMatrix(e);let t=this.rows,r=this.columns,i=e.rows,a=e.columns,s=new ut(t*i,r*a);for(let o=0;o<t;o++)for(let c=0;c<r;c++)for(let l=0;l<i;l++)for(let u=0;u<a;u++)s.set(i*o+l,a*c+u,this.get(o,c)*e.get(l,u));return s}kroneckerSum(e){if(e=ut.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,r=e.rows,i=this.kroneckerProduct(ut.eye(r,r)),a=ut.eye(t,t).kroneckerProduct(e);return i.add(a)}transpose(){let e=new ut(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e.set(r,t,this.get(t,r));return e}sortRows(e=aP){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=aP){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,r,i){Mw(this,e,t,r,i);let a=new ut(t-e+1,i-r+1);for(let s=e;s<=t;s++)for(let o=r;o<=i;o++)a.set(s-e,o-r,this.get(s,o));return a}subMatrixRow(e,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.columns-1),t>r||t<0||t>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let i=new ut(e.length,r-t+1);for(let a=0;a<e.length;a++)for(let s=t;s<=r;s++){if(e[a]<0||e[a]>=this.rows)throw new RangeError(`Row index out of range: ${e[a]}`);i.set(a,s-t,this.get(e[a],s))}return i}subMatrixColumn(e,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.rows-1),t>r||t<0||t>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let i=new ut(r-t+1,e.length);for(let a=0;a<e.length;a++)for(let s=t;s<=r;s++){if(e[a]<0||e[a]>=this.columns)throw new RangeError(`Column index out of range: ${e[a]}`);i.set(s-t,a,this.get(s,e[a]))}return i}setSubMatrix(e,t,r){if(e=ut.checkMatrix(e),e.isEmpty())return this;let i=t+e.rows-1,a=r+e.columns-1;Mw(this,t,i,r,a);for(let s=0;s<e.rows;s++)for(let o=0;o<e.columns;o++)this.set(t+s,r+o,e.get(s,o));return this}selection(e,t){bS(this,e),ES(this,t);let r=new ut(e.length,t.length);for(let i=0;i<e.length;i++){let a=e[i];for(let s=0;s<t.length;s++){let o=t[s];r.set(i,s,this.get(a,o))}}return r}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let r=0;r<e;r++)t+=this.get(r,r);return t}clone(){return this.constructor.copy(this,new ut(this.rows,this.columns))}static copy(e,t){for(const[r,i,a]of e.entries())t.set(r,i,a);return t}sum(e){switch(e){case"row":return KQ(this);case"column":return XQ(this);case void 0:return ZQ(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return QQ(this);case"column":return JQ(this);case void 0:return tJ(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":{for(let r=0;r<this.rows;r++)t[r]/=this.columns;return t}case"column":{for(let r=0;r<this.columns;r++)t[r]/=this.rows;return t}case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(e)}=t;if(typeof r!="boolean")throw new TypeError("unbiased must be a boolean");switch(e){case"row":{if(!$n.isAnyArray(i))throw new TypeError("mean must be an array");return eJ(this,r,i)}case"column":{if(!$n.isAnyArray(i))throw new TypeError("mean must be an array");return nJ(this,r,i)}case void 0:{if(typeof i!="number")throw new TypeError("mean must be a number");return rJ(this,r,i)}default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){typeof e=="object"&&(t=e,e=void 0);const r=this.variance(e,t);if(e===void 0)return Math.sqrt(r);for(let i=0;i<r.length;i++)r[i]=Math.sqrt(r[i]);return r}center(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:r=this.mean(e)}=t;switch(e){case"row":{if(!$n.isAnyArray(r))throw new TypeError("center must be an array");return iJ(this,r),this}case"column":{if(!$n.isAnyArray(r))throw new TypeError("center must be an array");return aJ(this,r),this}case void 0:{if(typeof r!="number")throw new TypeError("center must be a number");return sJ(this,r),this}default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");let r=t.scale;switch(e){case"row":{if(r===void 0)r=oJ(this);else if(!$n.isAnyArray(r))throw new TypeError("scale must be an array");return cJ(this,r),this}case"column":{if(r===void 0)r=lJ(this);else if(!$n.isAnyArray(r))throw new TypeError("scale must be an array");return uJ(this,r),this}case void 0:{if(r===void 0)r=hJ(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return fJ(this,r),this}default:throw new Error(`invalid option: ${e}`)}}toString(e){return R5(this,e)}[Symbol.iterator](){return this.entries()}*entries(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield[e,t,this.get(e,t)]}*values(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield this.get(e,t)}}Ot.prototype.klass="Matrix";typeof Symbol<"u"&&(Ot.prototype[Symbol.for("nodejs.util.inspect.custom")]=WQ);function aP(n,e){return n-e}function dJ(n){return n.every(e=>typeof e=="number")}Ot.random=Ot.rand;Ot.randomInt=Ot.randInt;Ot.diagonal=Ot.diag;Ot.prototype.diagonal=Ot.prototype.diag;Ot.identity=Ot.eye;Ot.prototype.negate=Ot.prototype.neg;Ot.prototype.tensorProduct=Ot.prototype.kroneckerProduct;var ih,Tw,Ss;let ut=(Ss=class extends Ot{constructor(t,r){super();W0(this,ih);A(this,"data");if(Ss.isMatrix(t))H0(this,ih,Tw).call(this,t.rows,t.columns),Ss.copy(t,this);else if(Number.isInteger(t)&&t>=0)H0(this,ih,Tw).call(this,t,r);else if($n.isAnyArray(t)){const i=t;if(t=i.length,r=t?i[0].length:0,typeof r!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let a=0;a<t;a++){if(i[a].length!==r)throw new RangeError("Inconsistent array dimensions");if(!dJ(i[a]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(i[a]))}this.rows=t,this.columns=r}else throw new TypeError("First argument must be a positive number or an array")}set(t,r,i){return this.data[t][r]=i,this}get(t,r){return this.data[t][r]}removeRow(t){return xr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,r){return r===void 0&&(r=t,t=this.rows),xr(this,t,!0),r=Float64Array.from(fo(this,r)),this.data.splice(t,0,r),this.rows+=1,this}removeColumn(t){wr(this,t);for(let r=0;r<this.rows;r++){const i=new Float64Array(this.columns-1);for(let a=0;a<t;a++)i[a]=this.data[r][a];for(let a=t+1;a<this.columns;a++)i[a-1]=this.data[r][a];this.data[r]=i}return this.columns-=1,this}addColumn(t,r){typeof r>"u"&&(r=t,t=this.columns),wr(this,t,!0),r=po(this,r);for(let i=0;i<this.rows;i++){const a=new Float64Array(this.columns+1);let s=0;for(;s<t;s++)a[s]=this.data[i][s];for(a[s++]=r[i];s<this.columns+1;s++)a[s]=this.data[i][s-1];this.data[i]=a}return this.columns+=1,this}},ih=new WeakSet,Tw=function(t,r){if(this.data=[],Number.isInteger(r)&&r>=0)for(let i=0;i<t;i++)this.data.push(new Float64Array(r));else throw new TypeError("nColumns must be a positive integer");this.rows=t,this.columns=r},Ss);YQ(Ot,ut);var gn;const Gp=class Gp extends Ot{constructor(t){super();W0(this,gn);if(ut.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");Vh(this,gn,ut.copy(t,new ut(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)Vh(this,gn,new ut(t,t));else if(Vh(this,gn,new ut(t)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Fr(this,gn).size}get rows(){return Fr(this,gn).rows}get columns(){return Fr(this,gn).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return ut.isMatrix(t)&&t.klassType==="SymmetricMatrix"}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}clone(){const t=new Gp(this.diagonalSize);for(const[r,i,a]of this.upperRightEntries())t.set(r,i,a);return t}toMatrix(){return new ut(this)}get(t,r){return Fr(this,gn).get(t,r)}set(t,r,i){return Fr(this,gn).set(t,r,i),Fr(this,gn).set(r,t,i),this}removeCross(t){return Fr(this,gn).removeRow(t),Fr(this,gn).removeColumn(t),this}addCross(t,r){r===void 0&&(r=t,t=this.diagonalSize);const i=r.slice();return i.splice(t,1),Fr(this,gn).addRow(t,i),Fr(this,gn).addColumn(t,r),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const r=[];for(const[i,a]of t.entries())a||r.push(i);r.reverse();for(const i of r)this.removeCross(i);return this}toCompact(){const{diagonalSize:t}=this,r=new Array(t*(t+1)/2);for(let i=0,a=0,s=0;s<r.length;s++)r[s]=this.get(a,i),++i>=t&&(i=++a);return r}static fromCompact(t){const r=t.length,i=(Math.sqrt(8*r+1)-1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const a=new Gp(i);for(let s=0,o=0,c=0;c<r;c++)a.set(s,o,t[c]),++s>=i&&(s=++o);return a}*upperRightEntries(){for(let t=0,r=0;t<this.diagonalSize;void 0){const i=this.get(t,r);yield[t,r,i],++r>=this.diagonalSize&&(r=++t)}}*upperRightValues(){for(let t=0,r=0;t<this.diagonalSize;void 0)yield this.get(t,r),++r>=this.diagonalSize&&(r=++t)}};gn=new WeakMap;let xs=Gp;xs.prototype.klassType="SymmetricMatrix";class Ag extends xs{static isDistanceMatrix(e){return xs.isSymmetricMatrix(e)&&e.klassSubType==="DistanceMatrix"}constructor(e){if(super(e),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(e,t,r){return e===t&&(r=0),super.set(e,t,r)}addCross(e,t){return t===void 0&&(t=e,e=this.diagonalSize),t=t.slice(),t[e]=0,super.addCross(e,t)}toSymmetricMatrix(){return new xs(this)}clone(){const e=new Ag(this.diagonalSize);for(const[t,r,i]of this.upperRightEntries())t!==r&&e.set(t,r,i);return e}toCompact(){const{diagonalSize:e}=this,t=(e-1)*e/2,r=new Array(t);for(let i=1,a=0,s=0;s<r.length;s++)r[s]=this.get(a,i),++i>=e&&(i=++a+1);return r}static fromCompact(e){const t=e.length;if(t===0)return new this(0);const r=(Math.sqrt(8*t+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(e)}`);const i=new this(r);for(let a=1,s=0,o=0;o<t;o++)i.set(a,s,e[o]),++a>=r&&(a=++s+1);return i}}Ag.prototype.klassSubType="DistanceMatrix";class Ji extends Ot{constructor(e,t,r){super(),this.matrix=e,this.rows=t,this.columns=r}}class pJ extends Ji{constructor(e,t){wr(e,t),super(e,e.rows,1),this.column=t}set(e,t,r){return this.matrix.set(e,this.column,r),this}get(e){return this.matrix.get(e,this.column)}}class gJ extends Ji{constructor(e,t){ES(e,t),super(e,e.rows,t.length),this.columnIndices=t}set(e,t,r){return this.matrix.set(e,this.columnIndices[t],r),this}get(e,t){return this.matrix.get(e,this.columnIndices[t])}}class vJ extends Ji{constructor(e){super(e,e.rows,e.columns)}set(e,t,r){return this.matrix.set(e,this.columns-t-1,r),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}class mJ extends Ji{constructor(e){super(e,e.rows,e.columns)}set(e,t,r){return this.matrix.set(this.rows-e-1,t,r),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}class yJ extends Ji{constructor(e,t){xr(e,t),super(e,1,e.columns),this.row=t}set(e,t,r){return this.matrix.set(this.row,t,r),this}get(e,t){return this.matrix.get(this.row,t)}}class bJ extends Ji{constructor(e,t){bS(e,t),super(e,t.length,e.columns),this.rowIndices=t}set(e,t,r){return this.matrix.set(this.rowIndices[e],t,r),this}get(e,t){return this.matrix.get(this.rowIndices[e],t)}}class od extends Ji{constructor(e,t,r){bS(e,t),ES(e,r),super(e,t.length,r.length),this.rowIndices=t,this.columnIndices=r}set(e,t,r){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],r),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}class EJ extends Ji{constructor(e,t,r,i,a){Mw(e,t,r,i,a),super(e,r-t+1,a-i+1),this.startRow=t,this.startColumn=i}set(e,t,r){return this.matrix.set(this.startRow+e,this.startColumn+t,r),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}class xJ extends Ji{constructor(e){super(e,e.columns,e.rows)}set(e,t,r){return this.matrix.set(t,e,r),this}get(e,t){return this.matrix.get(t,e)}}class k5 extends Ot{constructor(e,t={}){const{rows:r=1}=t;if(e.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=e.length/r,this.data=e}set(e,t,r){let i=this._calculateIndex(e,t);return this.data[i]=r,this}get(e,t){let r=this._calculateIndex(e,t);return this.data[r]}_calculateIndex(e,t){return e*this.columns+t}}class or extends Ot{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,r){return this.data[e][t]=r,this}get(e,t){return this.data[e][t]}}function wJ(n,e){if($n.isAnyArray(n))return n[0]&&$n.isAnyArray(n[0])?new or(n):new k5(n,e);throw new Error("the argument is not an array")}class Ng{constructor(e){e=or.checkMatrix(e);let t=e.clone(),r=t.rows,i=t.columns,a=new Float64Array(r),s=1,o,c,l,u,h,f,d,p,g;for(o=0;o<r;o++)a[o]=o;for(p=new Float64Array(r),c=0;c<i;c++){for(o=0;o<r;o++)p[o]=t.get(o,c);for(o=0;o<r;o++){for(g=Math.min(o,c),h=0,l=0;l<g;l++)h+=t.get(o,l)*p[l];p[o]-=h,t.set(o,c,p[o])}for(u=c,o=c+1;o<r;o++)Math.abs(p[o])>Math.abs(p[u])&&(u=o);if(u!==c){for(l=0;l<i;l++)f=t.get(u,l),t.set(u,l,t.get(c,l)),t.set(c,l,f);d=a[u],a[u]=a[c],a[c]=d,s=-s}if(c<r&&t.get(c,c)!==0)for(o=c+1;o<r;o++)t.set(o,c,t.get(o,c)/t.get(c,c))}this.LU=t,this.pivotVector=a,this.pivotSign=s}isSingular(){let e=this.LU,t=e.columns;for(let r=0;r<t;r++)if(e.get(r,r)===0)return!0;return!1}solve(e){e=ut.checkMatrix(e);let t=this.LU;if(t.rows!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i=e.columns,a=e.subMatrixRow(this.pivotVector,0,i-1),s=t.columns,o,c,l;for(l=0;l<s;l++)for(o=l+1;o<s;o++)for(c=0;c<i;c++)a.set(o,c,a.get(o,c)-a.get(l,c)*t.get(o,l));for(l=s-1;l>=0;l--){for(c=0;c<i;c++)a.set(l,c,a.get(l,c)/t.get(l,l));for(o=0;o<l;o++)for(c=0;c<i;c++)a.set(o,c,a.get(o,c)-a.get(l,c)*t.get(o,l))}return a}get determinant(){let e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");let t=this.pivotSign,r=e.columns;for(let i=0;i<r;i++)t*=e.get(i,i);return t}get lowerTriangularMatrix(){let e=this.LU,t=e.rows,r=e.columns,i=new ut(t,r);for(let a=0;a<t;a++)for(let s=0;s<r;s++)a>s?i.set(a,s,e.get(a,s)):a===s?i.set(a,s,1):i.set(a,s,0);return i}get upperTriangularMatrix(){let e=this.LU,t=e.rows,r=e.columns,i=new ut(t,r);for(let a=0;a<t;a++)for(let s=0;s<r;s++)a<=s?i.set(a,s,e.get(a,s)):i.set(a,s,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Li(n,e){let t=0;return Math.abs(n)>Math.abs(e)?(t=e/n,Math.abs(n)*Math.sqrt(1+t*t)):e!==0?(t=n/e,Math.abs(e)*Math.sqrt(1+t*t)):0}class xS{constructor(e){e=or.checkMatrix(e);let t=e.clone(),r=e.rows,i=e.columns,a=new Float64Array(i),s,o,c,l;for(c=0;c<i;c++){let u=0;for(s=c;s<r;s++)u=Li(u,t.get(s,c));if(u!==0){for(t.get(c,c)<0&&(u=-u),s=c;s<r;s++)t.set(s,c,t.get(s,c)/u);for(t.set(c,c,t.get(c,c)+1),o=c+1;o<i;o++){for(l=0,s=c;s<r;s++)l+=t.get(s,c)*t.get(s,o);for(l=-l/t.get(c,c),s=c;s<r;s++)t.set(s,o,t.get(s,o)+l*t.get(s,c))}}a[c]=-u}this.QR=t,this.Rdiag=a}solve(e){e=ut.checkMatrix(e);let t=this.QR,r=t.rows;if(e.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i=e.columns,a=e.clone(),s=t.columns,o,c,l,u;for(l=0;l<s;l++)for(c=0;c<i;c++){for(u=0,o=l;o<r;o++)u+=t.get(o,l)*a.get(o,c);for(u=-u/t.get(l,l),o=l;o<r;o++)a.set(o,c,a.get(o,c)+u*t.get(o,l))}for(l=s-1;l>=0;l--){for(c=0;c<i;c++)a.set(l,c,a.get(l,c)/this.Rdiag[l]);for(o=0;o<l;o++)for(c=0;c<i;c++)a.set(o,c,a.get(o,c)-a.get(l,c)*t.get(o,l))}return a.subMatrix(0,s-1,0,i-1)}isFullRank(){let e=this.QR.columns;for(let t=0;t<e;t++)if(this.Rdiag[t]===0)return!1;return!0}get upperTriangularMatrix(){let e=this.QR,t=e.columns,r=new ut(t,t),i,a;for(i=0;i<t;i++)for(a=0;a<t;a++)i<a?r.set(i,a,e.get(i,a)):i===a?r.set(i,a,this.Rdiag[i]):r.set(i,a,0);return r}get orthogonalMatrix(){let e=this.QR,t=e.rows,r=e.columns,i=new ut(t,r),a,s,o,c;for(o=r-1;o>=0;o--){for(a=0;a<t;a++)i.set(a,o,0);for(i.set(o,o,1),s=o;s<r;s++)if(e.get(o,o)!==0){for(c=0,a=o;a<t;a++)c+=e.get(a,o)*i.get(a,s);for(c=-c/e.get(o,o),a=o;a<t;a++)i.set(a,s,i.get(a,s)+c*e.get(a,o))}}return i}}let pc=class{constructor(e,t={}){if(e=or.checkMatrix(e),e.isEmpty())throw new Error("Matrix must be non-empty");let r=e.rows,i=e.columns;const{computeLeftSingularVectors:a=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=t;let c=!!a,l=!!s,u=!1,h;if(r<i)if(!o)h=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{h=e.transpose(),r=h.rows,i=h.columns,u=!0;let O=c;c=l,l=O}else h=e.clone();let f=Math.min(r,i),d=Math.min(r+1,i),p=new Float64Array(d),g=new ut(r,f),v=new ut(i,i),m=new Float64Array(i),y=new Float64Array(r),b=new Float64Array(d);for(let O=0;O<d;O++)b[O]=O;let w=Math.min(r-1,i),x=Math.max(0,Math.min(i-2,r)),S=Math.max(w,x);for(let O=0;O<S;O++){if(O<w){p[O]=0;for(let C=O;C<r;C++)p[O]=Li(p[O],h.get(C,O));if(p[O]!==0){h.get(O,O)<0&&(p[O]=-p[O]);for(let C=O;C<r;C++)h.set(C,O,h.get(C,O)/p[O]);h.set(O,O,h.get(O,O)+1)}p[O]=-p[O]}for(let C=O+1;C<i;C++){if(O<w&&p[O]!==0){let M=0;for(let T=O;T<r;T++)M+=h.get(T,O)*h.get(T,C);M=-M/h.get(O,O);for(let T=O;T<r;T++)h.set(T,C,h.get(T,C)+M*h.get(T,O))}m[C]=h.get(O,C)}if(c&&O<w)for(let C=O;C<r;C++)g.set(C,O,h.get(C,O));if(O<x){m[O]=0;for(let C=O+1;C<i;C++)m[O]=Li(m[O],m[C]);if(m[O]!==0){m[O+1]<0&&(m[O]=0-m[O]);for(let C=O+1;C<i;C++)m[C]/=m[O];m[O+1]+=1}if(m[O]=-m[O],O+1<r&&m[O]!==0){for(let C=O+1;C<r;C++)y[C]=0;for(let C=O+1;C<r;C++)for(let M=O+1;M<i;M++)y[C]+=m[M]*h.get(C,M);for(let C=O+1;C<i;C++){let M=-m[C]/m[O+1];for(let T=O+1;T<r;T++)h.set(T,C,h.get(T,C)+M*y[T])}}if(l)for(let C=O+1;C<i;C++)v.set(C,O,m[C])}}let _=Math.min(i,r+1);if(w<i&&(p[w]=h.get(w,w)),r<_&&(p[_-1]=0),x+1<_&&(m[x]=h.get(x,_-1)),m[_-1]=0,c){for(let O=w;O<f;O++){for(let C=0;C<r;C++)g.set(C,O,0);g.set(O,O,1)}for(let O=w-1;O>=0;O--)if(p[O]!==0){for(let C=O+1;C<f;C++){let M=0;for(let T=O;T<r;T++)M+=g.get(T,O)*g.get(T,C);M=-M/g.get(O,O);for(let T=O;T<r;T++)g.set(T,C,g.get(T,C)+M*g.get(T,O))}for(let C=O;C<r;C++)g.set(C,O,-g.get(C,O));g.set(O,O,1+g.get(O,O));for(let C=0;C<O-1;C++)g.set(C,O,0)}else{for(let C=0;C<r;C++)g.set(C,O,0);g.set(O,O,1)}}if(l)for(let O=i-1;O>=0;O--){if(O<x&&m[O]!==0)for(let C=O+1;C<i;C++){let M=0;for(let T=O+1;T<i;T++)M+=v.get(T,O)*v.get(T,C);M=-M/v.get(O+1,O);for(let T=O+1;T<i;T++)v.set(T,C,v.get(T,C)+M*v.get(T,O))}for(let C=0;C<i;C++)v.set(C,O,0);v.set(O,O,1)}let E=_-1,P=Number.EPSILON;for(;_>0;){let O,C;for(O=_-2;O>=-1&&O!==-1;O--){const M=Number.MIN_VALUE+P*Math.abs(p[O]+Math.abs(p[O+1]));if(Math.abs(m[O])<=M||Number.isNaN(m[O])){m[O]=0;break}}if(O===_-2)C=4;else{let M;for(M=_-1;M>=O&&M!==O;M--){let T=(M!==_?Math.abs(m[M]):0)+(M!==O+1?Math.abs(m[M-1]):0);if(Math.abs(p[M])<=P*T){p[M]=0;break}}M===O?C=3:M===_-1?C=1:(C=2,O=M)}switch(O++,C){case 1:{let M=m[_-2];m[_-2]=0;for(let T=_-2;T>=O;T--){let R=Li(p[T],M),D=p[T]/R,B=M/R;if(p[T]=R,T!==O&&(M=-B*m[T-1],m[T-1]=D*m[T-1]),l)for(let j=0;j<i;j++)R=D*v.get(j,T)+B*v.get(j,_-1),v.set(j,_-1,-B*v.get(j,T)+D*v.get(j,_-1)),v.set(j,T,R)}break}case 2:{let M=m[O-1];m[O-1]=0;for(let T=O;T<_;T++){let R=Li(p[T],M),D=p[T]/R,B=M/R;if(p[T]=R,M=-B*m[T],m[T]=D*m[T],c)for(let j=0;j<r;j++)R=D*g.get(j,T)+B*g.get(j,O-1),g.set(j,O-1,-B*g.get(j,T)+D*g.get(j,O-1)),g.set(j,T,R)}break}case 3:{const M=Math.max(Math.abs(p[_-1]),Math.abs(p[_-2]),Math.abs(m[_-2]),Math.abs(p[O]),Math.abs(m[O])),T=p[_-1]/M,R=p[_-2]/M,D=m[_-2]/M,B=p[O]/M,j=m[O]/M,L=((R+T)*(R-T)+D*D)/2,$=T*D*(T*D);let V=0;(L!==0||$!==0)&&(L<0?V=0-Math.sqrt(L*L+$):V=Math.sqrt(L*L+$),V=$/(L+V));let W=(B+T)*(B-T)+V,Y=B*j;for(let U=O;U<_-1;U++){let J=Li(W,Y);J===0&&(J=Number.MIN_VALUE);let at=W/J,ht=Y/J;if(U!==O&&(m[U-1]=J),W=at*p[U]+ht*m[U],m[U]=at*m[U]-ht*p[U],Y=ht*p[U+1],p[U+1]=at*p[U+1],l)for(let lt=0;lt<i;lt++)J=at*v.get(lt,U)+ht*v.get(lt,U+1),v.set(lt,U+1,-ht*v.get(lt,U)+at*v.get(lt,U+1)),v.set(lt,U,J);if(J=Li(W,Y),J===0&&(J=Number.MIN_VALUE),at=W/J,ht=Y/J,p[U]=J,W=at*m[U]+ht*p[U+1],p[U+1]=-ht*m[U]+at*p[U+1],Y=ht*m[U+1],m[U+1]=at*m[U+1],c&&U<r-1)for(let lt=0;lt<r;lt++)J=at*g.get(lt,U)+ht*g.get(lt,U+1),g.set(lt,U+1,-ht*g.get(lt,U)+at*g.get(lt,U+1)),g.set(lt,U,J)}m[_-2]=W;break}case 4:{if(p[O]<=0&&(p[O]=p[O]<0?-p[O]:0,l))for(let M=0;M<=E;M++)v.set(M,O,-v.get(M,O));for(;O<E&&!(p[O]>=p[O+1]);){let M=p[O];if(p[O]=p[O+1],p[O+1]=M,l&&O<i-1)for(let T=0;T<i;T++)M=v.get(T,O+1),v.set(T,O+1,v.get(T,O)),v.set(T,O,M);if(c&&O<r-1)for(let T=0;T<r;T++)M=g.get(T,O+1),g.set(T,O+1,g.get(T,O)),g.set(T,O,M);O++}_--;break}}}if(u){let O=v;v=g,g=O}this.m=r,this.n=i,this.s=p,this.U=g,this.V=v}solve(e){let t=e,r=this.threshold,i=this.s.length,a=ut.zeros(i,i);for(let f=0;f<i;f++)Math.abs(this.s[f])<=r?a.set(f,f,0):a.set(f,f,1/this.s[f]);let s=this.U,o=this.rightSingularVectors,c=o.mmul(a),l=o.rows,u=s.rows,h=ut.zeros(l,u);for(let f=0;f<l;f++)for(let d=0;d<u;d++){let p=0;for(let g=0;g<i;g++)p+=c.get(f,g)*s.get(d,g);h.set(f,d,p)}return h.mmul(t)}solveForDiagonal(e){return this.solve(ut.diag(e))}inverse(){let e=this.V,t=this.threshold,r=e.rows,i=e.columns,a=new ut(r,this.s.length);for(let u=0;u<r;u++)for(let h=0;h<i;h++)Math.abs(this.s[h])>t&&a.set(u,h,e.get(u,h)/this.s[h]);let s=this.U,o=s.rows,c=s.columns,l=new ut(r,o);for(let u=0;u<r;u++)for(let h=0;h<o;h++){let f=0;for(let d=0;d<c;d++)f+=a.get(u,d)*s.get(h,d);l.set(u,h,f)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,r=this.s;for(let i=0,a=r.length;i<a;i++)r[i]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return ut.diag(this.s)}};function SJ(n,e=!1){return n=or.checkMatrix(n),e?new pc(n).inverse():D5(n,ut.eye(n.rows))}function D5(n,e,t=!1){return n=or.checkMatrix(n),e=or.checkMatrix(e),t?new pc(n).solve(e):n.isSquare()?new Ng(n).solve(e):new xS(n).solve(e)}function cd(n){if(n=ut.checkMatrix(n),n.isSquare()){if(n.columns===0)return 1;let e,t,r,i;if(n.columns===2)return e=n.get(0,0),t=n.get(0,1),r=n.get(1,0),i=n.get(1,1),e*i-t*r;if(n.columns===3){let a,s,o;return a=new od(n,[1,2],[1,2]),s=new od(n,[1,2],[0,2]),o=new od(n,[1,2],[0,1]),e=n.get(0,0),t=n.get(0,1),r=n.get(0,2),e*cd(a)-t*cd(s)+r*cd(o)}else return new Ng(n).determinant}else throw Error("determinant can only be calculated for a square matrix")}function _J(n,e){let t=[];for(let r=0;r<n;r++)r!==e&&t.push(r);return t}function OJ(n,e,t,r=1e-9,i=1e-9){if(n>i)return new Array(e.rows+1).fill(0);{let a=e.addRow(t,[0]);for(let s=0;s<a.rows;s++)Math.abs(a.get(s,0))<r&&a.set(s,0,0);return a.to1DArray()}}function PJ(n,e={}){const{thresholdValue:t=1e-9,thresholdError:r=1e-9}=e;n=ut.checkMatrix(n);let i=n.rows,a=new ut(i,i);for(let s=0;s<i;s++){let o=ut.columnVector(n.getRow(s)),c=n.subMatrixRow(_J(i,s)).transpose(),u=new pc(c).solve(o),h=ut.sub(o,c.mmul(u)).abs().max();a.setRow(s,OJ(h,u,s,t,r))}return a}function CJ(n,e=Number.EPSILON){if(n=ut.checkMatrix(n),n.isEmpty())return n.transpose();let t=new pc(n,{autoTranspose:!0}),r=t.leftSingularVectors,i=t.rightSingularVectors,a=t.diagonal;for(let s=0;s<a.length;s++)Math.abs(a[s])>e?a[s]=1/a[s]:a[s]=0;return i.mmul(ut.diag(a).mmul(r.transpose()))}function MJ(n,e=n,t={}){n=new ut(n);let r=!1;if(typeof e=="object"&&!ut.isMatrix(e)&&!$n.isAnyArray(e)?(t=e,e=n,r=!0):e=new ut(e),n.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=t;i&&(n=n.center("column"),r||(e=e.center("column")));const a=n.transpose().mmul(e);for(let s=0;s<a.rows;s++)for(let o=0;o<a.columns;o++)a.set(s,o,a.get(s,o)*(1/(n.rows-1)));return a}function TJ(n,e=n,t={}){n=new ut(n);let r=!1;if(typeof e=="object"&&!ut.isMatrix(e)&&!$n.isAnyArray(e)?(t=e,e=n,r=!0):e=new ut(e),n.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:a=!0}=t;i&&(n.center("column"),r||e.center("column")),a&&(n.scale("column"),r||e.scale("column"));const s=n.standardDeviation("column",{unbiased:!0}),o=r?s:e.standardDeviation("column",{unbiased:!0}),c=n.transpose().mmul(e);for(let l=0;l<c.rows;l++)for(let u=0;u<c.columns;u++)c.set(l,u,c.get(l,u)*(1/(s[l]*o[u]))*(1/(n.rows-1)));return c}class L5{constructor(e,t={}){const{assumeSymmetric:r=!1}=t;if(e=or.checkMatrix(e),!e.isSquare())throw new Error("Matrix is not a square matrix");if(e.isEmpty())throw new Error("Matrix must be non-empty");let i=e.columns,a=new ut(i,i),s=new Float64Array(i),o=new Float64Array(i),c=e,l,u,h=!1;if(r?h=!0:h=e.isSymmetric(),h){for(l=0;l<i;l++)for(u=0;u<i;u++)a.set(l,u,c.get(l,u));AJ(i,o,s,a),NJ(i,o,s,a)}else{let f=new ut(i,i),d=new Float64Array(i);for(u=0;u<i;u++)for(l=0;l<i;l++)f.set(l,u,c.get(l,u));RJ(i,f,d,a),kJ(i,o,s,a,f)}this.n=i,this.e=o,this.d=s,this.V=a}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let e=this.n,t=this.e,r=this.d,i=new ut(e,e),a,s;for(a=0;a<e;a++){for(s=0;s<e;s++)i.set(a,s,0);i.set(a,a,r[a]),t[a]>0?i.set(a,a+1,t[a]):t[a]<0&&i.set(a,a-1,t[a])}return i}}function AJ(n,e,t,r){let i,a,s,o,c,l,u,h;for(c=0;c<n;c++)t[c]=r.get(n-1,c);for(o=n-1;o>0;o--){for(h=0,s=0,l=0;l<o;l++)h=h+Math.abs(t[l]);if(h===0)for(e[o]=t[o-1],c=0;c<o;c++)t[c]=r.get(o-1,c),r.set(o,c,0),r.set(c,o,0);else{for(l=0;l<o;l++)t[l]/=h,s+=t[l]*t[l];for(i=t[o-1],a=Math.sqrt(s),i>0&&(a=-a),e[o]=h*a,s=s-i*a,t[o-1]=i-a,c=0;c<o;c++)e[c]=0;for(c=0;c<o;c++){for(i=t[c],r.set(c,o,i),a=e[c]+r.get(c,c)*i,l=c+1;l<=o-1;l++)a+=r.get(l,c)*t[l],e[l]+=r.get(l,c)*i;e[c]=a}for(i=0,c=0;c<o;c++)e[c]/=s,i+=e[c]*t[c];for(u=i/(s+s),c=0;c<o;c++)e[c]-=u*t[c];for(c=0;c<o;c++){for(i=t[c],a=e[c],l=c;l<=o-1;l++)r.set(l,c,r.get(l,c)-(i*e[l]+a*t[l]));t[c]=r.get(o-1,c),r.set(o,c,0)}}t[o]=s}for(o=0;o<n-1;o++){if(r.set(n-1,o,r.get(o,o)),r.set(o,o,1),s=t[o+1],s!==0){for(l=0;l<=o;l++)t[l]=r.get(l,o+1)/s;for(c=0;c<=o;c++){for(a=0,l=0;l<=o;l++)a+=r.get(l,o+1)*r.get(l,c);for(l=0;l<=o;l++)r.set(l,c,r.get(l,c)-a*t[l])}}for(l=0;l<=o;l++)r.set(l,o+1,0)}for(c=0;c<n;c++)t[c]=r.get(n-1,c),r.set(n-1,c,0);r.set(n-1,n-1,1),e[0]=0}function NJ(n,e,t,r){let i,a,s,o,c,l,u,h,f,d,p,g,v,m,y,b;for(s=1;s<n;s++)e[s-1]=e[s];e[n-1]=0;let w=0,x=0,S=Number.EPSILON;for(l=0;l<n;l++){for(x=Math.max(x,Math.abs(t[l])+Math.abs(e[l])),u=l;u<n&&!(Math.abs(e[u])<=S*x);)u++;if(u>l)do{for(i=t[l],h=(t[l+1]-i)/(2*e[l]),f=Li(h,1),h<0&&(f=-f),t[l]=e[l]/(h+f),t[l+1]=e[l]*(h+f),d=t[l+1],a=i-t[l],s=l+2;s<n;s++)t[s]-=a;for(w=w+a,h=t[u],p=1,g=p,v=p,m=e[l+1],y=0,b=0,s=u-1;s>=l;s--)for(v=g,g=p,b=y,i=p*e[s],a=p*h,f=Li(h,e[s]),e[s+1]=y*f,y=e[s]/f,p=h/f,h=p*t[s]-y*i,t[s+1]=a+y*(p*i+y*t[s]),c=0;c<n;c++)a=r.get(c,s+1),r.set(c,s+1,y*r.get(c,s)+p*a),r.set(c,s,p*r.get(c,s)-y*a);h=-y*b*v*m*e[l]/d,e[l]=y*h,t[l]=p*h}while(Math.abs(e[l])>S*x);t[l]=t[l]+w,e[l]=0}for(s=0;s<n-1;s++){for(c=s,h=t[s],o=s+1;o<n;o++)t[o]<h&&(c=o,h=t[o]);if(c!==s)for(t[c]=t[s],t[s]=h,o=0;o<n;o++)h=r.get(o,s),r.set(o,s,r.get(o,c)),r.set(o,c,h)}}function RJ(n,e,t,r){let i=0,a=n-1,s,o,c,l,u,h,f;for(h=i+1;h<=a-1;h++){for(f=0,l=h;l<=a;l++)f=f+Math.abs(e.get(l,h-1));if(f!==0){for(c=0,l=a;l>=h;l--)t[l]=e.get(l,h-1)/f,c+=t[l]*t[l];for(o=Math.sqrt(c),t[h]>0&&(o=-o),c=c-t[h]*o,t[h]=t[h]-o,u=h;u<n;u++){for(s=0,l=a;l>=h;l--)s+=t[l]*e.get(l,u);for(s=s/c,l=h;l<=a;l++)e.set(l,u,e.get(l,u)-s*t[l])}for(l=0;l<=a;l++){for(s=0,u=a;u>=h;u--)s+=t[u]*e.get(l,u);for(s=s/c,u=h;u<=a;u++)e.set(l,u,e.get(l,u)-s*t[u])}t[h]=f*t[h],e.set(h,h-1,f*o)}}for(l=0;l<n;l++)for(u=0;u<n;u++)r.set(l,u,l===u?1:0);for(h=a-1;h>=i+1;h--)if(e.get(h,h-1)!==0){for(l=h+1;l<=a;l++)t[l]=e.get(l,h-1);for(u=h;u<=a;u++){for(o=0,l=h;l<=a;l++)o+=t[l]*r.get(l,u);for(o=o/t[h]/e.get(h,h-1),l=h;l<=a;l++)r.set(l,u,r.get(l,u)+o*t[l])}}}function kJ(n,e,t,r,i){let a=n-1,s=0,o=n-1,c=Number.EPSILON,l=0,u=0,h=0,f=0,d=0,p=0,g=0,v=0,m,y,b,w,x,S,_,E,P,O,C,M,T,R,D;for(m=0;m<n;m++)for((m<s||m>o)&&(t[m]=i.get(m,m),e[m]=0),y=Math.max(m-1,0);y<n;y++)u=u+Math.abs(i.get(m,y));for(;a>=s;){for(w=a;w>s&&(p=Math.abs(i.get(w-1,w-1))+Math.abs(i.get(w,w)),p===0&&(p=u),!(Math.abs(i.get(w,w-1))<c*p));)w--;if(w===a)i.set(a,a,i.get(a,a)+l),t[a]=i.get(a,a),e[a]=0,a--,v=0;else if(w===a-1){if(_=i.get(a,a-1)*i.get(a-1,a),h=(i.get(a-1,a-1)-i.get(a,a))/2,f=h*h+_,g=Math.sqrt(Math.abs(f)),i.set(a,a,i.get(a,a)+l),i.set(a-1,a-1,i.get(a-1,a-1)+l),E=i.get(a,a),f>=0){for(g=h>=0?h+g:h-g,t[a-1]=E+g,t[a]=t[a-1],g!==0&&(t[a]=E-_/g),e[a-1]=0,e[a]=0,E=i.get(a,a-1),p=Math.abs(E)+Math.abs(g),h=E/p,f=g/p,d=Math.sqrt(h*h+f*f),h=h/d,f=f/d,y=a-1;y<n;y++)g=i.get(a-1,y),i.set(a-1,y,f*g+h*i.get(a,y)),i.set(a,y,f*i.get(a,y)-h*g);for(m=0;m<=a;m++)g=i.get(m,a-1),i.set(m,a-1,f*g+h*i.get(m,a)),i.set(m,a,f*i.get(m,a)-h*g);for(m=s;m<=o;m++)g=r.get(m,a-1),r.set(m,a-1,f*g+h*r.get(m,a)),r.set(m,a,f*r.get(m,a)-h*g)}else t[a-1]=E+h,t[a]=E+h,e[a-1]=g,e[a]=-g;a=a-2,v=0}else{if(E=i.get(a,a),P=0,_=0,w<a&&(P=i.get(a-1,a-1),_=i.get(a,a-1)*i.get(a-1,a)),v===10){for(l+=E,m=s;m<=a;m++)i.set(m,m,i.get(m,m)-E);p=Math.abs(i.get(a,a-1))+Math.abs(i.get(a-1,a-2)),E=P=.75*p,_=-.4375*p*p}if(v===30&&(p=(P-E)/2,p=p*p+_,p>0)){for(p=Math.sqrt(p),P<E&&(p=-p),p=E-_/((P-E)/2+p),m=s;m<=a;m++)i.set(m,m,i.get(m,m)-p);l+=p,E=P=_=.964}for(v=v+1,x=a-2;x>=w&&(g=i.get(x,x),d=E-g,p=P-g,h=(d*p-_)/i.get(x+1,x)+i.get(x,x+1),f=i.get(x+1,x+1)-g-d-p,d=i.get(x+2,x+1),p=Math.abs(h)+Math.abs(f)+Math.abs(d),h=h/p,f=f/p,d=d/p,!(x===w||Math.abs(i.get(x,x-1))*(Math.abs(f)+Math.abs(d))<c*(Math.abs(h)*(Math.abs(i.get(x-1,x-1))+Math.abs(g)+Math.abs(i.get(x+1,x+1))))));)x--;for(m=x+2;m<=a;m++)i.set(m,m-2,0),m>x+2&&i.set(m,m-3,0);for(b=x;b<=a-1&&(R=b!==a-1,b!==x&&(h=i.get(b,b-1),f=i.get(b+1,b-1),d=R?i.get(b+2,b-1):0,E=Math.abs(h)+Math.abs(f)+Math.abs(d),E!==0&&(h=h/E,f=f/E,d=d/E)),E!==0);b++)if(p=Math.sqrt(h*h+f*f+d*d),h<0&&(p=-p),p!==0){for(b!==x?i.set(b,b-1,-p*E):w!==x&&i.set(b,b-1,-i.get(b,b-1)),h=h+p,E=h/p,P=f/p,g=d/p,f=f/h,d=d/h,y=b;y<n;y++)h=i.get(b,y)+f*i.get(b+1,y),R&&(h=h+d*i.get(b+2,y),i.set(b+2,y,i.get(b+2,y)-h*g)),i.set(b,y,i.get(b,y)-h*E),i.set(b+1,y,i.get(b+1,y)-h*P);for(m=0;m<=Math.min(a,b+3);m++)h=E*i.get(m,b)+P*i.get(m,b+1),R&&(h=h+g*i.get(m,b+2),i.set(m,b+2,i.get(m,b+2)-h*d)),i.set(m,b,i.get(m,b)-h),i.set(m,b+1,i.get(m,b+1)-h*f);for(m=s;m<=o;m++)h=E*r.get(m,b)+P*r.get(m,b+1),R&&(h=h+g*r.get(m,b+2),r.set(m,b+2,r.get(m,b+2)-h*d)),r.set(m,b,r.get(m,b)-h),r.set(m,b+1,r.get(m,b+1)-h*f)}}}if(u!==0){for(a=n-1;a>=0;a--)if(h=t[a],f=e[a],f===0)for(w=a,i.set(a,a,1),m=a-1;m>=0;m--){for(_=i.get(m,m)-h,d=0,y=w;y<=a;y++)d=d+i.get(m,y)*i.get(y,a);if(e[m]<0)g=_,p=d;else if(w=m,e[m]===0?i.set(m,a,_!==0?-d/_:-d/(c*u)):(E=i.get(m,m+1),P=i.get(m+1,m),f=(t[m]-h)*(t[m]-h)+e[m]*e[m],S=(E*p-g*d)/f,i.set(m,a,S),i.set(m+1,a,Math.abs(E)>Math.abs(g)?(-d-_*S)/E:(-p-P*S)/g)),S=Math.abs(i.get(m,a)),c*S*S>1)for(y=m;y<=a;y++)i.set(y,a,i.get(y,a)/S)}else if(f<0)for(w=a-1,Math.abs(i.get(a,a-1))>Math.abs(i.get(a-1,a))?(i.set(a-1,a-1,f/i.get(a,a-1)),i.set(a-1,a,-(i.get(a,a)-h)/i.get(a,a-1))):(D=_f(0,-i.get(a-1,a),i.get(a-1,a-1)-h,f),i.set(a-1,a-1,D[0]),i.set(a-1,a,D[1])),i.set(a,a-1,0),i.set(a,a,1),m=a-2;m>=0;m--){for(O=0,C=0,y=w;y<=a;y++)O=O+i.get(m,y)*i.get(y,a-1),C=C+i.get(m,y)*i.get(y,a);if(_=i.get(m,m)-h,e[m]<0)g=_,d=O,p=C;else if(w=m,e[m]===0?(D=_f(-O,-C,_,f),i.set(m,a-1,D[0]),i.set(m,a,D[1])):(E=i.get(m,m+1),P=i.get(m+1,m),M=(t[m]-h)*(t[m]-h)+e[m]*e[m]-f*f,T=(t[m]-h)*2*f,M===0&&T===0&&(M=c*u*(Math.abs(_)+Math.abs(f)+Math.abs(E)+Math.abs(P)+Math.abs(g))),D=_f(E*d-g*O+f*C,E*p-g*C-f*O,M,T),i.set(m,a-1,D[0]),i.set(m,a,D[1]),Math.abs(E)>Math.abs(g)+Math.abs(f)?(i.set(m+1,a-1,(-O-_*i.get(m,a-1)+f*i.get(m,a))/E),i.set(m+1,a,(-C-_*i.get(m,a)-f*i.get(m,a-1))/E)):(D=_f(-d-P*i.get(m,a-1),-p-P*i.get(m,a),g,f),i.set(m+1,a-1,D[0]),i.set(m+1,a,D[1]))),S=Math.max(Math.abs(i.get(m,a-1)),Math.abs(i.get(m,a))),c*S*S>1)for(y=m;y<=a;y++)i.set(y,a-1,i.get(y,a-1)/S),i.set(y,a,i.get(y,a)/S)}for(m=0;m<n;m++)if(m<s||m>o)for(y=m;y<n;y++)r.set(m,y,i.get(m,y));for(y=n-1;y>=s;y--)for(m=s;m<=o;m++){for(g=0,b=s;b<=Math.min(y,o);b++)g=g+r.get(m,b)*i.get(b,y);r.set(m,y,g)}}}function _f(n,e,t,r){let i,a;return Math.abs(t)>Math.abs(r)?(i=r/t,a=t+i*r,[(n+i*e)/a,(e-i*n)/a]):(i=t/r,a=r+i*t,[(i*n+e)/a,(i*e-n)/a])}class I5{constructor(e){if(e=or.checkMatrix(e),!e.isSymmetric())throw new Error("Matrix is not symmetric");let t=e,r=t.rows,i=new ut(r,r),a=!0,s,o,c;for(o=0;o<r;o++){let l=0;for(c=0;c<o;c++){let u=0;for(s=0;s<c;s++)u+=i.get(c,s)*i.get(o,s);u=(t.get(o,c)-u)/i.get(c,c),i.set(o,c,u),l=l+u*u}for(l=t.get(o,o)-l,a&=l>0,i.set(o,o,Math.sqrt(Math.max(l,0))),c=o+1;c<r;c++)i.set(o,c,0)}this.L=i,this.positiveDefinite=!!a}isPositiveDefinite(){return this.positiveDefinite}solve(e){e=or.checkMatrix(e);let t=this.L,r=t.rows;if(e.rows!==r)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let i=e.columns,a=e.clone(),s,o,c;for(c=0;c<r;c++)for(o=0;o<i;o++){for(s=0;s<c;s++)a.set(c,o,a.get(c,o)-a.get(s,o)*t.get(c,s));a.set(c,o,a.get(c,o)/t.get(c,c))}for(c=r-1;c>=0;c--)for(o=0;o<i;o++){for(s=c+1;s<r;s++)a.set(c,o,a.get(c,o)-a.get(s,o)*t.get(s,c));a.set(c,o,a.get(c,o)/t.get(c,c))}return a}get lowerTriangularMatrix(){return this.L}}class B5{constructor(e,t={}){e=or.checkMatrix(e);let{Y:r}=t;const{scaleScores:i=!1,maxIterations:a=1e3,terminationCriteria:s=1e-10}=t;let o;if(r){if($n.isAnyArray(r)&&typeof r[0]=="number"?r=ut.columnVector(r):r=or.checkMatrix(r),r.rows!==e.rows)throw new Error("Y should have the same number of rows as X");o=r.getColumnVector(0)}else o=e.getColumnVector(0);let c=1,l,u,h,f;for(let d=0;d<a&&c>s;d++)h=e.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),h=h.div(h.norm()),l=e.mmul(h).div(h.transpose().mmul(h).get(0,0)),d>0&&(c=l.clone().sub(f).pow(2).sum()),f=l.clone(),r?(u=r.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),u=u.div(u.norm()),o=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):o=l;if(r){let d=e.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));d=d.div(d.norm());let p=e.clone().sub(l.clone().mmul(d.transpose())),g=o.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),v=r.clone().sub(l.clone().mulS(g.get(0,0)).mmul(u.transpose()));this.t=l,this.p=d.transpose(),this.w=h.transpose(),this.q=u,this.u=o,this.s=l.transpose().mmul(l),this.xResidual=p,this.yResidual=v,this.betas=g}else this.w=h.transpose(),this.s=l.transpose().mmul(l).sqrt(),i?this.t=l.clone().div(this.s.get(0,0)):this.t=l,this.xResidual=e.sub(l.mmul(h.transpose()))}}Lt.AbstractMatrix=Ot;Lt.CHO=I5;Lt.CholeskyDecomposition=I5;Lt.DistanceMatrix=Ag;Lt.EVD=L5;Lt.EigenvalueDecomposition=L5;Lt.LU=Ng;Lt.LuDecomposition=Ng;var F5=Lt.Matrix=ut;Lt.MatrixColumnSelectionView=gJ;Lt.MatrixColumnView=pJ;Lt.MatrixFlipColumnView=vJ;Lt.MatrixFlipRowView=mJ;Lt.MatrixRowSelectionView=bJ;Lt.MatrixRowView=yJ;Lt.MatrixSelectionView=od;Lt.MatrixSubView=EJ;Lt.MatrixTransposeView=xJ;Lt.NIPALS=B5;Lt.Nipals=B5;Lt.QR=xS;Lt.QrDecomposition=xS;Lt.SVD=pc;var DJ=Lt.SingularValueDecomposition=pc;Lt.SymmetricMatrix=xs;Lt.WrapperMatrix1D=k5;Lt.WrapperMatrix2D=or;Lt.correlation=TJ;Lt.covariance=MJ;var sP=Lt.default=ut;Lt.determinant=cd;Lt.inverse=SJ;Lt.linearDependencies=PJ;Lt.pseudoInverse=CJ;Lt.solve=D5;Lt.wrap=wJ;const Ea=F5,$5=DJ;sP.Matrix&&sP.Matrix;const LJ={center:[0,0],linkDistance:50};class Rg{constructor(e={}){this.options=e,this.id="mds",this.options=Object.assign(Object.assign({},LJ),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,e,t)})}genericMDSLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a=[0,0],linkDistance:s=50}=i,o=t.getAllNodes(),c=t.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return Is(t,e,a);const l=fS({nodes:o,edges:c},!1),u=hS(l);IJ(u);const h=P5(u,s),f=BJ(h),d=[];return f.forEach((g,v)=>{const m=jn(o[v]);m.data.x=g[0]+a[0],m.data.y=g[1]+a[1],d.push(m)}),e&&d.forEach(g=>t.mergeNodeData(g.id,{x:g.data.x,y:g.data.y})),{nodes:d,edges:c}})}}const IJ=n=>{let e=-999999;n.forEach(t=>{t.forEach(r=>{r!==1/0&&e<r&&(e=r)})}),n.forEach((t,r)=>{t.forEach((i,a)=>{i===1/0&&(n[r][a]=e)})})},BJ=n=>{const t=Ea.mul(Ea.pow(n,2),-.5),r=t.mean("row"),i=t.mean("column"),a=t.mean();t.add(a).subRowVector(r).subColumnVector(i);const s=new $5(t),o=Ea.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(c=>Ea.mul([c],[o]).toJSON()[0].splice(0,2))},FJ={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},$J={center:[0,0],comboPadding:10,treeKey:"combo"};class wS{constructor(e={}){this.options=e,this.id="comboCombined",this.options=Object.assign(Object.assign({},$J),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,e,t)})}genericComboCombinedLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),r)),{center:a,treeKey:s,outerLayout:o}=i,c=t.getAllNodes().filter(E=>!E.data._isCombo),l=t.getAllNodes().filter(E=>E.data._isCombo),u=t.getAllEdges(),h=c==null?void 0:c.length;if(!h||h===1)return Is(t,e,a);const f=[],d=new Map;c.forEach(E=>{d.set(E.id,E)});const p=new Map;l.forEach(E=>{p.set(E.id,E)});const g=new Map,v=this.getInnerGraphs(t,s,d,p,u,i,g);yield Promise.all(v);const m=new Map,y=[],b=new Map;let w=!0;t.getRoots(s).forEach(E=>{const P=g.get(E.id),O=p.get(E.id)||d.get(E.id),C={id:E.id,data:Object.assign(Object.assign({},E.data),{x:P.data.x||O.data.x,y:P.data.y||O.data.y,fx:P.data.fx||O.data.fx,fy:P.data.fy||O.data.fy,mass:P.data.mass||O.data.mass,size:P.data.size})};y.push(C),m.set(E.id,!0),!isNaN(C.data.x)&&C.data.x!==0&&!isNaN(C.data.y)&&C.data.y!==0?w=!1:(C.data.x=Math.random()*100,C.data.y=Math.random()*100),Zd(t,[E],M=>{M.id!==E.id&&b.set(M.id,E.id)},"TB",s)});const x=[];u.forEach(E=>{const P=b.get(E.source)||E.source,O=b.get(E.target)||E.target;P!==O&&m.has(P)&&m.has(O)&&x.push({id:E.id,source:P,target:O,data:{}})});let S;if(y!=null&&y.length){if(y.length===1)y[0].data.x=a[0],y[0].data.y=a[1];else{const E=new qe({nodes:y,edges:x}),P=o||new Mg;w&&FJ[P.id]&&(yield(y.length<100?new Rg:new Wu).assign(E)),S=yield P.execute(E,Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},P.id==="force"?{gravity:1,factor:4,linkDistance:(O,C,M)=>{const T=Math.max(...C.data.size)||32,R=Math.max(...M.data.size)||32;return T/2+R/2+200}}:{}))}g.forEach(E=>{var P;const O=S.nodes.find(T=>T.id===E.id);if(O){const{x:T,y:R}=O.data;E.data.visited=!0,E.data.x=T,E.data.y=R,f.push({id:E.id,data:{x:T,y:R}})}const{x:C,y:M}=E.data;(P=E.data.nodes)===null||P===void 0||P.forEach(T=>{f.push({id:T.id,data:{x:T.data.x+C,y:T.data.y+M}})})}),g.forEach(({data:E})=>{const{x:P,y:O,visited:C,nodes:M}=E;M==null||M.forEach(T=>{if(!C){const R=f.find(D=>D.id===T.id);R.data.x+=P||0,R.data.y+=O||0}})})}return e&&f.forEach(E=>{t.mergeNodeData(E.id,{x:E.data.x,y:E.data.y})}),{nodes:f,edges:u}})}initVals(e){const t=Object.assign({},e),{nodeSize:r,spacing:i,comboPadding:a}=e;let s,o;if(rt(i)?o=()=>i:ft(i)?o=i:o=()=>0,t.spacing=o,!r)s=l=>{const u=o(l);return l.size?en(l.size)?((l.size[0]>l.size[1]?l.size[0]:l.size[1])+u)/2:ne(l.size)?((l.size.width>l.size.height?l.size.width:l.size.height)+u)/2:(l.size+u)/2:32+u/2};else if(ft(r))s=l=>{const u=r(l),h=o(l);return en(l.size)?((l.size[0]>l.size[1]?l.size[0]:l.size[1])+h)/2:((u||32)+h)/2};else if(en(r)){const u=(r[0]>r[1]?r[0]:r[1])/2;s=h=>u+o(h)/2}else{const l=r/2;s=u=>l+o(u)/2}t.nodeSize=s;let c;return rt(a)?c=()=>a:en(a)?c=()=>Math.max.apply(null,a):ft(a)?c=a:c=()=>0,t.comboPadding=c,t}getInnerGraphs(e,t,r,i,a,s,o){const{nodeSize:c,comboPadding:l,spacing:u,innerLayout:h}=s,f=h||new Wu({}),d={center:[0,0],preventOverlap:!0,nodeSpacing:u},p=[],g=v=>{let m=(l==null?void 0:l(v))||10;return en(m)&&(m=Math.max(...m)),{size:m?[m*2,m*2]:[30,30],padding:m}};return e.getRoots(t).forEach(v=>{o.set(v.id,{id:v.id,data:{nodes:[],size:g(v).size}});let m=Promise.resolve();Zd(e,[v],y=>{var b;if(!y.data._isCombo)return;const{size:w,padding:x}=g(y);if(!(!((b=e.getChildren(y.id,t))===null||b===void 0)&&b.length))o.set(y.id,{id:y.id,data:Object.assign(Object.assign({},y.data),{size:w})});else{const S=o.get(y.id);o.set(y.id,{id:y.id,data:Object.assign({nodes:[]},S==null?void 0:S.data)});const _=new Map,E=e.getChildren(y.id,t).map(C=>{if(C.data._isCombo)return o.has(C.id)||o.set(C.id,{id:C.id,data:Object.assign({},C.data)}),_.set(C.id,!0),o.get(C.id);const M=r.get(C.id)||i.get(C.id);return _.set(C.id,!0),{id:C.id,data:Object.assign(Object.assign({},M.data),C.data)}}),P={nodes:E,edges:a.filter(C=>_.has(C.source)&&_.has(C.target))};let O=1/0;E.forEach(C=>{var M;let{size:T}=C.data;T||(T=((M=o.get(C.id))===null||M===void 0?void 0:M.data.size)||(c==null?void 0:c(C))||[30,30]),rt(T)&&(T=[T,T]);const[R,D]=T;O>R&&(O=R),O>D&&(O=D),C.data.size=T}),m=m.then(()=>Et(this,void 0,void 0,function*(){const C=new qe(P),M=yield f.assign(C,d),{minX:T,minY:R,maxX:D,maxY:B}=C5(E),j={x:(D+T)/2,y:(B+R)/2};P.nodes.forEach($=>{$.data.x-=j.x,$.data.y-=j.y});const L=[Math.max(D-T,O)+x*2,Math.max(B-R,O)+x*2];return o.get(y.id).data.size=L,o.get(y.id).data.nodes=E,M}))}return!0},"BT",t),p.push(m)}),p}}function zJ(n,e){var t,r=1;n==null&&(n=0),e==null&&(e=0);function i(){var a,s=t.length,o,c=0,l=0;for(a=0;a<s;++a)o=t[a],c+=o.x,l+=o.y;for(c=(c/s-n)*r,l=(l/s-e)*r,a=0;a<s;++a)o=t[a],o.x-=c,o.y-=l}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(n=+a,i):n},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Ke(n){return function(){return n}}function xa(n){return(n()-.5)*1e-6}function jJ(n){return n.x+n.vx}function qJ(n){return n.y+n.vy}function GJ(n){var e,t,r,i=1,a=1;typeof n!="function"&&(n=Ke(n==null?1:+n));function s(){for(var l,u=e.length,h,f,d,p,g,v,m=0;m<a;++m)for(h=dc(e,jJ,qJ).visitAfter(o),l=0;l<u;++l)f=e[l],g=t[f.index],v=g*g,d=f.x+f.vx,p=f.y+f.vy,h.visit(y);function y(b,w,x,S,_){var E=b.data,P=b.r,O=g+P;if(E){if(E.index>f.index){var C=d-E.x-E.vx,M=p-E.y-E.vy,T=C*C+M*M;T<O*O&&(C===0&&(C=xa(r),T+=C*C),M===0&&(M=xa(r),T+=M*M),T=(O-(T=Math.sqrt(T)))/T*i,f.vx+=(C*=T)*(O=(P*=P)/(v+P)),f.vy+=(M*=T)*O,E.vx-=C*(O=1-O),E.vy-=M*O)}return}return w>d+O||S<d-O||x>p+O||_<p-O}}function o(l){if(l.data)return l.r=t[l.data.index];for(var u=l.r=0;u<4;++u)l[u]&&l[u].r>l.r&&(l.r=l[u].r)}function c(){if(e){var l,u=e.length,h;for(t=new Array(u),l=0;l<u;++l)h=e[l],t[h.index]=+n(h,l,e)}}return s.initialize=function(l,u){e=l,r=u,c()},s.iterations=function(l){return arguments.length?(a=+l,s):a},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(n=typeof l=="function"?l:Ke(+l),c(),s):n},s}function VJ(n){return n.index}function oP(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function WJ(n){var e=VJ,t=h,r,i=Ke(30),a,s,o,c,l,u=1;n==null&&(n=[]);function h(v){return 1/Math.min(o[v.source.index],o[v.target.index])}function f(v){for(var m=0,y=n.length;m<u;++m)for(var b=0,w,x,S,_,E,P,O;b<y;++b)w=n[b],x=w.source,S=w.target,_=S.x+S.vx-x.x-x.vx||xa(l),E=S.y+S.vy-x.y-x.vy||xa(l),P=Math.sqrt(_*_+E*E),P=(P-a[b])/P*v*r[b],_*=P,E*=P,S.vx-=_*(O=c[b]),S.vy-=E*O,x.vx+=_*(O=1-O),x.vy+=E*O}function d(){if(s){var v,m=s.length,y=n.length,b=new Map(s.map((x,S)=>[e(x,S,s),x])),w;for(v=0,o=new Array(m);v<y;++v)w=n[v],w.index=v,typeof w.source!="object"&&(w.source=oP(b,w.source)),typeof w.target!="object"&&(w.target=oP(b,w.target)),o[w.source.index]=(o[w.source.index]||0)+1,o[w.target.index]=(o[w.target.index]||0)+1;for(v=0,c=new Array(y);v<y;++v)w=n[v],c[v]=o[w.source.index]/(o[w.source.index]+o[w.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(s)for(var v=0,m=n.length;v<m;++v)r[v]=+t(n[v],v,n)}function g(){if(s)for(var v=0,m=n.length;v<m;++v)a[v]=+i(n[v],v,n)}return f.initialize=function(v,m){s=v,l=m,d()},f.links=function(v){return arguments.length?(n=v,d(),f):n},f.id=function(v){return arguments.length?(e=v,f):e},f.iterations=function(v){return arguments.length?(u=+v,f):u},f.strength=function(v){return arguments.length?(t=typeof v=="function"?v:Ke(+v),p(),f):t},f.distance=function(v){return arguments.length?(i=typeof v=="function"?v:Ke(+v),g(),f):i},f}var HJ={value:()=>{}};function SS(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new ld(t)}function ld(n){this._=n}function UJ(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}ld.prototype=SS.prototype={constructor:ld,on:function(n,e){var t=this._,r=UJ(n+"",t),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(n=r[a]).type)&&(i=YJ(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(n=r[a]).type)t[i]=cP(t[i],n.name,e);else if(e==null)for(i in t)t[i]=cP(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new ld(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,a;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(a=this._[n],r=0,i=a.length;r<i;++r)a[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,a=r.length;i<a;++i)r[i].value.apply(e,t)}};function YJ(n,e){for(var t=0,r=n.length,i;t<r;++t)if((i=n[t]).name===e)return i.value}function cP(n,e,t){for(var r=0,i=n.length;r<i;++r)if(n[r].name===e){n[r]=HJ,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var Zo=0,pu=0,Bc=0,z5=1e3,Jd,gu,tp=0,As=0,kg=0,Uu=typeof performance=="object"&&performance.now?performance:Date,j5=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function q5(){return As||(j5(KJ),As=Uu.now()+kg)}function KJ(){As=0}function Aw(){this._call=this._time=this._next=null}Aw.prototype=_S.prototype={constructor:Aw,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?q5():+t)+(e==null?0:+e),!this._next&&gu!==this&&(gu?gu._next=this:Jd=this,gu=this),this._call=n,this._time=t,Nw()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nw())}};function _S(n,e,t){var r=new Aw;return r.restart(n,e,t),r}function XJ(){q5(),++Zo;for(var n=Jd,e;n;)(e=As-n._time)>=0&&n._call.call(void 0,e),n=n._next;--Zo}function lP(){As=(tp=Uu.now())+kg,Zo=pu=0;try{XJ()}finally{Zo=0,QJ(),As=0}}function ZJ(){var n=Uu.now(),e=n-tp;e>z5&&(kg-=e,tp=n)}function QJ(){for(var n,e=Jd,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:Jd=t);gu=n,Nw(r)}function Nw(n){if(!Zo){pu&&(pu=clearTimeout(pu));var e=n-As;e>24?(n<1/0&&(pu=setTimeout(lP,n-Uu.now()-kg)),Bc&&(Bc=clearInterval(Bc))):(Bc||(tp=Uu.now(),Bc=setInterval(ZJ,z5)),Zo=1,j5(lP))}}const JJ=1664525,ttt=1013904223,uP=4294967296;function ett(){let n=1;return()=>(n=(JJ*n+ttt)%uP)/uP}function ntt(n){return n.x}function rtt(n){return n.y}var itt=10,att=Math.PI*(3-Math.sqrt(5));function stt(n){var e,t=1,r=.001,i=1-Math.pow(r,1/300),a=0,s=.6,o=new Map,c=_S(h),l=SS("tick","end"),u=ett();n==null&&(n=[]);function h(){f(),l.call("tick",e),t<r&&(c.stop(),l.call("end",e))}function f(g){var v,m=n.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(t+=(a-t)*i,o.forEach(function(w){w(t)}),v=0;v<m;++v)y=n[v],y.fx==null?y.x+=y.vx*=s:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=s:(y.y=y.fy,y.vy=0);return e}function d(){for(var g=0,v=n.length,m;g<v;++g){if(m=n[g],m.index=g,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var y=itt*Math.sqrt(.5+g),b=g*att;m.x=y*Math.cos(b),m.y=y*Math.sin(b)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(g){return g.initialize&&g.initialize(n,u),g}return d(),e={tick:f,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(g){return arguments.length?(n=g,d(),o.forEach(p),e):n},alpha:function(g){return arguments.length?(t=+g,e):t},alphaMin:function(g){return arguments.length?(r=+g,e):r},alphaDecay:function(g){return arguments.length?(i=+g,e):+i},alphaTarget:function(g){return arguments.length?(a=+g,e):a},velocityDecay:function(g){return arguments.length?(s=1-g,e):1-s},randomSource:function(g){return arguments.length?(u=g,o.forEach(p),e):u},force:function(g,v){return arguments.length>1?(v==null?o.delete(g):o.set(g,p(v)),e):o.get(g)},find:function(g,v,m){var y=0,b=n.length,w,x,S,_,E;for(m==null?m=1/0:m*=m,y=0;y<b;++y)_=n[y],w=g-_.x,x=v-_.y,S=w*w+x*x,S<m&&(E=_,m=S);return E},on:function(g,v){return arguments.length>1?(l.on(g,v),e):l.on(g)}}}function ott(){var n,e,t,r,i=Ke(-30),a,s=1,o=1/0,c=.81;function l(d){var p,g=n.length,v=dc(n,ntt,rtt).visitAfter(h);for(r=d,p=0;p<g;++p)e=n[p],v.visit(f)}function u(){if(n){var d,p=n.length,g;for(a=new Array(p),d=0;d<p;++d)g=n[d],a[g.index]=+i(g,d,n)}}function h(d){var p=0,g,v,m=0,y,b,w;if(d.length){for(y=b=w=0;w<4;++w)(g=d[w])&&(v=Math.abs(g.value))&&(p+=g.value,m+=v,y+=v*g.x,b+=v*g.y);d.x=y/m,d.y=b/m}else{g=d,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}d.value=p}function f(d,p,g,v){if(!d.value)return!0;var m=d.x-e.x,y=d.y-e.y,b=v-p,w=m*m+y*y;if(b*b/c<w)return w<o&&(m===0&&(m=xa(t),w+=m*m),y===0&&(y=xa(t),w+=y*y),w<s&&(w=Math.sqrt(s*w)),e.vx+=m*d.value*r/w,e.vy+=y*d.value*r/w),!0;if(d.length||w>=o)return;(d.data!==e||d.next)&&(m===0&&(m=xa(t),w+=m*m),y===0&&(y=xa(t),w+=y*y),w<s&&(w=Math.sqrt(s*w)));do d.data!==e&&(b=a[d.data.index]*r/w,e.vx+=m*b,e.vy+=y*b);while(d=d.next)}return l.initialize=function(d,p){n=d,t=p,u()},l.strength=function(d){return arguments.length?(i=typeof d=="function"?d:Ke(+d),u(),l):i},l.distanceMin=function(d){return arguments.length?(s=d*d,l):Math.sqrt(s)},l.distanceMax=function(d){return arguments.length?(o=d*d,l):Math.sqrt(o)},l.theta=function(d){return arguments.length?(c=d*d,l):Math.sqrt(c)},l}function ctt(n,e,t){var r,i=Ke(.1),a,s;typeof n!="function"&&(n=Ke(+n)),e==null&&(e=0),t==null&&(t=0);function o(l){for(var u=0,h=r.length;u<h;++u){var f=r[u],d=f.x-e||1e-6,p=f.y-t||1e-6,g=Math.sqrt(d*d+p*p),v=(s[u]-g)*a[u]*l/g;f.vx+=d*v,f.vy+=p*v}}function c(){if(r){var l,u=r.length;for(a=new Array(u),s=new Array(u),l=0;l<u;++l)s[l]=+n(r[l],l,r),a[l]=isNaN(s[l])?0:+i(r[l],l,r)}}return o.initialize=function(l){r=l,c()},o.strength=function(l){return arguments.length?(i=typeof l=="function"?l:Ke(+l),c(),o):i},o.radius=function(l){return arguments.length?(n=typeof l=="function"?l:Ke(+l),c(),o):n},o.x=function(l){return arguments.length?(e=+l,o):e},o.y=function(l){return arguments.length?(t=+l,o):t},o}function ltt(n){var e=Ke(.1),t,r,i;typeof n!="function"&&(n=Ke(n==null?0:+n));function a(o){for(var c=0,l=t.length,u;c<l;++c)u=t[c],u.vx+=(i[c]-u.x)*r[c]*o}function s(){if(t){var o,c=t.length;for(r=new Array(c),i=new Array(c),o=0;o<c;++o)r[o]=isNaN(i[o]=+n(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),s(),a):e},a.x=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),s(),a):n},a}function utt(n){var e=Ke(.1),t,r,i;typeof n!="function"&&(n=Ke(n==null?0:+n));function a(o){for(var c=0,l=t.length,u;c<l;++c)u=t[c],u.vy+=(i[c]-u.y)*r[c]*o}function s(){if(t){var o,c=t.length;for(r=new Array(c),i=new Array(c),o=0;o<c;++o)r[o]=isNaN(i[o]=+n(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),s(),a):e},a.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),s(),a):n},a}class Dg{constructor(e){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:WJ,manyBody:ott,center:zJ,collide:GJ,radial:ctt,x:ltt,y:utt},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Le(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericLayout(!0,e,t)})}stop(){this.simulation.stop()}tick(e){return this.simulation.tick(e),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(e,t){const r=this.context.nodes.find(i=>i.id===e);r&&t.forEach((i,a)=>{if(typeof i=="number"||i===null){const s=["fx","fy","fz"][a];r[s]=i}})}getOptions(e){var t,r;const i=Le({},this.options,e);return i.collide&&((t=i.collide)===null||t===void 0?void 0:t.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(r=i.nodeSize)!==null&&r!==void 0?r:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(e,t,r){var i;return Et(this,void 0,void 0,function*(){const a=this.getOptions(r),s=t.getAllNodes().map(({id:u,data:h})=>Object.assign({id:u,data:h},Os(h,this.config.inputNodeAttrs))),o=t.getAllEdges().map(u=>Object.assign({},u));Object.assign(this.context,{assign:e,nodes:s,edges:o,graph:t});const c=new Promise(u=>{this.resolver=u}),l=this.setSimulation(a);return l.nodes(s),(i=l.force("link"))===null||i===void 0||i.links(o),c})}getResult(){const{assign:e,nodes:t,edges:r,graph:i}=this.context,a=t.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),Os(o,this.config.outputNodeAttrs))})),s=r.map(({id:o,source:c,target:l,data:u})=>({id:o,source:typeof c=="object"?c.id:c,target:typeof l=="object"?l.id:l,data:u}));return e&&a.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:a,edges:s}}initSimulation(){return stt()}setSimulation(e){const t=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=t.on("tick",()=>{var r;return(r=e.onTick)===null||r===void 0?void 0:r.call(e,this.getResult())}).on("end",()=>{var r;return(r=this.resolver)===null||r===void 0?void 0:r.call(this,this.getResult())})),hP(t,this.config.simulationAttrs.map(r=>[r,e[r]])),Object.entries(this.forceMap).forEach(([r,i])=>{const a=r;if(e[r]){let s=t.force(a);s||(s=i(),t.force(a,s)),hP(s,Object.entries(e[a]))}else t.force(a,null)}),t}}const hP=(n,e)=>e.reduce((t,[r,i])=>!t[r]||i===void 0?t:t[r].call(n,i),n);function htt(n,e,t){var r,i=1;n==null&&(n=0),e==null&&(e=0),t==null&&(t=0);function a(){var s,o=r.length,c,l=0,u=0,h=0;for(s=0;s<o;++s)c=r[s],l+=c.x||0,u+=c.y||0,h+=c.z||0;for(l=(l/o-n)*i,u=(u/o-e)*i,h=(h/o-t)*i,s=0;s<o;++s)c=r[s],l&&(c.x-=l),u&&(c.y-=u),h&&(c.z-=h)}return a.initialize=function(s){r=s},a.x=function(s){return arguments.length?(n=+s,a):n},a.y=function(s){return arguments.length?(e=+s,a):e},a.z=function(s){return arguments.length?(t=+s,a):t},a.strength=function(s){return arguments.length?(i=+s,a):i},a}function ftt(n){const e=+this._x.call(null,n);return G5(this.cover(e),e,n)}function G5(n,e,t){if(isNaN(e))return n;var r,i=n._root,a={data:t},s=n._x0,o=n._x1,c,l,u,h,f;if(!i)return n._root=a,n;for(;i.length;)if((u=e>=(c=(s+o)/2))?s=c:o=c,r=i,!(i=i[h=+u]))return r[h]=a,n;if(l=+n._x.call(null,i.data),e===l)return a.next=i,r?r[h]=a:n._root=a,n;do r=r?r[h]=new Array(2):n._root=new Array(2),(u=e>=(c=(s+o)/2))?s=c:o=c;while((h=+u)==(f=+(l>=c)));return r[f]=i,r[h]=a,n}function dtt(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e);let r=1/0,i=-1/0;for(let a=0,s;a<e;++a)isNaN(s=+this._x.call(null,n[a]))||(t[a]=s,s<r&&(r=s),s>i&&(i=s));if(r>i)return this;this.cover(r).cover(i);for(let a=0;a<e;++a)G5(this,t[a],n[a]);return this}function ptt(n){if(isNaN(n=+n))return this;var e=this._x0,t=this._x1;if(isNaN(e))t=(e=Math.floor(n))+1;else{for(var r=t-e||1,i=this._root,a,s;e>n||n>=t;)switch(s=+(n<e),a=new Array(2),a[s]=i,i=a,r*=2,s){case 0:t=e+r;break;case 1:e=t-r;break}this._root&&this._root.length&&(this._root=i)}return this._x0=e,this._x1=t,this}function gtt(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function vtt(n){return arguments.length?this.cover(+n[0][0]).cover(+n[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Wi(n,e,t){this.node=n,this.x0=e,this.x1=t}function mtt(n,e){var t,r=this._x0,i,a,s=this._x1,o=[],c=this._root,l,u;for(c&&o.push(new Wi(c,r,s)),e==null?e=1/0:(r=n-e,s=n+e);l=o.pop();)if(!(!(c=l.node)||(i=l.x0)>s||(a=l.x1)<r))if(c.length){var h=(i+a)/2;o.push(new Wi(c[1],h,a),new Wi(c[0],i,h)),(u=+(n>=h))&&(l=o[o.length-1],o[o.length-1]=o[o.length-1-u],o[o.length-1-u]=l)}else{var f=Math.abs(n-+this._x.call(null,c.data));f<e&&(e=f,r=n-f,s=n+f,t=c.data)}return t}function ytt(n){if(isNaN(c=+this._x.call(null,n)))return this;var e,t=this._root,r,i,a,s=this._x0,o=this._x1,c,l,u,h,f;if(!t)return this;if(t.length)for(;;){if((u=c>=(l=(s+o)/2))?s=l:o=l,e=t,!(t=t[h=+u]))return this;if(!t.length)break;e[h+1&1]&&(r=e,f=h)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[h]=a:delete e[h],(t=e[0]||e[1])&&t===(e[1]||e[0])&&!t.length&&(r?r[f]=t:this._root=t),this):(this._root=a,this)}function btt(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function Ett(){return this._root}function xtt(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function wtt(n){var e=[],t,r=this._root,i,a,s;for(r&&e.push(new Wi(r,this._x0,this._x1));t=e.pop();)if(!n(r=t.node,a=t.x0,s=t.x1)&&r.length){var o=(a+s)/2;(i=r[1])&&e.push(new Wi(i,o,s)),(i=r[0])&&e.push(new Wi(i,a,o))}return this}function Stt(n){var e=[],t=[],r;for(this._root&&e.push(new Wi(this._root,this._x0,this._x1));r=e.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.x1,c=(s+o)/2;(a=i[0])&&e.push(new Wi(a,s,c)),(a=i[1])&&e.push(new Wi(a,c,o))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.x1);return this}function _tt(n){return n[0]}function Ott(n){return arguments.length?(this._x=n,this):this._x}function OS(n,e){var t=new PS(e??_tt,NaN,NaN);return n==null?t:t.addAll(n)}function PS(n,e,t){this._x=n,this._x0=e,this._x1=t,this._root=void 0}function fP(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Hn=OS.prototype=PS.prototype;Hn.copy=function(){var n=new PS(this._x,this._x0,this._x1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=fP(e),n;for(t=[{source:e,target:n._root=new Array(2)}];e=t.pop();)for(var i=0;i<2;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(2)}):e.target[i]=fP(r));return n};Hn.add=ftt;Hn.addAll=dtt;Hn.cover=ptt;Hn.data=gtt;Hn.extent=vtt;Hn.find=mtt;Hn.remove=ytt;Hn.removeAll=btt;Hn.root=Ett;Hn.size=xtt;Hn.visit=wtt;Hn.visitAfter=Stt;Hn.x=Ott;function Ae(n){return function(){return n}}function _r(n){return(n()-.5)*1e-6}function Gv(n){return n.x+n.vx}function dP(n){return n.y+n.vy}function Ptt(n){return n.z+n.vz}function Ctt(n){var e,t,r,i,a=1,s=1;typeof n!="function"&&(n=Ae(n==null?1:+n));function o(){for(var u,h=e.length,f,d,p,g,v,m,y,b=0;b<s;++b)for(f=(t===1?OS(e,Gv):t===2?dc(e,Gv,dP):t===3?Cg(e,Gv,dP,Ptt):null).visitAfter(c),u=0;u<h;++u)d=e[u],m=r[d.index],y=m*m,p=d.x+d.vx,t>1&&(g=d.y+d.vy),t>2&&(v=d.z+d.vz),f.visit(w);function w(x,S,_,E,P,O,C){var M=[S,_,E,P,O,C],T=M[0],R=M[1],D=M[2],B=M[t],j=M[t+1],L=M[t+2],$=x.data,V=x.r,W=m+V;if($){if($.index>d.index){var Y=p-$.x-$.vx,U=t>1?g-$.y-$.vy:0,J=t>2?v-$.z-$.vz:0,at=Y*Y+U*U+J*J;at<W*W&&(Y===0&&(Y=_r(i),at+=Y*Y),t>1&&U===0&&(U=_r(i),at+=U*U),t>2&&J===0&&(J=_r(i),at+=J*J),at=(W-(at=Math.sqrt(at)))/at*a,d.vx+=(Y*=at)*(W=(V*=V)/(y+V)),t>1&&(d.vy+=(U*=at)*W),t>2&&(d.vz+=(J*=at)*W),$.vx-=Y*(W=1-W),t>1&&($.vy-=U*W),t>2&&($.vz-=J*W))}return}return T>p+W||B<p-W||t>1&&(R>g+W||j<g-W)||t>2&&(D>v+W||L<v-W)}}function c(u){if(u.data)return u.r=r[u.data.index];for(var h=u.r=0;h<Math.pow(2,t);++h)u[h]&&u[h].r>u.r&&(u.r=u[h].r)}function l(){if(e){var u,h=e.length,f;for(r=new Array(h),u=0;u<h;++u)f=e[u],r[f.index]=+n(f,u,e)}}return o.initialize=function(u,...h){e=u,i=h.find(f=>typeof f=="function")||Math.random,t=h.find(f=>[1,2,3].includes(f))||2,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(a=+u,o):a},o.radius=function(u){return arguments.length?(n=typeof u=="function"?u:Ae(+u),l(),o):n},o}function Mtt(n){return n.index}function pP(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function Ttt(n){var e=Mtt,t=f,r,i=Ae(30),a,s,o,c,l,u,h=1;n==null&&(n=[]);function f(m){return 1/Math.min(c[m.source.index],c[m.target.index])}function d(m){for(var y=0,b=n.length;y<h;++y)for(var w=0,x,S,_,E=0,P=0,O=0,C,M;w<b;++w)x=n[w],S=x.source,_=x.target,E=_.x+_.vx-S.x-S.vx||_r(u),o>1&&(P=_.y+_.vy-S.y-S.vy||_r(u)),o>2&&(O=_.z+_.vz-S.z-S.vz||_r(u)),C=Math.sqrt(E*E+P*P+O*O),C=(C-a[w])/C*m*r[w],E*=C,P*=C,O*=C,_.vx-=E*(M=l[w]),o>1&&(_.vy-=P*M),o>2&&(_.vz-=O*M),S.vx+=E*(M=1-M),o>1&&(S.vy+=P*M),o>2&&(S.vz+=O*M)}function p(){if(s){var m,y=s.length,b=n.length,w=new Map(s.map((S,_)=>[e(S,_,s),S])),x;for(m=0,c=new Array(y);m<b;++m)x=n[m],x.index=m,typeof x.source!="object"&&(x.source=pP(w,x.source)),typeof x.target!="object"&&(x.target=pP(w,x.target)),c[x.source.index]=(c[x.source.index]||0)+1,c[x.target.index]=(c[x.target.index]||0)+1;for(m=0,l=new Array(b);m<b;++m)x=n[m],l[m]=c[x.source.index]/(c[x.source.index]+c[x.target.index]);r=new Array(b),g(),a=new Array(b),v()}}function g(){if(s)for(var m=0,y=n.length;m<y;++m)r[m]=+t(n[m],m,n)}function v(){if(s)for(var m=0,y=n.length;m<y;++m)a[m]=+i(n[m],m,n)}return d.initialize=function(m,...y){s=m,u=y.find(b=>typeof b=="function")||Math.random,o=y.find(b=>[1,2,3].includes(b))||2,p()},d.links=function(m){return arguments.length?(n=m,p(),d):n},d.id=function(m){return arguments.length?(e=m,d):e},d.iterations=function(m){return arguments.length?(h=+m,d):h},d.strength=function(m){return arguments.length?(t=typeof m=="function"?m:Ae(+m),g(),d):t},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Ae(+m),v(),d):i},d}const Att=1664525,Ntt=1013904223,gP=4294967296;function Rtt(){let n=1;return()=>(n=(Att*n+Ntt)%gP)/gP}var vP=3;function Vv(n){return n.x}function mP(n){return n.y}function ktt(n){return n.z}var Dtt=10,Ltt=Math.PI*(3-Math.sqrt(5)),Itt=Math.PI*20/(9+Math.sqrt(221));function Btt(n,e){e=e||2;var t=Math.min(vP,Math.max(1,Math.round(e))),r,i=1,a=.001,s=1-Math.pow(a,1/300),o=0,c=.6,l=new Map,u=_S(d),h=SS("tick","end"),f=Rtt();n==null&&(n=[]);function d(){p(),h.call("tick",r),i<a&&(u.stop(),h.call("end",r))}function p(m){var y,b=n.length,w;m===void 0&&(m=1);for(var x=0;x<m;++x)for(i+=(o-i)*s,l.forEach(function(S){S(i)}),y=0;y<b;++y)w=n[y],w.fx==null?w.x+=w.vx*=c:(w.x=w.fx,w.vx=0),t>1&&(w.fy==null?w.y+=w.vy*=c:(w.y=w.fy,w.vy=0)),t>2&&(w.fz==null?w.z+=w.vz*=c:(w.z=w.fz,w.vz=0));return r}function g(){for(var m=0,y=n.length,b;m<y;++m){if(b=n[m],b.index=m,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),b.fz!=null&&(b.z=b.fz),isNaN(b.x)||t>1&&isNaN(b.y)||t>2&&isNaN(b.z)){var w=Dtt*(t>2?Math.cbrt(.5+m):t>1?Math.sqrt(.5+m):m),x=m*Ltt,S=m*Itt;t===1?b.x=w:t===2?(b.x=w*Math.cos(x),b.y=w*Math.sin(x)):(b.x=w*Math.sin(x)*Math.cos(S),b.y=w*Math.cos(x),b.z=w*Math.sin(x)*Math.sin(S))}(isNaN(b.vx)||t>1&&isNaN(b.vy)||t>2&&isNaN(b.vz))&&(b.vx=0,t>1&&(b.vy=0),t>2&&(b.vz=0))}}function v(m){return m.initialize&&m.initialize(n,f,t),m}return g(),r={tick:p,restart:function(){return u.restart(d),r},stop:function(){return u.stop(),r},numDimensions:function(m){return arguments.length?(t=Math.min(vP,Math.max(1,Math.round(m))),l.forEach(v),r):t},nodes:function(m){return arguments.length?(n=m,g(),l.forEach(v),r):n},alpha:function(m){return arguments.length?(i=+m,r):i},alphaMin:function(m){return arguments.length?(a=+m,r):a},alphaDecay:function(m){return arguments.length?(s=+m,r):+s},alphaTarget:function(m){return arguments.length?(o=+m,r):o},velocityDecay:function(m){return arguments.length?(c=1-m,r):1-c},randomSource:function(m){return arguments.length?(f=m,l.forEach(v),r):f},force:function(m,y){return arguments.length>1?(y==null?l.delete(m):l.set(m,v(y)),r):l.get(m)},find:function(){var m=Array.prototype.slice.call(arguments),y=m.shift()||0,b=(t>1?m.shift():null)||0,w=(t>2?m.shift():null)||0,x=m.shift()||1/0,S=0,_=n.length,E,P,O,C,M,T;for(x*=x,S=0;S<_;++S)M=n[S],E=y-M.x,P=b-(M.y||0),O=w-(M.z||0),C=E*E+P*P+O*O,C<x&&(T=M,x=C);return T},on:function(m,y){return arguments.length>1?(h.on(m,y),r):h.on(m)}}}function Ftt(){var n,e,t,r,i,a=Ae(-30),s,o=1,c=1/0,l=.81;function u(p){var g,v=n.length,m=(e===1?OS(n,Vv):e===2?dc(n,Vv,mP):e===3?Cg(n,Vv,mP,ktt):null).visitAfter(f);for(i=p,g=0;g<v;++g)t=n[g],m.visit(d)}function h(){if(n){var p,g=n.length,v;for(s=new Array(g),p=0;p<g;++p)v=n[p],s[v.index]=+a(v,p,n)}}function f(p){var g=0,v,m,y=0,b,w,x,S,_=p.length;if(_){for(b=w=x=S=0;S<_;++S)(v=p[S])&&(m=Math.abs(v.value))&&(g+=v.value,y+=m,b+=m*(v.x||0),w+=m*(v.y||0),x+=m*(v.z||0));g*=Math.sqrt(4/_),p.x=b/y,e>1&&(p.y=w/y),e>2&&(p.z=x/y)}else{v=p,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do g+=s[v.data.index];while(v=v.next)}p.value=g}function d(p,g,v,m,y){if(!p.value)return!0;var b=[v,m,y][e-1],w=p.x-t.x,x=e>1?p.y-t.y:0,S=e>2?p.z-t.z:0,_=b-g,E=w*w+x*x+S*S;if(_*_/l<E)return E<c&&(w===0&&(w=_r(r),E+=w*w),e>1&&x===0&&(x=_r(r),E+=x*x),e>2&&S===0&&(S=_r(r),E+=S*S),E<o&&(E=Math.sqrt(o*E)),t.vx+=w*p.value*i/E,e>1&&(t.vy+=x*p.value*i/E),e>2&&(t.vz+=S*p.value*i/E)),!0;if(p.length||E>=c)return;(p.data!==t||p.next)&&(w===0&&(w=_r(r),E+=w*w),e>1&&x===0&&(x=_r(r),E+=x*x),e>2&&S===0&&(S=_r(r),E+=S*S),E<o&&(E=Math.sqrt(o*E)));do p.data!==t&&(_=s[p.data.index]*i/E,t.vx+=w*_,e>1&&(t.vy+=x*_),e>2&&(t.vz+=S*_));while(p=p.next)}return u.initialize=function(p,...g){n=p,r=g.find(v=>typeof v=="function")||Math.random,e=g.find(v=>[1,2,3].includes(v))||2,h()},u.strength=function(p){return arguments.length?(a=typeof p=="function"?p:Ae(+p),h(),u):a},u.distanceMin=function(p){return arguments.length?(o=p*p,u):Math.sqrt(o)},u.distanceMax=function(p){return arguments.length?(c=p*p,u):Math.sqrt(c)},u.theta=function(p){return arguments.length?(l=p*p,u):Math.sqrt(l)},u}function $tt(n,e,t,r){var i,a,s=Ae(.1),o,c;typeof n!="function"&&(n=Ae(+n)),e==null&&(e=0),t==null&&(t=0),r==null&&(r=0);function l(h){for(var f=0,d=i.length;f<d;++f){var p=i[f],g=p.x-e||1e-6,v=(p.y||0)-t||1e-6,m=(p.z||0)-r||1e-6,y=Math.sqrt(g*g+v*v+m*m),b=(c[f]-y)*o[f]*h/y;p.vx+=g*b,a>1&&(p.vy+=v*b),a>2&&(p.vz+=m*b)}}function u(){if(i){var h,f=i.length;for(o=new Array(f),c=new Array(f),h=0;h<f;++h)c[h]=+n(i[h],h,i),o[h]=isNaN(c[h])?0:+s(i[h],h,i)}}return l.initialize=function(h,...f){i=h,a=f.find(d=>[1,2,3].includes(d))||2,u()},l.strength=function(h){return arguments.length?(s=typeof h=="function"?h:Ae(+h),u(),l):s},l.radius=function(h){return arguments.length?(n=typeof h=="function"?h:Ae(+h),u(),l):n},l.x=function(h){return arguments.length?(e=+h,l):e},l.y=function(h){return arguments.length?(t=+h,l):t},l.z=function(h){return arguments.length?(r=+h,l):r},l}function ztt(n){var e=Ae(.1),t,r,i;typeof n!="function"&&(n=Ae(n==null?0:+n));function a(o){for(var c=0,l=t.length,u;c<l;++c)u=t[c],u.vx+=(i[c]-u.x)*r[c]*o}function s(){if(t){var o,c=t.length;for(r=new Array(c),i=new Array(c),o=0;o<c;++o)r[o]=isNaN(i[o]=+n(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Ae(+o),s(),a):e},a.x=function(o){return arguments.length?(n=typeof o=="function"?o:Ae(+o),s(),a):n},a}function jtt(n){var e=Ae(.1),t,r,i;typeof n!="function"&&(n=Ae(n==null?0:+n));function a(o){for(var c=0,l=t.length,u;c<l;++c)u=t[c],u.vy+=(i[c]-u.y)*r[c]*o}function s(){if(t){var o,c=t.length;for(r=new Array(c),i=new Array(c),o=0;o<c;++o)r[o]=isNaN(i[o]=+n(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Ae(+o),s(),a):e},a.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ae(+o),s(),a):n},a}function qtt(n){var e=Ae(.1),t,r,i;typeof n!="function"&&(n=Ae(n==null?0:+n));function a(o){for(var c=0,l=t.length,u;c<l;++c)u=t[c],u.vz+=(i[c]-u.z)*r[c]*o}function s(){if(t){var o,c=t.length;for(r=new Array(c),i=new Array(c),o=0;o<c;++o)r[o]=isNaN(i[o]=+n(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Ae(+o),s(),a):e},a.z=function(o){return arguments.length?(n=typeof o=="function"?o:Ae(+o),s(),a):n},a}class V5 extends Dg{constructor(){super(...arguments),this.id="d3-force-3d",this.config={inputNodeAttrs:["x","y","z","vx","vy","vz","fx","fy","fz"],outputNodeAttrs:["x","y","z","vx","vy","vz"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource","numDimensions"]},this.forceMap={link:Ttt,manyBody:Ftt,center:htt,collide:Ctt,radial:$tt,x:ztt,y:jtt,z:qtt},this.options={numDimensions:3,link:{id:e=>e.id},manyBody:{},center:{x:0,y:0,z:0}}}initSimulation(){return Btt()}}function CS(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wv,yP;function Gtt(){if(yP)return Wv;yP=1;function n(){this.__data__=[],this.size=0}return Wv=n,Wv}var Hv,bP;function gc(){if(bP)return Hv;bP=1;function n(e,t){return e===t||e!==e&&t!==t}return Hv=n,Hv}var Uv,EP;function Lg(){if(EP)return Uv;EP=1;var n=gc();function e(t,r){for(var i=t.length;i--;)if(n(t[i][0],r))return i;return-1}return Uv=e,Uv}var Yv,xP;function Vtt(){if(xP)return Yv;xP=1;var n=Lg(),e=Array.prototype,t=e.splice;function r(i){var a=this.__data__,s=n(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():t.call(a,s,1),--this.size,!0}return Yv=r,Yv}var Kv,wP;function Wtt(){if(wP)return Kv;wP=1;var n=Lg();function e(t){var r=this.__data__,i=n(r,t);return i<0?void 0:r[i][1]}return Kv=e,Kv}var Xv,SP;function Htt(){if(SP)return Xv;SP=1;var n=Lg();function e(t){return n(this.__data__,t)>-1}return Xv=e,Xv}var Zv,_P;function Utt(){if(_P)return Zv;_P=1;var n=Lg();function e(t,r){var i=this.__data__,a=n(i,t);return a<0?(++this.size,i.push([t,r])):i[a][1]=r,this}return Zv=e,Zv}var Qv,OP;function Ig(){if(OP)return Qv;OP=1;var n=Gtt(),e=Vtt(),t=Wtt(),r=Htt(),i=Utt();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var l=s[o];this.set(l[0],l[1])}}return a.prototype.clear=n,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=r,a.prototype.set=i,Qv=a,Qv}var Jv,PP;function Ytt(){if(PP)return Jv;PP=1;var n=Ig();function e(){this.__data__=new n,this.size=0}return Jv=e,Jv}var tm,CP;function Ktt(){if(CP)return tm;CP=1;function n(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}return tm=n,tm}var em,MP;function Xtt(){if(MP)return em;MP=1;function n(e){return this.__data__.get(e)}return em=n,em}var nm,TP;function Ztt(){if(TP)return nm;TP=1;function n(e){return this.__data__.has(e)}return nm=n,nm}var rm,AP;function W5(){if(AP)return rm;AP=1;var n=typeof jt=="object"&&jt&&jt.Object===Object&&jt;return rm=n,rm}var im,NP;function Qr(){if(NP)return im;NP=1;var n=W5(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return im=t,im}var am,RP;function vc(){if(RP)return am;RP=1;var n=Qr(),e=n.Symbol;return am=e,am}var sm,kP;function Qtt(){if(kP)return sm;kP=1;var n=vc(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,i=n?n.toStringTag:void 0;function a(s){var o=t.call(s,i),c=s[i];try{s[i]=void 0;var l=!0}catch{}var u=r.call(s);return l&&(o?s[i]=c:delete s[i]),u}return sm=a,sm}var om,DP;function Jtt(){if(DP)return om;DP=1;var n=Object.prototype,e=n.toString;function t(r){return e.call(r)}return om=t,om}var cm,LP;function Bs(){if(LP)return cm;LP=1;var n=vc(),e=Qtt(),t=Jtt(),r="[object Null]",i="[object Undefined]",a=n?n.toStringTag:void 0;function s(o){return o==null?o===void 0?i:r:a&&a in Object(o)?e(o):t(o)}return cm=s,cm}var lm,IP;function Nr(){if(IP)return lm;IP=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return lm=n,lm}var um,BP;function bh(){if(BP)return um;BP=1;var n=Bs(),e=Nr(),t="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var c=n(o);return c==r||c==i||c==t||c==a}return um=s,um}var hm,FP;function tet(){if(FP)return hm;FP=1;var n=Qr(),e=n["__core-js_shared__"];return hm=e,hm}var fm,$P;function eet(){if($P)return fm;$P=1;var n=tet(),e=function(){var r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function t(r){return!!e&&e in r}return fm=t,fm}var dm,zP;function H5(){if(zP)return dm;zP=1;var n=Function.prototype,e=n.toString;function t(r){if(r!=null){try{return e.call(r)}catch{}try{return r+""}catch{}}return""}return dm=t,dm}var pm,jP;function net(){if(jP)return pm;jP=1;var n=bh(),e=eet(),t=Nr(),r=H5(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,c=s.toString,l=o.hasOwnProperty,u=RegExp("^"+c.call(l).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(f){if(!t(f)||e(f))return!1;var d=n(f)?u:a;return d.test(r(f))}return pm=h,pm}var gm,qP;function ret(){if(qP)return gm;qP=1;function n(e,t){return e==null?void 0:e[t]}return gm=n,gm}var vm,GP;function Fs(){if(GP)return vm;GP=1;var n=net(),e=ret();function t(r,i){var a=e(r,i);return n(a)?a:void 0}return vm=t,vm}var mm,VP;function MS(){if(VP)return mm;VP=1;var n=Fs(),e=Qr(),t=n(e,"Map");return mm=t,mm}var ym,WP;function Bg(){if(WP)return ym;WP=1;var n=Fs(),e=n(Object,"create");return ym=e,ym}var bm,HP;function iet(){if(HP)return bm;HP=1;var n=Bg();function e(){this.__data__=n?n(null):{},this.size=0}return bm=e,bm}var Em,UP;function aet(){if(UP)return Em;UP=1;function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Em=n,Em}var xm,YP;function set(){if(YP)return xm;YP=1;var n=Bg(),e="__lodash_hash_undefined__",t=Object.prototype,r=t.hasOwnProperty;function i(a){var s=this.__data__;if(n){var o=s[a];return o===e?void 0:o}return r.call(s,a)?s[a]:void 0}return xm=i,xm}var wm,KP;function oet(){if(KP)return wm;KP=1;var n=Bg(),e=Object.prototype,t=e.hasOwnProperty;function r(i){var a=this.__data__;return n?a[i]!==void 0:t.call(a,i)}return wm=r,wm}var Sm,XP;function cet(){if(XP)return Sm;XP=1;var n=Bg(),e="__lodash_hash_undefined__";function t(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=n&&i===void 0?e:i,this}return Sm=t,Sm}var _m,ZP;function uet(){if(ZP)return _m;ZP=1;var n=iet(),e=aet(),t=set(),r=oet(),i=cet();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var l=s[o];this.set(l[0],l[1])}}return a.prototype.clear=n,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=r,a.prototype.set=i,_m=a,_m}var Om,QP;function het(){if(QP)return Om;QP=1;var n=uet(),e=Ig(),t=MS();function r(){this.size=0,this.__data__={hash:new n,map:new(t||e),string:new n}}return Om=r,Om}var Pm,JP;function fet(){if(JP)return Pm;JP=1;function n(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Pm=n,Pm}var Cm,tC;function Fg(){if(tC)return Cm;tC=1;var n=fet();function e(t,r){var i=t.__data__;return n(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Cm=e,Cm}var Mm,eC;function det(){if(eC)return Mm;eC=1;var n=Fg();function e(t){var r=n(this,t).delete(t);return this.size-=r?1:0,r}return Mm=e,Mm}var Tm,nC;function pet(){if(nC)return Tm;nC=1;var n=Fg();function e(t){return n(this,t).get(t)}return Tm=e,Tm}var Am,rC;function get(){if(rC)return Am;rC=1;var n=Fg();function e(t){return n(this,t).has(t)}return Am=e,Am}var Nm,iC;function vet(){if(iC)return Nm;iC=1;var n=Fg();function e(t,r){var i=n(this,t),a=i.size;return i.set(t,r),this.size+=i.size==a?0:1,this}return Nm=e,Nm}var Rm,aC;function TS(){if(aC)return Rm;aC=1;var n=het(),e=det(),t=pet(),r=get(),i=vet();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var l=s[o];this.set(l[0],l[1])}}return a.prototype.clear=n,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=r,a.prototype.set=i,Rm=a,Rm}var km,sC;function met(){if(sC)return km;sC=1;var n=Ig(),e=MS(),t=TS(),r=200;function i(a,s){var o=this.__data__;if(o instanceof n){var c=o.__data__;if(!e||c.length<r-1)return c.push([a,s]),this.size=++o.size,this;o=this.__data__=new t(c)}return o.set(a,s),this.size=o.size,this}return km=i,km}var Dm,oC;function $g(){if(oC)return Dm;oC=1;var n=Ig(),e=Ytt(),t=Ktt(),r=Xtt(),i=Ztt(),a=met();function s(o){var c=this.__data__=new n(o);this.size=c.size}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=i,s.prototype.set=a,Dm=s,Dm}var Lm,cC;function AS(){if(cC)return Lm;cC=1;function n(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}return Lm=n,Lm}var Im,lC;function U5(){if(lC)return Im;lC=1;var n=Fs(),e=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch{}}();return Im=e,Im}var Bm,uC;function zg(){if(uC)return Bm;uC=1;var n=U5();function e(t,r,i){r=="__proto__"&&n?n(t,r,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[r]=i}return Bm=e,Bm}var Fm,hC;function jg(){if(hC)return Fm;hC=1;var n=zg(),e=gc(),t=Object.prototype,r=t.hasOwnProperty;function i(a,s,o){var c=a[s];(!(r.call(a,s)&&e(c,o))||o===void 0&&!(s in a))&&n(a,s,o)}return Fm=i,Fm}var $m,fC;function Eh(){if(fC)return $m;fC=1;var n=jg(),e=zg();function t(r,i,a,s){var o=!a;a||(a={});for(var c=-1,l=i.length;++c<l;){var u=i[c],h=s?s(a[u],r[u],u,a,r):void 0;h===void 0&&(h=r[u]),o?e(a,u,h):n(a,u,h)}return a}return $m=t,$m}var zm,dC;function yet(){if(dC)return zm;dC=1;function n(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}return zm=n,zm}var jm,pC;function wi(){if(pC)return jm;pC=1;function n(e){return e!=null&&typeof e=="object"}return jm=n,jm}var qm,gC;function bet(){if(gC)return qm;gC=1;var n=Bs(),e=wi(),t="[object Arguments]";function r(i){return e(i)&&n(i)==t}return qm=r,qm}var Gm,vC;function xh(){if(vC)return Gm;vC=1;var n=bet(),e=wi(),t=Object.prototype,r=t.hasOwnProperty,i=t.propertyIsEnumerable,a=n(function(){return arguments}())?n:function(s){return e(s)&&r.call(s,"callee")&&!i.call(s,"callee")};return Gm=a,Gm}var Vm,mC;function He(){if(mC)return Vm;mC=1;var n=Array.isArray;return Vm=n,Vm}var vu={exports:{}},Wm,yC;function Eet(){if(yC)return Wm;yC=1;function n(){return!1}return Wm=n,Wm}vu.exports;var bC;function mc(){return bC||(bC=1,function(n,e){var t=Qr(),r=Eet(),i=e&&!e.nodeType&&e,a=i&&!0&&n&&!n.nodeType&&n,s=a&&a.exports===i,o=s?t.Buffer:void 0,c=o?o.isBuffer:void 0,l=c||r;n.exports=l}(vu,vu.exports)),vu.exports}var Hm,EC;function qg(){if(EC)return Hm;EC=1;var n=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(r,i){var a=typeof r;return i=i??n,!!i&&(a=="number"||a!="symbol"&&e.test(r))&&r>-1&&r%1==0&&r<i}return Hm=t,Hm}var Um,xC;function NS(){if(xC)return Um;xC=1;var n=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=n}return Um=e,Um}var Ym,wC;function xet(){if(wC)return Ym;wC=1;var n=Bs(),e=NS(),t=wi(),r="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",h="[object Object]",f="[object RegExp]",d="[object Set]",p="[object String]",g="[object WeakMap]",v="[object ArrayBuffer]",m="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",x="[object Int16Array]",S="[object Int32Array]",_="[object Uint8Array]",E="[object Uint8ClampedArray]",P="[object Uint16Array]",O="[object Uint32Array]",C={};C[y]=C[b]=C[w]=C[x]=C[S]=C[_]=C[E]=C[P]=C[O]=!0,C[r]=C[i]=C[v]=C[a]=C[m]=C[s]=C[o]=C[c]=C[l]=C[u]=C[h]=C[f]=C[d]=C[p]=C[g]=!1;function M(T){return t(T)&&e(T.length)&&!!C[n(T)]}return Ym=M,Ym}var Km,SC;function Gg(){if(SC)return Km;SC=1;function n(e){return function(t){return e(t)}}return Km=n,Km}var mu={exports:{}};mu.exports;var _C;function RS(){return _C||(_C=1,function(n,e){var t=W5(),r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===r,s=a&&t.process,o=function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();n.exports=o}(mu,mu.exports)),mu.exports}var Xm,OC;function wh(){if(OC)return Xm;OC=1;var n=xet(),e=Gg(),t=RS(),r=t&&t.isTypedArray,i=r?e(r):n;return Xm=i,Xm}var Zm,PC;function Y5(){if(PC)return Zm;PC=1;var n=yet(),e=xh(),t=He(),r=mc(),i=qg(),a=wh(),s=Object.prototype,o=s.hasOwnProperty;function c(l,u){var h=t(l),f=!h&&e(l),d=!h&&!f&&r(l),p=!h&&!f&&!d&&a(l),g=h||f||d||p,v=g?n(l.length,String):[],m=v.length;for(var y in l)(u||o.call(l,y))&&!(g&&(y=="length"||d&&(y=="offset"||y=="parent")||p&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||i(y,m)))&&v.push(y);return v}return Zm=c,Zm}var Qm,CC;function Vg(){if(CC)return Qm;CC=1;var n=Object.prototype;function e(t){var r=t&&t.constructor,i=typeof r=="function"&&r.prototype||n;return t===i}return Qm=e,Qm}var Jm,MC;function K5(){if(MC)return Jm;MC=1;function n(e,t){return function(r){return e(t(r))}}return Jm=n,Jm}var ty,TC;function wet(){if(TC)return ty;TC=1;var n=K5(),e=n(Object.keys,Object);return ty=e,ty}var ey,AC;function kS(){if(AC)return ey;AC=1;var n=Vg(),e=wet(),t=Object.prototype,r=t.hasOwnProperty;function i(a){if(!n(a))return e(a);var s=[];for(var o in Object(a))r.call(a,o)&&o!="constructor"&&s.push(o);return s}return ey=i,ey}var ny,NC;function ta(){if(NC)return ny;NC=1;var n=bh(),e=NS();function t(r){return r!=null&&e(r.length)&&!n(r)}return ny=t,ny}var ry,RC;function Va(){if(RC)return ry;RC=1;var n=Y5(),e=kS(),t=ta();function r(i){return t(i)?n(i):e(i)}return ry=r,ry}var iy,kC;function _et(){if(kC)return iy;kC=1;var n=Eh(),e=Va();function t(r,i){return r&&n(i,e(i),r)}return iy=t,iy}var ay,DC;function Oet(){if(DC)return ay;DC=1;function n(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}return ay=n,ay}var sy,LC;function Pet(){if(LC)return sy;LC=1;var n=Nr(),e=Vg(),t=Oet(),r=Object.prototype,i=r.hasOwnProperty;function a(s){if(!n(s))return t(s);var o=e(s),c=[];for(var l in s)l=="constructor"&&(o||!i.call(s,l))||c.push(l);return c}return sy=a,sy}var oy,IC;function $s(){if(IC)return oy;IC=1;var n=Y5(),e=Pet(),t=ta();function r(i){return t(i)?n(i,!0):e(i)}return oy=r,oy}var cy,BC;function Cet(){if(BC)return cy;BC=1;var n=Eh(),e=$s();function t(r,i){return r&&n(i,e(i),r)}return cy=t,cy}var yu={exports:{}};yu.exports;var FC;function X5(){return FC||(FC=1,function(n,e){var t=Qr(),r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===r,s=a?t.Buffer:void 0,o=s?s.allocUnsafe:void 0;function c(l,u){if(u)return l.slice();var h=l.length,f=o?o(h):new l.constructor(h);return l.copy(f),f}n.exports=c}(yu,yu.exports)),yu.exports}var ly,$C;function Z5(){if($C)return ly;$C=1;function n(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}return ly=n,ly}var uy,zC;function Q5(){if(zC)return uy;zC=1;function n(e,t){for(var r=-1,i=e==null?0:e.length,a=0,s=[];++r<i;){var o=e[r];t(o,r,e)&&(s[a++]=o)}return s}return uy=n,uy}var hy,jC;function J5(){if(jC)return hy;jC=1;function n(){return[]}return hy=n,hy}var fy,qC;function DS(){if(qC)return fy;qC=1;var n=Q5(),e=J5(),t=Object.prototype,r=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),n(i(s),function(o){return r.call(s,o)}))}:e;return fy=a,fy}var dy,GC;function Met(){if(GC)return dy;GC=1;var n=Eh(),e=DS();function t(r,i){return n(r,e(r),i)}return dy=t,dy}var py,VC;function LS(){if(VC)return py;VC=1;function n(e,t){for(var r=-1,i=t.length,a=e.length;++r<i;)e[a+r]=t[r];return e}return py=n,py}var gy,WC;function Wg(){if(WC)return gy;WC=1;var n=K5(),e=n(Object.getPrototypeOf,Object);return gy=e,gy}var vy,HC;function t4(){if(HC)return vy;HC=1;var n=LS(),e=Wg(),t=DS(),r=J5(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)n(o,t(s)),s=e(s);return o}:r;return vy=a,vy}var my,UC;function Tet(){if(UC)return my;UC=1;var n=Eh(),e=t4();function t(r,i){return n(r,e(r),i)}return my=t,my}var yy,YC;function e4(){if(YC)return yy;YC=1;var n=LS(),e=He();function t(r,i,a){var s=i(r);return e(r)?s:n(s,a(r))}return yy=t,yy}var by,KC;function n4(){if(KC)return by;KC=1;var n=e4(),e=DS(),t=Va();function r(i){return n(i,t,e)}return by=r,by}var Ey,XC;function Aet(){if(XC)return Ey;XC=1;var n=e4(),e=t4(),t=$s();function r(i){return n(i,t,e)}return Ey=r,Ey}var xy,ZC;function Net(){if(ZC)return xy;ZC=1;var n=Fs(),e=Qr(),t=n(e,"DataView");return xy=t,xy}var wy,QC;function Ret(){if(QC)return wy;QC=1;var n=Fs(),e=Qr(),t=n(e,"Promise");return wy=t,wy}var Sy,JC;function r4(){if(JC)return Sy;JC=1;var n=Fs(),e=Qr(),t=n(e,"Set");return Sy=t,Sy}var _y,tM;function ket(){if(tM)return _y;tM=1;var n=Fs(),e=Qr(),t=n(e,"WeakMap");return _y=t,_y}var Oy,eM;function yc(){if(eM)return Oy;eM=1;var n=Net(),e=MS(),t=Ret(),r=r4(),i=ket(),a=Bs(),s=H5(),o="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",h="[object WeakMap]",f="[object DataView]",d=s(n),p=s(e),g=s(t),v=s(r),m=s(i),y=a;return(n&&y(new n(new ArrayBuffer(1)))!=f||e&&y(new e)!=o||t&&y(t.resolve())!=l||r&&y(new r)!=u||i&&y(new i)!=h)&&(y=function(b){var w=a(b),x=w==c?b.constructor:void 0,S=x?s(x):"";if(S)switch(S){case d:return f;case p:return o;case g:return l;case v:return u;case m:return h}return w}),Oy=y,Oy}var Py,nM;function Det(){if(nM)return Py;nM=1;var n=Object.prototype,e=n.hasOwnProperty;function t(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&e.call(r,"index")&&(a.index=r.index,a.input=r.input),a}return Py=t,Py}var Cy,rM;function i4(){if(rM)return Cy;rM=1;var n=Qr(),e=n.Uint8Array;return Cy=e,Cy}var My,iM;function IS(){if(iM)return My;iM=1;var n=i4();function e(t){var r=new t.constructor(t.byteLength);return new n(r).set(new n(t)),r}return My=e,My}var Ty,aM;function Let(){if(aM)return Ty;aM=1;var n=IS();function e(t,r){var i=r?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}return Ty=e,Ty}var Ay,sM;function Iet(){if(sM)return Ay;sM=1;var n=/\w*$/;function e(t){var r=new t.constructor(t.source,n.exec(t));return r.lastIndex=t.lastIndex,r}return Ay=e,Ay}var Ny,oM;function Bet(){if(oM)return Ny;oM=1;var n=vc(),e=n?n.prototype:void 0,t=e?e.valueOf:void 0;function r(i){return t?Object(t.call(i)):{}}return Ny=r,Ny}var Ry,cM;function a4(){if(cM)return Ry;cM=1;var n=IS();function e(t,r){var i=r?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}return Ry=e,Ry}var ky,lM;function Fet(){if(lM)return ky;lM=1;var n=IS(),e=Let(),t=Iet(),r=Bet(),i=a4(),a="[object Boolean]",s="[object Date]",o="[object Map]",c="[object Number]",l="[object RegExp]",u="[object Set]",h="[object String]",f="[object Symbol]",d="[object ArrayBuffer]",p="[object DataView]",g="[object Float32Array]",v="[object Float64Array]",m="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",w="[object Uint8Array]",x="[object Uint8ClampedArray]",S="[object Uint16Array]",_="[object Uint32Array]";function E(P,O,C){var M=P.constructor;switch(O){case d:return n(P);case a:case s:return new M(+P);case p:return e(P,C);case g:case v:case m:case y:case b:case w:case x:case S:case _:return i(P,C);case o:return new M;case c:case h:return new M(P);case l:return t(P);case u:return new M;case f:return r(P)}}return ky=E,ky}var Dy,uM;function s4(){if(uM)return Dy;uM=1;var n=Nr(),e=Object.create,t=function(){function r(){}return function(i){if(!n(i))return{};if(e)return e(i);r.prototype=i;var a=new r;return r.prototype=void 0,a}}();return Dy=t,Dy}var Ly,hM;function o4(){if(hM)return Ly;hM=1;var n=s4(),e=Wg(),t=Vg();function r(i){return typeof i.constructor=="function"&&!t(i)?n(e(i)):{}}return Ly=r,Ly}var Iy,fM;function $et(){if(fM)return Iy;fM=1;var n=yc(),e=wi(),t="[object Map]";function r(i){return e(i)&&n(i)==t}return Iy=r,Iy}var By,dM;function zet(){if(dM)return By;dM=1;var n=$et(),e=Gg(),t=RS(),r=t&&t.isMap,i=r?e(r):n;return By=i,By}var Fy,pM;function jet(){if(pM)return Fy;pM=1;var n=yc(),e=wi(),t="[object Set]";function r(i){return e(i)&&n(i)==t}return Fy=r,Fy}var $y,gM;function qet(){if(gM)return $y;gM=1;var n=jet(),e=Gg(),t=RS(),r=t&&t.isSet,i=r?e(r):n;return $y=i,$y}var zy,vM;function c4(){if(vM)return zy;vM=1;var n=$g(),e=AS(),t=jg(),r=_et(),i=Cet(),a=X5(),s=Z5(),o=Met(),c=Tet(),l=n4(),u=Aet(),h=yc(),f=Det(),d=Fet(),p=o4(),g=He(),v=mc(),m=zet(),y=Nr(),b=qet(),w=Va(),x=$s(),S=1,_=2,E=4,P="[object Arguments]",O="[object Array]",C="[object Boolean]",M="[object Date]",T="[object Error]",R="[object Function]",D="[object GeneratorFunction]",B="[object Map]",j="[object Number]",L="[object Object]",$="[object RegExp]",V="[object Set]",W="[object String]",Y="[object Symbol]",U="[object WeakMap]",J="[object ArrayBuffer]",at="[object DataView]",ht="[object Float32Array]",lt="[object Float64Array]",Nt="[object Int8Array]",pe="[object Int16Array]",Be="[object Int32Array]",nn="[object Uint8Array]",ri="[object Uint8ClampedArray]",Ya="[object Uint16Array]",Ka="[object Uint32Array]",Ht={};Ht[P]=Ht[O]=Ht[J]=Ht[at]=Ht[C]=Ht[M]=Ht[ht]=Ht[lt]=Ht[Nt]=Ht[pe]=Ht[Be]=Ht[B]=Ht[j]=Ht[L]=Ht[$]=Ht[V]=Ht[W]=Ht[Y]=Ht[nn]=Ht[ri]=Ht[Ya]=Ht[Ka]=!0,Ht[T]=Ht[R]=Ht[U]=!1;function dr($t,Lr,Ir,ia,z,dn){var ce,Kn=Lr&S,pr=Lr&_,gr=Lr&E;if(Ir&&(ce=z?Ir($t,ia,z,dn):Ir($t)),ce!==void 0)return ce;if(!y($t))return $t;var ye=g($t);if(ye){if(ce=f($t),!Kn)return s($t,ce)}else{var ii=h($t),Xa=ii==R||ii==D;if(v($t))return a($t,Kn);if(ii==L||ii==P||Xa&&!z){if(ce=pr||Xa?{}:p($t),!Kn)return pr?c($t,i(ce,$t)):o($t,r(ce,$t))}else{if(!Ht[ii])return z?$t:{};ce=d($t,ii,Kn)}}dn||(dn=new n);var Za=dn.get($t);if(Za)return Za;dn.set($t,ce),b($t)?$t.forEach(function(Br){ce.add(dr(Br,Lr,Ir,Br,$t,dn))}):m($t)&&$t.forEach(function(Br,Ci){ce.set(Ci,dr(Br,Lr,Ir,Ci,$t,dn))});var Ce=gr?pr?u:l:pr?x:w,zh=ye?void 0:Ce($t);return e(zh||$t,function(Br,Ci){zh&&(Ci=Br,Br=$t[Ci]),t(ce,Ci,dr(Br,Lr,Ir,Ci,$t,dn))}),ce}return zy=dr,zy}var jy,mM;function Get(){if(mM)return jy;mM=1;var n=c4(),e=4;function t(r){return n(r,e)}return jy=t,jy}var qy,yM;function BS(){if(yM)return qy;yM=1;function n(e){return function(){return e}}return qy=n,qy}var Gy,bM;function Vet(){if(bM)return Gy;bM=1;function n(e){return function(t,r,i){for(var a=-1,s=Object(t),o=i(t),c=o.length;c--;){var l=o[e?c:++a];if(r(s[l],l,s)===!1)break}return t}}return Gy=n,Gy}var Vy,EM;function FS(){if(EM)return Vy;EM=1;var n=Vet(),e=n();return Vy=e,Vy}var Wy,xM;function $S(){if(xM)return Wy;xM=1;var n=FS(),e=Va();function t(r,i){return r&&n(r,i,e)}return Wy=t,Wy}var Hy,wM;function Wet(){if(wM)return Hy;wM=1;var n=ta();function e(t,r){return function(i,a){if(i==null)return i;if(!n(i))return t(i,a);for(var s=i.length,o=r?s:-1,c=Object(i);(r?o--:++o<s)&&a(c[o],o,c)!==!1;);return i}}return Hy=e,Hy}var Uy,SM;function Hg(){if(SM)return Uy;SM=1;var n=$S(),e=Wet(),t=e(n);return Uy=t,Uy}var Yy,_M;function zs(){if(_M)return Yy;_M=1;function n(e){return e}return Yy=n,Yy}var Ky,OM;function l4(){if(OM)return Ky;OM=1;var n=zs();function e(t){return typeof t=="function"?t:n}return Ky=e,Ky}var Xy,PM;function u4(){if(PM)return Xy;PM=1;var n=AS(),e=Hg(),t=l4(),r=He();function i(a,s){var o=r(a)?n:e;return o(a,t(s))}return Xy=i,Xy}var Zy,CM;function h4(){return CM||(CM=1,Zy=u4()),Zy}var Qy,MM;function Het(){if(MM)return Qy;MM=1;var n=Hg();function e(t,r){var i=[];return n(t,function(a,s,o){r(a,s,o)&&i.push(a)}),i}return Qy=e,Qy}var Jy,TM;function Uet(){if(TM)return Jy;TM=1;var n="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,n),this}return Jy=e,Jy}var t1,AM;function Yet(){if(AM)return t1;AM=1;function n(e){return this.__data__.has(e)}return t1=n,t1}var e1,NM;function f4(){if(NM)return e1;NM=1;var n=TS(),e=Uet(),t=Yet();function r(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new n;++a<s;)this.add(i[a])}return r.prototype.add=r.prototype.push=e,r.prototype.has=t,e1=r,e1}var n1,RM;function Ket(){if(RM)return n1;RM=1;function n(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}return n1=n,n1}var r1,kM;function d4(){if(kM)return r1;kM=1;function n(e,t){return e.has(t)}return r1=n,r1}var i1,DM;function p4(){if(DM)return i1;DM=1;var n=f4(),e=Ket(),t=d4(),r=1,i=2;function a(s,o,c,l,u,h){var f=c&r,d=s.length,p=o.length;if(d!=p&&!(f&&p>d))return!1;var g=h.get(s),v=h.get(o);if(g&&v)return g==o&&v==s;var m=-1,y=!0,b=c&i?new n:void 0;for(h.set(s,o),h.set(o,s);++m<d;){var w=s[m],x=o[m];if(l)var S=f?l(x,w,m,o,s,h):l(w,x,m,s,o,h);if(S!==void 0){if(S)continue;y=!1;break}if(b){if(!e(o,function(_,E){if(!t(b,E)&&(w===_||u(w,_,c,l,h)))return b.push(E)})){y=!1;break}}else if(!(w===x||u(w,x,c,l,h))){y=!1;break}}return h.delete(s),h.delete(o),y}return i1=a,i1}var a1,LM;function Xet(){if(LM)return a1;LM=1;function n(e){var t=-1,r=Array(e.size);return e.forEach(function(i,a){r[++t]=[a,i]}),r}return a1=n,a1}var s1,IM;function zS(){if(IM)return s1;IM=1;function n(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}return s1=n,s1}var o1,BM;function Zet(){if(BM)return o1;BM=1;var n=vc(),e=i4(),t=gc(),r=p4(),i=Xet(),a=zS(),s=1,o=2,c="[object Boolean]",l="[object Date]",u="[object Error]",h="[object Map]",f="[object Number]",d="[object RegExp]",p="[object Set]",g="[object String]",v="[object Symbol]",m="[object ArrayBuffer]",y="[object DataView]",b=n?n.prototype:void 0,w=b?b.valueOf:void 0;function x(S,_,E,P,O,C,M){switch(E){case y:if(S.byteLength!=_.byteLength||S.byteOffset!=_.byteOffset)return!1;S=S.buffer,_=_.buffer;case m:return!(S.byteLength!=_.byteLength||!C(new e(S),new e(_)));case c:case l:case f:return t(+S,+_);case u:return S.name==_.name&&S.message==_.message;case d:case g:return S==_+"";case h:var T=i;case p:var R=P&s;if(T||(T=a),S.size!=_.size&&!R)return!1;var D=M.get(S);if(D)return D==_;P|=o,M.set(S,_);var B=r(T(S),T(_),P,O,C,M);return M.delete(S),B;case v:if(w)return w.call(S)==w.call(_)}return!1}return o1=x,o1}var c1,FM;function Qet(){if(FM)return c1;FM=1;var n=n4(),e=1,t=Object.prototype,r=t.hasOwnProperty;function i(a,s,o,c,l,u){var h=o&e,f=n(a),d=f.length,p=n(s),g=p.length;if(d!=g&&!h)return!1;for(var v=d;v--;){var m=f[v];if(!(h?m in s:r.call(s,m)))return!1}var y=u.get(a),b=u.get(s);if(y&&b)return y==s&&b==a;var w=!0;u.set(a,s),u.set(s,a);for(var x=h;++v<d;){m=f[v];var S=a[m],_=s[m];if(c)var E=h?c(_,S,m,s,a,u):c(S,_,m,a,s,u);if(!(E===void 0?S===_||l(S,_,o,c,u):E)){w=!1;break}x||(x=m=="constructor")}if(w&&!x){var P=a.constructor,O=s.constructor;P!=O&&"constructor"in a&&"constructor"in s&&!(typeof P=="function"&&P instanceof P&&typeof O=="function"&&O instanceof O)&&(w=!1)}return u.delete(a),u.delete(s),w}return c1=i,c1}var l1,$M;function Jet(){if($M)return l1;$M=1;var n=$g(),e=p4(),t=Zet(),r=Qet(),i=yc(),a=He(),s=mc(),o=wh(),c=1,l="[object Arguments]",u="[object Array]",h="[object Object]",f=Object.prototype,d=f.hasOwnProperty;function p(g,v,m,y,b,w){var x=a(g),S=a(v),_=x?u:i(g),E=S?u:i(v);_=_==l?h:_,E=E==l?h:E;var P=_==h,O=E==h,C=_==E;if(C&&s(g)){if(!s(v))return!1;x=!0,P=!1}if(C&&!P)return w||(w=new n),x||o(g)?e(g,v,m,y,b,w):t(g,v,_,m,y,b,w);if(!(m&c)){var M=P&&d.call(g,"__wrapped__"),T=O&&d.call(v,"__wrapped__");if(M||T){var R=M?g.value():g,D=T?v.value():v;return w||(w=new n),b(R,D,m,y,w)}}return C?(w||(w=new n),r(g,v,m,y,b,w)):!1}return l1=p,l1}var u1,zM;function g4(){if(zM)return u1;zM=1;var n=Jet(),e=wi();function t(r,i,a,s,o){return r===i?!0:r==null||i==null||!e(r)&&!e(i)?r!==r&&i!==i:n(r,i,a,s,t,o)}return u1=t,u1}var h1,jM;function tnt(){if(jM)return h1;jM=1;var n=$g(),e=g4(),t=1,r=2;function i(a,s,o,c){var l=o.length,u=l,h=!c;if(a==null)return!u;for(a=Object(a);l--;){var f=o[l];if(h&&f[2]?f[1]!==a[f[0]]:!(f[0]in a))return!1}for(;++l<u;){f=o[l];var d=f[0],p=a[d],g=f[1];if(h&&f[2]){if(p===void 0&&!(d in a))return!1}else{var v=new n;if(c)var m=c(p,g,d,a,s,v);if(!(m===void 0?e(g,p,t|r,c,v):m))return!1}}return!0}return h1=i,h1}var f1,qM;function v4(){if(qM)return f1;qM=1;var n=Nr();function e(t){return t===t&&!n(t)}return f1=e,f1}var d1,GM;function ent(){if(GM)return d1;GM=1;var n=v4(),e=Va();function t(r){for(var i=e(r),a=i.length;a--;){var s=i[a],o=r[s];i[a]=[s,o,n(o)]}return i}return d1=t,d1}var p1,VM;function m4(){if(VM)return p1;VM=1;function n(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}return p1=n,p1}var g1,WM;function nnt(){if(WM)return g1;WM=1;var n=tnt(),e=ent(),t=m4();function r(i){var a=e(i);return a.length==1&&a[0][2]?t(a[0][0],a[0][1]):function(s){return s===i||n(s,i,a)}}return g1=r,g1}var v1,HM;function bc(){if(HM)return v1;HM=1;var n=Bs(),e=wi(),t="[object Symbol]";function r(i){return typeof i=="symbol"||e(i)&&n(i)==t}return v1=r,v1}var m1,UM;function jS(){if(UM)return m1;UM=1;var n=He(),e=bc(),t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(a,s){if(n(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:r.test(a)||!t.test(a)||s!=null&&a in Object(s)}return m1=i,m1}var y1,YM;function rnt(){if(YM)return y1;YM=1;var n=TS(),e="Expected a function";function t(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],c=a.cache;if(c.has(o))return c.get(o);var l=r.apply(this,s);return a.cache=c.set(o,l)||c,l};return a.cache=new(t.Cache||n),a}return t.Cache=n,y1=t,y1}var b1,KM;function int(){if(KM)return b1;KM=1;var n=rnt(),e=500;function t(r){var i=n(r,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return b1=t,b1}var E1,XM;function ant(){if(XM)return E1;XM=1;var n=int(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t=/\\(\\)?/g,r=n(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,c,l){a.push(c?l.replace(t,"$1"):o||s)}),a});return E1=r,E1}var x1,ZM;function Ug(){if(ZM)return x1;ZM=1;function n(e,t){for(var r=-1,i=e==null?0:e.length,a=Array(i);++r<i;)a[r]=t(e[r],r,e);return a}return x1=n,x1}var w1,QM;function snt(){if(QM)return w1;QM=1;var n=vc(),e=Ug(),t=He(),r=bc(),i=1/0,a=n?n.prototype:void 0,s=a?a.toString:void 0;function o(c){if(typeof c=="string")return c;if(t(c))return e(c,o)+"";if(r(c))return s?s.call(c):"";var l=c+"";return l=="0"&&1/c==-i?"-0":l}return w1=o,w1}var S1,JM;function y4(){if(JM)return S1;JM=1;var n=snt();function e(t){return t==null?"":n(t)}return S1=e,S1}var _1,tT;function Yg(){if(tT)return _1;tT=1;var n=He(),e=jS(),t=ant(),r=y4();function i(a,s){return n(a)?a:e(a,s)?[a]:t(r(a))}return _1=i,_1}var O1,eT;function Sh(){if(eT)return O1;eT=1;var n=bc(),e=1/0;function t(r){if(typeof r=="string"||n(r))return r;var i=r+"";return i=="0"&&1/r==-e?"-0":i}return O1=t,O1}var P1,nT;function Kg(){if(nT)return P1;nT=1;var n=Yg(),e=Sh();function t(r,i){i=n(i,r);for(var a=0,s=i.length;r!=null&&a<s;)r=r[e(i[a++])];return a&&a==s?r:void 0}return P1=t,P1}var C1,rT;function ont(){if(rT)return C1;rT=1;var n=Kg();function e(t,r,i){var a=t==null?void 0:n(t,r);return a===void 0?i:a}return C1=e,C1}var M1,iT;function cnt(){if(iT)return M1;iT=1;function n(e,t){return e!=null&&t in Object(e)}return M1=n,M1}var T1,aT;function b4(){if(aT)return T1;aT=1;var n=Yg(),e=xh(),t=He(),r=qg(),i=NS(),a=Sh();function s(o,c,l){c=n(c,o);for(var u=-1,h=c.length,f=!1;++u<h;){var d=a(c[u]);if(!(f=o!=null&&l(o,d)))break;o=o[d]}return f||++u!=h?f:(h=o==null?0:o.length,!!h&&i(h)&&r(d,h)&&(t(o)||e(o)))}return T1=s,T1}var A1,sT;function E4(){if(sT)return A1;sT=1;var n=cnt(),e=b4();function t(r,i){return r!=null&&e(r,i,n)}return A1=t,A1}var N1,oT;function lnt(){if(oT)return N1;oT=1;var n=g4(),e=ont(),t=E4(),r=jS(),i=v4(),a=m4(),s=Sh(),o=1,c=2;function l(u,h){return r(u)&&i(h)?a(s(u),h):function(f){var d=e(f,u);return d===void 0&&d===h?t(f,u):n(h,d,o|c)}}return N1=l,N1}var R1,cT;function x4(){if(cT)return R1;cT=1;function n(e){return function(t){return t==null?void 0:t[e]}}return R1=n,R1}var k1,lT;function unt(){if(lT)return k1;lT=1;var n=Kg();function e(t){return function(r){return n(r,t)}}return k1=e,k1}var D1,uT;function hnt(){if(uT)return D1;uT=1;var n=x4(),e=unt(),t=jS(),r=Sh();function i(a){return t(a)?n(r(a)):e(a)}return D1=i,D1}var L1,hT;function ea(){if(hT)return L1;hT=1;var n=nnt(),e=lnt(),t=zs(),r=He(),i=hnt();function a(s){return typeof s=="function"?s:s==null?t:typeof s=="object"?r(s)?e(s[0],s[1]):n(s):i(s)}return L1=a,L1}var I1,fT;function w4(){if(fT)return I1;fT=1;var n=Q5(),e=Het(),t=ea(),r=He();function i(a,s){var o=r(a)?n:e;return o(a,t(s,3))}return I1=i,I1}var B1,dT;function fnt(){if(dT)return B1;dT=1;var n=Object.prototype,e=n.hasOwnProperty;function t(r,i){return r!=null&&e.call(r,i)}return B1=t,B1}var F1,pT;function S4(){if(pT)return F1;pT=1;var n=fnt(),e=b4();function t(r,i){return r!=null&&e(r,i,n)}return F1=t,F1}var $1,gT;function dnt(){if(gT)return $1;gT=1;var n=kS(),e=yc(),t=xh(),r=He(),i=ta(),a=mc(),s=Vg(),o=wh(),c="[object Map]",l="[object Set]",u=Object.prototype,h=u.hasOwnProperty;function f(d){if(d==null)return!0;if(i(d)&&(r(d)||typeof d=="string"||typeof d.splice=="function"||a(d)||o(d)||t(d)))return!d.length;var p=e(d);if(p==c||p==l)return!d.size;if(s(d))return!n(d).length;for(var g in d)if(h.call(d,g))return!1;return!0}return $1=f,$1}var z1,vT;function _4(){if(vT)return z1;vT=1;function n(e){return e===void 0}return z1=n,z1}var j1,mT;function O4(){if(mT)return j1;mT=1;var n=Hg(),e=ta();function t(r,i){var a=-1,s=e(r)?Array(r.length):[];return n(r,function(o,c,l){s[++a]=i(o,c,l)}),s}return j1=t,j1}var q1,yT;function P4(){if(yT)return q1;yT=1;var n=Ug(),e=ea(),t=O4(),r=He();function i(a,s){var o=r(a)?n:t;return o(a,e(s,3))}return q1=i,q1}var G1,bT;function pnt(){if(bT)return G1;bT=1;function n(e,t,r,i){var a=-1,s=e==null?0:e.length;for(i&&s&&(r=e[++a]);++a<s;)r=t(r,e[a],a,e);return r}return G1=n,G1}var V1,ET;function gnt(){if(ET)return V1;ET=1;function n(e,t,r,i,a){return a(e,function(s,o,c){r=i?(i=!1,s):t(r,s,o,c)}),r}return V1=n,V1}var W1,xT;function C4(){if(xT)return W1;xT=1;var n=pnt(),e=Hg(),t=ea(),r=gnt(),i=He();function a(s,o,c){var l=i(s)?n:r,u=arguments.length<3;return l(s,t(o,4),c,u,e)}return W1=a,W1}var H1,wT;function vnt(){if(wT)return H1;wT=1;var n=Bs(),e=He(),t=wi(),r="[object String]";function i(a){return typeof a=="string"||!e(a)&&t(a)&&n(a)==r}return H1=i,H1}var U1,ST;function mnt(){if(ST)return U1;ST=1;var n=x4(),e=n("length");return U1=e,U1}var Y1,_T;function ynt(){if(_T)return Y1;_T=1;var n="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=e+t+r,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+n+i+a+"]");function c(l){return o.test(l)}return Y1=c,Y1}var K1,OT;function bnt(){if(OT)return K1;OT=1;var n="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=e+t+r,a="\\ufe0e\\ufe0f",s="["+n+"]",o="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",l="(?:"+o+"|"+c+")",u="[^"+n+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",d="\\u200d",p=l+"?",g="["+a+"]?",v="(?:"+d+"(?:"+[u,h,f].join("|")+")"+g+p+")*",m=g+p+v,y="(?:"+[u+o+"?",o,h,f,s].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+m,"g");function w(x){for(var S=b.lastIndex=0;b.test(x);)++S;return S}return K1=w,K1}var X1,PT;function Ent(){if(PT)return X1;PT=1;var n=mnt(),e=ynt(),t=bnt();function r(i){return e(i)?t(i):n(i)}return X1=r,X1}var Z1,CT;function xnt(){if(CT)return Z1;CT=1;var n=kS(),e=yc(),t=ta(),r=vnt(),i=Ent(),a="[object Map]",s="[object Set]";function o(c){if(c==null)return 0;if(t(c))return r(c)?i(c):c.length;var l=e(c);return l==a||l==s?c.size:n(c).length}return Z1=o,Z1}var Q1,MT;function wnt(){if(MT)return Q1;MT=1;var n=AS(),e=s4(),t=$S(),r=ea(),i=Wg(),a=He(),s=mc(),o=bh(),c=Nr(),l=wh();function u(h,f,d){var p=a(h),g=p||s(h)||l(h);if(f=r(f,4),d==null){var v=h&&h.constructor;g?d=p?new v:[]:c(h)?d=o(v)?e(i(h)):{}:d={}}return(g?n:t)(h,function(m,y,b){return f(d,m,y,b)}),d}return Q1=u,Q1}var J1,TT;function Snt(){if(TT)return J1;TT=1;var n=vc(),e=xh(),t=He(),r=n?n.isConcatSpreadable:void 0;function i(a){return t(a)||e(a)||!!(r&&a&&a[r])}return J1=i,J1}var tb,AT;function qS(){if(AT)return tb;AT=1;var n=LS(),e=Snt();function t(r,i,a,s,o){var c=-1,l=r.length;for(a||(a=e),o||(o=[]);++c<l;){var u=r[c];i>0&&a(u)?i>1?t(u,i-1,a,s,o):n(o,u):s||(o[o.length]=u)}return o}return tb=t,tb}var eb,NT;function _nt(){if(NT)return eb;NT=1;function n(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}return eb=n,eb}var nb,RT;function M4(){if(RT)return nb;RT=1;var n=_nt(),e=Math.max;function t(r,i,a){return i=e(i===void 0?r.length-1:i,0),function(){for(var s=arguments,o=-1,c=e(s.length-i,0),l=Array(c);++o<c;)l[o]=s[i+o];o=-1;for(var u=Array(i+1);++o<i;)u[o]=s[o];return u[i]=a(l),n(r,this,u)}}return nb=t,nb}var rb,kT;function Ont(){if(kT)return rb;kT=1;var n=BS(),e=U5(),t=zs(),r=e?function(i,a){return e(i,"toString",{configurable:!0,enumerable:!1,value:n(a),writable:!0})}:t;return rb=r,rb}var ib,DT;function Pnt(){if(DT)return ib;DT=1;var n=800,e=16,t=Date.now;function r(i){var a=0,s=0;return function(){var o=t(),c=e-(o-s);if(s=o,c>0){if(++a>=n)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return ib=r,ib}var ab,LT;function T4(){if(LT)return ab;LT=1;var n=Ont(),e=Pnt(),t=e(n);return ab=t,ab}var sb,IT;function Xg(){if(IT)return sb;IT=1;var n=zs(),e=M4(),t=T4();function r(i,a){return t(e(i,a,n),i+"")}return sb=r,sb}var ob,BT;function A4(){if(BT)return ob;BT=1;function n(e,t,r,i){for(var a=e.length,s=r+(i?1:-1);i?s--:++s<a;)if(t(e[s],s,e))return s;return-1}return ob=n,ob}var cb,FT;function Cnt(){if(FT)return cb;FT=1;function n(e){return e!==e}return cb=n,cb}var lb,$T;function Mnt(){if($T)return lb;$T=1;function n(e,t,r){for(var i=r-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}return lb=n,lb}var ub,zT;function Tnt(){if(zT)return ub;zT=1;var n=A4(),e=Cnt(),t=Mnt();function r(i,a,s){return a===a?t(i,a,s):n(i,e,s)}return ub=r,ub}var hb,jT;function Ant(){if(jT)return hb;jT=1;var n=Tnt();function e(t,r){var i=t==null?0:t.length;return!!i&&n(t,r,0)>-1}return hb=e,hb}var fb,qT;function Nnt(){if(qT)return fb;qT=1;function n(e,t,r){for(var i=-1,a=e==null?0:e.length;++i<a;)if(r(t,e[i]))return!0;return!1}return fb=n,fb}var db,GT;function Rnt(){if(GT)return db;GT=1;function n(){}return db=n,db}var pb,VT;function knt(){if(VT)return pb;VT=1;var n=r4(),e=Rnt(),t=zS(),r=1/0,i=n&&1/t(new n([,-0]))[1]==r?function(a){return new n(a)}:e;return pb=i,pb}var gb,WT;function Dnt(){if(WT)return gb;WT=1;var n=f4(),e=Ant(),t=Nnt(),r=d4(),i=knt(),a=zS(),s=200;function o(c,l,u){var h=-1,f=e,d=c.length,p=!0,g=[],v=g;if(u)p=!1,f=t;else if(d>=s){var m=l?null:i(c);if(m)return a(m);p=!1,f=r,v=new n}else v=l?[]:g;t:for(;++h<d;){var y=c[h],b=l?l(y):y;if(y=u||y!==0?y:0,p&&b===b){for(var w=v.length;w--;)if(v[w]===b)continue t;l&&v.push(b),g.push(y)}else f(v,b,u)||(v!==g&&v.push(b),g.push(y))}return g}return gb=o,gb}var vb,HT;function N4(){if(HT)return vb;HT=1;var n=ta(),e=wi();function t(r){return e(r)&&n(r)}return vb=t,vb}var mb,UT;function Lnt(){if(UT)return mb;UT=1;var n=qS(),e=Xg(),t=Dnt(),r=N4(),i=e(function(a){return t(n(a,1,r,!0))});return mb=i,mb}var yb,YT;function Int(){if(YT)return yb;YT=1;var n=Ug();function e(t,r){return n(r,function(i){return t[i]})}return yb=e,yb}var bb,KT;function R4(){if(KT)return bb;KT=1;var n=Int(),e=Va();function t(r){return r==null?[]:n(r,e(r))}return bb=t,bb}var Eb,XT;function Rr(){if(XT)return Eb;XT=1;var n;if(typeof CS=="function")try{n={clone:Get(),constant:BS(),each:h4(),filter:w4(),has:S4(),isArray:He(),isEmpty:dnt(),isFunction:bh(),isUndefined:_4(),keys:Va(),map:P4(),reduce:C4(),size:xnt(),transform:wnt(),union:Lnt(),values:R4()}}catch{}return n||(n=window._),Eb=n,Eb}var xb,ZT;function GS(){if(ZT)return xb;ZT=1;var n=Rr();xb=i;var e="\0",t="\0",r="";function i(u){this._isDirected=n.has(u,"directed")?u.directed:!0,this._isMultigraph=n.has(u,"multigraph")?u.multigraph:!1,this._isCompound=n.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=n.constant(void 0),this._defaultEdgeLabelFn=n.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[t]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return n.isFunction(u)||(u=n.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return n.keys(this._nodes)},i.prototype.sources=function(){var u=this;return n.filter(this.nodes(),function(h){return n.isEmpty(u._in[h])})},i.prototype.sinks=function(){var u=this;return n.filter(this.nodes(),function(h){return n.isEmpty(u._out[h])})},i.prototype.setNodes=function(u,h){var f=arguments,d=this;return n.each(u,function(p){f.length>1?d.setNode(p,h):d.setNode(p)}),this},i.prototype.setNode=function(u,h){return n.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=h),this):(this._nodes[u]=arguments.length>1?h:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=t,this._children[u]={},this._children[t][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return n.has(this._nodes,u)},i.prototype.removeNode=function(u){var h=this;if(n.has(this._nodes,u)){var f=function(d){h.removeEdge(h._edgeObjs[d])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],n.each(this.children(u),function(d){h.setParent(d)}),delete this._children[u]),n.each(n.keys(this._in[u]),f),delete this._in[u],delete this._preds[u],n.each(n.keys(this._out[u]),f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,h){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n.isUndefined(h))h=t;else{h+="";for(var f=h;!n.isUndefined(f);f=this.parent(f))if(f===u)throw new Error("Setting "+h+" as parent of "+u+" would create a cycle");this.setNode(h)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=h,this._children[h][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var h=this._parent[u];if(h!==t)return h}},i.prototype.children=function(u){if(n.isUndefined(u)&&(u=t),this._isCompound){var h=this._children[u];if(h)return n.keys(h)}else{if(u===t)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var h=this._preds[u];if(h)return n.keys(h)},i.prototype.successors=function(u){var h=this._sucs[u];if(h)return n.keys(h)},i.prototype.neighbors=function(u){var h=this.predecessors(u);if(h)return n.union(h,this.successors(u))},i.prototype.isLeaf=function(u){var h;return this.isDirected()?h=this.successors(u):h=this.neighbors(u),h.length===0},i.prototype.filterNodes=function(u){var h=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});h.setGraph(this.graph());var f=this;n.each(this._nodes,function(g,v){u(v)&&h.setNode(v,g)}),n.each(this._edgeObjs,function(g){h.hasNode(g.v)&&h.hasNode(g.w)&&h.setEdge(g,f.edge(g))});var d={};function p(g){var v=f.parent(g);return v===void 0||h.hasNode(v)?(d[g]=v,v):v in d?d[v]:p(v)}return this._isCompound&&n.each(h.nodes(),function(g){h.setParent(g,p(g))}),h},i.prototype.setDefaultEdgeLabel=function(u){return n.isFunction(u)||(u=n.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return n.values(this._edgeObjs)},i.prototype.setPath=function(u,h){var f=this,d=arguments;return n.reduce(u,function(p,g){return d.length>1?f.setEdge(p,g,h):f.setEdge(p,g),g}),this},i.prototype.setEdge=function(){var u,h,f,d,p=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,h=g.w,f=g.name,arguments.length===2&&(d=arguments[1],p=!0)):(u=g,h=arguments[1],f=arguments[3],arguments.length>2&&(d=arguments[2],p=!0)),u=""+u,h=""+h,n.isUndefined(f)||(f=""+f);var v=o(this._isDirected,u,h,f);if(n.has(this._edgeLabels,v))return p&&(this._edgeLabels[v]=d),this;if(!n.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(h),this._edgeLabels[v]=p?d:this._defaultEdgeLabelFn(u,h,f);var m=c(this._isDirected,u,h,f);return u=m.v,h=m.w,Object.freeze(m),this._edgeObjs[v]=m,a(this._preds[h],u),a(this._sucs[u],h),this._in[h][v]=m,this._out[u][v]=m,this._edgeCount++,this},i.prototype.edge=function(u,h,f){var d=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,h,f);return this._edgeLabels[d]},i.prototype.hasEdge=function(u,h,f){var d=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,h,f);return n.has(this._edgeLabels,d)},i.prototype.removeEdge=function(u,h,f){var d=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,u,h,f),p=this._edgeObjs[d];return p&&(u=p.v,h=p.w,delete this._edgeLabels[d],delete this._edgeObjs[d],s(this._preds[h],u),s(this._sucs[u],h),delete this._in[h][d],delete this._out[u][d],this._edgeCount--),this},i.prototype.inEdges=function(u,h){var f=this._in[u];if(f){var d=n.values(f);return h?n.filter(d,function(p){return p.v===h}):d}},i.prototype.outEdges=function(u,h){var f=this._out[u];if(f){var d=n.values(f);return h?n.filter(d,function(p){return p.w===h}):d}},i.prototype.nodeEdges=function(u,h){var f=this.inEdges(u,h);if(f)return f.concat(this.outEdges(u,h))};function a(u,h){u[h]?u[h]++:u[h]=1}function s(u,h){--u[h]||delete u[h]}function o(u,h,f,d){var p=""+h,g=""+f;if(!u&&p>g){var v=p;p=g,g=v}return p+r+g+r+(n.isUndefined(d)?e:d)}function c(u,h,f,d){var p=""+h,g=""+f;if(!u&&p>g){var v=p;p=g,g=v}var m={v:p,w:g};return d&&(m.name=d),m}function l(u,h){return o(u,h.v,h.w,h.name)}return xb}var wb,QT;function Bnt(){return QT||(QT=1,wb="2.1.8"),wb}var Sb,JT;function Fnt(){return JT||(JT=1,Sb={Graph:GS(),version:Bnt()}),Sb}var _b,tA;function $nt(){if(tA)return _b;tA=1;var n=Rr(),e=GS();_b={write:t,read:a};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:r(s),edges:i(s)};return n.isUndefined(s.graph())||(o.value=n.clone(s.graph())),o}function r(s){return n.map(s.nodes(),function(o){var c=s.node(o),l=s.parent(o),u={v:o};return n.isUndefined(c)||(u.value=c),n.isUndefined(l)||(u.parent=l),u})}function i(s){return n.map(s.edges(),function(o){var c=s.edge(o),l={v:o.v,w:o.w};return n.isUndefined(o.name)||(l.name=o.name),n.isUndefined(c)||(l.value=c),l})}function a(s){var o=new e(s.options).setGraph(s.value);return n.each(s.nodes,function(c){o.setNode(c.v,c.value),c.parent&&o.setParent(c.v,c.parent)}),n.each(s.edges,function(c){o.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),o}return _b}var Ob,eA;function znt(){if(eA)return Ob;eA=1;var n=Rr();Ob=e;function e(t){var r={},i=[],a;function s(o){n.has(r,o)||(r[o]=!0,a.push(o),n.each(t.successors(o),s),n.each(t.predecessors(o),s))}return n.each(t.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return Ob}var Pb,nA;function k4(){if(nA)return Pb;nA=1;var n=Rr();Pb=e;function e(){this._arr=[],this._keyIndices={}}return e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map(function(t){return t.key})},e.prototype.has=function(t){return n.has(this._keyIndices,t)},e.prototype.priority=function(t){var r=this._keyIndices[t];if(r!==void 0)return this._arr[r].priority},e.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(t,r){var i=this._keyIndices;if(t=String(t),!n.has(i,t)){var a=this._arr,s=a.length;return i[t]=s,a.push({key:t,priority:r}),this._decrease(s),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,r){var i=this._keyIndices[t];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},e.prototype._heapify=function(t){var r=this._arr,i=2*t,a=i+1,s=t;i<r.length&&(s=r[i].priority<r[s].priority?i:s,a<r.length&&(s=r[a].priority<r[s].priority?a:s),s!==t&&(this._swap(t,s),this._heapify(s)))},e.prototype._decrease=function(t){for(var r=this._arr,i=r[t].priority,a;t!==0&&(a=t>>1,!(r[a].priority<i));)this._swap(t,a),t=a},e.prototype._swap=function(t,r){var i=this._arr,a=this._keyIndices,s=i[t],o=i[r];i[t]=o,i[r]=s,a[o.key]=t,a[s.key]=r},Pb}var Cb,rA;function D4(){if(rA)return Cb;rA=1;var n=Rr(),e=k4();Cb=r;var t=n.constant(1);function r(a,s,o,c){return i(a,String(s),o||t,c||function(l){return a.outEdges(l)})}function i(a,s,o,c){var l={},u=new e,h,f,d=function(p){var g=p.v!==h?p.v:p.w,v=l[g],m=o(p),y=f.distance+m;if(m<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+p+" Weight: "+m);y<v.distance&&(v.distance=y,v.predecessor=h,u.decrease(g,y))};for(a.nodes().forEach(function(p){var g=p===s?0:Number.POSITIVE_INFINITY;l[p]={distance:g},u.add(p,g)});u.size()>0&&(h=u.removeMin(),f=l[h],f.distance!==Number.POSITIVE_INFINITY);)c(h).forEach(d);return l}return Cb}var Mb,iA;function jnt(){if(iA)return Mb;iA=1;var n=D4(),e=Rr();Mb=t;function t(r,i,a){return e.transform(r.nodes(),function(s,o){s[o]=n(r,o,i,a)},{})}return Mb}var Tb,aA;function L4(){if(aA)return Tb;aA=1;var n=Rr();Tb=e;function e(t){var r=0,i=[],a={},s=[];function o(c){var l=a[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),t.successors(c).forEach(function(f){n.has(a,f)?a[f].onStack&&(l.lowlink=Math.min(l.lowlink,a[f].index)):(o(f),l.lowlink=Math.min(l.lowlink,a[f].lowlink))}),l.lowlink===l.index){var u=[],h;do h=i.pop(),a[h].onStack=!1,u.push(h);while(c!==h);s.push(u)}}return t.nodes().forEach(function(c){n.has(a,c)||o(c)}),s}return Tb}var Ab,sA;function qnt(){if(sA)return Ab;sA=1;var n=Rr(),e=L4();Ab=t;function t(r){return n.filter(e(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return Ab}var Nb,oA;function Gnt(){if(oA)return Nb;oA=1;var n=Rr();Nb=t;var e=n.constant(1);function t(i,a,s){return r(i,a||e,s||function(o){return i.outEdges(o)})}function r(i,a,s){var o={},c=i.nodes();return c.forEach(function(l){o[l]={},o[l][l]={distance:0},c.forEach(function(u){l!==u&&(o[l][u]={distance:Number.POSITIVE_INFINITY})}),s(l).forEach(function(u){var h=u.v===l?u.w:u.v,f=a(u);o[l][h]={distance:f,predecessor:l}})}),c.forEach(function(l){var u=o[l];c.forEach(function(h){var f=o[h];c.forEach(function(d){var p=f[l],g=u[d],v=f[d],m=p.distance+g.distance;m<v.distance&&(v.distance=m,v.predecessor=g.predecessor)})})}),o}return Nb}var Rb,cA;function I4(){if(cA)return Rb;cA=1;var n=Rr();Rb=e,e.CycleException=t;function e(r){var i={},a={},s=[];function o(c){if(n.has(a,c))throw new t;n.has(i,c)||(a[c]=!0,i[c]=!0,n.each(r.predecessors(c),o),delete a[c],s.push(c))}if(n.each(r.sinks(),o),n.size(i)!==r.nodeCount())throw new t;return s}function t(){}return t.prototype=new Error,Rb}var kb,lA;function Vnt(){if(lA)return kb;lA=1;var n=I4();kb=e;function e(t){try{n(t)}catch(r){if(r instanceof n.CycleException)return!1;throw r}return!0}return kb}var Db,uA;function B4(){if(uA)return Db;uA=1;var n=Rr();Db=e;function e(r,i,a){n.isArray(i)||(i=[i]);var s=(r.isDirected()?r.successors:r.neighbors).bind(r),o=[],c={};return n.each(i,function(l){if(!r.hasNode(l))throw new Error("Graph does not have node: "+l);t(r,l,a==="post",c,s,o)}),o}function t(r,i,a,s,o,c){n.has(s,i)||(s[i]=!0,a||c.push(i),n.each(o(i),function(l){t(r,l,a,s,o,c)}),a&&c.push(i))}return Db}var Lb,hA;function Wnt(){if(hA)return Lb;hA=1;var n=B4();Lb=e;function e(t,r){return n(t,r,"post")}return Lb}var Ib,fA;function Hnt(){if(fA)return Ib;fA=1;var n=B4();Ib=e;function e(t,r){return n(t,r,"pre")}return Ib}var Bb,dA;function Unt(){if(dA)return Bb;dA=1;var n=Rr(),e=GS(),t=k4();Bb=r;function r(i,a){var s=new e,o={},c=new t,l;function u(f){var d=f.v===l?f.w:f.v,p=c.priority(d);if(p!==void 0){var g=a(f);g<p&&(o[d]=l,c.decrease(d,g))}}if(i.nodeCount()===0)return s;n.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),s.setNode(f)}),c.decrease(i.nodes()[0],0);for(var h=!1;c.size()>0;){if(l=c.removeMin(),n.has(o,l))s.setEdge(l,o[l]);else{if(h)throw new Error("Input graph is not connected: "+i);h=!0}i.nodeEdges(l).forEach(u)}return s}return Bb}var Fb,pA;function Ynt(){return pA||(pA=1,Fb={components:znt(),dijkstra:D4(),dijkstraAll:jnt(),findCycles:qnt(),floydWarshall:Gnt(),isAcyclic:Vnt(),postorder:Wnt(),preorder:Hnt(),prim:Unt(),tarjan:L4(),topsort:I4()}),Fb}var $b,gA;function Knt(){if(gA)return $b;gA=1;var n=Fnt();return $b={Graph:n.Graph,json:$nt(),alg:Ynt(),version:n.version},$b}var ep;if(typeof CS=="function")try{ep=Knt()}catch{}ep||(ep=window.graphlib);var Jr=ep,zb,vA;function Xnt(){if(vA)return zb;vA=1;var n=c4(),e=1,t=4;function r(i){return n(i,e|t)}return zb=r,zb}var jb,mA;function Zg(){if(mA)return jb;mA=1;var n=gc(),e=ta(),t=qg(),r=Nr();function i(a,s,o){if(!r(o))return!1;var c=typeof s;return(c=="number"?e(o)&&t(s,o.length):c=="string"&&s in o)?n(o[s],a):!1}return jb=i,jb}var qb,yA;function Znt(){if(yA)return qb;yA=1;var n=Xg(),e=gc(),t=Zg(),r=$s(),i=Object.prototype,a=i.hasOwnProperty,s=n(function(o,c){o=Object(o);var l=-1,u=c.length,h=u>2?c[2]:void 0;for(h&&t(c[0],c[1],h)&&(u=1);++l<u;)for(var f=c[l],d=r(f),p=-1,g=d.length;++p<g;){var v=d[p],m=o[v];(m===void 0||e(m,i[v])&&!a.call(o,v))&&(o[v]=f[v])}return o});return qb=s,qb}var Gb,bA;function Qnt(){if(bA)return Gb;bA=1;var n=ea(),e=ta(),t=Va();function r(i){return function(a,s,o){var c=Object(a);if(!e(a)){var l=n(s,3);a=t(a),s=function(h){return l(c[h],h,c)}}var u=i(a,s,o);return u>-1?c[l?a[u]:u]:void 0}}return Gb=r,Gb}var Vb,EA;function Jnt(){if(EA)return Vb;EA=1;var n=/\s/;function e(t){for(var r=t.length;r--&&n.test(t.charAt(r)););return r}return Vb=e,Vb}var Wb,xA;function trt(){if(xA)return Wb;xA=1;var n=Jnt(),e=/^\s+/;function t(r){return r&&r.slice(0,n(r)+1).replace(e,"")}return Wb=t,Wb}var Hb,wA;function ert(){if(wA)return Hb;wA=1;var n=trt(),e=Nr(),t=bc(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function c(l){if(typeof l=="number")return l;if(t(l))return r;if(e(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=e(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=n(l);var h=a.test(l);return h||s.test(l)?o(l.slice(2),h?2:8):i.test(l)?r:+l}return Hb=c,Hb}var Ub,SA;function F4(){if(SA)return Ub;SA=1;var n=ert(),e=1/0,t=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=n(i),i===e||i===-e){var a=i<0?-1:1;return a*t}return i===i?i:0}return Ub=r,Ub}var Yb,_A;function nrt(){if(_A)return Yb;_A=1;var n=F4();function e(t){var r=n(t),i=r%1;return r===r?i?r-i:r:0}return Yb=e,Yb}var Kb,OA;function rrt(){if(OA)return Kb;OA=1;var n=A4(),e=ea(),t=nrt(),r=Math.max;function i(a,s,o){var c=a==null?0:a.length;if(!c)return-1;var l=o==null?0:t(o);return l<0&&(l=r(c+l,0)),n(a,e(s,3),l)}return Kb=i,Kb}var Xb,PA;function irt(){if(PA)return Xb;PA=1;var n=Qnt(),e=rrt(),t=n(e);return Xb=t,Xb}var Zb,CA;function $4(){if(CA)return Zb;CA=1;var n=qS();function e(t){var r=t==null?0:t.length;return r?n(t,1):[]}return Zb=e,Zb}var Qb,MA;function art(){if(MA)return Qb;MA=1;var n=FS(),e=l4(),t=$s();function r(i,a){return i==null?i:n(i,e(a),t)}return Qb=r,Qb}var Jb,TA;function srt(){if(TA)return Jb;TA=1;function n(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}return Jb=n,Jb}var tE,AA;function ort(){if(AA)return tE;AA=1;var n=zg(),e=$S(),t=ea();function r(i,a){var s={};return a=t(a,3),e(i,function(o,c,l){n(s,c,a(o,c,l))}),s}return tE=r,tE}var eE,NA;function VS(){if(NA)return eE;NA=1;var n=bc();function e(t,r,i){for(var a=-1,s=t.length;++a<s;){var o=t[a],c=r(o);if(c!=null&&(l===void 0?c===c&&!n(c):i(c,l)))var l=c,u=o}return u}return eE=e,eE}var nE,RA;function crt(){if(RA)return nE;RA=1;function n(e,t){return e>t}return nE=n,nE}var rE,kA;function lrt(){if(kA)return rE;kA=1;var n=VS(),e=crt(),t=zs();function r(i){return i&&i.length?n(i,t,e):void 0}return rE=r,rE}var iE,DA;function z4(){if(DA)return iE;DA=1;var n=zg(),e=gc();function t(r,i,a){(a!==void 0&&!e(r[i],a)||a===void 0&&!(i in r))&&n(r,i,a)}return iE=t,iE}var aE,LA;function urt(){if(LA)return aE;LA=1;var n=Bs(),e=Wg(),t=wi(),r="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,c=s.call(Object);function l(u){if(!t(u)||n(u)!=r)return!1;var h=e(u);if(h===null)return!0;var f=o.call(h,"constructor")&&h.constructor;return typeof f=="function"&&f instanceof f&&s.call(f)==c}return aE=l,aE}var sE,IA;function j4(){if(IA)return sE;IA=1;function n(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}return sE=n,sE}var oE,BA;function hrt(){if(BA)return oE;BA=1;var n=Eh(),e=$s();function t(r){return n(r,e(r))}return oE=t,oE}var cE,FA;function frt(){if(FA)return cE;FA=1;var n=z4(),e=X5(),t=a4(),r=Z5(),i=o4(),a=xh(),s=He(),o=N4(),c=mc(),l=bh(),u=Nr(),h=urt(),f=wh(),d=j4(),p=hrt();function g(v,m,y,b,w,x,S){var _=d(v,y),E=d(m,y),P=S.get(E);if(P){n(v,y,P);return}var O=x?x(_,E,y+"",v,m,S):void 0,C=O===void 0;if(C){var M=s(E),T=!M&&c(E),R=!M&&!T&&f(E);O=E,M||T||R?s(_)?O=_:o(_)?O=r(_):T?(C=!1,O=e(E,!0)):R?(C=!1,O=t(E,!0)):O=[]:h(E)||a(E)?(O=_,a(_)?O=p(_):(!u(_)||l(_))&&(O=i(E))):C=!1}C&&(S.set(E,O),w(O,E,b,x,S),S.delete(E)),n(v,y,O)}return cE=g,cE}var lE,$A;function drt(){if($A)return lE;$A=1;var n=$g(),e=z4(),t=FS(),r=frt(),i=Nr(),a=$s(),s=j4();function o(c,l,u,h,f){c!==l&&t(l,function(d,p){if(f||(f=new n),i(d))r(c,l,p,u,o,h,f);else{var g=h?h(s(c,p),d,p+"",c,l,f):void 0;g===void 0&&(g=d),e(c,p,g)}},a)}return lE=o,lE}var uE,zA;function prt(){if(zA)return uE;zA=1;var n=Xg(),e=Zg();function t(r){return n(function(i,a){var s=-1,o=a.length,c=o>1?a[o-1]:void 0,l=o>2?a[2]:void 0;for(c=r.length>3&&typeof c=="function"?(o--,c):void 0,l&&e(a[0],a[1],l)&&(c=o<3?void 0:c,o=1),i=Object(i);++s<o;){var u=a[s];u&&r(i,u,s,c)}return i})}return uE=t,uE}var hE,jA;function grt(){if(jA)return hE;jA=1;var n=drt(),e=prt(),t=e(function(r,i,a){n(r,i,a)});return hE=t,hE}var fE,qA;function q4(){if(qA)return fE;qA=1;function n(e,t){return e<t}return fE=n,fE}var dE,GA;function vrt(){if(GA)return dE;GA=1;var n=VS(),e=q4(),t=zs();function r(i){return i&&i.length?n(i,t,e):void 0}return dE=r,dE}var pE,VA;function mrt(){if(VA)return pE;VA=1;var n=VS(),e=ea(),t=q4();function r(i,a){return i&&i.length?n(i,e(a,2),t):void 0}return pE=r,pE}var gE,WA;function yrt(){if(WA)return gE;WA=1;var n=Qr(),e=function(){return n.Date.now()};return gE=e,gE}var vE,HA;function brt(){if(HA)return vE;HA=1;var n=jg(),e=Yg(),t=qg(),r=Nr(),i=Sh();function a(s,o,c,l){if(!r(s))return s;o=e(o,s);for(var u=-1,h=o.length,f=h-1,d=s;d!=null&&++u<h;){var p=i(o[u]),g=c;if(p==="__proto__"||p==="constructor"||p==="prototype")return s;if(u!=f){var v=d[p];g=l?l(v,p,d):void 0,g===void 0&&(g=r(v)?v:t(o[u+1])?[]:{})}n(d,p,g),d=d[p]}return s}return vE=a,vE}var mE,UA;function Ert(){if(UA)return mE;UA=1;var n=Kg(),e=brt(),t=Yg();function r(i,a,s){for(var o=-1,c=a.length,l={};++o<c;){var u=a[o],h=n(i,u);s(h,u)&&e(l,t(u,i),h)}return l}return mE=r,mE}var yE,YA;function xrt(){if(YA)return yE;YA=1;var n=Ert(),e=E4();function t(r,i){return n(r,i,function(a,s){return e(r,s)})}return yE=t,yE}var bE,KA;function wrt(){if(KA)return bE;KA=1;var n=$4(),e=M4(),t=T4();function r(i){return t(e(i,void 0,n),i+"")}return bE=r,bE}var EE,XA;function Srt(){if(XA)return EE;XA=1;var n=xrt(),e=wrt(),t=e(function(r,i){return r==null?{}:n(r,i)});return EE=t,EE}var xE,ZA;function _rt(){if(ZA)return xE;ZA=1;var n=Math.ceil,e=Math.max;function t(r,i,a,s){for(var o=-1,c=e(n((i-r)/(a||1)),0),l=Array(c);c--;)l[s?c:++o]=r,r+=a;return l}return xE=t,xE}var wE,QA;function Ort(){if(QA)return wE;QA=1;var n=_rt(),e=Zg(),t=F4();function r(i){return function(a,s,o){return o&&typeof o!="number"&&e(a,s,o)&&(s=o=void 0),a=t(a),s===void 0?(s=a,a=0):s=t(s),o=o===void 0?a<s?1:-1:t(o),n(a,s,o,i)}}return wE=r,wE}var SE,JA;function Prt(){if(JA)return SE;JA=1;var n=Ort(),e=n();return SE=e,SE}var _E,tN;function Crt(){if(tN)return _E;tN=1;function n(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}return _E=n,_E}var OE,eN;function Mrt(){if(eN)return OE;eN=1;var n=bc();function e(t,r){if(t!==r){var i=t!==void 0,a=t===null,s=t===t,o=n(t),c=r!==void 0,l=r===null,u=r===r,h=n(r);if(!l&&!h&&!o&&t>r||o&&c&&u&&!l&&!h||a&&c&&u||!i&&u||!s)return 1;if(!a&&!o&&!h&&t<r||h&&i&&s&&!a&&!o||l&&i&&s||!c&&s||!u)return-1}return 0}return OE=e,OE}var PE,nN;function Trt(){if(nN)return PE;nN=1;var n=Mrt();function e(t,r,i){for(var a=-1,s=t.criteria,o=r.criteria,c=s.length,l=i.length;++a<c;){var u=n(s[a],o[a]);if(u){if(a>=l)return u;var h=i[a];return u*(h=="desc"?-1:1)}}return t.index-r.index}return PE=e,PE}var CE,rN;function Art(){if(rN)return CE;rN=1;var n=Ug(),e=Kg(),t=ea(),r=O4(),i=Crt(),a=Gg(),s=Trt(),o=zs(),c=He();function l(u,h,f){h.length?h=n(h,function(g){return c(g)?function(v){return e(v,g.length===1?g[0]:g)}:g}):h=[o];var d=-1;h=n(h,a(t));var p=r(u,function(g,v,m){var y=n(h,function(b){return b(g)});return{criteria:y,index:++d,value:g}});return i(p,function(g,v){return s(g,v,f)})}return CE=l,CE}var ME,iN;function Nrt(){if(iN)return ME;iN=1;var n=qS(),e=Art(),t=Xg(),r=Zg(),i=t(function(a,s){if(a==null)return[];var o=s.length;return o>1&&r(a,s[0],s[1])?s=[]:o>2&&r(s[0],s[1],s[2])&&(s=[s[0]]),e(a,n(s,1),[])});return ME=i,ME}var TE,aN;function Rrt(){if(aN)return TE;aN=1;var n=y4(),e=0;function t(r){var i=++e;return n(r)+i}return TE=t,TE}var AE,sN;function krt(){if(sN)return AE;sN=1;function n(e,t,r){for(var i=-1,a=e.length,s=t.length,o={};++i<a;){var c=i<s?t[i]:void 0;r(o,e[i],c)}return o}return AE=n,AE}var NE,oN;function Drt(){if(oN)return NE;oN=1;var n=jg(),e=krt();function t(r,i){return e(r||[],i||[],n)}return NE=t,NE}var np;if(typeof CS=="function")try{np={cloneDeep:Xnt(),constant:BS(),defaults:Znt(),each:h4(),filter:w4(),find:irt(),flatten:$4(),forEach:u4(),forIn:art(),has:S4(),isUndefined:_4(),last:srt(),map:P4(),mapValues:ort(),max:lrt(),merge:grt(),min:vrt(),minBy:mrt(),now:yrt(),pick:Srt(),range:Prt(),reduce:C4(),sortBy:Nrt(),uniqueId:Rrt(),values:R4(),zipObject:Drt()}}catch{}np||(np=window._);var Me=np,Lrt=Qg;function Qg(){var n={};n._next=n._prev=n,this._sentinel=n}Qg.prototype.dequeue=function(){var n=this._sentinel,e=n._prev;if(e!==n)return G4(e),e};Qg.prototype.enqueue=function(n){var e=this._sentinel;n._prev&&n._next&&G4(n),n._next=e._next,e._next._prev=n,e._next=n,n._prev=e};Qg.prototype.toString=function(){for(var n=[],e=this._sentinel,t=e._prev;t!==e;)n.push(JSON.stringify(t,Irt)),t=t._prev;return"["+n.join(", ")+"]"};function G4(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function Irt(n,e){if(n!=="_next"&&n!=="_prev")return e}var $i=Me,Brt=Jr.Graph,Frt=Lrt,$rt=jrt,zrt=$i.constant(1);function jrt(n,e){if(n.nodeCount()<=1)return[];var t=Grt(n,e||zrt),r=qrt(t.graph,t.buckets,t.zeroIdx);return $i.flatten($i.map(r,function(i){return n.outEdges(i.v,i.w)}),!0)}function qrt(n,e,t){for(var r=[],i=e[e.length-1],a=e[0],s;n.nodeCount();){for(;s=a.dequeue();)RE(n,e,t,s);for(;s=i.dequeue();)RE(n,e,t,s);if(n.nodeCount()){for(var o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){r=r.concat(RE(n,e,t,s,!0));break}}}return r}function RE(n,e,t,r,i){var a=i?[]:void 0;return $i.forEach(n.inEdges(r.v),function(s){var o=n.edge(s),c=n.node(s.v);i&&a.push({v:s.v,w:s.w}),c.out-=o,Rw(e,t,c)}),$i.forEach(n.outEdges(r.v),function(s){var o=n.edge(s),c=s.w,l=n.node(c);l.in-=o,Rw(e,t,l)}),n.removeNode(r.v),a}function Grt(n,e){var t=new Brt,r=0,i=0;$i.forEach(n.nodes(),function(o){t.setNode(o,{v:o,in:0,out:0})}),$i.forEach(n.edges(),function(o){var c=t.edge(o.v,o.w)||0,l=e(o),u=c+l;t.setEdge(o.v,o.w,u),i=Math.max(i,t.node(o.v).out+=l),r=Math.max(r,t.node(o.w).in+=l)});var a=$i.range(i+r+3).map(function(){return new Frt}),s=r+1;return $i.forEach(t.nodes(),function(o){Rw(a,s,t.node(o))}),{graph:t,buckets:a,zeroIdx:s}}function Rw(n,e,t){t.out?t.in?n[t.out-t.in+e].enqueue(t):n[n.length-1].enqueue(t):n[0].enqueue(t)}var us=Me,Vrt=$rt,Wrt={run:Hrt,undo:Yrt};function Hrt(n){var e=n.graph().acyclicer==="greedy"?Vrt(n,t(n)):Urt(n);us.forEach(e,function(r){var i=n.edge(r);n.removeEdge(r),i.forwardName=r.name,i.reversed=!0,n.setEdge(r.w,r.v,i,us.uniqueId("rev"))});function t(r){return function(i){return r.edge(i).weight}}}function Urt(n){var e=[],t={},r={};function i(a){us.has(r,a)||(r[a]=!0,t[a]=!0,us.forEach(n.outEdges(a),function(s){us.has(t,s.w)?e.push(s):i(s.w)}),delete t[a])}return us.forEach(n.nodes(),i),e}function Yrt(n){us.forEach(n.edges(),function(e){var t=n.edge(e);if(t.reversed){n.removeEdge(e);var r=t.forwardName;delete t.reversed,delete t.forwardName,n.setEdge(e.w,e.v,t,r)}})}var Zt=Me,V4=Jr.Graph,Wn={addDummyNode:W4,simplify:Krt,asNonCompoundGraph:Xrt,successorWeights:Zrt,predecessorWeights:Qrt,intersectRect:Jrt,buildLayerMatrix:tit,normalizeRanks:eit,removeEmptyRanks:nit,addBorderNode:rit,maxRank:H4,partition:iit,time:ait,notime:sit};function W4(n,e,t,r){var i;do i=Zt.uniqueId(r);while(n.hasNode(i));return t.dummy=e,n.setNode(i,t),i}function Krt(n){var e=new V4().setGraph(n.graph());return Zt.forEach(n.nodes(),function(t){e.setNode(t,n.node(t))}),Zt.forEach(n.edges(),function(t){var r=e.edge(t.v,t.w)||{weight:0,minlen:1},i=n.edge(t);e.setEdge(t.v,t.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),e}function Xrt(n){var e=new V4({multigraph:n.isMultigraph()}).setGraph(n.graph());return Zt.forEach(n.nodes(),function(t){n.children(t).length||e.setNode(t,n.node(t))}),Zt.forEach(n.edges(),function(t){e.setEdge(t,n.edge(t))}),e}function Zrt(n){var e=Zt.map(n.nodes(),function(t){var r={};return Zt.forEach(n.outEdges(t),function(i){r[i.w]=(r[i.w]||0)+n.edge(i).weight}),r});return Zt.zipObject(n.nodes(),e)}function Qrt(n){var e=Zt.map(n.nodes(),function(t){var r={};return Zt.forEach(n.inEdges(t),function(i){r[i.v]=(r[i.v]||0)+n.edge(i).weight}),r});return Zt.zipObject(n.nodes(),e)}function Jrt(n,e){var t=n.x,r=n.y,i=e.x-t,a=e.y-r,s=n.width/2,o=n.height/2;if(!i&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var c,l;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),c=o*i/a,l=o):(i<0&&(s=-s),c=s,l=s*a/i),{x:t+c,y:r+l}}function tit(n){var e=Zt.map(Zt.range(H4(n)+1),function(){return[]});return Zt.forEach(n.nodes(),function(t){var r=n.node(t),i=r.rank;Zt.isUndefined(i)||(e[i][r.order]=t)}),e}function eit(n){var e=Zt.min(Zt.map(n.nodes(),function(t){return n.node(t).rank}));Zt.forEach(n.nodes(),function(t){var r=n.node(t);Zt.has(r,"rank")&&(r.rank-=e)})}function nit(n){var e=Zt.min(Zt.map(n.nodes(),function(a){return n.node(a).rank})),t=[];Zt.forEach(n.nodes(),function(a){var s=n.node(a).rank-e;t[s]||(t[s]=[]),t[s].push(a)});var r=0,i=n.graph().nodeRankFactor;Zt.forEach(t,function(a,s){Zt.isUndefined(a)&&s%i!==0?--r:r&&Zt.forEach(a,function(o){n.node(o).rank+=r})})}function rit(n,e,t,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=r),W4(n,"border",i,e)}function H4(n){return Zt.max(Zt.map(n.nodes(),function(e){var t=n.node(e).rank;if(!Zt.isUndefined(t))return t}))}function iit(n,e){var t={lhs:[],rhs:[]};return Zt.forEach(n,function(r){e(r)?t.lhs.push(r):t.rhs.push(r)}),t}function ait(n,e){var t=Zt.now();try{return e()}finally{console.log(n+" time: "+(Zt.now()-t)+"ms")}}function sit(n,e){return e()}var U4=Me,oit=Wn,cit={run:lit,undo:hit};function lit(n){n.graph().dummyChains=[],U4.forEach(n.edges(),function(e){uit(n,e)})}function uit(n,e){var t=e.v,r=n.node(t).rank,i=e.w,a=n.node(i).rank,s=e.name,o=n.edge(e),c=o.labelRank;if(a!==r+1){n.removeEdge(e);var l,u,h;for(h=0,++r;r<a;++h,++r)o.points=[],u={width:0,height:0,edgeLabel:o,edgeObj:e,rank:r},l=oit.addDummyNode(n,"edge",u,"_d"),r===c&&(u.width=o.width,u.height=o.height,u.dummy="edge-label",u.labelpos=o.labelpos),n.setEdge(t,l,{weight:o.weight},s),h===0&&n.graph().dummyChains.push(l),t=l;n.setEdge(t,i,{weight:o.weight},s)}}function hit(n){U4.forEach(n.graph().dummyChains,function(e){var t=n.node(e),r=t.edgeLabel,i;for(n.setEdge(t.edgeObj,r);t.dummy;)i=n.successors(e)[0],n.removeNode(e),r.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height),e=i,t=n.node(e)})}var Of=Me,Jg={longestPath:fit,slack:dit};function fit(n){var e={};function t(r){var i=n.node(r);if(Of.has(e,r))return i.rank;e[r]=!0;var a=Of.min(Of.map(n.outEdges(r),function(s){return t(s.w)-n.edge(s).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),i.rank=a}Of.forEach(n.sources(),t)}function dit(n,e){return n.node(e.w).rank-n.node(e.v).rank-n.edge(e).minlen}var rp=Me,pit=Jr.Graph,ip=Jg.slack,Y4=git;function git(n){var e=new pit({directed:!1}),t=n.nodes()[0],r=n.nodeCount();e.setNode(t,{});for(var i,a;vit(e,n)<r;)i=mit(e,n),a=e.hasNode(i.v)?ip(n,i):-ip(n,i),yit(e,n,a);return e}function vit(n,e){function t(r){rp.forEach(e.nodeEdges(r),function(i){var a=i.v,s=r===a?i.w:a;!n.hasNode(s)&&!ip(e,i)&&(n.setNode(s,{}),n.setEdge(r,s,{}),t(s))})}return rp.forEach(n.nodes(),t),n.nodeCount()}function mit(n,e){return rp.minBy(e.edges(),function(t){if(n.hasNode(t.v)!==n.hasNode(t.w))return ip(e,t)})}function yit(n,e,t){rp.forEach(n.nodes(),function(r){e.node(r).rank+=t})}var Ki=Me,bit=Y4,Eit=Jg.slack,xit=Jg.longestPath,wit=Jr.alg.preorder,Sit=Jr.alg.postorder,_it=Wn.simplify,Oit=js;js.initLowLimValues=HS;js.initCutValues=WS;js.calcCutValue=K4;js.leaveEdge=Z4;js.enterEdge=Q4;js.exchangeEdges=J4;function js(n){n=_it(n),xit(n);var e=bit(n);HS(e),WS(e,n);for(var t,r;t=Z4(e);)r=Q4(e,n,t),J4(e,n,t,r)}function WS(n,e){var t=Sit(n,n.nodes());t=t.slice(0,t.length-1),Ki.forEach(t,function(r){Pit(n,e,r)})}function Pit(n,e,t){var r=n.node(t),i=r.parent;n.edge(t,i).cutvalue=K4(n,e,t)}function K4(n,e,t){var r=n.node(t),i=r.parent,a=!0,s=e.edge(t,i),o=0;return s||(a=!1,s=e.edge(i,t)),o=s.weight,Ki.forEach(e.nodeEdges(t),function(c){var l=c.v===t,u=l?c.w:c.v;if(u!==i){var h=l===a,f=e.edge(c).weight;if(o+=h?f:-f,Mit(n,t,u)){var d=n.edge(t,u).cutvalue;o+=h?-d:d}}}),o}function HS(n,e){arguments.length<2&&(e=n.nodes()[0]),X4(n,{},1,e)}function X4(n,e,t,r,i){var a=t,s=n.node(r);return e[r]=!0,Ki.forEach(n.neighbors(r),function(o){Ki.has(e,o)||(t=X4(n,e,t,o,r))}),s.low=a,s.lim=t++,i?s.parent=i:delete s.parent,t}function Z4(n){return Ki.find(n.edges(),function(e){return n.edge(e).cutvalue<0})}function Q4(n,e,t){var r=t.v,i=t.w;e.hasEdge(r,i)||(r=t.w,i=t.v);var a=n.node(r),s=n.node(i),o=a,c=!1;a.lim>s.lim&&(o=s,c=!0);var l=Ki.filter(e.edges(),function(u){return c===cN(n,n.node(u.v),o)&&c!==cN(n,n.node(u.w),o)});return Ki.minBy(l,function(u){return Eit(e,u)})}function J4(n,e,t,r){var i=t.v,a=t.w;n.removeEdge(i,a),n.setEdge(r.v,r.w,{}),HS(n),WS(n,e),Cit(n,e)}function Cit(n,e){var t=Ki.find(n.nodes(),function(i){return!e.node(i).parent}),r=wit(n,t);r=r.slice(1),Ki.forEach(r,function(i){var a=n.node(i).parent,s=e.edge(i,a),o=!1;s||(s=e.edge(a,i),o=!0),e.node(i).rank=e.node(a).rank+(o?s.minlen:-s.minlen)})}function Mit(n,e,t){return n.hasEdge(e,t)}function cN(n,e,t){return t.low<=e.lim&&e.lim<=t.lim}var Tit=Jg,tB=Tit.longestPath,Ait=Y4,Nit=Oit,Rit=kit;function kit(n){switch(n.graph().ranker){case"network-simplex":lN(n);break;case"tight-tree":Lit(n);break;case"longest-path":Dit(n);break;default:lN(n)}}var Dit=tB;function Lit(n){tB(n),Ait(n)}function lN(n){Nit(n)}var kw=Me,Iit=Bit;function Bit(n){var e=$it(n);kw.forEach(n.graph().dummyChains,function(t){for(var r=n.node(t),i=r.edgeObj,a=Fit(n,e,i.v,i.w),s=a.path,o=a.lca,c=0,l=s[c],u=!0;t!==i.w;){if(r=n.node(t),u){for(;(l=s[c])!==o&&n.node(l).maxRank<r.rank;)c++;l===o&&(u=!1)}if(!u){for(;c<s.length-1&&n.node(l=s[c+1]).minRank<=r.rank;)c++;l=s[c]}n.setParent(t,l),t=n.successors(t)[0]}})}function Fit(n,e,t,r){var i=[],a=[],s=Math.min(e[t].low,e[r].low),o=Math.max(e[t].lim,e[r].lim),c,l;c=t;do c=n.parent(c),i.push(c);while(c&&(e[c].low>s||o>e[c].lim));for(l=c,c=r;(c=n.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}function $it(n){var e={},t=0;function r(i){var a=t;kw.forEach(n.children(i),r),e[i]={low:a,lim:t++}}return kw.forEach(n.children(),r),e}var zi=Me,Dw=Wn,zit={run:jit,cleanup:Vit};function jit(n){var e=Dw.addDummyNode(n,"root",{},"_root"),t=qit(n),r=zi.max(zi.values(t))-1,i=2*r+1;n.graph().nestingRoot=e,zi.forEach(n.edges(),function(s){n.edge(s).minlen*=i});var a=Git(n)+1;zi.forEach(n.children(),function(s){eB(n,e,i,a,r,t,s)}),n.graph().nodeRankFactor=i}function eB(n,e,t,r,i,a,s){var o=n.children(s);if(!o.length){s!==e&&n.setEdge(e,s,{weight:0,minlen:t});return}var c=Dw.addBorderNode(n,"_bt"),l=Dw.addBorderNode(n,"_bb"),u=n.node(s);n.setParent(c,s),u.borderTop=c,n.setParent(l,s),u.borderBottom=l,zi.forEach(o,function(h){eB(n,e,t,r,i,a,h);var f=n.node(h),d=f.borderTop?f.borderTop:h,p=f.borderBottom?f.borderBottom:h,g=f.borderTop?r:2*r,v=d!==p?1:i-a[s]+1;n.setEdge(c,d,{weight:g,minlen:v,nestingEdge:!0}),n.setEdge(p,l,{weight:g,minlen:v,nestingEdge:!0})}),n.parent(s)||n.setEdge(e,c,{weight:0,minlen:i+a[s]})}function qit(n){var e={};function t(r,i){var a=n.children(r);a&&a.length&&zi.forEach(a,function(s){t(s,i+1)}),e[r]=i}return zi.forEach(n.children(),function(r){t(r,1)}),e}function Git(n){return zi.reduce(n.edges(),function(e,t){return e+n.edge(t).weight},0)}function Vit(n){var e=n.graph();n.removeNode(e.nestingRoot),delete e.nestingRoot,zi.forEach(n.edges(),function(t){var r=n.edge(t);r.nestingEdge&&n.removeEdge(t)})}var kE=Me,Wit=Wn,Hit=Uit;function Uit(n){function e(t){var r=n.children(t),i=n.node(t);if(r.length&&kE.forEach(r,e),kE.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)uN(n,"borderLeft","_bl",t,i,a),uN(n,"borderRight","_br",t,i,a)}}kE.forEach(n.children(),e)}function uN(n,e,t,r,i,a){var s={width:0,height:0,rank:a,borderType:e},o=i[e][a-1],c=Wit.addDummyNode(n,"border",s,t);i[e][a]=c,n.setParent(c,r),o&&n.setEdge(o,c,{weight:1})}var fi=Me,Yit={adjust:Kit,undo:Xit};function Kit(n){var e=n.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&nB(n)}function Xit(n){var e=n.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&Zit(n),(e==="lr"||e==="rl")&&(Qit(n),nB(n))}function nB(n){fi.forEach(n.nodes(),function(e){hN(n.node(e))}),fi.forEach(n.edges(),function(e){hN(n.edge(e))})}function hN(n){var e=n.width;n.width=n.height,n.height=e}function Zit(n){fi.forEach(n.nodes(),function(e){DE(n.node(e))}),fi.forEach(n.edges(),function(e){var t=n.edge(e);fi.forEach(t.points,DE),fi.has(t,"y")&&DE(t)})}function DE(n){n.y=-n.y}function Qit(n){fi.forEach(n.nodes(),function(e){LE(n.node(e))}),fi.forEach(n.edges(),function(e){var t=n.edge(e);fi.forEach(t.points,LE),fi.has(t,"x")&&LE(t)})}function LE(n){var e=n.x;n.x=n.y,n.y=e}var Ai=Me,Jit=tat;function tat(n){var e={},t=Ai.filter(n.nodes(),function(o){return!n.children(o).length}),r=Ai.max(Ai.map(t,function(o){return n.node(o).rank})),i=Ai.map(Ai.range(r+1),function(){return[]});function a(o){if(!Ai.has(e,o)){e[o]=!0;var c=n.node(o);i[c.rank].push(o),Ai.forEach(n.successors(o),a)}}var s=Ai.sortBy(t,function(o){return n.node(o).rank});return Ai.forEach(s,a),i}var aa=Me,eat=nat;function nat(n,e){for(var t=0,r=1;r<e.length;++r)t+=rat(n,e[r-1],e[r]);return t}function rat(n,e,t){for(var r=aa.zipObject(t,aa.map(t,function(l,u){return u})),i=aa.flatten(aa.map(e,function(l){return aa.sortBy(aa.map(n.outEdges(l),function(u){return{pos:r[u.w],weight:n.edge(u).weight}}),"pos")}),!0),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var o=aa.map(new Array(s),function(){return 0}),c=0;return aa.forEach(i.forEach(function(l){var u=l.pos+a;o[u]+=l.weight;for(var h=0;u>0;)u%2&&(h+=o[u+1]),u=u-1>>1,o[u]+=l.weight;c+=l.weight*h})),c}var fN=Me,iat=aat;function aat(n,e){return fN.map(e,function(t){var r=n.inEdges(t);if(r.length){var i=fN.reduce(r,function(a,s){var o=n.edge(s),c=n.node(s.v);return{sum:a.sum+o.weight*c.order,weight:a.weight+o.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}var Jn=Me,sat=oat;function oat(n,e){var t={};Jn.forEach(n,function(i,a){var s=t[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:a};Jn.isUndefined(i.barycenter)||(s.barycenter=i.barycenter,s.weight=i.weight)}),Jn.forEach(e.edges(),function(i){var a=t[i.v],s=t[i.w];!Jn.isUndefined(a)&&!Jn.isUndefined(s)&&(s.indegree++,a.out.push(t[i.w]))});var r=Jn.filter(t,function(i){return!i.indegree});return cat(r)}function cat(n){var e=[];function t(a){return function(s){s.merged||(Jn.isUndefined(s.barycenter)||Jn.isUndefined(a.barycenter)||s.barycenter>=a.barycenter)&&lat(a,s)}}function r(a){return function(s){s.in.push(a),--s.indegree===0&&n.push(s)}}for(;n.length;){var i=n.pop();e.push(i),Jn.forEach(i.in.reverse(),t(i)),Jn.forEach(i.out,r(i))}return Jn.map(Jn.filter(e,function(a){return!a.merged}),function(a){return Jn.pick(a,["vs","i","barycenter","weight"])})}function lat(n,e){var t=0,r=0;n.weight&&(t+=n.barycenter*n.weight,r+=n.weight),e.weight&&(t+=e.barycenter*e.weight,r+=e.weight),n.vs=e.vs.concat(n.vs),n.barycenter=t/r,n.weight=r,n.i=Math.min(e.i,n.i),e.merged=!0}var bu=Me,uat=Wn,hat=fat;function fat(n,e){var t=uat.partition(n,function(u){return bu.has(u,"barycenter")}),r=t.lhs,i=bu.sortBy(t.rhs,function(u){return-u.i}),a=[],s=0,o=0,c=0;r.sort(dat(!!e)),c=dN(a,i,c),bu.forEach(r,function(u){c+=u.vs.length,a.push(u.vs),s+=u.barycenter*u.weight,o+=u.weight,c=dN(a,i,c)});var l={vs:bu.flatten(a,!0)};return o&&(l.barycenter=s/o,l.weight=o),l}function dN(n,e,t){for(var r;e.length&&(r=bu.last(e)).i<=t;)e.pop(),n.push(r.vs),t++;return t}function dat(n){return function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i}}var pa=Me,pat=iat,gat=sat,vat=hat,mat=rB;function rB(n,e,t,r){var i=n.children(e),a=n.node(e),s=a?a.borderLeft:void 0,o=a?a.borderRight:void 0,c={};s&&(i=pa.filter(i,function(p){return p!==s&&p!==o}));var l=pat(n,i);pa.forEach(l,function(p){if(n.children(p.v).length){var g=rB(n,p.v,t,r);c[p.v]=g,pa.has(g,"barycenter")&&bat(p,g)}});var u=gat(l,t);yat(u,c);var h=vat(u,r);if(s&&(h.vs=pa.flatten([s,h.vs,o],!0),n.predecessors(s).length)){var f=n.node(n.predecessors(s)[0]),d=n.node(n.predecessors(o)[0]);pa.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+f.order+d.order)/(h.weight+2),h.weight+=2}return h}function yat(n,e){pa.forEach(n,function(t){t.vs=pa.flatten(t.vs.map(function(r){return e[r]?e[r].vs:r}),!0)})}function bat(n,e){pa.isUndefined(n.barycenter)?(n.barycenter=e.barycenter,n.weight=e.weight):(n.barycenter=(n.barycenter*n.weight+e.barycenter*e.weight)/(n.weight+e.weight),n.weight+=e.weight)}var Eu=Me,Eat=Jr.Graph,xat=wat;function wat(n,e,t){var r=Sat(n),i=new Eat({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(a){return n.node(a)});return Eu.forEach(n.nodes(),function(a){var s=n.node(a),o=n.parent(a);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(i.setNode(a),i.setParent(a,o||r),Eu.forEach(n[t](a),function(c){var l=c.v===a?c.w:c.v,u=i.edge(l,a),h=Eu.isUndefined(u)?0:u.weight;i.setEdge(l,a,{weight:n.edge(c).weight+h})}),Eu.has(s,"minRank")&&i.setNode(a,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))}),i}function Sat(n){for(var e;n.hasNode(e=Eu.uniqueId("_root")););return e}var _at=Me,Oat=Pat;function Pat(n,e,t){var r={},i;_at.forEach(t,function(a){for(var s=n.parent(a),o,c;s;){if(o=n.parent(s),o?(c=r[o],r[o]=s):(c=i,i=s),c&&c!==s){e.setEdge(c,s);return}s=o}})}var Aa=Me,Cat=Jit,Mat=eat,Tat=mat,Aat=xat,Nat=Oat,Rat=Jr.Graph,pN=Wn,kat=Dat;function Dat(n){var e=pN.maxRank(n),t=gN(n,Aa.range(1,e+1),"inEdges"),r=gN(n,Aa.range(e-1,-1,-1),"outEdges"),i=Cat(n);vN(n,i);for(var a=Number.POSITIVE_INFINITY,s,o=0,c=0;c<4;++o,++c){Lat(o%2?t:r,o%4>=2),i=pN.buildLayerMatrix(n);var l=Mat(n,i);l<a&&(c=0,s=Aa.cloneDeep(i),a=l)}vN(n,s)}function gN(n,e,t){return Aa.map(e,function(r){return Aat(n,r,t)})}function Lat(n,e){var t=new Rat;Aa.forEach(n,function(r){var i=r.graph().root,a=Tat(r,i,t,e);Aa.forEach(a.vs,function(s,o){r.node(s).order=o}),Nat(r,t,a.vs)})}function vN(n,e){Aa.forEach(e,function(t){Aa.forEach(t,function(r,i){n.node(r).order=i})})}var St=Me,Iat=Jr.Graph,Bat=Wn,Fat={positionX:jat,findType1Conflicts:iB,findType2Conflicts:aB,addConflict:US,hasConflict:sB,verticalAlignment:oB,horizontalCompaction:cB,alignCoordinates:uB,findSmallestWidthAlignment:lB,balance:hB};function iB(n,e){var t={};function r(i,a){var s=0,o=0,c=i.length,l=St.last(a);return St.forEach(a,function(u,h){var f=$at(n,u),d=f?n.node(f).order:c;(f||u===l)&&(St.forEach(a.slice(o,h+1),function(p){St.forEach(n.predecessors(p),function(g){var v=n.node(g),m=v.order;(m<s||d<m)&&!(v.dummy&&n.node(p).dummy)&&US(t,g,p)})}),o=h+1,s=d)}),a}return St.reduce(e,r),t}function aB(n,e){var t={};function r(a,s,o,c,l){var u;St.forEach(St.range(s,o),function(h){u=a[h],n.node(u).dummy&&St.forEach(n.predecessors(u),function(f){var d=n.node(f);d.dummy&&(d.order<c||d.order>l)&&US(t,f,u)})})}function i(a,s){var o=-1,c,l=0;return St.forEach(s,function(u,h){if(n.node(u).dummy==="border"){var f=n.predecessors(u);f.length&&(c=n.node(f[0]).order,r(s,l,h,o,c),l=h,o=c)}r(s,l,s.length,c,a.length)}),s}return St.reduce(e,i),t}function $at(n,e){if(n.node(e).dummy)return St.find(n.predecessors(e),function(t){return n.node(t).dummy})}function US(n,e,t){if(e>t){var r=e;e=t,t=r}var i=n[e];i||(n[e]=i={}),i[t]=!0}function sB(n,e,t){if(e>t){var r=e;e=t,t=r}return St.has(n[e],t)}function oB(n,e,t,r){var i={},a={},s={};return St.forEach(e,function(o){St.forEach(o,function(c,l){i[c]=c,a[c]=c,s[c]=l})}),St.forEach(e,function(o){var c=-1;St.forEach(o,function(l){var u=r(l);if(u.length){u=St.sortBy(u,function(g){return s[g]});for(var h=(u.length-1)/2,f=Math.floor(h),d=Math.ceil(h);f<=d;++f){var p=u[f];a[l]===l&&c<s[p]&&!sB(t,l,p)&&(a[p]=l,a[l]=i[l]=i[p],c=s[p])}}})}),{root:i,align:a}}function cB(n,e,t,r,i){var a={},s=zat(n,e,t,i),o=i?"borderLeft":"borderRight";function c(h,f){for(var d=s.nodes(),p=d.pop(),g={};p;)g[p]?h(p):(g[p]=!0,d.push(p),d=d.concat(f(p))),p=d.pop()}function l(h){a[h]=s.inEdges(h).reduce(function(f,d){return Math.max(f,a[d.v]+s.edge(d))},0)}function u(h){var f=s.outEdges(h).reduce(function(p,g){return Math.min(p,a[g.w]-s.edge(g))},Number.POSITIVE_INFINITY),d=n.node(h);f!==Number.POSITIVE_INFINITY&&d.borderType!==o&&(a[h]=Math.max(a[h],f))}return c(l,s.predecessors.bind(s)),c(u,s.successors.bind(s)),St.forEach(r,function(h){a[h]=a[t[h]]}),a}function zat(n,e,t,r){var i=new Iat,a=n.graph(),s=qat(a.nodesep,a.edgesep,r);return St.forEach(e,function(o){var c;St.forEach(o,function(l){var u=t[l];if(i.setNode(u),c){var h=t[c],f=i.edge(h,u);i.setEdge(h,u,Math.max(s(n,l,c),f||0))}c=l})}),i}function lB(n,e){return St.minBy(St.values(e),function(t){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return St.forIn(t,function(a,s){var o=Gat(n,s)/2;r=Math.max(a+o,r),i=Math.min(a-o,i)}),r-i})}function uB(n,e){var t=St.values(e),r=St.min(t),i=St.max(t);St.forEach(["u","d"],function(a){St.forEach(["l","r"],function(s){var o=a+s,c=n[o],l;if(c!==e){var u=St.values(c);l=s==="l"?r-St.min(u):i-St.max(u),l&&(n[o]=St.mapValues(c,function(h){return h+l}))}})})}function hB(n,e){return St.mapValues(n.ul,function(t,r){if(e)return n[e.toLowerCase()][r];var i=St.sortBy(St.map(n,r));return(i[1]+i[2])/2})}function jat(n){var e=Bat.buildLayerMatrix(n),t=St.merge(iB(n,e),aB(n,e)),r={},i;St.forEach(["u","d"],function(s){i=s==="u"?e:St.values(e).reverse(),St.forEach(["l","r"],function(o){o==="r"&&(i=St.map(i,function(h){return St.values(h).reverse()}));var c=(s==="u"?n.predecessors:n.successors).bind(n),l=oB(n,i,t,c),u=cB(n,i,l.root,l.align,o==="r");o==="r"&&(u=St.mapValues(u,function(h){return-h})),r[s+o]=u})});var a=lB(n,r);return uB(r,a),hB(r,n.graph().align)}function qat(n,e,t){return function(r,i,a){var s=r.node(i),o=r.node(a),c=0,l;if(c+=s.width/2,St.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2;break}if(l&&(c+=t?l:-l),l=0,c+=(s.dummy?e:n)/2,c+=(o.dummy?e:n)/2,c+=o.width/2,St.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":l=o.width/2;break;case"r":l=-o.width/2;break}return l&&(c+=t?l:-l),l=0,c}}function Gat(n,e){return n.node(e).width}var xu=Me,fB=Wn,Vat=Fat.positionX,Wat=Hat;function Hat(n){n=fB.asNonCompoundGraph(n),Uat(n),xu.forEach(Vat(n),function(e,t){n.node(t).x=e})}function Uat(n){var e=fB.buildLayerMatrix(n),t=n.graph().ranksep,r=0;xu.forEach(e,function(i){var a=xu.max(xu.map(i,function(s){return n.node(s).height}));xu.forEach(i,function(s){n.node(s).y=r+a/2}),r+=a+t})}var Tt=Me,mN=Wrt,yN=cit,Yat=Rit,Kat=Wn.normalizeRanks,Xat=Iit,Zat=Wn.removeEmptyRanks,bN=zit,Qat=Hit,EN=Yit,Jat=kat,tst=Wat,Fa=Wn,est=Jr.Graph,nst=rst;function rst(n,e){var t=e&&e.debugTiming?Fa.time:Fa.notime;t("layout",function(){var r=t("  buildLayoutGraph",function(){return pst(n)});t("  runLayout",function(){ist(r,t)}),t("  updateInputGraph",function(){ast(n,r)})})}function ist(n,e){e("    makeSpaceForEdgeLabels",function(){gst(n)}),e("    removeSelfEdges",function(){_st(n)}),e("    acyclic",function(){mN.run(n)}),e("    nestingGraph.run",function(){bN.run(n)}),e("    rank",function(){Yat(Fa.asNonCompoundGraph(n))}),e("    injectEdgeLabelProxies",function(){vst(n)}),e("    removeEmptyRanks",function(){Zat(n)}),e("    nestingGraph.cleanup",function(){bN.cleanup(n)}),e("    normalizeRanks",function(){Kat(n)}),e("    assignRankMinMax",function(){mst(n)}),e("    removeEdgeLabelProxies",function(){yst(n)}),e("    normalize.run",function(){yN.run(n)}),e("    parentDummyChains",function(){Xat(n)}),e("    addBorderSegments",function(){Qat(n)}),e("    order",function(){Jat(n)}),e("    insertSelfEdges",function(){Ost(n)}),e("    adjustCoordinateSystem",function(){EN.adjust(n)}),e("    position",function(){tst(n)}),e("    positionSelfEdges",function(){Pst(n)}),e("    removeBorderNodes",function(){Sst(n)}),e("    normalize.undo",function(){yN.undo(n)}),e("    fixupEdgeLabelCoords",function(){xst(n)}),e("    undoCoordinateSystem",function(){EN.undo(n)}),e("    translateGraph",function(){bst(n)}),e("    assignNodeIntersects",function(){Est(n)}),e("    reversePoints",function(){wst(n)}),e("    acyclic.undo",function(){mN.undo(n)})}function ast(n,e){Tt.forEach(n.nodes(),function(t){var r=n.node(t),i=e.node(t);r&&(r.x=i.x,r.y=i.y,e.children(t).length&&(r.width=i.width,r.height=i.height))}),Tt.forEach(n.edges(),function(t){var r=n.edge(t),i=e.edge(t);r.points=i.points,Tt.has(i,"x")&&(r.x=i.x,r.y=i.y)}),n.graph().width=e.graph().width,n.graph().height=e.graph().height}var sst=["nodesep","edgesep","ranksep","marginx","marginy"],ost={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},cst=["acyclicer","ranker","rankdir","align"],lst=["width","height"],ust={width:0,height:0},hst=["minlen","weight","width","height","labeloffset"],fst={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},dst=["labelpos"];function pst(n){var e=new est({multigraph:!0,compound:!0}),t=BE(n.graph());return e.setGraph(Tt.merge({},ost,IE(t,sst),Tt.pick(t,cst))),Tt.forEach(n.nodes(),function(r){var i=BE(n.node(r));e.setNode(r,Tt.defaults(IE(i,lst),ust)),e.setParent(r,n.parent(r))}),Tt.forEach(n.edges(),function(r){var i=BE(n.edge(r));e.setEdge(r,Tt.merge({},fst,IE(i,hst),Tt.pick(i,dst)))}),e}function gst(n){var e=n.graph();e.ranksep/=2,Tt.forEach(n.edges(),function(t){var r=n.edge(t);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function vst(n){Tt.forEach(n.edges(),function(e){var t=n.edge(e);if(t.width&&t.height){var r=n.node(e.v),i=n.node(e.w),a={rank:(i.rank-r.rank)/2+r.rank,e};Fa.addDummyNode(n,"edge-proxy",a,"_ep")}})}function mst(n){var e=0;Tt.forEach(n.nodes(),function(t){var r=n.node(t);r.borderTop&&(r.minRank=n.node(r.borderTop).rank,r.maxRank=n.node(r.borderBottom).rank,e=Tt.max(e,r.maxRank))}),n.graph().maxRank=e}function yst(n){Tt.forEach(n.nodes(),function(e){var t=n.node(e);t.dummy==="edge-proxy"&&(n.edge(t.e).labelRank=t.rank,n.removeNode(e))})}function bst(n){var e=Number.POSITIVE_INFINITY,t=0,r=Number.POSITIVE_INFINITY,i=0,a=n.graph(),s=a.marginx||0,o=a.marginy||0;function c(l){var u=l.x,h=l.y,f=l.width,d=l.height;e=Math.min(e,u-f/2),t=Math.max(t,u+f/2),r=Math.min(r,h-d/2),i=Math.max(i,h+d/2)}Tt.forEach(n.nodes(),function(l){c(n.node(l))}),Tt.forEach(n.edges(),function(l){var u=n.edge(l);Tt.has(u,"x")&&c(u)}),e-=s,r-=o,Tt.forEach(n.nodes(),function(l){var u=n.node(l);u.x-=e,u.y-=r}),Tt.forEach(n.edges(),function(l){var u=n.edge(l);Tt.forEach(u.points,function(h){h.x-=e,h.y-=r}),Tt.has(u,"x")&&(u.x-=e),Tt.has(u,"y")&&(u.y-=r)}),a.width=t-e+s,a.height=i-r+o}function Est(n){Tt.forEach(n.edges(),function(e){var t=n.edge(e),r=n.node(e.v),i=n.node(e.w),a,s;t.points?(a=t.points[0],s=t.points[t.points.length-1]):(t.points=[],a=i,s=r),t.points.unshift(Fa.intersectRect(r,a)),t.points.push(Fa.intersectRect(i,s))})}function xst(n){Tt.forEach(n.edges(),function(e){var t=n.edge(e);if(Tt.has(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function wst(n){Tt.forEach(n.edges(),function(e){var t=n.edge(e);t.reversed&&t.points.reverse()})}function Sst(n){Tt.forEach(n.nodes(),function(e){if(n.children(e).length){var t=n.node(e),r=n.node(t.borderTop),i=n.node(t.borderBottom),a=n.node(Tt.last(t.borderLeft)),s=n.node(Tt.last(t.borderRight));t.width=Math.abs(s.x-a.x),t.height=Math.abs(i.y-r.y),t.x=a.x+t.width/2,t.y=r.y+t.height/2}}),Tt.forEach(n.nodes(),function(e){n.node(e).dummy==="border"&&n.removeNode(e)})}function _st(n){Tt.forEach(n.edges(),function(e){if(e.v===e.w){var t=n.node(e.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e,label:n.edge(e)}),n.removeEdge(e)}})}function Ost(n){var e=Fa.buildLayerMatrix(n);Tt.forEach(e,function(t){var r=0;Tt.forEach(t,function(i,a){var s=n.node(i);s.order=a+r,Tt.forEach(s.selfEdges,function(o){Fa.addDummyNode(n,"selfedge",{width:o.label.width,height:o.label.height,rank:s.rank,order:a+ ++r,e:o.e,label:o.label},"_se")}),delete s.selfEdges})})}function Pst(n){Tt.forEach(n.nodes(),function(e){var t=n.node(e);if(t.dummy==="selfedge"){var r=n.node(t.e.v),i=r.x+r.width/2,a=r.y,s=t.x-i,o=r.height/2;n.setEdge(t.e,t.label),n.removeNode(e),t.label.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{x:i+s,y:a},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],t.label.x=t.x,t.label.y=t.y}})}function IE(n,e){return Tt.mapValues(Tt.pick(n,e),Number)}function BE(n){var e={};return Tt.forEach(n,function(t,r){e[r.toLowerCase()]=t}),e}var Pf=Me,Cst=Wn,Mst=Jr.Graph,Tst={debugOrdering:Ast};function Ast(n){var e=Cst.buildLayerMatrix(n),t=new Mst({compound:!0,multigraph:!0}).setGraph({});return Pf.forEach(n.nodes(),function(r){t.setNode(r,{label:r}),t.setParent(r,"layer"+n.node(r).rank)}),Pf.forEach(n.edges(),function(r){t.setEdge(r.v,r.w,{},r.name)}),Pf.forEach(e,function(r,i){var a="layer"+i;t.setNode(a,{rank:"same"}),Pf.reduce(r,function(s,o){return t.setEdge(s,o,{style:"invis"}),o})}),t}var Nst="0.8.5",dB={graphlib:Jr,layout:nst,debug:Tst,util:{time:Wn.time,notime:Wn.notime},version:Nst};const Rst=ah(dB);function kst(n){if(!n)return[0,0,0];if(rt(n))return[n,n,n];if(n.length===0)return[0,0,0];const[e,t=e,r=e]=n;return[e,t,r]}class Ec{constructor(e){this.id="dagre",this.options={},Object.assign(this.options,Ec.defaultOptions,e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,Object.assign(Object.assign({},this.options),t))})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,Object.assign(Object.assign({},this.options),t))})}genericDagreLayout(e,t,r){return Et(this,void 0,void 0,function*(){const{nodeSize:i}=r,a=new dB.graphlib.Graph;a.setGraph(r),a.setDefaultEdgeLabel(()=>({}));const s=t.getAllNodes(),o=t.getAllEdges();[...s,...o].some(({id:l})=>rt(l))&&console.error("Dagre layout only support string id, it will convert number to string."),t.getAllNodes().forEach(l=>{const{id:u}=l,h=Object.assign({},l.data);if(i!==void 0){const[f,d]=kst(ft(i)?i(l):i);Object.assign(h,{width:f,height:d})}a.setNode(u.toString(),h)}),t.getAllEdges().forEach(({id:l,source:u,target:h})=>{a.setEdge(u.toString(),h.toString(),{id:l})}),Rst.layout(a);const c={nodes:[],edges:[]};return a.nodes().forEach(l=>{const u=a.node(l);c.nodes.push({id:l,data:u}),e&&t.mergeNodeData(l,u)}),a.edges().forEach(l=>{const u=a.edge(l),{id:h}=u,f=ie(u,["id"]),{v:d,w:p}=l;c.edges.push({id:h,source:d,target:p,data:f}),e&&t.mergeEdgeData(h,f)}),c})}}Ec.defaultOptions={};class YS{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,r=this.ry-e.ry;return Math.hypot(t,r)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,r=e.ry-this.ry;let i=Math.hypot(t,r);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=a*t/i,this.fy+=a*r/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,r=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,a=this.degree+e.degree,s={rx:r,ry:i,mass:t,degree:a};return new YS(s)}}class Eo{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const r=this.length/2;return e<=this.xmid+r&&e>=this.xmid-r&&t<=this.ymid+r&&t>=this.ymid-r}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,r=this.length/2,i={xmid:e,ymid:t,length:r};return new Eo(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,r=this.length/2,i={xmid:e,ymid:t,length:r};return new Eo(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,r=this.length/2,i={xmid:e,ymid:t,length:r};return new Eo(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,r=this.length/2,i={xmid:e,ymid:t,length:r};return new Eo(i)}}class xo{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new xo(this.quad.NW()),this.NE=new xo(this.quad.NE()),this.SW=new xo(this.quad.SW()),this.SE=new xo(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,r=this.body.distanceTo(e);t/r<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}const Dst={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class KS{constructor(e={}){this.options=e,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},Dst),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,e,t)})}genericForceAtlas2Layout(e,t,r){return Et(this,void 0,void 0,function*(){const i=t.getAllEdges(),a=t.getAllNodes(),s=this.formatOptions(r,a.length),{width:o,height:c,prune:l,maxIteration:u,nodeSize:h,center:f}=s;if(!(a!=null&&a.length)||a.length===1)return Is(t,e,f);const d=a.map(m=>jn(m,[o,c])),p=i.filter(m=>{const{source:y,target:b}=m;return y!==b}),g=new qe({nodes:d,edges:p}),v=this.getSizes(g,t,h);if(this.run(g,t,u,v,e,s),l){for(let y=0;y<p.length;y+=1){const{source:b,target:w}=p[y],x=g.getDegree(b),S=g.getDegree(b);if(x<=1){const _=g.getNode(w);g.mergeNodeData(b,{x:_.data.x,y:_.data.y})}else if(S<=1){const _=g.getNode(b);g.mergeNodeData(w,{x:_.data.x,y:_.data.y})}}const m=Object.assign(Object.assign({},s),{prune:!1,barnesHut:!1});this.run(g,t,100,v,e,m)}return{nodes:d,edges:i}})}getSizes(e,t,r){const i=e.getAllNodes(),a={};for(let s=0;s<i.length;s+=1){const{id:o,data:c}=i[s];if(a[o]=10,rt(c.size))a[o]=c.size;else if(en(c.size))isNaN(c.size[0])||(a[o]=Math.max(c.size[0])),isNaN(c.size[1])||(a[o]=Math.max(c.size[1]));else if(ne(c.size))a[o]=Math.max(c.size.width,c.size.height);else if(ft(r)){const l=t.getNode(o),u=r(l);en(u)?a[o]=Math.max(...u):a[o]=u}else en(r)?a[o]=Math.max(...r):rt(r)&&(a[o]=r)}return a}formatOptions(e={},t){const r=Object.assign(Object.assign({},this.options),e),{center:i,width:a,height:s,barnesHut:o,prune:c,maxIteration:l,kr:u,kg:h}=r;return r.width=!a&&typeof window<"u"?window.innerWidth:a,r.height=!s&&typeof window<"u"?window.innerHeight:s,r.center=i||[r.width/2,r.height/2],o===void 0&&t>250&&(r.barnesHut=!0),c===void 0&&t>100&&(r.prune=!0),l===0&&!c?(r.maxIteration=250,t<=200&&t>100?r.maxIteration=1e3:t>200&&(r.maxIteration=1200)):l===0&&c&&(r.maxIteration=100,t<=200&&t>100?r.maxIteration=500:t>200&&(r.maxIteration=950)),u||(r.kr=50,t>100&&t<=500?r.kr=20:t>500&&(r.kr=1)),h||(r.kg=20,t>100&&t<=500?r.kg=10:t>500&&(r.kg=1)),r}run(e,t,r,i,a,s){const{kr:o,barnesHut:c,onTick:l}=s,u=e.getAllNodes();let h=0,f=r;const d={},p={},g={};for(let v=0;v<u.length;v+=1){const{data:m,id:y}=u[v];if(d[y]=[0,0],c){const b={id:v,rx:m.x,ry:m.y,mass:1,g:o,degree:e.getDegree(y)};g[y]=new YS(b)}}for(;f>0;)h=this.oneStep(e,{iter:f,preventOverlapIters:50,krPrime:100,sg:h,forces:d,preForces:p,bodies:g,sizes:i},s),f--,l==null||l({nodes:u,edges:t.getAllEdges()});return e}oneStep(e,t,r){const{iter:i,preventOverlapIters:a,krPrime:s,sg:o,preForces:c,bodies:l,sizes:u}=t;let{forces:h}=t;const{preventOverlap:f,barnesHut:d}=r,p=e.getAllNodes();for(let g=0;g<p.length;g+=1){const{id:v}=p[g];c[v]=[...h[v]],h[v]=[0,0]}return h=this.getAttrForces(e,i,a,u,h,r),d&&(f&&i>a||!f)?h=this.getOptRepGraForces(e,h,l,r):h=this.getRepGraForces(e,i,a,h,s,u,r),this.updatePos(e,h,c,o,r)}getAttrForces(e,t,r,i,a,s){const{preventOverlap:o,dissuadeHubs:c,mode:l,prune:u}=s,h=e.getAllEdges();for(let f=0;f<h.length;f+=1){const{source:d,target:p}=h[f],g=e.getNode(d),v=e.getNode(p),m=e.getDegree(d),y=e.getDegree(p);if(u&&(m<=1||y<=1))continue;const b=[v.data.x-g.data.x,v.data.y-g.data.y];let w=Math.hypot(b[0],b[1]);w=w<1e-4?1e-4:w,b[0]=b[0]/w,b[1]=b[1]/w,o&&t<r&&(w=w-i[d]-i[p]);let x=w,S=x;l==="linlog"&&(x=Math.log(1+w),S=x),c&&(x=w/m,S=w/y),o&&t<r&&w<=0?(x=0,S=0):o&&t<r&&w>0&&(x=w,S=w),a[d][0]+=x*b[0],a[p][0]-=S*b[0],a[d][1]+=x*b[1],a[p][1]-=S*b[1]}return a}getOptRepGraForces(e,t,r,i){const{kg:a,center:s,prune:o}=i,c=e.getAllNodes(),l=c.length;let u=9e10,h=-9e10,f=9e10,d=-9e10;for(let y=0;y<l;y+=1){const{id:b,data:w}=c[y];o&&e.getDegree(b)<=1||(r[b].setPos(w.x,w.y),w.x>=h&&(h=w.x),w.x<=u&&(u=w.x),w.y>=d&&(d=w.y),w.y<=f&&(f=w.y))}const p=Math.max(h-u,d-f),g={xmid:(h+u)/2,ymid:(d+f)/2,length:p,massCenter:s,mass:l},v=new Eo(g),m=new xo(v);for(let y=0;y<l;y+=1){const{id:b}=c[y];o&&e.getDegree(b)<=1||r[b].in(v)&&m.insert(r[b])}for(let y=0;y<l;y+=1){const{id:b,data:w}=c[y],x=e.getDegree(b);if(o&&x<=1)continue;r[b].resetForce(),m.updateForce(r[b]),t[b][0]-=r[b].fx,t[b][1]-=r[b].fy;const S=[w.x-s[0],w.y-s[1]];let _=Math.hypot(S[0],S[1]);_=_<1e-4?1e-4:_,S[0]=S[0]/_,S[1]=S[1]/_;const E=a*(x+1);t[b][0]-=E*S[0],t[b][1]-=E*S[1]}return t}getRepGraForces(e,t,r,i,a,s,o){const{preventOverlap:c,kr:l,kg:u,center:h,prune:f}=o,d=e.getAllNodes(),p=d.length;for(let g=0;g<p;g+=1){const v=d[g],m=e.getDegree(v.id);for(let x=g+1;x<p;x+=1){const S=d[x],_=e.getDegree(S.id);if(f&&(m<=1||_<=1))continue;const E=[S.data.x-v.data.x,S.data.y-v.data.y];let P=Math.hypot(E[0],E[1]);P=P<1e-4?1e-4:P,E[0]=E[0]/P,E[1]=E[1]/P,c&&t<r&&(P=P-s[v.id]-s[S.id]);let O=l*(m+1)*(_+1)/P;c&&t<r&&P<0?O=a*(m+1)*(_+1):c&&t<r&&P===0?O=0:c&&t<r&&P>0&&(O=l*(m+1)*(_+1)/P),i[v.id][0]-=O*E[0],i[S.id][0]+=O*E[0],i[v.id][1]-=O*E[1],i[S.id][1]+=O*E[1]}const y=[v.data.x-h[0],v.data.y-h[1]],b=Math.hypot(y[0],y[1]);y[0]=y[0]/b,y[1]=y[1]/b;const w=u*(m+1);i[v.id][0]-=w*y[0],i[v.id][1]-=w*y[1]}return i}updatePos(e,t,r,i,a){const{ks:s,tao:o,prune:c,ksmax:l}=a,u=e.getAllNodes(),h=u.length,f=[],d=[];let p=0,g=0,v=i;for(let y=0;y<h;y+=1){const{id:b}=u[y],w=e.getDegree(b);if(c&&w<=1)continue;const x=[t[b][0]-r[b][0],t[b][1]-r[b][1]],S=Math.hypot(x[0],x[1]),_=[t[b][0]+r[b][0],t[b][1]+r[b][1]],E=Math.hypot(_[0],_[1]);f[y]=S,d[y]=E/2,p+=(w+1)*f[y],g+=(w+1)*d[y]}const m=v;v=o*g/p,m!==0&&(v=v>1.5*m?1.5*m:v);for(let y=0;y<h;y+=1){const{id:b,data:w}=u[y],x=e.getDegree(b);if(c&&x<=1||rt(w.fx)&&rt(w.fy))continue;let S=s*v/(1+v*Math.sqrt(f[y])),_=Math.hypot(t[b][0],t[b][1]);_=_<1e-4?1e-4:_;const E=l/_;S=S>E?E:S;const P=S*t[b][0],O=S*t[b][1];e.mergeNodeData(b,{x:w.x+P,y:w.y+O})}return v}}const Lst={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Ist=800;class XS{constructor(e={}){this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},Lst),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;r<e;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(r=>this.lastGraph.mergeNodeData(r.id,{x:r.data.x,y:r.data.y,z:this.options.dimensions===3?r.data.z:void 0})),t}genericFruchtermanLayout(e,t,r){return Et(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(r),{dimensions:a,width:s,height:o,center:c,clustering:l,nodeClusterBy:u,maxIteration:h,onTick:f}=i,d=t.getAllNodes(),p=t.getAllEdges();if(!(d!=null&&d.length)){const b={nodes:[],edges:p};return this.lastResult=b,b}if(d.length===1){e&&t.mergeNodeData(d[0].id,{x:c[0],y:c[1],z:a===3?c[2]:void 0});const b={nodes:[Object.assign(Object.assign({},d[0]),{data:Object.assign(Object.assign({},d[0].data),{x:c[0],y:c[1],z:a===3?c[2]:void 0})})],edges:p};return this.lastResult=b,b}const g=d.map(b=>jn(b,[s,o])),v=new qe({nodes:g,edges:p}),m={};if(l&&g.forEach(b=>{const w=b.data[u];m[w]||(m[w]={name:w,cx:0,cy:0,count:0})}),this.lastLayoutNodes=g,this.lastLayoutEdges=p,this.lastAssign=e,this.lastGraph=v,this.lastOptions=i,this.lastClusterMap=m,typeof window>"u")return;let y=0;return new Promise(b=>{this.timeInterval=window.setInterval(()=>{if(!this.running){b({nodes:g,edges:p});return}this.runOneStep(v,m,i),e&&g.forEach(({id:w,data:x})=>t.mergeNodeData(w,{x:x.x,y:x.y,z:a===3?x.z:void 0})),f==null||f({nodes:g,edges:p}),y++,y>=h&&(window.clearInterval(this.timeInterval),b({nodes:g,edges:p}))},0),this.running=!0})})}formatOptions(e={}){const t=Object.assign(Object.assign({},this.options),e),{clustering:r,nodeClusterBy:i}=t,{center:a,width:s,height:o}=t;return t.width=!s&&typeof window<"u"?window.innerWidth:s,t.height=!o&&typeof window<"u"?window.innerHeight:o,t.center=a||[t.width/2,t.height/2],t.clustering=r&&!!i,t}runOneStep(e,t,r){const{dimensions:i,height:a,width:s,gravity:o,center:c,speed:l,clustering:u,nodeClusterBy:h,clusterGravity:f}=r,d=a*s,p=Math.sqrt(d)/10,g=e.getAllNodes(),v=d/(g.length+1),m=Math.sqrt(v),y={};if(this.applyCalculate(e,y,m,v),u){for(const w in t)t[w].cx=0,t[w].cy=0,t[w].count=0;g.forEach(w=>{const{data:x}=w,S=t[x[h]];rt(x.x)&&(S.cx+=x.x),rt(x.y)&&(S.cy+=x.y),S.count++});for(const w in t)t[w].cx/=t[w].count,t[w].cy/=t[w].count;const b=f||o;g.forEach((w,x)=>{const{id:S,data:_}=w;if(!rt(_.x)||!rt(_.y))return;const E=t[_[h]],P=Math.sqrt((_.x-E.cx)*(_.x-E.cx)+(_.y-E.cy)*(_.y-E.cy)),O=m*b;y[S].x-=O*(_.x-E.cx)/P,y[S].y-=O*(_.y-E.cy)/P})}g.forEach((b,w)=>{const{id:x,data:S}=b;if(!rt(S.x)||!rt(S.y))return;const _=.01*m*o;y[x].x-=_*(S.x-c[0]),y[x].y-=_*(S.y-c[1]),i===3&&(y[x].z-=_*(S.z-c[2]))}),g.forEach((b,w)=>{const{id:x,data:S}=b;if(rt(S.fx)&&rt(S.fy)){S.x=S.fx,S.y=S.fy,i===3&&(S.z=S.fz);return}if(!rt(S.x)||!rt(S.y))return;const _=Math.sqrt(y[x].x*y[x].x+y[x].y*y[x].y+(i===3?y[x].z*y[x].z:0));if(_>0){const E=Math.min(p*(l/Ist),_);e.mergeNodeData(x,{x:S.x+y[x].x/_*E,y:S.y+y[x].y/_*E,z:i===3?S.z+y[x].z/_*E:void 0})}})}applyCalculate(e,t,r,i){this.calRepulsive(e,t,i),this.calAttractive(e,t,r)}calRepulsive(e,t,r){const i=e.getAllNodes();i.forEach(({data:a,id:s},o)=>{t[s]={x:0,y:0,z:0},i.forEach(({data:c,id:l},u)=>{if(o<=u||!rt(a.x)||!rt(c.x)||!rt(a.y)||!rt(c.y))return;let h=a.x-c.x,f=a.y-c.y,d=this.options.dimensions===3?a.z-c.z:0,p=h*h+f*f+d*d;p===0&&(p=1,h=.01,f=.01,d=.01);const g=r/p,v=h*g,m=f*g,y=d*g;t[s].x+=v,t[s].y+=m,t[l].x-=v,t[l].y-=m,this.options.dimensions===3&&(t[s].z+=y,t[l].z-=y)})})}calAttractive(e,t,r){e.getAllEdges().forEach(a=>{const{source:s,target:o}=a;if(!s||!o||s===o)return;const{data:c}=e.getNode(s),{data:l}=e.getNode(o);if(!rt(l.x)||!rt(c.x)||!rt(l.y)||!rt(c.y))return;const u=l.x-c.x,h=l.y-c.y,f=this.options.dimensions===3?l.z-c.z:0,d=Math.sqrt(u*u+h*h+f*f)/r,p=u*d,g=h*d,v=f*d;t[s].x+=p,t[s].y+=g,t[o].x-=p,t[o].y-=g,this.options.dimensions===3&&(t[s].z+=v,t[o].z-=v)})}}const Bst={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class ZS{constructor(e={}){this.options=e,this.id="grid",this.options=Object.assign(Object.assign({},Bst),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericGridLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,e,t)})}genericGridLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{begin:a=[0,0],condense:s,preventOverlapPadding:o,preventOverlap:c,rows:l,cols:u,nodeSpacing:h,nodeSize:f,width:d,height:p,position:g}=i;let{sortBy:v}=i;const m=t.getAllNodes(),y=t.getAllEdges(),b=m==null?void 0:m.length;if(!b||b===1)return Is(t,e,a);const w=m.map(D=>jn(D));v!=="id"&&(!At(v)||w[0].data[v]===void 0)&&(v="degree"),v==="degree"?w.sort((D,B)=>t.getDegree(B.id,"both")-t.getDegree(D.id,"both")):v==="id"?w.sort((D,B)=>rt(B.id)&&rt(D.id)?B.id-D.id:`${D.id}`.localeCompare(`${B.id}`)):w.sort((D,B)=>B.data[v]-D.data[v]);const x=!d&&typeof window<"u"?window.innerWidth:d,S=!p&&typeof window<"u"?window.innerHeight:p,_=b,E={rows:l,cols:u};if(l!=null&&u!=null)E.rows=l,E.cols=u;else if(l!=null&&u==null)E.rows=l,E.cols=Math.ceil(_/E.rows);else if(l==null&&u!=null)E.cols=u,E.rows=Math.ceil(_/E.cols);else{const D=Math.sqrt(_*S/x);E.rows=Math.round(D),E.cols=Math.round(x/S*D)}if(E.rows=Math.max(E.rows,1),E.cols=Math.max(E.cols,1),E.cols*E.rows>_){const D=Cf(E),B=Mf(E);(D-1)*B>=_?Cf(E,D-1):(B-1)*D>=_&&Mf(E,B-1)}else for(;E.cols*E.rows<_;){const D=Cf(E),B=Mf(E);(B+1)*D>=_?Mf(E,B+1):Cf(E,D+1)}let P=s?0:x/E.cols,O=s?0:S/E.rows;if(c||h){const D=ir(10,h),B=dS(30,f,!1);w.forEach(j=>{(!j.data.x||!j.data.y)&&(j.data.x=0,j.data.y=0);const L=t.getNode(j.id),$=B(L)||30;let V,W;en($)?(V=$[0],W=$[1]):(V=$,W=$);const Y=D!==void 0?D(j):o,U=V+Y,J=W+Y;P=Math.max(P,U),O=Math.max(O,J)})}const C={},M={row:0,col:0},T={};for(let D=0;D<w.length;D++){const B=w[D];let j;if(g&&(j=g(t.getNode(B.id))),j&&(j.row!==void 0||j.col!==void 0)){const L={row:j.row,col:j.col};if(L.col===void 0)for(L.col=0;Lw(C,L);)L.col++;else if(L.row===void 0)for(L.row=0;Lw(C,L);)L.row++;T[B.id]=L,pB(C,L)}Fst(B,a,P,O,T,E,M,C)}const R={nodes:w,edges:y};return e&&w.forEach(D=>{t.mergeNodeData(D.id,{x:D.data.x,y:D.data.y})}),R})}}const Cf=(n,e)=>{let t;const r=n.rows||5,i=n.cols||5;return e==null?t=Math.min(r,i):Math.min(r,i)===n.rows?n.rows=e:n.cols=e,t},Mf=(n,e)=>{let t;const r=n.rows||5,i=n.cols||5;return e==null?t=Math.max(r,i):Math.max(r,i)===n.rows?n.rows=e:n.cols=e,t},Lw=(n,e)=>n[`c-${e.row}-${e.col}`]||!1,pB=(n,e)=>n[`c-${e.row}-${e.col}`]=!0,xN=(n,e)=>{const t=n.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)},Fst=(n,e,t,r,i,a,s,o)=>{let c,l;const u=i[n.id];if(u)c=u.col*t+t/2+e[0],l=u.row*r+r/2+e[1];else{for(;Lw(o,s);)xN(a,s);c=s.col*t+t/2+e[0],l=s.row*r+r/2+e[1],pB(o,s),xN(a,s)}n.data.x=c,n.data.y=l},$st=(n,e,t)=>{try{const r=Ea.mul(Ea.pow(e,2),-.5),i=r.mean("row"),a=r.mean("column"),s=r.mean();r.add(s).subRowVector(i).subColumnVector(a);const o=new $5(r),c=Ea.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(l=>Ea.mul([l],[c]).toJSON()[0].splice(0,n))}catch{const i=[];for(let a=0;a<e.length;a++){const s=Math.random()*t,o=Math.random()*t;i.push([s,o])}return i}},zst=800,jst={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},qst=(n,e)=>{const t=Object.assign(Object.assign({},jst),e),{positions:r,iterations:i,width:a,k:s,speed:o=100,strictRadial:c,focusIdx:l,radii:u=[],nodeSizeFunc:h}=t,f=n.getAllNodes(),d=[],p=a/10;for(let g=0;g<i;g++)r.forEach((v,m)=>{d[m]={x:0,y:0}}),Gst(f,r,d,s,u,h),Vst(r,d,o,c,l,p,a,u);return r},Gst=(n,e,t,r,i,a)=>{e.forEach((s,o)=>{t[o]={x:0,y:0},e.forEach((c,l)=>{if(o===l||i[o]!==i[l])return;let u=s.x-c.x,h=s.y-c.y,f=Math.sqrt(u*u+h*h);if(f===0){f=1;const d=o>l?1:-1;u=.01*d,h=.01*d}if(f<a(n[o])/2+a(n[l])/2){const d=r*r/f;t[o].x+=u/f*d,t[o].y+=h/f*d}})})},Vst=(n,e,t,r,i,a,s,o)=>{const c=a||s/10;return r&&e.forEach((l,u)=>{const h=n[u].x-n[i].x,f=n[u].y-n[i].y,d=Math.sqrt(h*h+f*f);let p=f/d,g=-h/d;const v=Math.sqrt(l.x*l.x+l.y*l.y);let m=Math.acos((p*l.x+g*l.y)/v);m>Math.PI/2&&(m-=Math.PI/2,p*=-1,g*=-1);const y=Math.cos(m)*v;l.x=p*y,l.y=g*y}),n.forEach((l,u)=>{if(u===i)return;const h=Math.sqrt(e[u].x*e[u].x+e[u].y*e[u].y);if(h>0&&u!==i){const f=Math.min(c*(t/zst),h);if(l.x+=e[u].x/h*f,l.y+=e[u].y/h*f,r){let d=l.x-n[i].x,p=l.y-n[i].y;const g=Math.sqrt(d*d+p*p);d=d/g*o[u],p=p/g*o[u],l.x=n[i].x+d,l.y=n[i].y+p}}}),n},Wst={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class QS{constructor(e={}){this.options=e,this.id="radial",this.options=Object.assign(Object.assign({},Wst),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,e,t)})}genericRadialLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{width:a,height:s,center:o,focusNode:c,unitRadius:l,nodeSize:u,nodeSpacing:h,strictRadial:f,preventOverlap:d,maxPreventOverlapIteration:p,sortBy:g,linkDistance:v=50,sortStrength:m=10,maxIteration:y=1e3}=i,b=t.getAllNodes(),w=t.getAllEdges(),x=!a&&typeof window<"u"?window.innerWidth:a,S=!s&&typeof window<"u"?window.innerHeight:s,_=o||[x/2,S/2];if(!(b!=null&&b.length)||b.length===1)return Is(t,e,_);let E=b[0];if(At(c)){for(let lt=0;lt<b.length;lt++)if(b[lt].id===c){E=b[lt];break}}else E=c||b[0];const P=Yst(b,E.id),O=fS({nodes:b,edges:w},!1),C=hS(O),M=Xst(C,P);Kst(C,P,M+1);const T=C[P];let R=x-_[0]>_[0]?_[0]:x-_[0],D=S-_[1]>_[1]?_[1]:S-_[1];R===0&&(R=x/2),D===0&&(D=S/2);const B=Math.min(R,D),j=Math.max(...T),L=[],$=l||B/j;T.forEach((lt,Nt)=>{L[Nt]=lt*$});const V=Hst(b,C,v,L,$,g,m),W=Ust(V),Y=$st(v,V,v);let U=Y.map(([lt,Nt])=>({x:(isNaN(lt)?Math.random()*v:lt)-Y[P][0],y:(isNaN(Nt)?Math.random()*v:Nt)-Y[P][1]}));this.run(y,U,W,V,L,P);let J;if(d){J=pS(u,h);const lt={nodes:b,nodeSizeFunc:J,positions:U,radii:L,height:S,width:x,strictRadial:!!f,focusIdx:P,iterations:p||200,k:U.length/4.5};U=qst(t,lt)}const at=[];return U.forEach((lt,Nt)=>{const pe=jn(b[Nt]);pe.data.x=lt.x+_[0],pe.data.y=lt.y+_[1],at.push(pe)}),e&&at.forEach(lt=>t.mergeNodeData(lt.id,{x:lt.data.x,y:lt.data.y})),{nodes:at,edges:w}})}run(e,t,r,i,a,s){for(let o=0;o<=e;o++){const c=o/e;this.oneIteration(c,t,a,i,r,s)}}oneIteration(e,t,r,i,a,s){const o=1-e;t.forEach((c,l)=>{const u=Cw(c,{x:0,y:0}),h=u===0?0:1/u;if(l===s)return;let f=0,d=0,p=0;t.forEach((v,m)=>{if(l===m)return;const y=Cw(c,v),b=y===0?0:1/y,w=i[m][l];p+=a[l][m],f+=a[l][m]*(v.x+w*(c.x-v.x)*b),d+=a[l][m]*(v.y+w*(c.y-v.y)*b)});const g=r[l]===0?0:1/r[l];p*=o,p+=e*g*g,f*=o,f+=e*g*c.x*h,c.x=f/p,d*=o,d+=e*g*c.y*h,c.y=d/p})}}const Hst=(n,e,t,r,i,a,s)=>{if(!n)return[];const o=[];if(e){const c={};e.forEach((l,u)=>{const h=[];l.forEach((f,d)=>{var p,g;if(u===d)h.push(0);else if(r[u]===r[d])if(a==="data")h.push(f*(Math.abs(u-d)*s)/(r[u]/i));else if(a){let v,m;if(c[n[u].id])v=c[n[u].id];else{const y=(a==="id"?n[u].id:(p=n[u].data)===null||p===void 0?void 0:p[a])||0;At(y)?v=y.charCodeAt(0):v=y,c[n[u].id]=v}if(c[n[d].id])m=c[n[d].id];else{const y=(a==="id"?n[d].id:(g=n[d].data)===null||g===void 0?void 0:g[a])||0;At(y)?m=y.charCodeAt(0):m=y,c[n[d].id]=m}h.push(f*(Math.abs(v-m)*s)/(r[u]/i))}else h.push(f*t/(r[u]/i));else{const v=(t+i)/2;h.push(f*v)}}),o.push(h)})}return o},Ust=n=>{const e=n.length,t=n[0].length,r=[];for(let i=0;i<e;i++){const a=[];for(let s=0;s<t;s++)n[i][s]!==0?a.push(1/(n[i][s]*n[i][s])):a.push(0);r.push(a)}return r},Yst=(n,e)=>{let t=-1;return n.forEach((r,i)=>{r.id===e&&(t=i)}),Math.max(t,0)},Kst=(n,e,t)=>{const r=n.length;for(let i=0;i<r;i++)if(n[e][i]===1/0){n[e][i]=t,n[i][e]=t;for(let a=0;a<r;a++)n[i][a]!==1/0&&n[e][a]===1/0&&(n[e][a]=t+n[i][a],n[a][e]=t+n[i][a])}for(let i=0;i<r;i++)if(i!==e){for(let a=0;a<r;a++)if(n[i][a]===1/0){let s=Math.abs(n[e][i]-n[e][a]);s=s===0?1:s,n[i][a]=s}}},Xst=(n,e)=>{let t=0;for(let r=0;r<n[e].length;r++)n[e][r]!==1/0&&(t=n[e][r]>t?n[e][r]:t);return t},Zst={center:[0,0],width:300,height:300};class JS{constructor(e={}){this.options=e,this.id="random",this.options=Object.assign(Object.assign({},Zst),e)}execute(e,t){return Et(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,e,t)})}assign(e,t){return Et(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,e,t)})}genericRandomLayout(e,t,r){return Et(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a,width:s,height:o}=i,c=t.getAllNodes(),l=.9,u=!s&&typeof window<"u"?window.innerWidth:s,h=!o&&typeof window<"u"?window.innerHeight:o,f=a||[u/2,h/2],d=[];return c&&c.forEach(g=>{d.push({id:g.id,data:{x:(Math.random()-.5)*l*u+f[0],y:(Math.random()-.5)*l*h+f[1]}})}),e&&d.forEach(g=>t.mergeNodeData(g.id,{x:g.data.x,y:g.data.y})),{nodes:d,edges:t.getAllEdges()}})}}const Qst={circular:vS,concentric:Wu,mds:Rg,random:JS,grid:ZS,radial:QS,force:Mg,d3force:Dg,"d3-force-3d":V5,fruchterman:XS,forceAtlas2:KS,dagre:Ec,antvDagre:gS,comboCombined:wS};function Iw(n){return!!n.tick&&!!n.stop}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gB=Symbol("Comlink.proxy"),Jst=Symbol("Comlink.endpoint"),vB=Symbol("Comlink.releaseProxy"),FE=Symbol("Comlink.finalizer"),ud=Symbol("Comlink.thrown"),mB=n=>typeof n=="object"&&n!==null||typeof n=="function",tot={canHandle:n=>mB(n)&&n[gB],serialize(n){const{port1:e,port2:t}=new MessageChannel;return bB(n,e),[t,[t]]},deserialize(n){return n.start(),xB(n)}},eot={canHandle:n=>mB(n)&&ud in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},yB=new Map([["proxy",tot],["throw",eot]]);function not(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function bB(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!not(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:s,path:o}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(os);let l;try{const u=o.slice(0,-1).reduce((f,d)=>f[d],n),h=o.reduce((f,d)=>f[d],n);switch(s){case"GET":l=h;break;case"SET":u[o.slice(-1)[0]]=os(i.data.value),l=!0;break;case"APPLY":l=h.apply(u,c);break;case"CONSTRUCT":{const f=new h(...c);l=cot(f)}break;case"ENDPOINT":{const{port1:f,port2:d}=new MessageChannel;bB(n,d),l=oot(f,[f])}break;case"RELEASE":l=void 0;break;default:return}}catch(u){l={value:u,[ud]:0}}Promise.resolve(l).catch(u=>({value:u,[ud]:0})).then(u=>{const[h,f]=op(u);e.postMessage(Object.assign(Object.assign({},h),{id:a}),f),s==="RELEASE"&&(e.removeEventListener("message",r),EB(e),FE in n&&typeof n[FE]=="function"&&n[FE]())}).catch(u=>{const[h,f]=op({value:new TypeError("Unserializable return value"),[ud]:0});e.postMessage(Object.assign(Object.assign({},h),{id:a}),f)})}),e.start&&e.start()}function rot(n){return n.constructor.name==="MessagePort"}function EB(n){rot(n)&&n.close()}function xB(n,e){return Bw(n,[],e)}function Tf(n){if(n)throw new Error("Proxy has been released and is not useable")}function wB(n){return go(n,{type:"RELEASE"}).then(()=>{EB(n)})}const ap=new WeakMap,sp="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(ap.get(n)||0)-1;ap.set(n,e),e===0&&wB(n)});function iot(n,e){const t=(ap.get(e)||0)+1;ap.set(e,t),sp&&sp.register(n,e,n)}function aot(n){sp&&sp.unregister(n)}function Bw(n,e=[],t=function(){}){let r=!1;const i=new Proxy(t,{get(a,s){if(Tf(r),s===vB)return()=>{aot(i),wB(n),r=!0};if(s==="then"){if(e.length===0)return{then:()=>i};const o=go(n,{type:"GET",path:e.map(c=>c.toString())}).then(os);return o.then.bind(o)}return Bw(n,[...e,s])},set(a,s,o){Tf(r);const[c,l]=op(o);return go(n,{type:"SET",path:[...e,s].map(u=>u.toString()),value:c},l).then(os)},apply(a,s,o){Tf(r);const c=e[e.length-1];if(c===Jst)return go(n,{type:"ENDPOINT"}).then(os);if(c==="bind")return Bw(n,e.slice(0,-1));const[l,u]=wN(o);return go(n,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:l},u).then(os)},construct(a,s){Tf(r);const[o,c]=wN(s);return go(n,{type:"CONSTRUCT",path:e.map(l=>l.toString()),argumentList:o},c).then(os)}});return iot(i,n),i}function sot(n){return Array.prototype.concat.apply([],n)}function wN(n){const e=n.map(op);return[e.map(t=>t[0]),sot(e.map(t=>t[1]))]}const SB=new WeakMap;function oot(n,e){return SB.set(n,e),n}function cot(n){return Object.assign(n,{[gB]:!0})}function op(n){for(const[e,t]of yB)if(t.canHandle(n)){const[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},SB.get(n)||[]]}function os(n){switch(n.type){case"HANDLER":return yB.get(n.name).deserialize(n.value);case"RAW":return n.value}}function go(n,e,t){return new Promise(r=>{const i=lot();n.addEventListener("message",function a(s){!s.data||!s.data.id||s.data.id!==i||(n.removeEventListener("message",a),r(s.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),t)})}function lot(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class _B extends yh{constructor(e,t,r){super(),this.graph=e,this.layout=t,this.options=r,this.spawnWorker()}spawnWorker(){this.proxy=xB(new Worker(new URL(""+new URL("worker-BR9VNGTV.js",import.meta.url).href,import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var e;return Et(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,r=ie(t,["onTick"]),i={};Object.keys(r).forEach(c=>{ft(r[c])||(i[c]=r[c])});const a={layout:{id:this.layout.id,options:i,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[o]=yield this.proxy.calculateLayout(a,[s]);return o})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[vB]()}isRunning(){return this.running}}const uot=Object.freeze(Object.defineProperty({__proto__:null,AntVDagreLayout:gS,CircularLayout:vS,ComboCombinedLayout:wS,ConcentricLayout:Wu,D3Force3DLayout:V5,D3ForceLayout:Dg,DagreLayout:Ec,ForceAtlas2Layout:KS,ForceLayout:Mg,FruchtermanLayout:XS,GridLayout:ZS,MDSLayout:Rg,RadialLayout:QS,RandomLayout:JS,Supervisor:_B,clone:Qd,cloneFormatData:jn,floydWarshall:hS,formatNodeSize:pS,formatNumberFn:ir,formatSizeFn:dS,getAdjMatrix:fS,getEuclideanDistance:Cw,getLayoutBBox:C5,graphTreeDfs:Zd,isArray:en,isLayoutWithIterations:Iw,registry:Qst,scaleMatrix:P5},Symbol.toStringTag,{value:"Module"})),hot=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],fot=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],dot=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],pot=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],got=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"],ao=n=>n?parseInt(n):0;function vot(n){const e=getComputedStyle(n),t=n.clientWidth||ao(e.width),r=n.clientHeight||ao(e.height),i=ao(e.paddingLeft)+ao(e.paddingRight),a=ao(e.paddingTop)+ao(e.paddingBottom);return[t-i,r-a]}function SN(n){let e=640,t=480;const[r,i]=vot(n);e=r||e,t=i||t;const a=1,s=1;return[Math.max(rt(e)?e:a,a),Math.max(rt(t)?t:s,s)]}function _h(n,e=!0){const t=document.createElement("div");return t.setAttribute("class",`g6-${n}`),t.style.position="absolute",t.style.display="block",e&&(t.style.inset="0px",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none"),t}function Fw(n,e="div",t={},r="",i=document.body){const a=document.getElementById(n);a&&a.remove();const s=document.createElement(e);return s.innerHTML=r,s.id=n,Object.assign(s.style,t),i.appendChild(s),s}function mot(n,e){const t=n.firstChild;t?n.insertBefore(e,t):n.appendChild(e)}class kr extends J2{}const Vp=class Vp extends kr{constructor(t,r){super(t,Object.assign({},Vp.defaultOptions,r));A(this,"$element",_h("background"));this.context.canvas.getContainer().prepend(this.$element),this.update(r)}async update(t){super.update(t),Object.assign(this.$element.style,lg(this.options,["key","type"]))}destroy(){super.destroy(),this.$element.remove()}};A(Vp,"defaultOptions",{transition:"background 0.5s",backgroundSize:"cover"});let $w=Vp;function t_(n,e,t,r,i,a){const s=n,o=e,c=t-s,l=r-o;let u=i-s,h=a-o,f=u*c+h*l,d=0;f<=0?d=0:(u=c-u,h=l-h,f=u*c+h*l,f<=0?d=0:d=f*f/(c*c+l*l));const p=u*u+h*h-d;return p<0?0:p}function wa(n,e,t,r){return(n-t)*(n-t)+(e-r)*(e-r)}function _N(n,e,t,r,i){return wa(n,e,t,r)<i*i}function yot(n){if(!Number.isFinite(n))return t=>t;if(n===0)return Math.round;const e=Math.pow(10,n);return t=>Math.round(t*e)/e}function e_(n){const e=Math.min(n.x1,n.x2),t=Math.max(n.x1,n.x2),r=Math.min(n.y1,n.y2),i=Math.max(n.y1,n.y2);return{x:e,y:r,x2:t,y2:i,width:t-e,height:i-r}}class Xe{constructor(e,t,r,i){this.x1=e,this.y1=t,this.x2=r,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new Xe(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const r=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=r}distSquare(e,t){return t_(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,r){if(this.x1<this.x2){if(e<this.x1-r||e>this.x2+r)return!1}else if(e<this.x2-r||e>this.x1+r)return!1;if(this.y1<this.y2){if(t<this.y1-r||t>this.y2+r)return!1}else if(t<this.y2-r||t>this.y1+r)return!1;return!0}}var Re;(function(n){n[n.POINT=1]="POINT",n[n.PARALLEL=2]="PARALLEL",n[n.COINCIDENT=3]="COINCIDENT",n[n.NONE=4]="NONE"})(Re||(Re={}));class $E{constructor(e,t=0,r=0){this.state=e,this.x=t,this.y=r}}function Af(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,s=r/i;return 0<=a&&a<=1&&0<=s&&s<=1?new $E(Re.POINT,n.x1+a*(n.x2-n.x1),n.y1+a*(n.y2-n.y1)):new $E(Re.NONE)}return new $E(t===0||r===0?Re.COINCIDENT:Re.PARALLEL)}function OB(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,s=r/i;if(0<=a&&a<=1&&0<=s&&s<=1)return a}return Number.POSITIVE_INFINITY}function bot(n,e){function t(i,a,s,o){let c=OB(e,new Xe(i,a,s,o));return c=Math.abs(c-.5),c>=0&&c<=1?1:0}let r=t(n.x,n.y,n.x2,n.y);return r+=t(n.x,n.y,n.x,n.y2),r>1||(r+=t(n.x,n.y2,n.x2,n.y2),r>1)?!0:(r+=t(n.x2,n.y,n.x2,n.y2),r>0)}var De;(function(n){n[n.LEFT=0]="LEFT",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM"})(De||(De={}));function hd(n,e,t){const r=new Set;return n.width<=0?(r.add(De.LEFT),r.add(De.RIGHT)):e<n.x?r.add(De.LEFT):e>n.x+n.width&&r.add(De.RIGHT),n.height<=0?(r.add(De.TOP),r.add(De.BOTTOM)):t<n.y?r.add(De.TOP):t>n.y+n.height&&r.add(De.BOTTOM),r}function PB(n,e){let t=e.x1,r=e.y1;const i=e.x2,a=e.y2,s=Array.from(hd(n,i,a));if(s.length===0)return!0;let o=hd(n,t,r);for(;o.size!==0;){for(const c of s)if(o.has(c))return!1;if(o.has(De.RIGHT)||o.has(De.LEFT)){let c=n.x;o.has(De.RIGHT)&&(c+=n.width),r=r+(c-t)*(a-r)/(i-t),t=c}else{let c=n.y;o.has(De.BOTTOM)&&(c+=n.height),t=t+(c-r)*(i-t)/(a-r),r=c}o=hd(n,t,r)}return!0}function Eot(n,e){let t=Number.POSITIVE_INFINITY,r=0;function i(a,s,o,c){let l=OB(e,new Xe(a,s,o,c));l=Math.abs(l-.5),l>=0&&l<=1&&(r++,l<t&&(t=l))}return i(n.x,n.y,n.x2,n.y),i(n.x,n.y,n.x,n.y2),r>1||(i(n.x,n.y2,n.x2,n.y2),r>1)?t:(i(n.x2,n.y,n.x2,n.y2),r===0?-1:t)}function xot(n,e){let t=0;const r=Af(n,new Xe(e.x,e.y,e.x2,e.y));t+=r.state===Re.POINT?1:0;const i=Af(n,new Xe(e.x,e.y,e.x,e.y2));t+=i.state===Re.POINT?1:0;const a=Af(n,new Xe(e.x,e.y2,e.x2,e.y2));t+=a.state===Re.POINT?1:0;const s=Af(n,new Xe(e.x2,e.y,e.x2,e.y2));return t+=s.state===Re.POINT?1:0,{top:r,left:i,bottom:a,right:s,count:t}}class sn{constructor(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new sn(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new sn(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),a=Math.max(this.y2,e.y+e.height);this.x=t,this.y=r,this.width=i-t,this.height=a-r}addPoint(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),a=Math.max(this.y2,e.y);this.x=t,this.y=r,this.width=i-t,this.height=a-r}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const r=hd(this,e,t);return r.has(De.TOP)?r.has(De.LEFT)?wa(e,t,this.x,this.y):r.has(De.RIGHT)?wa(e,t,this.x2,this.y):(this.y-t)*(this.y-t):r.has(De.BOTTOM)?r.has(De.LEFT)?wa(e,t,this.x,this.y2):r.has(De.RIGHT)?wa(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):r.has(De.LEFT)?(this.x-e)*(this.x-e):r.has(De.RIGHT)?(e-this.x2)*(e-this.x2):0}}function CB(n){if(n.length===0)return null;const e=n[0],t=new sn(e.x,e.y,0,0);for(const r of n)t.addPoint(r);return t}class Yu{constructor(e,t,r){this.cx=e,this.cy=t,this.radius=r}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new Yu(e.cx,e.cy,e.radius)}containsPt(e,t){return wa(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const r=wa(this.cx,this.cy,e,t);if(r<this.radius*this.radius)return 0;const i=Math.sqrt(r)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Na{constructor(e,t=0,r=0,i=0,a=0,s=10,o=10,c=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=e,this.i=t,this.j=r,this.pixelX=i,this.pixelY=a,this.width=s,this.height=o,this.area=c}createSub(e,t){return new Na(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new Na(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new Na(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),r=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),s=i-t,o=a-r;return new sn(t,r,s,o)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const r=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-r),a=this.boundY(e.y-r),s=this.boundX(e.x2+r),o=this.boundY(e.y2+r),c=s-i,l=o-a;return new sn(i,a,c,l)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=r)}set(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=r)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const r=this.width,i=e.width,a=Math.max(0,e.i),s=Math.max(0,e.j),o=Math.min(e.i+e.width,r),c=Math.min(e.j+e.height,this.height);if(!(c<=0||o<=0||a>=r||c>=this.height))for(let l=s;l<c;l++){const u=(l-e.j)*i,h=l*r;for(let f=a;f<o;f++){const d=e.area[f-e.i+u];d!==0&&(this.area[f+h]+=t*d)}}}fill(e){this.area.fill(e)}fillArea(e,t){const r=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const a=r+i*this.width;this.area.fill(t,a,a+e.width)}}fillHorizontalLine(e,t,r,i){const a=e+t*this.width;this.area.fill(i,a,a+r)}fillVerticalLine(e,t,r,i){const a=e+t*this.width;for(let s=0;s<r;s++)this.area[a+s*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const r=t*this.width;for(let i=0;i<this.width;i++){const a=this.area[r+i];e+=a.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const r=this.area.reduce((s,o)=>Math.min(s,o),Number.POSITIVE_INFINITY),i=this.area.reduce((s,o)=>Math.max(s,o),Number.NEGATIVE_INFINITY),a=s=>(s-r)/(i-r);e.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++){const c=this.area[s+o*this.width];e.fillStyle=`rgba(0, 0, 0, ${a(c)})`,e.fillRect(s,o,1,1)}e.restore()}drawThreshold(e,t,r=!0){if(!(this.width<=0||this.height<=0)){e.save(),r&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const s=this.area[i+a*this.width];e.fillStyle=s>t?"black":"white",e.fillRect(i,a,1,1)}e.restore()}}}function n_(n,e){const t=r=>({x:r.x-e,y:r.y-e,width:r.width+2*e,height:r.height+2*e});return Array.isArray(n)?n.map(t):t(n)}function zw(n,e,t){return r_(Object.assign(e_(n),{distSquare:(r,i)=>t_(n.x1,n.y1,n.x2,n.y2,r,i)}),e,t)}function r_(n,e,t){const r=n_(n,t),i=e.scale(r),a=e.createSub(i,r);return wot(a,e,t,(s,o)=>n.distSquare(s,o)),a}function wot(n,e,t,r){const i=t*t;for(let a=0;a<n.height;a++)for(let s=0;s<n.width;s++){const o=e.invertScaleX(n.i+s),c=e.invertScaleY(n.j+a),l=r(o,c);if(l===0){n.set(s,a,i);continue}if(l<i){const u=t-Math.sqrt(l);n.set(s,a,u*u)}}return n}function MB(n,e,t){const r=e.scale(n),i=e.addPadding(r,t),a=e.createSub(i,{x:n.x-t,y:n.y-t}),s=r.x-i.x,o=r.y-i.y,c=i.x2-r.x2,l=i.y2-r.y2,u=i.width-s-c,h=i.height-o-l,f=t*t;a.fillArea({x:s,y:o,width:u+1,height:h+1},f);const d=[0],p=Math.max(o,s,c,l);{const y=e.invertScaleX(r.x+r.width/2);for(let b=1;b<p;b++){const w=e.invertScaleY(r.y-b),x=n.distSquare(y,w);if(x<f){const S=t-Math.sqrt(x);d.push(S*S)}else break}}const g=[],v=Math.max(s,c),m=Math.max(o,c);for(let y=1;y<v;y++){const b=e.invertScaleX(r.x-y),w=[];for(let x=1;x<m;x++){const S=e.invertScaleY(r.y-x),_=n.distSquare(b,S);if(_<f){const E=t-Math.sqrt(_);w.push(E*E)}else w.push(0)}g.push(w)}for(let y=1;y<Math.min(o,d.length);y++){const b=d[y];a.fillHorizontalLine(s,o-y,u+1,b)}for(let y=1;y<Math.min(l,d.length);y++){const b=d[y];a.fillHorizontalLine(s,o+h+y,u+1,b)}for(let y=1;y<Math.min(s,d.length);y++){const b=d[y];a.fillVerticalLine(s-y,o,h+1,b)}for(let y=1;y<Math.min(l,d.length);y++){const b=d[y];a.fillVerticalLine(s+u+y,o,h+1,b)}for(let y=1;y<s;y++){const b=g[y-1],w=s-y;for(let x=1;x<o;x++)a.set(w,o-x,b[x-1]);for(let x=1;x<l;x++)a.set(w,o+h+x,b[x-1])}for(let y=1;y<c;y++){const b=g[y-1],w=s+u+y;for(let x=1;x<o;x++)a.set(w,o-x,b[x-1]);for(let x=1;x<l;x++)a.set(w,o+h+x,b[x-1])}return a}function Sot(n,e,t,r){return{x:n,y:e,width:t,height:r}}function _ot(n,e,t){return{cx:n,cy:e,radius:t}}function Oot(n,e,t,r){return{x1:n,y1:e,x2:t,y2:r}}function Ee(n,e){return{x:n,y:e}}function TB(n,e,t,r){if(n.length===0)return[];const i=Aot(n);return i.map((a,s)=>{const o=i.slice(0,s);return Pot(e,a,o,t,r)}).flat()}function Pot(n,e,t,r,i){const a=Ee(e.cx,e.cy),s=Tot(a,t,n);if(s==null)return[];const o=new Xe(a.x,a.y,s.cx,s.cy),c=Cot(o,n,r,i);return Mot(c,n)}function Cot(n,e,t,r){const i=[],a=[];a.push(n);let s=!0;for(let o=0;o<t&&s;o++)for(s=!1;!s&&a.length>0;){const c=a.pop(),l=AB(e,c),u=l?xot(c,l):null;if(!l||!u||u.count!==2){s||i.push(c);continue}let h=r,f=Rf(l,h,u,!0),d=sa(f,a)||sa(f,i),p=Nf(f,e);for(;!d&&p&&h>=1;)h/=1.5,f=Rf(l,h,u,!0),d=sa(f,a)||sa(f,i),p=Nf(f,e);if(f&&!d&&!p&&(a.push(new Xe(c.x1,c.y1,f.x,f.y)),a.push(new Xe(f.x,f.y,c.x2,c.y2)),s=!0),s)continue;h=r,f=Rf(l,h,u,!1);let g=sa(f,a)||sa(f,i);for(p=Nf(f,e);!g&&p&&h>=1;)h/=1.5,f=Rf(l,h,u,!1),g=sa(f,a)||sa(f,i),p=Nf(f,e);f&&!g&&(a.push(new Xe(c.x1,c.y1,f.x,f.y)),a.push(new Xe(f.x,f.y,c.x2,c.y2)),s=!0),s||i.push(c)}for(;a.length>0;)i.push(a.pop());return i}function Mot(n,e){const t=[];for(;n.length>0;){const r=n.pop();if(n.length===0){t.push(r);break}const i=n.pop(),a=new Xe(r.x1,r.y1,i.x2,i.y2);AB(e,a)?(t.push(r),n.push(i)):n.push(a)}return t}function Tot(n,e,t){let r=Number.POSITIVE_INFINITY;return e.reduce((i,a)=>{const s=wa(n.x,n.y,a.cx,a.cy);if(s>r)return i;const o=new Xe(n.x,n.y,a.cx,a.cy),c=Not(t,o);return s*(c+1)*(c+1)<r&&(i=a,r=s*(c+1)*(c+1)),i},null)}function Aot(n){if(n.length<2)return n;let e=0,t=0;return n.forEach(r=>{e+=r.cx,t+=r.cy}),e/=n.length,t/=n.length,n.map(r=>{const i=e-r.cx,a=t-r.cy,s=i*i+a*a;return[r,s]}).sort((r,i)=>r[1]-i[1]).map(r=>r[0])}function Nf(n,e){return e.some(t=>t.containsPt(n.x,n.y))}function sa(n,e){return e.some(t=>!!(_N(t.x1,t.y1,n.x,n.y,.001)||_N(t.x2,t.y2,n.x,n.y,.001)))}function AB(n,e){let t=Number.POSITIVE_INFINITY,r=null;for(const i of n){if(!PB(i,e))continue;const a=Eot(i,e);a>=0&&a<t&&(r=i,t=a)}return r}function Not(n,e){return n.reduce((t,r)=>PB(r,e)&&bot(r,e)?t+1:t,0)}function Rf(n,e,t,r){const i=t.top,a=t.left,s=t.bottom,o=t.right;if(r){if(a.state===Re.POINT){if(i.state===Re.POINT)return Ee(n.x-e,n.y-e);if(s.state===Re.POINT)return Ee(n.x-e,n.y2+e);const f=n.width*n.height;return n.width*((a.y-n.y+(o.y-n.y))*.5)<f*.5?a.y>o.y?Ee(n.x-e,n.y-e):Ee(n.x2+e,n.y-e):a.y<o.y?Ee(n.x-e,n.y2+e):Ee(n.x2+e,n.y2+e)}if(o.state===Re.POINT){if(i.state===Re.POINT)return Ee(n.x2+e,n.y-e);if(s.state===Re.POINT)return Ee(n.x2+e,n.y2+e)}const u=n.height*n.width;return n.height*((i.x-n.x+(o.x-n.x))*.5)<u*.5?i.x>s.x?Ee(n.x-e,n.y-e):Ee(n.x-e,n.y2+e):i.x<s.x?Ee(n.x2+e,n.y-e):Ee(n.x2+e,n.y2+e)}if(a.state===Re.POINT){if(i.state===Re.POINT)return Ee(n.x2+e,n.y2+e);if(s.state===Re.POINT)return Ee(n.x2+e,n.y-e);const u=n.height*n.width;return n.width*((a.y-n.y+(o.y-n.y))*.5)<u*.5?a.y>o.y?Ee(n.x2+e,n.y2+e):Ee(n.x-e,n.y2+e):a.y<o.y?Ee(n.x2+e,n.y-e):Ee(n.x-e,n.y-e)}if(o.state===Re.POINT){if(i.state===Re.POINT)return Ee(n.x-e,n.y2+e);if(s.state===Re.POINT)return Ee(n.x-e,n.y-e)}const c=n.height*n.width;return n.height*((i.x-n.x+(o.x-n.x))*.5)<c*.5?i.x>s.x?Ee(n.x2+e,n.y2+e):Ee(n.x2+e,n.y-e):i.x<s.x?Ee(n.x-e,n.y2+e):Ee(n.x-e,n.y-e)}function Rot(n,e,t,r){if(!(n.closed?t<n.length:t<n.length-1))return!1;const a=n.get(e),s=n.get(t+1);for(let o=e+1;o<=t;o++){const c=n.get(o);if(t_(a.x,a.y,s.x,s.y,c.x,c.y)>r)return!1}return!0}function kot(n=0){return e=>{if(n<0||e.length<3)return e;const t=[];let r=0;const i=n*n;for(;r<e.length;){let a=r+1;for(;Rot(e,r,a,i);)a++;t.push(e.get(r)),r=a}return new Wa(t)}}function Dot(n,e){switch(n){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function Lot(n=6){function a(s,o,c){let l=0,u=0;for(let h=-2;h<=1;h++){const f=s.get(o+h),d=Dot(h,c);l+=d*f.x,u+=d*f.y}return{x:l,y:u}}return s=>{if(s.length<3)return s;const o=[],c=s.closed,l=s.length+3-1+(c?0:2);o.push(a(s,2-(c?0:2),0));for(let u=2-(c?0:2);u<l;u++)for(let h=1;h<=n;h++)o.push(a(s,u,h/n));return new Wa(o)}}function Iot(n=8){return e=>{let t=n,r=e.length;if(t>1)for(r=Math.floor(e.length/t);r<3&&t>1;)t-=1,r=Math.floor(e.length/t);const i=[];for(let a=0,s=0;s<r;s++,a+=t)i.push(e.get(a));return new Wa(i)}}class Wa{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,r=this.points.length;return e<0?this.closed?this.get(e+r):this.points[0]:e>=r?this.closed?this.get(e-r):this.points[r-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const r=typeof e=="function"?e:yot(e);let i="M";for(const a of t)i+=`${r(a.x)},${r(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const r of t)e.lineTo(r.x,r.y);this.closed&&e.closePath()}}sample(e){return Iot(e)(this)}simplify(e){return kot(e)(this)}bSplines(e){return Lot(e)(this)}apply(e){return e(this)}containsElements(e){const t=CB(this.points);return t?e.every(r=>t.containsPt(r.cx,r.cy)&&this.withinArea(r.cx,r.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let r=0;const i=this.points[0],a=new Xe(i.x,i.y,i.x,i.y);for(let s=1;s<this.points.length;s++){const o=this.points[s];a.x1=a.x2,a.y1=a.y2,a.x2=o.x,a.y2=o.y,a.cuts(e,t)&&r++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(e,t)&&r++,r%2===1}}class Bot{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new Wa(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const Fc=0,kf=1,Df=2,zE=3;function Fot(n,e){const t=(Math.floor(n.width)+Math.floor(n.height))*2,r=new Bot(t);function i(c,l,u,h){const f=n.get(c,l);return Number.isNaN(f)?Number.NaN:f>e?u+h:u}function a(c,l){let u=Fc;return u=i(c,l,u,1),u=i(c+1,l,u,2),u=i(c,l+1,u,4),u=i(c+1,l+1,u,8),Number.isNaN(u)?-1:u}let s=kf;function o(c,l){let u=c,h=l,f=n.invertScaleX(u),d=n.invertScaleY(h);for(let p=0;p<n.width*n.height;p++){const g={x:f,y:d};if(r.contains(g)){if(r.isFirst(g))return!0}else r.add(g);const v=a(u,h);switch(v){case-1:return!0;case 0:case 3:case 2:case 7:s=Df;break;case 12:case 14:case 4:s=zE;break;case 6:s=s===Fc?zE:Df;break;case 1:case 13:case 5:s=Fc;break;case 9:s=s===Df?Fc:kf;break;case 10:case 8:case 11:s=kf;break;default:return console.warn("Marching squares invalid state: "+v),!0}switch(s){case Fc:h--,d-=n.pixelGroup;break;case kf:h++,d+=n.pixelGroup;break;case zE:u--,f-=n.pixelGroup;break;case Df:u++,f+=n.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+v),!0}}return!0}for(let c=0;c<n.width;c++)for(let l=0;l<n.height;l++){if(n.get(c,l)<=e)continue;const u=a(c,l);if(!(u<0||u===15)&&o(c,l))return r.path()}return null}const Ku={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Cu(n){return n!=null&&typeof n.radius=="number"}function ON(n,e){if(Cu(n)!==Cu(e))return!1;if(Cu(n)){const r=e;return n.cx===r.cx&&n.cy===r.cy&&n.radius===r.radius}const t=e;return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}var jr;(function(n){n[n.MEMBERS=0]="MEMBERS",n[n.NON_MEMBERS=1]="NON_MEMBERS",n[n.EDGES=2]="EDGES"})(jr||(jr={}));let Xu=class{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new sn(0,0,0,0),this.potentialArea=new Na(1,0,0,0,0,0,0),this.o=Object.assign({},Ku,e)}pushMember(...e){if(e.length!==0){this.dirty.add(jr.MEMBERS);for(const t of e)this.members.push({raw:t,obj:Cu(t)?Yu.from(t):sn.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(r=>ON(r.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(jr.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(r=>ON(r.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(jr.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(r=>r.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(jr.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(jr.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:Cu(t)?Yu.from(t):sn.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(jr.EDGES);for(const t of e)this.edges.push({raw:t,obj:Xe.from(t),area:null})}}update(){const e=this.dirty.has(jr.MEMBERS),t=this.dirty.has(jr.NON_MEMBERS);let r=this.dirty.has(jr.EDGES);this.dirty.clear();const i=this.members.map(l=>l.obj);if(this.o.virtualEdges&&(e||t)){const l=this.nonMembers.map(f=>f.obj),u=TB(i,l,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(f=>[f.obj.toString(),f.area]));this.virtualEdges=u.map(f=>{var d;return{raw:f,obj:f,area:(d=h.get(f.toString()))!==null&&d!==void 0?d:null}}),r=!0}let a=!1;if(e||r){const l=this.virtualEdges.concat(this.edges).map(d=>d.obj),u=RB(i,l),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,f=sn.from(n_(u,h));f.equals(this.activeRegion)||(a=!0,this.activeRegion=f)}if(a){const l=Math.ceil(this.activeRegion.width/this.o.pixelGroup),u=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Na.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(l!==this.potentialArea.width||u!==this.potentialArea.height)&&(this.potentialArea=Na.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const s=new Map,o=l=>{if(l.area){const u=`${l.obj.width}x${l.obj.height}x${l.obj instanceof sn?"R":"C"}`;s.set(u,l.area)}},c=l=>{if(l.area)return;const u=`${l.obj.width}x${l.obj.height}x${l.obj instanceof sn?"R":"C"}`;if(s.has(u)){const f=s.get(u);l.area=this.potentialArea.copy(f,{x:l.obj.x-this.o.nodeR1,y:l.obj.y-this.o.nodeR1});return}const h=l.obj instanceof sn?MB(l.obj,this.potentialArea,this.o.nodeR1):r_(l.obj,this.potentialArea,this.o.nodeR1);l.area=h,s.set(u,h)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(c),this.nonMembers.forEach(l=>{this.activeRegion.intersects(l.obj)?c(l):l.area=null}),this.edges.forEach(l=>{l.area||(l.area=zw(l.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(l=>{l.area||(l.area=zw(l.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new Wa([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,r=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),a=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),s=this.members.map(o=>o.obj);return NB(t,r,i,a,o=>o.containsElements(s),e)}};function NB(n,e,t,r,i,a={}){const s=Object.assign({},Ku,a);let o=s.threshold,c=s.memberInfluenceFactor,l=s.edgeInfluenceFactor,u=s.nonMemberInfluenceFactor;const h=(s.nodeR0-s.nodeR1)*(s.nodeR0-s.nodeR1),f=(s.edgeR0-s.edgeR1)*(s.edgeR0-s.edgeR1);for(let d=0;d<s.maxMarchingIterations;d++){if(n.clear(),c!==0){const g=c/h;for(const v of e)n.incArea(v,g)}if(l!==0){const g=l/f;for(const v of t)n.incArea(v,g)}if(u!==0){const g=u/h;for(const v of r)n.incArea(v,g)}const p=Fot(n,o);if(p&&i(p))return p;if(o*=.95,d<=s.maxMarchingIterations*.5)c*=1.2,l*=1.2;else if(u!==0&&r.length>0)u*=.8;else break}return new Wa([])}function RB(n,e){if(n.length===0)return new sn(0,0,0,0);const t=sn.from(n[0]);for(const r of n)t.add(r);for(const r of e)t.add(e_(r));return t}function $ot(n,e=[],t=[],r={}){if(n.length===0)return new Wa([]);const i=new Xu(r);return i.pushMember(...n),i.pushNonMember(...e),i.pushEdge(...t),i.compute()}const zot=Object.freeze(Object.defineProperty({__proto__:null,Area:Na,BubbleSets:Xu,Circle:Yu,Line:Xe,PointPath:Wa,Rectangle:sn,addPadding:n_,boundingBox:CB,calculatePotentialOutline:NB,calculateVirtualEdges:TB,circle:_ot,createGenericInfluenceArea:r_,createLineInfluenceArea:zw,createOutline:$ot,createRectangleInfluenceArea:MB,default:Xu,defaultOptions:Ku,line:Oot,lineBoundingBox:e_,point:Ee,rect:Sot,unionBoundingBox:RB},Symbol.toStringTag,{value:"Module"})),Wp=class Wp extends kr{constructor(t,r){super(t,Le({},Wp.defaultOptions,r));A(this,"shape");A(this,"bubbleSets");A(this,"path");A(this,"members",new Map);A(this,"avoidMembers",new Map);A(this,"bubbleSetOptions",{});A(this,"drawBubbleSets",()=>{const{style:t,bubbleSetOptions:r}=this.parseOptions();ve(this.bubbleSetOptions,r)||this.init(),this.bubbleSetOptions={...r};const i={...t,d:this.getPath()};this.shape?this.shape.update(i):(this.shape=new Hd({style:i}),this.context.canvas.appendChild(this.shape))});A(this,"updateBubbleSetsPath",t=>{if(!this.shape)return;const r=Z(t.data);[...this.options.members,...this.options.avoidMembers].includes(r)&&this.shape.update({...this.parseOptions().style,d:this.getPath(r)})});A(this,"getPath",t=>{const{graph:r}=this.context,i=this.options.members,a=[...this.members.keys()],s=this.options.avoidMembers,o=[...this.avoidMembers.keys()];if(!t&&ve(i,a)&&ve(s,o))return this.path;const{enter:c=[],exit:l=[]}=No(a,i,g=>g),{enter:u=[],exit:h=[]}=No(o,s,g=>g);t&&(l.push(t),c.push(t));const f=(g,v,m)=>{g.forEach(y=>{const b=m?this.members:this.avoidMembers,w=m?"pushMember":"pushNonMember",x=m?"removeMember":"removeNonMember";if(v){let S;r.getElementType(y)==="edge"?([S]=qot(r,y),this.bubbleSets.pushEdge(S)):([S]=jot(r,y),this.bubbleSets[w](S)),b.set(y,S)}else{const S=b.get(y);S&&(r.getElementType(y)==="edge"?this.bubbleSets.removeEdge(S):this.bubbleSets[x](S),b.delete(y))}})};f(l,!1,!0),f(c,!0,!0),f(h,!1,!1),f(u,!0,!1);const p=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=FI(p.points.map(Vr)),this.path});this.bindEvents(),this.bubbleSets=new Xu(this.options)}bindEvents(){this.context.graph.on(dt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(dt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new Xu(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const{type:t,key:r,members:i,avoidMembers:a,...s}=this.options,o=Object.keys(s).reduce((c,l)=>(l in Ku?c.bubbleSetOptions[l]=s[l]:c.style[l]=s[l],c),{style:{},bubbleSetOptions:{}});return{type:t,key:r,members:i,avoidMembers:a,...o}}addMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.avoidMembers.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i))),this.options.members=[...new Set([...this.options.members,...r])],this.drawBubbleSets()}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),this.drawBubbleSets()}updateMember(t){this.options.members=ft(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.members.includes(i))&&(this.options.members=this.options.members.filter(i=>!r.includes(i))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...r])],this.drawBubbleSets()}removeAvoidMember(t){const r=Array.isArray(t)?t:[t];this.options.avoidMembers.some(i=>r.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(dt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(dt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}};A(Wp,"defaultOptions",{members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2,...Ku});let jw=Wp;const jot=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getElementRenderBounds(r);return new sn(i.min[0],i.min[1],Ei(i),xi(i))}),qot=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getEdgeData(r),a=n.getElementPosition(i.source),s=n.getElementPosition(i.target);return Xe.from({x1:a[0],y1:a[1],x2:s[0],y2:s[1]})});function Got(n){return`
    <ul class="g6-contextmenu-ul">
      ${n.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const Vot=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`,Hp=class Hp extends kr{constructor(t,r){super(t,Object.assign({},Hp.defaultOptions,r));A(this,"$element");A(this,"onTriggerEvent",t=>{var r;(r=t.preventDefault)==null||r.call(t),this.show(t)});A(this,"onMenuItemClick",t=>{const{onClick:r,trigger:i}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const a=t.target.getAttribute("value");r==null||r(a,t.target),this.hide()}i!=="click"&&this.hide()});this.initElement(),this.update(r)}initElement(){this.$element=_h("contextmenu",!1);const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),Fw("g6-contextmenu-css","style",{},Vot,document.head)}async show(t){const{enable:r,offset:i}=this.options;if(typeof r=="function"&&!r(t)||!r){this.hide();return}const a=await this.getDOMContent(t);a instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(a)):this.$element.innerHTML=a;const s=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-s.left+i[0]}px`,this.$element.style.top=`${t.client.y-s.top+i[1]}px`,this.$element.style.display="block"}hide(){this.$element.style.display="none"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}async getDOMContent(t){const{getContent:r,getItems:i}=this.options;return i?Got(await i(t)):await r(t)}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`canvas:${r}`,this.onTriggerEvent),t.on(`node:${r}`,this.onTriggerEvent),t.on(`edge:${r}`,this.onTriggerEvent),t.on(`combo:${r}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`canvas:${r}`,this.onTriggerEvent),t.off(`node:${r}`,this.onTriggerEvent),t.off(`edge:${r}`,this.onTriggerEvent),t.off(`combo:${r}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}};A(Hp,"defaultOptions",{trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0});let qw=Hp;const Up=class Up extends kr{constructor(t,r){super(t,Object.assign({},Up.defaultOptions,r));A(this,"shortcut");A(this,"style");A(this,"$el",this.context.canvas.getContainer());A(this,"graphSize",[0,0]);A(this,"onFullscreenChange",()=>{var r,i,a,s;const t=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(t),t?(i=(r=this.options).onEnter)==null||i.call(r):(s=(a=this.options).onExit)==null||s.call(a)});this.shortcut=new lc(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:r=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(r,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(a=>{document.addEventListener(a,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(r=>{document.removeEventListener(r,this.onFullscreenChange,!1)})}setGraphSize(t=!0){let r,i;t?(r=window.screen.width,i=window.screen.height,this.graphSize=this.context.graph.getSize()):[r,i]=this.graphSize,this.context.graph.setSize(r,i),this.context.graph.render()}request(){document.fullscreenElement||!Wot()||this.$el.requestFullscreen().catch(t=>{Qi.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}};A(Up,"defaultOptions",{trigger:{},autoFit:!0});let Gw=Up;function Wot(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}const Yp=class Yp extends kr{constructor(t,r){super(t,Object.assign({},Yp.defaultOptions,r));A(this,"$element",_h("grid-line"));A(this,"offset",[0,0]);A(this,"onTransform",t=>{if(!this.options.follow)return;const{data:{translate:r}}=t;r&&this.updateOffset(r)});const i=this.context.canvas.getContainer();mot(i,this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(dt.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:t,stroke:r,lineWidth:i,border:a,borderLineWidth:s,borderStroke:o,borderStyle:c}=this.options;Object.assign(this.$element.style,{border:a?`${s}px ${c} ${o}`:"none",backgroundImage:`linear-gradient(${r} ${i}px, transparent ${i}px), linear-gradient(90deg, ${r} ${i}px, transparent ${i}px)`,backgroundSize:`${t}px ${t}px`})}updateOffset(t){this.offset=MU(qt(this.offset,t),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(dt.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}};A(Yp,"defaultOptions",{border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"});let Vw=Yp;function i_(n){const e={Added:new Map,Updated:new Map,Removed:new Map};return n.forEach(t=>{const{type:r,value:i}=t,a=Z(i);if(r==="NodeAdded"||r==="EdgeAdded"||r==="ComboAdded")e.Added.set(a,t);else if(r==="NodeUpdated"||r==="EdgeUpdated"||r==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:r.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:s}=e.Updated.get(a);e.Updated.set(a,{type:r,value:i,original:s})}else e.Removed.has(a)||e.Updated.set(a,t);else(r==="NodeRemoved"||r==="EdgeRemoved"||r==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function kB(n){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:c=[],ComboRemoved:l=[]}=sh(n,u=>u.type);return{add:{nodes:e,edges:i,combos:o},update:{nodes:t,edges:a,combos:c},remove:{nodes:r,edges:s,combos:l}}}function DB(n,e){for(const t in n)ne(n[t])&&!Array.isArray(n[t])&&n[t]!==null?(e[t]||(e[t]={}),DB(n[t],e[t])):e[t]||(e[t]=jd(t))}function Hot(n,e=!1,t){const r={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:s}=kB(i_(n));return["nodes","edges","combos"].forEach(o=>{a[o]&&a[o].forEach(c=>{var h,f;const l={...c.value};let u={...c.original};if(t){const d=t.graph.getElementType(Z(c.original)),p=d==="edge"?"stroke":"fill",g=t.element.getElementComputedStyle(d,c.original);u={...c.original,style:{[p]:g[p],...c.original.style}}}DB(l,u),(h=r.current.update)[o]||(h[o]=[]),r.current.update[o].push(l),(f=r.original.update)[o]||(f[o]=[]),r.original.update[o].push(u)}),i[o]&&i[o].forEach(c=>{var u,h;const l={...c.value};(u=r.current.add)[o]||(u[o]=[]),r.current.add[o].push(l),(h=r.original.remove)[o]||(h[o]=[]),r.original.remove[o].push(l)}),s[o]&&s[o].forEach(c=>{var u,h;const l={...c.value};(u=r.current.remove)[o]||(u[o]=[]),r.current.remove[o].push(l),(h=r.original.add)[o]||(h[o]=[]),r.original.add[o].push(l)})}),r}const Kp=class Kp extends kr{constructor(t,r){super(t,Object.assign({},Kp.defaultOptions,r));A(this,"emitter");A(this,"batchChanges",null);A(this,"batchAnimation",!1);A(this,"undoStack",[]);A(this,"redoStack",[]);A(this,"freezed",!1);A(this,"executeCommand",(t,r=!0)=>{var a,s,o;this.freezed=!0,(s=(a=this.options).executeCommand)==null||s.call(a,t);const i=r?t.original:t.current;this.context.graph.addData(i.add),this.context.graph.updateData(i.update),this.context.graph.removeData(EI(i.remove,!1)),(o=this.context.element)==null||o.draw({silence:!0,animation:t.animation}),this.freezed=!1});A(this,"addCommand",t=>{var r;if(!this.freezed){if(t.type===dt.AFTER_DRAW){const{dataChanges:i=[],animation:a=!0}=t.data;if((r=this.context.batch)!=null&&r.isBatching){if(!this.batchChanges)return;this.batchChanges.push(i),this.batchAnimation&&(this.batchAnimation=a);return}this.batchChanges=[i],this.batchAnimation=a}this.undoStackPush(Hot(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(da.ADD,this.undoStack[this.undoStack.length-1])}});A(this,"initBatchCommand",t=>{const{initiate:r}=t.data;this.batchAnimation=!1,r?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)});this.emitter=new yh;const{graph:i}=this.context;i.on(dt.AFTER_DRAW,this.addCommand),i.on(dt.BATCH_START,this.initBatchCommand),i.on(dt.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var r,i,a,s;const t=this.undoStack.pop();if(t){if(this.executeCommand(t),((i=(r=this.options).beforeAddCommand)==null?void 0:i.call(r,t,!1))===!1)return;this.redoStack.push(t),(s=(a=this.options).afterAddCommand)==null||s.call(a,t,!1),this.notify(da.UNDO,t)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(da.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(da.CANCEL,t)),this}undoStackPush(t){var a,s,o,c;const{stackSize:r}=this.options;r!==0&&this.undoStack.length>=r&&this.undoStack.shift(),((s=(a=this.options).beforeAddCommand)==null?void 0:s.call(a,t,!0))!==!1&&(this.undoStack.push(t),(c=(o=this.options).afterAddCommand)==null||c.call(o,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(da.CLEAR,null)}notify(t,r){this.emitter.emit(t,{cmd:r}),this.emitter.emit(da.CHANGE,{cmd:r})}on(t,r){this.emitter.on(t,r)}destroy(){const{graph:t}=this.context;t.off(dt.AFTER_DRAW,this.addCommand),t.off(dt.BATCH_START,this.initBatchCommand),t.off(dt.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}};A(Kp,"defaultOptions",{stackSize:0});let Ww=Kp;function Lf(n,e,t,r,i,a){const s=(a-e)*(t-n)-(r-e)*(i-n);return s>0?!0:!(s<0)}function Uot(n,e){const t=n[0][0],r=n[0][1],i=n[1][0],a=n[1][1],s=e[0][0],o=e[0][1],c=e[1][0],l=e[1][1];return Lf(t,r,s,o,c,l)!==Lf(i,a,s,o,c,l)&&Lf(t,r,i,a,s,o)!==Lf(t,r,i,a,c,l)}var Yot=Uot;function LB(n,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(let t=0;t<n.length;t++){const r=n[t],i=this.coordToCellNum(r[0]),a=this.coordToCellNum(r[1]);if(this._cells[i])this._cells[i][a]?this._cells[i][a].push(r):this._cells[i][a]=[r];else{const s=[];s[a]=[r],this._cells[i]=s}}}LB.prototype={cellPoints:function(n,e){return this._cells[n]!==void 0&&this._cells[n][e]!==void 0?this._cells[n][e]:[]},rangePoints:function(n){const e=this.coordToCellNum(n[0]),t=this.coordToCellNum(n[1]),r=this.coordToCellNum(n[2]),i=this.coordToCellNum(n[3]),a=[];for(let s=e;s<=r;s++)for(let o=t;o<=i;o++)for(let c=0;c<this.cellPoints(s,o).length;c++)a.push(this.cellPoints(s,o)[c]);return a},removePoint:function(n){const e=this.coordToCellNum(n[0]),t=this.coordToCellNum(n[1]),r=this._cells[e][t];let i;for(let a=0;a<r.length;a++)if(r[a][0]===n[0]&&r[a][1]===n[1]){i=a;break}return r.splice(i,1),r},trunc:Math.trunc||function(n){return n-n%1},coordToCellNum:function(n){return this.trunc(n*this._reverseCellSize)},extendBbox:function(n,e){return[n[0]-e*this._cellSize,n[1]-e*this._cellSize,n[2]+e*this._cellSize,n[3]+e*this._cellSize]}};function Kot(n,e){return new LB(n,e)}var Xot=Kot,Zot={toXy:function(n,e){return e===void 0?n.slice():n.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(n,e){return e===void 0?n.slice():n.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}};function IB(n,e,t){return(e[0]-n[0])*(t[1]-n[1])-(e[1]-n[1])*(t[0]-n[0])}function Qot(n){const e=[];for(let t=0;t<n.length;t++){for(;e.length>=2&&IB(e[e.length-2],e[e.length-1],n[t])<=0;)e.pop();e.push(n[t])}return e.pop(),e}function Jot(n){const e=n.reverse(),t=[];for(let r=0;r<e.length;r++){for(;t.length>=2&&IB(t[t.length-2],t[t.length-1],e[r])<=0;)t.pop();t.push(e[r])}return t.pop(),t}function tct(n){const e=Qot(n),r=Jot(n).concat(e);return r.push(n[0]),r}var ect=tct;const nct=Yot,rct=Xot,jE=Zot,ict=ect;function act(n){const e=[n[0]];let t=n[0];for(let r=1;r<n.length;r++){const i=n[r];(t[0]!==i[0]||t[1]!==i[1])&&e.push(i),t=i}return e}function sct(n){return n.sort(function(e,t){return e[0]-t[0]||e[1]-t[1]})}function Hw(n,e){return Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2)}function PN(n,e,t){const r=[e[0]-n[0],e[1]-n[1]],i=[t[0]-n[0],t[1]-n[1]],a=Hw(n,e),s=Hw(n,t);return(r[0]*i[0]+r[1]*i[1])/Math.sqrt(a*s)}function CN(n,e){for(let t=0;t<e.length-1;t++){const r=[e[t],e[t+1]];if(!(n[0][0]===r[0][0]&&n[0][1]===r[0][1]||n[0][0]===r[1][0]&&n[0][1]===r[1][1])&&nct(n,r))return!0}return!1}function oct(n){let e=1/0,t=1/0,r=-1/0,i=-1/0;for(let a=n.length-1;a>=0;a--)n[a][0]<e&&(e=n[a][0]),n[a][1]<t&&(t=n[a][1]),n[a][0]>r&&(r=n[a][0]),n[a][1]>i&&(i=n[a][1]);return[r-e,i-t]}function cct(n){return[Math.min(n[0][0],n[1][0]),Math.min(n[0][1],n[1][1]),Math.max(n[0][0],n[1][0]),Math.max(n[0][1],n[1][1])]}function lct(n,e,t){let r=null,i=MN,a=MN,s,o;for(let c=0;c<e.length;c++)s=PN(n[0],n[1],e[c]),o=PN(n[1],n[0],e[c]),s>i&&o>a&&!CN([n[0],e[c]],t)&&!CN([n[1],e[c]],t)&&(i=s,a=o,r=e[c]);return r}function BB(n,e,t,r,i){let a=!1;for(let s=0;s<n.length-1;s++){const o=[n[s],n[s+1]],c=o[0][0]+","+o[0][1]+","+o[1][0]+","+o[1][1];if(Hw(o[0],o[1])<e||i.has(c))continue;let l=0,u=cct(o),h,f,d;do u=r.extendBbox(u,l),h=u[2]-u[0],f=u[3]-u[1],d=lct(o,r.rangePoints(u),n),l++;while(d===null&&(t[0]>h||t[1]>f));h>=t[0]&&f>=t[1]&&i.add(c),d!==null&&(n.splice(s+1,0,d),r.removePoint(d),a=!0)}return a?BB(n,e,t,r,i):n}function uct(n,e,t){let r=e||20;const i=act(sct(jE.toXy(n,t)));if(i.length<4){const h=i.concat([i[0]]);return t?jE.fromXy(h,t):h}const a=oct(i),s=[a[0]*TN,a[1]*TN],o=ict(i),c=i.filter(function(h){return o.indexOf(h)<0}),l=Math.ceil(1/(i.length/(a[0]*a[1]))),u=BB(o,Math.pow(r,2),s,rct(c,l),new Set);return t?jE.fromXy(u,t):u}const MN=Math.cos(90/(180/Math.PI)),TN=.6;var FB=uct;const hct=ah(FB);function fct(n,e,t){if(n.length===1)return dct(n[0],e,t);if(n.length===2)return pct(n,e,t);switch(t){case"smooth":return vct(n,e);case"sharp":return mct(n,e);case"rounded":default:return gct(n,e)}}const dct=(n,e,t)=>{if(t==="sharp")return[["M",n[0]-e,n[1]-e],["L",n[0]+e,n[1]-e],["L",n[0]+e,n[1]+e],["L",n[0]-e,n[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",n[0],n[1]-e],["A",...r,n[0],n[1]+e],["A",...r,n[0],n[1]-e]]},pct=(n,e,t)=>{const r=[e,e,0,0,0],i=t==="sharp"?qt(n[0],ba(Gi(We(n[0],n[1])),e)):n[0],a=t==="sharp"?qt(n[1],ba(Gi(We(n[1],n[0])),e)):n[1],s=ba(Gi(wg(We(i,a),!1)),e),o=ba(s,-1),c=qt(i,s),l=qt(a,s),u=qt(a,o),h=qt(i,o);return t==="sharp"?[["M",c[0],c[1]],["L",l[0],l[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",c[0],c[1]],["L",l[0],l[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,c[0],c[1]]]},gct=(n,e)=>{const t=AI(n).map((o,c)=>{const l=(c-2+n.length)%n.length,u=(c-1+n.length)%n.length,h=(c+1)%n.length,f=n[l],d=n[u],p=n[h],g=We(f,d),v=We(d,o),m=We(o,p),y=(_,E)=>eS(_,E,!0)<Math.PI,b=y(g,v),w=y(v,m),x=_=>ba(Gi(wg(_,!1)),e),S=x(v);return[{p:Zx(b?qt(d,x(g)):qt(d,S)),concave:b&&d},{p:Zx(w?qt(o,x(m)):qt(o,S)),concave:w&&o}]}),r=[e,e,0,0,0],i=t.findIndex((o,c)=>!t[(c-1+t.length)%t.length][0].concave&&!t[(c-1+t.length)%t.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=t.slice(i).concat(t.slice(0,i));let s=[];return a.flatMap((o,c)=>{const l=[],u=a[t.length-1];return c===0&&l.push(["M",...u[1].p]),o[0].concave?s.push(o[0].p,o[1].p):l.push(["A",...r,...o[0].p]),o[1].concave?s.unshift(o[1].p):l.push(["L",...o[1].p]),s.length===3&&(l.pop(),l.push(["C",...s.flat()]),s=[]),l})},vct=(n,e)=>{const t=AI(n).map((r,i)=>{const a=n[(i+1)%n.length];return{p:r,v:Gi(We(a,r))}});return t.forEach((r,i)=>{const a=i>0?i-1:n.length-1,s=t[a].v,o=Gi(qt(s,ba(r.v,eS(s,r.v,!0)<Math.PI?1:-1)));r.p=qt(r.p,ba(o,e))}),FI(t.map(r=>r.p))},mct=(n,e)=>{const r=n.map((a,s)=>{const o=n[s===0?n.length-1:s-1],c=zu(ba(Gi(wg(We(o,a),!1)),e));return[qt(o,c),qt(a,c)]}).flat();return r.map((a,s)=>{if(s%2===0)return null;const o=[r[(s-1)%r.length],r[s%r.length]],c=[r[(s+1)%r.length],r[(s+2)%r.length]];return PI(o,c,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])},Xp=class Xp extends kr{constructor(t,r){super(t,Object.assign({},Xp.defaultOptions,r));A(this,"shape");A(this,"hullMemberIds",[]);A(this,"path");A(this,"optionsCache");A(this,"drawHull",()=>{if(!this.shape)this.shape=new Hd({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const t=!ve(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}this.optionsCache={...this.options}});A(this,"updateHullPath",t=>{this.shape&&this.options.members.includes(Z(t.data))&&this.shape.update({d:this.getHullPath(!0)})});A(this,"getHullPath",(t=!1)=>{const{graph:r}=this.context,i=this.getMember();if(i.length===0)return"";const a=i.map(c=>r.getNodeData(c)),s=hct(a.map(hi),this.options.concavity).slice(1).reverse(),o=s.flatMap(c=>a.filter(l=>ve(hi(l),c)).map(Z));return ve(o,this.hullMemberIds)&&!t?this.path:(this.hullMemberIds=o,this.path=fct(s,this.getPadding(),this.options.corner),this.path)});this.bindEvents()}bindEvents(){this.context.graph.on(dt.AFTER_RENDER,this.drawHull),this.context.graph.on(dt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const{members:r,padding:i,corner:a,...s}=this.options;return{...s,d:this.getHullPath(t)}}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((i,a)=>{const{halfExtents:s}=t.getElementRenderBounds(a),o=Math.max(s[0],s[1]);return Math.max(i,o)},0)+this.options.padding}addMember(t){const r=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...r])],this.shape.update({d:this.getHullPath()})}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),r.some(i=>this.hullMemberIds.includes(i))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=ft(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(dt.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}};A(Xp,"defaultOptions",{members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2});let Uw=Xp;function a_(n,e){e(n),n.children&&n.children.forEach(function(t){t&&a_(t,e)})}function Ha(n){Oh(n,!0)}function xn(n){Oh(n,!1)}function Oh(n,e){var t=e?"visible":"hidden";a_(n,function(r){r.attr("visibility",t)})}var yct=function(n){tt(e,n);function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=n.apply(this,Q([],N(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(vt.INSERTED,function(){xn(i)}),i}return e}(Ze);function s_(n){var e=n.appendChild(new yct({class:"offscreen"}));return xn(e),e}function $B(n){for(var e=n;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}var Ph=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=ie(t,["style"]);return n.call(this,G({style:G({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=s_(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(cc);function Ns(n){return n*Math.PI/180}function o_(n){return Number((n*180/Math.PI).toPrecision(5))}var Xt=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},n.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},n}();function bct(n){var e=n.getRenderBounds(),t=N(e.min,2),r=t[0],i=t[1],a=N(e.max,2),s=a[0],o=a[1],c=s-r,l=o-i;return new Xt(r,i,c,l)}function cr(n,e){return ft(n)?n.apply(void 0,Q([],N(e),!1)):n}var ur=function(n,e){var t=function(i){return"".concat(e,"-").concat(i)},r=Object.fromEntries(Object.entries(n).map(function(i){var a=N(i,2),s=a[0],o=a[1],c=t(o);return[s,{name:c,class:".".concat(c),id:"#".concat(c),toString:function(){return c}}]}));return Object.assign(r,{prefix:t}),r},Ect=5,zB=function(n,e,t,r){t===void 0&&(t=0),r===void 0&&(r=Ect),Object.entries(e).forEach(function(i){var a=N(i,2),s=a[0],o=a[1],c=n;Object.prototype.hasOwnProperty.call(e,s)&&(o?ka(o)?(ka(n[s])||(c[s]={}),t<r?zB(n[s],o,t+1,r):c[s]=e[s]):me(o)?(c[s]=[],c[s]=c[s].concat(o)):c[s]=o:c[s]=o)})},fe=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)zB(n,e[r]);return n},c_=function(n){return n!==void 0&&n!=null&&!Number.isNaN(n)},If,Yw;function xct(n){Yw=n}var jB=N2(function(n,e){var t=e.fontSize,r=e.fontFamily,i=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return Yw?Yw(n,t):(If||(If=K.offscreenCanvasCreator.getOrCreateContext(void 0)),If.font=[a,s,i,"".concat(t,"px"),r].join(" "),If.measureText(n).width)},function(n,e){return[n,Object.values(e||l_(n)).join()].join("")},4096),l_=function(n){var e=n.style.fontFamily||"sans-serif",t=n.style.fontWeight||"normal",r=n.style.fontStyle||"normal",i=n.style.fontVariant,a=n.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:e,fontWeight:t,fontStyle:r,fontVariant:i}};function u_(n){return n.nodeName==="text"?n:n.nodeName==="g"&&n.children.length===1&&n.children[0].nodeName==="text"?n.children[0]:null}function h_(n,e){var t=u_(n);t&&t.attr(e)}function cp(n,e,t){t===void 0&&(t="..."),h_(n,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}function qB(n,e,t,r){t===void 0&&(t=2),r===void 0&&(r="top"),h_(n,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:r})}function Zu(n){var e=n.canvas,t=n.touches,r=n.offsetX,i=n.offsetY;if(e){var a=e.x,s=e.y;return[a,s]}if(t){var o=t[0],c=o.clientX,l=o.clientY;return[c,l]}return r&&i?[r,i]:[0,0]}function mi(n){return typeof n=="function"?n():At(n)||rt(n)?new Ph({style:{text:String(n)}}):n}function Bf(n,e,t,r,i,a){return(n===e||Math.min(n,e)<=i&&i<=Math.max(n,e))&&(t===r||Math.min(t,r)<=a&&a<=Math.max(t,r))}function Ff(n,e,t){var r=n;(!n.length||e<n[0]||e===n[0]&&t<n[1])&&(r[0]=e,r[1]=t)}function GB(n,e,t,r){var i=N(n,2),a=i[0],s=i[1],o=N(e,2),c=o[0],l=o[1],u=N(t,2),h=u[0],f=u[1],d=N(r,2),p=d[0],g=d[1],v=[];if((g-f)*(c-a)===(l-s)*(p-h))(l-s)*(h-a)===(f-s)*(c-a)&&(Bf(a,c,s,l,h,f)&&Ff(v,h,f),Bf(a,c,s,l,p,g)&&Ff(v,p,g),Bf(h,p,f,g,a,s)&&Ff(v,a,s),Bf(h,p,f,g,c,l)&&Ff(v,c,l));else{var m=(h*(g-f)+s*(p-h)-f*(p-h)-a*(g-f))/((c-a)*(g-f)-(p-h)*(l-s)),y=(a*(l-s)+f*(c-a)-s*(c-a)-h*(l-s))/((p-h)*(l-s)-(c-a)*(g-f));m>=0&&m<=1&&y>=0&&y<=1&&(v[0]=a+m*(c-a),v[1]=s+m*(l-s))}return v}function Kw(n,e){var t=N(n,2),r=t[0],i=t[1],a=N(e,2),s=a[0],o=a[1];return Math.pow(Math.pow(r-s,2)+Math.pow(i-o,2),.5)}function VB(n,e){return n.reduce(function(t,r){return(t[r[e]]=t[r[e]]||[]).push(r),t},{})}function WB(n){var e=document.createElement("div");return e.innerHTML=n,e.firstChild}function wct(n){return typeof n=="string"?WB(n):n}function Nn(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),n?t(e):(r&&i(e),null)}function Qe(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&n===e||i&&n===t?!0:n>e&&n<t}var HB=function(n,e){return function(t){return n*(1-t)+e*t}};function UB(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0;return function(i){var a=new Array(r),s=new Array(t),o=0;for(o=0;o<r;++o)a[o]=t0(n[o],e[o]);for(;o<t;++o)s[o]=e[o];for(o=0;o<r;++o)s[o]=a[o](i);return s}}function YB(n,e){n===void 0&&(n={}),e===void 0&&(e={});var t={},r={};return Object.entries(e).forEach(function(i){var a=N(i,2),s=a[0],o=a[1];s in n?t[s]=t0(n[s],o):r[s]=o}),function(i){return Object.entries(t).forEach(function(a){var s=N(a,2),o=s[0],c=s[1];return r[o]=c(i)}),r}}function t0(n,e){return typeof n=="number"&&typeof e=="number"?HB(n,e):Array.isArray(n)&&Array.isArray(e)?UB(n,e):typeof n=="object"&&typeof e=="object"?YB(n,e):function(t){return n}}function KB(n,e,t,r){if(!r)return n.attr("__keyframe_data__",t),null;var i=r.duration,a=i===void 0?0:i,s=t0(e,t),o=Math.ceil(+a/16),c=new Array(o).fill(0).map(function(l,u,h){return{__keyframe_data__:s(u/(h.length-1))}});return n.animate(c,G({fill:"both"},r))}function AN(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,a=0;a<n.length;a++){var s=n[a],o=s.x,c=s.y,l=s.width,u=s.height,h=N([o+l,c+u],2),f=h[0],d=h[1];o<e&&(e=o),c<t&&(t=c),f>r&&(r=f),d>i&&(i=d)}return new Xt(e,t,r-e,i-t)}var XB=function(n,e,t){var r=n.width,i=n.height,a=t.flexDirection,s=a===void 0?"row":a;t.flexWrap;var o=t.justifyContent,c=o===void 0?"flex-start":o;t.alignContent;var l=t.alignItems,u=l===void 0?"flex-start":l,h=s==="row",f=s==="row"||s==="column",d=h?f?[1,0]:[-1,0]:f?[0,1]:[0,-1],p=N([0,0],2),g=p[0],v=p[1],m=e.map(function(E){var P,O=E.width,C=E.height,M=N([g,v],2),T=M[0],R=M[1];return P=N([g+O*d[0],v+C*d[1]],2),g=P[0],v=P[1],new Xt(T,R,O,C)}),y=AN(m),b={"flex-start":0,"flex-end":h?r-y.width:i-y.height,center:h?(r-y.width)/2:(i-y.height)/2},w=m.map(function(E){var P=E.x,O=E.y,C=Xt.fromRect(E);return C.x=h?P+b[c]:P,C.y=h?O:O+b[c],C});AN(w);var x=function(E){var P=N(h?["height",i]:["width",r],2),O=P[0],C=P[1];switch(u){case"flex-start":return 0;case"flex-end":return C-E[O];case"center":return C/2-E[O]/2;default:return 0}},S=w.map(function(E){var P=E.x,O=E.y,C=Xt.fromRect(E);return C.x=h?P:P+x(C),C.y=h?O+x(C):O,C}),_=S.map(function(E){var P,O,C=Xt.fromRect(E);return C.x+=(P=n.x)!==null&&P!==void 0?P:0,C.y+=(O=n.y)!==null&&O!==void 0?O:0,C});return _},ZB=function(n,e,t){return[]};const QB=function(n,e,t){if(e.length===0)return[];var r={flex:XB,grid:ZB},i=t.display in r?r[t.display]:null;return(i==null?void 0:i.call(null,n,e,t))||[]};function Wr(n,e){return[n[0]*e,n[1]*e]}function wo(n,e){return[n[0]+e[0],n[1]+e[1]]}function fd(n,e){return[n[0]-e[0],n[1]-e[1]]}function ua(n,e){return[Math.min(n[0],e[0]),Math.min(n[1],e[1])]}function ha(n,e){return[Math.max(n[0],e[0]),Math.max(n[1],e[1])]}function Qo(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2))}function f_(n){if(n[0]===0&&n[1]===0)return[0,0];var e=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));return[n[0]/e,n[1]/e]}function JB(n,e,t){var r=N(n,2),i=r[0],a=r[1],s=N(e,2),o=s[0],c=s[1],l=i-o,u=a-c,h=Math.sin(t),f=Math.cos(t);return[l*f-u*h+o,l*h+u*f+c]}function t8(n,e){return e?[n[1],-n[0]]:[-n[1],n[0]]}function Qu(n,e){return+n.toPrecision(e)}function Sct(n){return n.toLocaleString()}function _ct(n){return n.toExponential()}function Oct(n,e){return e===void 0&&(e=0),Math.abs(n)<1e3?String(n):"".concat(Qu(n/1e3,e).toLocaleString(),"K")}var Pct=function(n,e,t){return n<0&&Number.isFinite(n)?e:t},Cct=function(n,e,t){return n>0&&Number.isFinite(n)?e:t},Mct=function(n,e){return n*e},Tct=function(n,e){return n/2+(e||0)/2};function Xw(n,e){var t={},r=Array.isArray(e)?e:[e];for(var i in n)r.includes(i)||(t[i]=n[i]);return t}function Act(n,e,t,r){var i,a=[],s=!!r,o,c,l=[1/0,1/0],u=[-1/0,-1/0],h,f,d;if(s){i=N(r,2),l=i[0],u=i[1];for(var p=0,g=n.length;p<g;p+=1){var v=n[p];l=ua(l,v),u=ha(u,v)}}for(var p=0,m=n.length;p<m;p+=1){var v=n[p];if(p===0&&!t)d=v;else if(p===m-1&&!t)f=v,a.push(d),a.push(f);else{var y=[p?p-1:m-1,p-1][t?0:1];o=n[y],c=n[t?(p+1)%m:p+1];var b=[0,0];b=fd(c,o),b=Wr(b,e);var w=Qo(v,o),x=Qo(v,c),S=w+x;S!==0&&(w/=S,x/=S);var _=Wr(b,-w),E=Wr(b,x);f=wo(v,_),h=wo(v,E),h=ua(h,ha(c,v)),h=ha(h,ua(c,v)),_=fd(h,v),_=Wr(_,-w/x),f=wo(v,_),f=ua(f,ha(o,v)),f=ha(f,ua(o,v)),E=fd(v,f),E=Wr(E,x/w),h=wo(v,E),s&&(f=ha(f,l),f=ua(f,u),h=ha(h,l),h=ua(h,u)),a.push(d),a.push(f),d=h}}return t&&a.push(a.shift()),a}function e8(n,e,t){var r;e===void 0&&(e=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var i=!!e,a=[],s=0,o=n.length;s<o;s+=2)a.push([n[s],n[s+1]]);for(var c=Act(a,.4,i,t),l=a.length,u=[],h,f,d,s=0;s<l-1;s+=1)h=c[s*2],f=c[s*2+1],d=a[s+1],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]]);return i&&(h=c[l],f=c[l+1],r=N(a,1),d=r[0],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]])),u}var n8=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function r8(n){return n8.includes(n)}function Zw(n){var e={};for(var t in n)r8(t)&&(e[t]=n[t]);return e}function i8(n,e){if(n.length<=e)return n;for(var t=Math.floor(n.length/e),r=[],i=0;i<n.length;i+=t)r.push(n[i]);return r}function e0(n,e,t){t===void 0&&(t=!1);var r=n.getBBox(),i=r.width,a=r.height,s=e/Math.max(i,a);return t&&(n.style.transform="scale(".concat(s,")")),s}function Nct(n,e){var t=new Map;return n.forEach(function(r){var i=e(r);t.has(i)||t.set(i,[]),t.get(i).push(r)}),t}function Rct(n){throw new Error(n)}var a8=function(){function n(i,a,s,o,c,l,u){i===void 0&&(i=null),a===void 0&&(a=null),s===void 0&&(s=null),o===void 0&&(o=null),c===void 0&&(c=[null,null,null,null,null]),l===void 0&&(l=[]),u===void 0&&(u=[]),e.add(this),this._elements=Array.from(i),this._data=a,this._parent=s,this._document=o,this._enter=c[0],this._update=c[1],this._exit=c[2],this._merge=c[3],this._split=c[4],this._transitions=l,this._facetElements=u}n.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(a,null,this._elements[0],this._document)},n.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,a)},n.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([a],null,a,this._document)},n.prototype.append=function(i){var a=this,s=typeof i=="function"?i:function(){return a.createElement(i)},o=[];if(this._data!==null){for(var c=0;c<this._data.length;c++){var l=this._data[c],u=N(Array.isArray(l)?l:[l,null],2),h=u[0],f=u[1],d=s(h,c);d.__data__=h,f!==null&&(d.__fromElements__=f),this._parent.appendChild(d),o.push(d)}return new t(o,null,this._parent,this._document)}for(var c=0;c<this._elements.length;c++){var p=this._elements[c],h=p.__data__,d=s(h,c);p.appendChild(d),o.push(d)}return new t(o,null,o[0],this._document)},n.prototype.maybeAppend=function(i,a){var s=cv(this,e,"m",r).call(this,i[0]==="#"?i:"#".concat(i),a);return s.attr("id",i),s},n.prototype.maybeAppendByClassName=function(i,a){var s=i.toString(),o=cv(this,e,"m",r).call(this,s[0]==="."?s:".".concat(s),a);return o.attr("className",s),o},n.prototype.maybeAppendByName=function(i,a){var s=cv(this,e,"m",r).call(this,'[name="'.concat(i,'"]'),a);return s.attr("name",i),s},n.prototype.data=function(i,a,s){var o,c;a===void 0&&(a=function(O){return O}),s===void 0&&(s=function(){return null});for(var l=[],u=[],h=new Set(this._elements),f=[],d=new Set,p=new Map(this._elements.map(function(O,C){return[a(O.__data__,C),O]})),g=new Map(this._facetElements.map(function(O,C){return[a(O.__data__,C),O]})),v=Nct(this._elements,function(O){return s(O.__data__)}),m=0;m<i.length;m++){var y=i[m],b=a(y,m),w=s(y,m);if(p.has(b)){var x=p.get(b);x.__data__=y,x.__facet__=!1,u.push(x),h.delete(x),p.delete(b)}else if(g.has(b)){var x=g.get(b);x.__data__=y,x.__facet__=!0,u.push(x),g.delete(b)}else if(v.has(b)){var S=v.get(b);f.push([y,S]);try{for(var _=(o=void 0,er(S)),E=_.next();!E.done;E=_.next()){var x=E.value;h.delete(x)}}catch(O){o={error:O}}finally{try{E&&!E.done&&(c=_.return)&&c.call(_)}finally{if(o)throw o.error}}v.delete(b)}else if(p.has(w)){var x=p.get(w);x.__toData__?x.__toData__.push(y):x.__toData__=[y],d.add(x),h.delete(x)}else l.push(y)}var P=[new t([],l,this._parent,this._document),new t(u,null,this._parent,this._document),new t(h,null,this._parent,this._document),new t([],f,this._parent,this._document),new t(d,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,P)},n.prototype.merge=function(i){var a=Q(Q([],N(this._elements),!1),N(i._elements),!1),s=Q(Q([],N(this._transitions),!1),N(i._transitions),!1);return new t(a,null,this._parent,this._document,void 0,s)},n.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=t.registry[i];return a?new a:Rct("Unknown node type: ".concat(i))},n.prototype.join=function(i,a,s,o,c){i===void 0&&(i=function(p){return p}),a===void 0&&(a=function(p){return p}),s===void 0&&(s=function(p){return p.remove()}),o===void 0&&(o=function(p){return p}),c===void 0&&(c=function(p){return p.remove()});var l=i(this._enter),u=a(this._update),h=s(this._exit),f=o(this._merge),d=c(this._split);return u.merge(l).merge(h).merge(f).merge(d)},n.prototype.remove=function(){for(var i=function(o){var c=a._elements[o],l=a._transitions[o];l?l.then(function(){return c.remove()}):c.remove()},a=this,s=0;s<this._elements.length;s++)i(s);return new t([],null,this._parent,this._document,void 0,this._transitions)},n.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var s=this._elements[a],o=s.__data__;i.call(s,o,a)}return this},n.prototype.attr=function(i,a){var s=typeof a!="function"?function(){return a}:a;return this.each(function(o,c){a!==void 0&&(this[i]=s.call(this,o,c))})},n.prototype.style=function(i,a,s){s===void 0&&(s=!0);var o=typeof a!="function"||!s?function(){return a}:a;return this.each(function(c,l){a!==void 0&&(this.style[i]=o.call(this,c,l))})},n.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(s,o){var c=this;Object.entries(i).forEach(function(l){var u=N(l,2),h=u[0],f=u[1],d=typeof f!="function"||!a?function(){return f}:f;f!==void 0&&c.attr(h,d.call(c,s,o))})})},n.prototype.update=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,c){i&&this.update&&this.update(s.call(this,o,c))})},n.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,c){i&&this.update&&this.update(s.call(this,o,c))})},n.prototype.transition=function(i){var a=this._transitions;return this.each(function(s,o){a[o]=i.call(this,s,o)})},n.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},n.prototype.call=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return i.call.apply(i,Q([this._parent,this],N(a),!1)),this},n.prototype.node=function(){return this._elements[0]},n.prototype.nodes=function(){return this._elements},n.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},n.prototype.parent=function(){return this._parent};var e,t,r;return t=n,e=new WeakSet,r=function(a,s){var o=this._elements[0],c=o.querySelector(a);if(c)return new t([c],null,this._parent,this._document);var l=typeof s=="string"?this.createElement(s):s();return o.appendChild(l),new t([l],null,this._parent,this._document)},n.registry={g:Ze,rect:kn,circle:Zi,path:Yr,text:Ph,ellipse:mg,image:Ds,line:bg,polygon:dh,polyline:W2,html:yg},n}();function ot(n){return new a8([n],null,n,n.ownerDocument)}function Ur(n,e,t){return n.querySelector(e)?ot(n).select(e):ot(n).append(t)}function xe(n){if(rt(n))return[n,n,n,n];if(me(n)){var e=n.length;if(e===1)return[n[0],n[0],n[0],n[0]];if(e===2)return[n[0],n[1],n[0],n[1]];if(e===3)return[n[0],n[1],n[2],n[1]];if(e===4)return n}return[0,0,0,0]}function s8(n){var e=n&&n.getRenderBounds();if(!e)return{width:0,height:0};var t=e.getMax(),r=e.getMin();return{width:t[0]-r[0],height:t[1]-r[1]}}function Qw(n){var e=n.getLocalBounds(),t=e.min,r=e.max,i=N([t,r],2),a=N(i[0],2),s=a[0],o=a[1],c=N(i[1],2),l=c[0],u=c[1];return{x:s,y:o,width:l-s,height:u-o,left:s,bottom:u,top:o,right:l}}function kct(n,e){var t=ot(n).append("text").node();return t.attr(G(G({},e),{visibility:"hidden"})),t}function o8(n,e){var t=N(n,2),r=t[0],i=t[1],a=N(e,2),s=a[0],o=a[1];return r!==s&&i===o}function Dct(n,e){var t=N(n,2),r=t[0],i=t[1],a=N(e,2),s=a[0],o=a[1];return r===s&&i!==o}function c8(n,e){var t,r,i=e.attributes;try{for(var a=er(Object.entries(i)),s=a.next();!s.done;s=a.next()){var o=N(s.value,2),c=o[0],l=o[1];c!=="id"&&c!=="className"&&n.attr(c,l)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}function n0(n){return n.toString().charAt(0).toUpperCase()+n.toString().slice(1)}function l8(n){return n.toString().charAt(0).toLowerCase()+n.toString().slice(1)}function u8(n,e){return"".concat(e).concat(n0(n))}function Jw(n,e,t){var r;t===void 0&&(t=!0);var i=e||((r=n.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",a=n.replace(new RegExp("^(".concat(i,")")),"");return t?l8(a):a}function h8(n,e){Object.entries(e).forEach(function(t){var r=N(t,2),i=r[0],a=r[1];Q([n],N(n.querySelectorAll(i)),!1).filter(function(s){return s.matches(i)}).forEach(function(s){if(s){var o=s;o.style.cssText+=Object.entries(a).reduce(function(c,l){return"".concat(c).concat(l.join(":"),";")},"")}})})}var $f=function(n,e){if(!(n!=null&&n.startsWith(e)))return!1;var t=n[e.length];return t>="A"&&t<="Z"};function pt(n,e,t){t===void 0&&(t=!1);var r={};return Object.entries(n).forEach(function(i){var a=N(i,2),s=a[0],o=a[1];if(!(s==="className"||s==="class")){if($f(s,"show")&&$f(Jw(s,"show"),e)!==t)s===u8(e,"show")?r[s]=o:r[s.replace(new RegExp(n0(e)),"")]=o;else if(!$f(s,"show")&&$f(s,e)!==t){var c=Jw(s,e);c==="filter"&&typeof o=="function"||(r[c]=o)}}}),r}function Pr(n,e){return Object.entries(n).reduce(function(t,r){var i=N(r,2),a=i[0],s=i[1];return a.startsWith("show")?t["show".concat(e).concat(a.slice(4))]=s:t["".concat(e).concat(n0(a))]=s,t},{})}function yi(n,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(n).forEach(function(a){var s=N(a,2),o=s[0],c=s[1];e.includes(o)||(t.indexOf(o)!==-1?i[o]=c:r[o]=c)}),[r,i]}function Lct(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function Jo(n,e,t,r){this.message=n,this.expected=e,this.found=t,this.location=r,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Jo)}Lct(Jo,Error);Jo.buildMessage=function(n,e){var t={literal:function(l){return'"'+i(l.text)+'"'},class:function(l){var u="",h;for(h=0;h<l.parts.length;h++)u+=l.parts[h]instanceof Array?a(l.parts[h][0])+"-"+a(l.parts[h][1]):a(l.parts[h]);return"["+(l.inverted?"^":"")+u+"]"},any:function(l){return"any character"},end:function(l){return"end of input"},other:function(l){return l.description}};function r(l){return l.charCodeAt(0).toString(16).toUpperCase()}function i(l){return l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+r(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+r(u)})}function a(l){return l.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+r(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+r(u)})}function s(l){return t[l.type](l)}function o(l){var u=new Array(l.length),h,f;for(h=0;h<l.length;h++)u[h]=s(l[h]);if(u.sort(),u.length>0){for(h=1,f=1;h<u.length;h++)u[h-1]!==u[h]&&(u[f]=u[h],f++);u.length=f}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function c(l){return l?'"'+i(l)+'"':"end of input"}return"Expected "+o(n)+" but "+c(e)+" found."};function Ict(n,e){e=e!==void 0?e:{};var t={},r={svg_path:Br},i=Br,a=function(k){if(!k)return[];for(var I=[],q=0;q<k.length;q++)I=I.concat.apply(I,k[q]);var F=I[0];return F&&F.code=="m"&&(delete F.relative,F.code="M"),I},s=function(k,I){return AF(k,I)},o=/^[Mm]/,c=ye(["M","m"],!1,!1),l=function(k,I,q){var F=Zs(k,[I]);return q&&(F=F.concat(Zs(k=="M"?"L":"l",q[1]))),F},u=/^[Zz]/,h=ye(["Z","z"],!1,!1),f=function(){return Zs("Z")},d=/^[Ll]/,p=ye(["L","l"],!1,!1),g=function(k,I){return Zs(k,I)},v=/^[Hh]/,m=ye(["H","h"],!1,!1),y=function(k,I){return Zs(k,I.map(function(q){return{x:q}}))},b=/^[Vv]/,w=ye(["V","v"],!1,!1),x=function(k,I){return Zs(k,I.map(function(q){return{y:q}}))},S=/^[Cc]/,_=ye(["C","c"],!1,!1),E=function(k,I,q){return{x1:k.x,y1:k.y,x2:I.x,y2:I.y,x:q.x,y:q.y}},P=/^[Ss]/,O=ye(["S","s"],!1,!1),C=function(k,I){return{x2:k.x,y2:k.y,x:I.x,y:I.y}},M=/^[Qq]/,T=ye(["Q","q"],!1,!1),R=function(k,I){return{x1:k.x,y1:k.y,x:I.x,y:I.y}},D=/^[Tt]/,B=ye(["T","t"],!1,!1),j=/^[Aa]/,L=ye(["A","a"],!1,!1),$=function(k,I,q,F,H,et){return{rx:k,ry:I,xAxisRotation:q,largeArc:F,sweep:H,x:et.x,y:et.y}},V=function(k,I){return{x:k,y:I}},W=function(k){return k*1},Y=function(k){return k.join("")*1},U=/^[01]/,J=ye(["0","1"],!1,!1),at=function(k){return k=="1"},ht=function(){return""},lt=",",Nt=gr(",",!1),pe=function(k){return k.join("")},Be=".",nn=gr(".",!1),ri=/^[eE]/,Ya=ye(["e","E"],!1,!1),Ka=/^[+\-]/,Ht=ye(["+","-"],!1,!1),dr=/^[0-9]/,$t=ye([["0","9"]],!1,!1),Lr=function(k){return k.join("")},Ir=/^[ \t\n\r]/,ia=ye([" ","	",`
`,"\r"],!1,!1),z=0,dn=[{line:1,column:1}],ce=0,Kn=[],pr;if("startRule"in e){if(!(e.startRule in r))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');i=r[e.startRule]}function gr(k,I){return{type:"literal",text:k,ignoreCase:I}}function ye(k,I,q){return{type:"class",parts:k,inverted:I,ignoreCase:q}}function ii(){return{type:"end"}}function Xa(k){var I=dn[k],q;if(I)return I;for(q=k-1;!dn[q];)q--;for(I=dn[q],I={line:I.line,column:I.column};q<k;)n.charCodeAt(q)===10?(I.line++,I.column=1):I.column++,q++;return dn[k]=I,I}function Za(k,I){var q=Xa(k),F=Xa(I);return{start:{offset:k,line:q.line,column:q.column},end:{offset:I,line:F.line,column:F.column}}}function Ce(k){z<ce||(z>ce&&(ce=z,Kn=[]),Kn.push(k))}function zh(k,I,q){return new Jo(Jo.buildMessage(k,I),k,I,q)}function Br(){var k,I,q,F,H;for(k=z,I=[],q=Bt();q!==t;)I.push(q),q=Bt();if(I!==t)if(q=Ci(),q===t&&(q=null),q!==t){for(F=[],H=Bt();H!==t;)F.push(H),H=Bt();F!==t?(I=a(q),k=I):(z=k,k=t)}else z=k,k=t;else z=k,k=t;return k}function Ci(){var k,I,q,F,H,et;if(k=z,I=L0(),I!==t){for(q=[],F=z,H=[],et=Bt();et!==t;)H.push(et),et=Bt();for(H!==t?(et=L0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;){for(q.push(F),F=z,H=[],et=Bt();et!==t;)H.push(et),et=Bt();H!==t?(et=L0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t)}q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function L0(){var k,I,q,F,H,et;if(k=z,I=pF(),I!==t){for(q=[],F=z,H=[],et=Bt();et!==t;)H.push(et),et=Bt();for(H!==t?(et=Q_(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;){for(q.push(F),F=z,H=[],et=Bt();et!==t;)H.push(et),et=Bt();H!==t?(et=Q_(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t)}q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function Q_(){var k;return k=gF(),k===t&&(k=vF(),k===t&&(k=mF(),k===t&&(k=yF(),k===t&&(k=bF(),k===t&&(k=xF(),k===t&&(k=SF(),k===t&&(k=OF(),k===t&&(k=CF())))))))),k}function pF(){var k,I,q,F,H,et,Qs;if(k=z,o.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(c)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=On(),F!==t?(H=z,et=we(),et===t&&(et=null),et!==t?(Qs=J_(),Qs!==t?(et=[et,Qs],H=et):(z=H,H=t)):(z=H,H=t),H===t&&(H=null),H!==t?(I=l(I,F,H),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function gF(){var k,I;return k=z,u.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(h)),I!==t&&(I=f()),k=I,k}function vF(){var k,I,q,F;if(k=z,d.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(p)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=J_(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function J_(){var k,I,q,F,H,et;if(k=z,I=On(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=On(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=On(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function mF(){var k,I,q,F;if(k=z,v.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(m)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=t3(),F!==t?(I=y(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function t3(){var k,I,q,F,H,et;if(k=z,I=Xs(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=Xs(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=Xs(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function yF(){var k,I,q,F;if(k=z,b.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(w)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=t3(),F!==t?(I=x(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function bF(){var k,I,q,F;if(k=z,S.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(_)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=EF(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function EF(){var k,I,q,F,H,et;if(k=z,I=I0(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=I0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=I0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function I0(){var k,I,q,F,H,et;return k=z,I=On(),I!==t?(q=we(),q===t&&(q=null),q!==t?(F=On(),F!==t?(H=we(),H===t&&(H=null),H!==t?(et=On(),et!==t?(I=E(I,F,et),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t),k}function xF(){var k,I,q,F;if(k=z,P.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(O)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=wF(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function wF(){var k,I,q,F,H,et;if(k=z,I=B0(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=B0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=B0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function B0(){var k,I,q,F;return k=z,I=On(),I!==t?(q=we(),q===t&&(q=null),q!==t?(F=On(),F!==t?(I=C(I,F),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t),k}function SF(){var k,I,q,F;if(k=z,M.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(T)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=_F(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function _F(){var k,I,q,F,H,et;if(k=z,I=F0(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=F0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=F0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function F0(){var k,I,q,F;return k=z,I=On(),I!==t?(q=we(),q===t&&(q=null),q!==t?(F=On(),F!==t?(I=R(I,F),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t),k}function OF(){var k,I,q,F;if(k=z,D.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(B)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=PF(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function PF(){var k,I,q,F,H,et;if(k=z,I=On(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=On(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=On(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function CF(){var k,I,q,F;if(k=z,j.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(L)),I!==t){for(q=[],F=Bt();F!==t;)q.push(F),F=Bt();q!==t?(F=MF(),F!==t?(I=g(I,F),k=I):(z=k,k=t)):(z=k,k=t)}else z=k,k=t;return k}function MF(){var k,I,q,F,H,et;if(k=z,I=$0(),I!==t){for(q=[],F=z,H=we(),H===t&&(H=null),H!==t?(et=$0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);F!==t;)q.push(F),F=z,H=we(),H===t&&(H=null),H!==t?(et=$0(),et!==t?(H=[H,et],F=H):(z=F,F=t)):(z=F,F=t);q!==t?(I=s(I,q),k=I):(z=k,k=t)}else z=k,k=t;return k}function $0(){var k,I,q,F,H,et,Qs,j0,qh,q0,Gh,G0;return k=z,I=e3(),I!==t?(q=we(),q===t&&(q=null),q!==t?(F=e3(),F!==t?(H=we(),H===t&&(H=null),H!==t?(et=Xs(),et!==t?(Qs=we(),Qs!==t?(j0=n3(),j0!==t?(qh=we(),qh===t&&(qh=null),qh!==t?(q0=n3(),q0!==t?(Gh=we(),Gh===t&&(Gh=null),Gh!==t?(G0=On(),G0!==t?(I=$(I,F,et,j0,q0,G0),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t)):(z=k,k=t),k}function On(){var k,I,q,F;return k=z,I=Xs(),I!==t?(q=we(),q===t&&(q=null),q!==t?(F=Xs(),F!==t?(I=V(I,F),k=I):(z=k,k=t)):(z=k,k=t)):(z=k,k=t),k}function e3(){var k,I;return k=z,I=i3(),I===t&&(I=Qa()),I!==t&&(I=W(I)),k=I,k}function Xs(){var k,I,q,F;return k=z,I=z,q=z0(),q===t&&(q=null),q!==t?(F=i3(),F!==t?(q=[q,F],I=q):(z=I,I=t)):(z=I,I=t),I===t&&(I=z,q=z0(),q===t&&(q=null),q!==t?(F=Qa(),F!==t?(q=[q,F],I=q):(z=I,I=t)):(z=I,I=t)),I!==t&&(I=Y(I)),k=I,k}function n3(){var k,I;return k=z,U.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(J)),I!==t&&(I=at(I)),k=I,k}function we(){var k,I,q,F,H;if(k=z,I=[],q=Bt(),q!==t)for(;q!==t;)I.push(q),q=Bt();else I=t;if(I!==t)if(q=r3(),q===t&&(q=null),q!==t){for(F=[],H=Bt();H!==t;)F.push(H),H=Bt();F!==t?(I=[I,q,F],k=I):(z=k,k=t)}else z=k,k=t;else z=k,k=t;if(k===t){if(k=z,I=z,q=r3(),q!==t){for(F=[],H=Bt();H!==t;)F.push(H),H=Bt();F!==t?(q=[q,F],I=q):(z=I,I=t)}else z=I,I=t;I!==t&&(I=ht()),k=I}return k}function r3(){var k;return n.charCodeAt(z)===44?(k=lt,z++):(k=t,Ce(Nt)),k}function i3(){var k,I,q,F;return k=z,I=z,q=TF(),q!==t?(F=a3(),F===t&&(F=null),F!==t?(q=[q,F],I=q):(z=I,I=t)):(z=I,I=t),I===t&&(I=z,q=Qa(),q!==t?(F=a3(),F!==t?(q=[q,F],I=q):(z=I,I=t)):(z=I,I=t)),I!==t&&(I=pe(I)),k=I,k}function TF(){var k,I,q,F,H;return k=z,I=z,q=Qa(),q===t&&(q=null),q!==t?(n.charCodeAt(z)===46?(F=Be,z++):(F=t,Ce(nn)),F!==t?(H=Qa(),H!==t?(q=[q,F,H],I=q):(z=I,I=t)):(z=I,I=t)):(z=I,I=t),I===t&&(I=z,q=Qa(),q!==t?(n.charCodeAt(z)===46?(F=Be,z++):(F=t,Ce(nn)),F!==t?(q=[q,F],I=q):(z=I,I=t)):(z=I,I=t)),I!==t&&(I=pe(I)),k=I,k}function a3(){var k,I,q,F,H;return k=z,I=z,ri.test(n.charAt(z))?(q=n.charAt(z),z++):(q=t,Ce(Ya)),q!==t?(F=z0(),F===t&&(F=null),F!==t?(H=Qa(),H!==t?(q=[q,F,H],I=q):(z=I,I=t)):(z=I,I=t)):(z=I,I=t),I!==t&&(I=pe(I)),k=I,k}function z0(){var k;return Ka.test(n.charAt(z))?(k=n.charAt(z),z++):(k=t,Ce(Ht)),k}function Qa(){var k,I,q;if(k=z,I=[],dr.test(n.charAt(z))?(q=n.charAt(z),z++):(q=t,Ce($t)),q!==t)for(;q!==t;)I.push(q),dr.test(n.charAt(z))?(q=n.charAt(z),z++):(q=t,Ce($t));else I=t;return I!==t&&(I=Lr(I)),k=I,k}function Bt(){var k,I;return k=z,Ir.test(n.charAt(z))?(I=n.charAt(z),z++):(I=t,Ce(ia)),I!==t&&(I=ht()),k=I,k}function AF(k,I){if(!I)return[k];for(var q=[k],F=0,H=I.length;F<H;F++)q[F+1]=I[F][1];return q}var jh={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var s3 in jh)jh[s3.toUpperCase()]=jh[s3];function Zs(k,I){I||(I=[{}]);for(var q=I.length;q--;){var F={code:k,command:jh[k]};k==k.toLowerCase()&&(F.relative=!0);for(var H in I[q])F[H]=I[q][H];I[q]=F}return I}if(pr=i(),pr!==t&&z===n.length)return pr;throw pr!==t&&z<n.length&&Ce(ii()),zh(Kn,ce<n.length?n.charAt(ce):null,ce<n.length?Za(ce,ce+1):Za(ce,ce))}var Bct={SyntaxError:Jo,parse:Ict},lp=Bct.parse;lp.parseSVG=lp;lp.makeAbsolute=$ct;var Fct=lp;function $ct(n){var e,t={x:0,y:0},r={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(i){i.command==="moveto"&&(e=i),i.x0=t.x,i.y0=t.y;for(var a in r)a in i&&(i[a]+=i.relative?i[r[a]]:0);"x"in i||(i.x=t.x),"y"in i||(i.y=t.y),i.relative=!1,i.code=i.code.toUpperCase(),i.command=="closepath"&&(i.x=e.x,i.y=e.y),t=i}),n}const zct=ah(Fct);function f8(n,e,t){return e===void 0&&(e=1024),t===void 0&&(t=1014),function(r,i,a){var s=zct(n);return s.map(function(o){var c=[];c.push(o.relative===!0?o.code.toLowerCase():o.code.toUpperCase());var l=[[o.x1,o.y1],[o.x2,o.y2],[o.x,o.y]];return l.forEach(function(u){var h=N(u,2),f=h[0],d=h[1];f!==void 0&&c.push(o.relative===!0?f/e*2*a:r-a+a*2*(f/e)),d!==void 0&&c.push(o.relative===!0?d/t*2*a:i-a+a*2*(d/t))}),c})}}function jct(n){var e=/<path\s+d="(.*?)"/i.exec(n),t=/viewBox="\d+\s+\d+\s+(\d+)\s+(\d+)"/i.exec(n);if(e===null||e.length<2)return function(){return[]};var r=1024,i=1024;return t!==null&&t.length>=3&&(Number.isNaN(parseInt(t[1],10))||(r=parseInt(t[1],10)),Number.isNaN(parseInt(t[2],10))||(i=parseInt(t[2],10))),f8(e[1],r,i)}function qct(n,e){return n===void 0&&(n=0),e===void 0&&(e=!1),function(t,r,i){var a=i.value,s;typeof a=="function"&&(i.value=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];if(!s){var l=this;e&&a.apply(l,o),s=window.setTimeout(function(){a.apply(l,o),s=null},n)}})}}var NN=["year","month","day","hour","minute","second"],Gct=["YYYY","MM","DD","hh","mm","ss"];function Ju(n){return n instanceof Date?n:new Date(n)}function d8(n){for(var e=N(n,2),t=e[0],r=e[1],i=NN.indexOf(t),a=NN.indexOf(r),s="",o=i;o<=a;o+=1)if(s+=Gct[o],o<a){var c="-";o===2?c=" ":o>2&&(c=":"),s+=c}return s}function pn(n,e){var t={YYYY:n.getFullYear(),MM:n.getMonth()+1,DD:n.getDate(),HH:n.getHours(),mm:n.getMinutes(),ss:n.getSeconds()},r=e;return Object.keys(t).forEach(function(i){var a=t[i];r=r.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),r}function Vct(n,e){return Ju(n).getTime()-Ju(e).getTime()}function Wct(n,e){var t=N([Ju(n),Ju(e)],2),r=t[0],i=t[1];return r.getFullYear()!==i.getFullYear()?"year":r.getMonth()!==i.getMonth()?"month":r.getDay()!==i.getDay()?"day":r.getHours()!==i.getHours()?"hour":r.getMinutes()!==i.getMinutes()?"minute":"second"}function Hct(n,e){var t=new Date(n),r={year:function(i){i.setMonth(0),i.setHours(0,0,0,0)},month:function(i){i.setDate(1),i.setHours(0,0,0,0)},day:function(i){return i.setHours(0,0,0,0)},hour:function(i){return i.setMinutes(0,0,0)},minute:function(i){return i.setSeconds(0,0)},second:function(i){return i.setMilliseconds(0)}};return r[e](t),pn(t,d8(["year",e]))}function Uct(n){var e=localStorage.getItem("__debug__");return function(t,r,i){var a="[".concat(r,"] ").concat(n),s=i.value;typeof s=="function"&&(i.value=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];e&&console.time(a),s.apply(this,o),e&&console.timeEnd(a)})}}function p8(n,e,t){var r=n.getBBox(),i=r.width,a=r.height,s=N([e,t].map(function(l,u){var h;return l.includes("%")?parseFloat(((h=l.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(u===0?i:a):l}),2),o=s[0],c=s[1];return[o,c]}function d_(n,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(t,function(i,a,s){return"translate(".concat(p8(n,a,s),")")});n.attr("transform",r)}catch{}}function g8(n){var e;return((e=n[0])===null||e===void 0?void 0:e.map(function(t,r){return n.map(function(i){return i[r]})}))||[]}function Yct(){Oh(this,this.attributes.visibility!=="hidden")}var Yt=function(n){tt(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this,fe({},{style:r},t))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=s_(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&Yct.call(this)},e.prototype.update=function(t,r){var i;return this.attr(fe({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,r){},e.prototype.getSubShapeStyle=function(t){t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex;var r=ie(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return r},e}(V2),p_=function(n,e,t){return[["M",n-t,e],["A",t,t,0,1,0,n+t,e],["A",t,t,0,1,0,n-t,e],["Z"]]},Kct=p_,Xct=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e-t],["L",n+t,e+t],["L",n-t,e+t],["Z"]]},Zct=function(n,e,t){return[["M",n-t,e],["L",n,e-t],["L",n+t,e],["L",n,e+t],["Z"]]},Qct=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e+r],["L",n,e-r],["L",n+t,e+r],["Z"]]},Jct=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e-r],["L",n+t,e-r],["L",n,e+r],["Z"]]},tlt=function(n,e,t){var r=t/2*Math.sqrt(3);return[["M",n,e-t],["L",n+r,e-t/2],["L",n+r,e+t/2],["L",n,e+t],["L",n-r,e+t/2],["L",n-r,e-t/2],["Z"]]},elt=function(n,e,t){var r=t-1.5;return[["M",n-t,e-r],["L",n+t,e+r],["L",n+t,e-r],["L",n-t,e+r],["Z"]]},v8=function(n,e,t){return[["M",n,e+t],["L",n,e-t]]},nlt=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e+t],["M",n+t,e-t],["L",n-t,e+t]]},rlt=function(n,e,t){return[["M",n-t/2,e-t],["L",n+t/2,e-t],["M",n,e-t],["L",n,e+t],["M",n-t/2,e+t],["L",n+t/2,e+t]]},ilt=function(n,e,t){return[["M",n-t,e],["L",n+t,e],["M",n,e-t],["L",n,e+t]]},alt=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},m8=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},slt=m8,olt=function(n,e,t){return[["M",n-t,e],["A",t/2,t/2,0,1,1,n,e],["A",t/2,t/2,0,1,0,n+t,e]]},clt=function(n,e,t){return[["M",n-t-1,e-2.5],["L",n,e-2.5],["L",n,e+2.5],["L",n+t+1,e+2.5]]},llt=function(n,e,t){return[["M",n-t-1,e+2.5],["L",n,e+2.5],["L",n,e-2.5],["L",n+t+1,e-2.5]]},ult=function(n,e,t){return[["M",n-(t+1),e+2.5],["L",n-t/2,e+2.5],["L",n-t/2,e-2.5],["L",n+t/2,e-2.5],["L",n+t/2,e+2.5],["L",n+t+1,e+2.5]]};function hlt(n,e){return[["M",n-5,e+2.5],["L",n-5,e],["L",n,e],["L",n,e-3],["L",n,e+3],["L",n+6.5,e+3]]}var flt=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e],["L",n-t,e+t],["Z"]]};function dlt(n){var e="default";if(ne(n)&&n instanceof Image)e="image";else if(ft(n))e="symbol";else if(At(n)){var t=new RegExp("data:(image|text)");n.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(n)?e="url":e="symbol"}return e}function plt(n){var e=dlt(n);return["base64","url","image"].includes(e)?"image":n&&e==="symbol"?"path":null}var Qt=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,c=this.getSubShapeStyle(t),l=c.symbol,u=c.size,h=u===void 0?16:u,f=ie(c,["symbol","size"]),d=plt(l);Nn(!!d,ot(r),function(p){p.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call(function(g){if(d==="image"){var v=h*2;g.styles({img:l,width:v,height:v,x:a-h,y:o-h})}else{var v=h/2,m=ft(l)?l:e.getSymbol(l);g.styles(G({d:m==null?void 0:m(a,o,v)},f))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,r){e.MARKER_SYMBOL_MAP.set(t,r)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Yt);Qt.registerSymbol("cross",nlt);Qt.registerSymbol("hyphen",alt);Qt.registerSymbol("line",v8);Qt.registerSymbol("plus",ilt);Qt.registerSymbol("tick",rlt);Qt.registerSymbol("circle",p_);Qt.registerSymbol("point",Kct);Qt.registerSymbol("bowtie",elt);Qt.registerSymbol("hexagon",tlt);Qt.registerSymbol("square",Xct);Qt.registerSymbol("diamond",Zct);Qt.registerSymbol("triangle",Qct);Qt.registerSymbol("triangle-down",Jct);Qt.registerSymbol("line",v8);Qt.registerSymbol("dot",m8);Qt.registerSymbol("dash",slt);Qt.registerSymbol("smooth",olt);Qt.registerSymbol("hv",clt);Qt.registerSymbol("vh",llt);Qt.registerSymbol("hvh",ult);Qt.registerSymbol("vhv",hlt);function glt(n,e,t,r,i){var a=n.getLocalBounds(),s=0,o=0;r==="start"&&(s=e),r==="center"&&(s=-a.halfExtents[0]),r==="end"&&(s=-e-a.halfExtents[0]*2),i==="top"&&(o=t+a.halfExtents[1]),i==="middle"&&(o=0),i==="bottom"&&(o=t-a.halfExtents[1]*2),n.setLocalPosition([s,o])}function vlt(n,e){var t=n.getLocalBounds();return{x:t.halfExtents[0]?t.max[0]+(e||0):n.style.x,y:t.halfExtents[1]?(t.min[1]+t.max[1])/2:n.style.y}}var r0=function(n){tt(e,n);function e(t){return n.call(this,t,{padding:4,spacing:4})||this}return e.prototype.render=function(t,r){var i=t.padding,a=i===void 0?0:i,s=t.marker,o=t.text,c=t.radius,l=t.spacing,u=t.align,h=t.verticalAlign,f=pt(t,"label"),d=pt(t,"background"),p=N(xe(a),4),g=p[0],v=p[1],m=p[2],y=p[3],b=Ur(r,".tag-content","g").attr("className","tag-content").style("zIndex",0).node(),w=s||{symbol:"triangle",size:0},x=Ur(b,".tag-marker",function(){return new Qt({style:w})}).attr("className","tag-marker").update(w).node(),S=vlt(x,l),_=S.x,E=S.y;ot(b).maybeAppendByClassName("tag-text",function(){return new Ph}).styles(G(G({fontSize:12,text:gt(o)?"":"".concat(o),x:_,y:E},f),{textBaseline:"middle"})).call(function(O){o||O.remove()}),glt(b,y,g,u||"start",h||"top");var P=b.getLocalBounds();ot(r).maybeAppendByClassName("tag-background","rect").styles(G({zIndex:-1,y:P.min[1]-g,x:P.min[0]-y,width:d!==null?y+v+P.halfExtents[0]*2:0,height:d!==null?g+m+P.halfExtents[1]*2:0,radius:c??2,fill:"#fafafa",stroke:"#d9d9d9",lineWidth:1},d))},e.tag="tag",e}(Yt),mlt={small:{textFontSize:10,buttonWidth:40,buttonHeight:20,markerSize:8},middle:{textFontSize:12,buttonWidth:60,buttonHeight:30,markerSize:12},large:{textFontSize:16,buttonWidth:80,buttonHeight:40,markerSize:16}},ylt={primary:{default:{textFill:"#fff",buttonFill:"#1890ff",buttonLineWidth:0,markerFill:"#1890ff"},active:{buttonFill:"#40a9ff",markerFill:"#40a9ff"},disabled:{}},dashed:{default:{buttonFill:"transparent",buttonStroke:"#bbb",buttonLineDash:[5,5]},active:{},disabled:{}},link:{default:{textFill:"#1890ff",buttonFill:"transparent",buttonLineWidth:0,markerFill:"#1890ff"},active:{},disabled:{}},text:{default:{textFill:"#000",buttonFill:"transparent",buttonLineWidth:0,markerFill:"#000"},active:{},disabled:{}},default:{default:{textFill:"#000",buttonFill:"transparent",buttonStroke:"#bbb",markerFill:"#bbb"},active:{textFill:"#1890ff",buttonStroke:"#1890ff",markerStroke:"#1890ff"},disabled:{}}},zf={strict:{textFill:"#b8b8b8"},buttonStroke:"#d9d9d9",buttonFill:"#f5f5f5",markerStroke:"#d9d9d9"},blt=function(n){tt(e,n);function e(t){var r=n.call(this,t,{cursor:"pointer",padding:10,size:"middle",type:"default",text:"",state:"default",markerAlign:"left",markerSpacing:5,default:{buttonLineWidth:1,buttonRadius:5},active:{}})||this;return r.state="default",r.clickEvents=function(){var i=r.attributes,a=i.onClick,s=i.state;s!=="disabled"&&(a==null||a.call(r,r))},r.mouseenterEvent=function(){var i=r.attributes.state;i!=="disabled"&&(r.state="active",r.render(r.attributes,r))},r.mouseleaveEvent=function(){var i=r.attributes.state;r.state=i,r.render(r.attributes,r)},r}return Object.defineProperty(e.prototype,"markerSize",{get:function(){var t=this.attributes.markerSymbol,r=this.getStyle("marker"),i=t?(r==null?void 0:r.size)||2:0;return i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textAvailableWidth",{get:function(){var t=this.attributes,r=t.markerSymbol,i=t.padding,a=t.ellipsis,s=t.width,o=t.markerSpacing;if(!a)return 1/0;var c=mt(s)?this.getStyle("button").width:s;return r?c-i*2-o-this.markerSize:c-i*2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buttonHeight",{get:function(){var t=this.attributes.height;return t?+t:+this.getStyle("button").height},enumerable:!1,configurable:!0}),e.prototype.getStyle=function(t){var r=this.attributes,i=r.size,a=r.type,s=this.state,o=Le({},mlt[i],ylt[a][s],this.attributes.default,this.attributes[s]);return s==="disabled"&&(Object.keys(o).forEach(function(c){c in zf&&(o[c]=zf[c])}),Object.keys(zf.strict).forEach(function(c){o[c]=zf.strict[c]}),Le(o,this.attributes.disabled||{})),pt(o,t)},e.prototype.render=function(t,r){var i=t.text,a=i===void 0?"":i,s=t.padding,o=s===void 0?0:s,c=t.markerSymbol,l=t.markerSpacing,u=l===void 0?0:l,h=t.x,f=h===void 0?0:h,d=t.y,p=d===void 0?0:d;r.attr({cursor:this.state==="disabled"?"not-allowed":"pointer"});var g=N(xe(o),4);g[0];var v=g[1];g[2];var m=g[3],y=this.buttonHeight,b=this.getStyle("marker"),w=this.markerSize,x=G(G({},b),{symbol:c,x:f+m+w/2,y:p+y/2,size:w}),S=Ur(r,".marker",function(){return new Qt({className:"marker",style:x})}).update({style:x}).node(),_=S.getLocalBounds(),E=this.getStyle("text");this.textShape=Ur(r,".text","text").attr("className","text").styles(G(G({x:f+(w?_.max[0]+u:m),y:p+y/2},E),{text:a,textAlign:"left",textBaseline:"middle",wordWrap:!0,wordWrapWidth:this.textAvailableWidth,maxLines:1,textOverflow:"..."})).node();var P=this.textShape.getLocalBounds(),O=this.getStyle("button");ot(r).maybeAppendByClassName(".background","rect").styles(G(G({zIndex:-1},O),{x:f,y:p,height:y,width:m+(w?w+u:0)+P.halfExtents[0]*2+v}))},e.prototype.update=function(t){t===void 0&&(t={}),this.attr(Le({},this.attributes,t));var r=this.attributes.state;this.state=r,this.render(this.attributes,this)},e.prototype.setState=function(t){this.update({state:t})},e.prototype.hide=function(){this.style.visibility="hidden"},e.prototype.show=function(){this.style.visibility="visible"},e.prototype.bindEvents=function(){this.addEventListener("click",this.clickEvents),this.addEventListener("mouseenter",this.mouseenterEvent),this.addEventListener("mouseleave",this.mouseleaveEvent)},e.tag="button",e}(Yt),Elt=function(n){tt(e,n);function e(t){return n.call(this,Le({},e.defaultOptions,t))||this}return e.prototype.render=function(t,r){var i=t.x,a=t.y,s=t.items;t.textStyle;var o=t.padding,c=o===void 0?0:o,l=t.width,u=t.separator,h=N(xe(c),3),f=h[0],d=h[1],p=h[2],g=pt(t,"tag"),v=Ur(r,".container","g").styles({className:"container",x:i+p,y:a+f}),m=0,y=0;v.node().removeChildren();for(var b=function(S){var _=s[S],E=new r0({className:"breadcrumb-item",style:G(G(G(G({transform:"translate(".concat(m,", ").concat(y,")")},g),{text:gt(_.text)?_.id:_.text}),Os(_,["marker"])),{padding:0})});v.append(function(){return E});var P=E.getLocalBounds(),O=P.halfExtents[0]*2,C=P.halfExtents[1]*2;if(m+=O,!gt(l)){var M=l-d;m>M&&(E.attr({transform:"translateY(".concat(y+C,")")}),m=O,y+=C)}w.bindInnerEvents(E,_);var T=u||{},R=T.spacing,D=R===void 0?0:R,B=T.text,j=B===void 0?"/":B,L=T.style;if(S!==s.length-1){var $=new Ph({className:"".concat(e.tag,"-separator"),id:"".concat(e.tag,"-separator-").concat(S),style:G(G({x:m+D,y:y+C/2},L),{text:j,textAlign:"end",textBaseline:"middle"})});v.append(function(){return $});var V=$.getLocalBounds();m+=V.halfExtents[0]*2+D}},w=this,x=0;x<s.length;x++)b(x)},e.prototype.update=function(t){this.attr(Le({},this.attributes,t)),this.render(this.attributes,this)},e.prototype.bindInnerEvents=function(t,r){var i=this.attributes,a=i.items,s=i.onClick;s&&t.addEventListener("click",function(){s.call(t,r.id,r,a)})},e.tag="breadcrumb",e.defaultOptions={style:{separator:{text:"/",style:{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"},spacing:8},textStyle:{default:{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"},active:{fill:"#5468ff",cursor:"pointer"}},padding:[8,8,8,8]}},e}(Yt);function up(n,...e){return e.reduce((t,r)=>i=>t(r(i)),n)}function t2(n,e){return e-n?t=>(t-n)/(e-n):t=>.5}function xlt(n,e){const t=e<n?e:n,r=n>e?n:e;return i=>Math.min(Math.max(t,i),r)}function wlt(n,e,t,r,i){let a=t||0,s=r||n.length;const o=c=>c;for(;a<s;){const c=Math.floor((a+s)/2);o(n[c])>e?s=c:a=c+1}return a}const RN=Math.sqrt(50),kN=Math.sqrt(10),DN=Math.sqrt(2);function dd(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),a=r/10**i;return i>=0?(a>=RN?10:a>=kN?5:a>=DN?2:1)*10**i:-(10**-i)/(a>=RN?10:a>=kN?5:a>=DN?2:1)}const Slt=(n,e,t=5)=>{const r=[n,e];let i=0,a=r.length-1,s=r[i],o=r[a],c;return o<s&&([s,o]=[o,s],[i,a]=[a,i]),c=dd(s,o,t),c>0?(s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c,c=dd(s,o,t)):c<0&&(s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c,c=dd(s,o,t)),c>0?(r[i]=Math.floor(s/c)*c,r[a]=Math.ceil(o/c)*c):c<0&&(r[i]=Math.ceil(s*c)/c,r[a]=Math.floor(o*c)/c),r};function LN(n){return!mt(n)&&!zD(n)&&!Number.isNaN(n)}var y8={exports:{}},_lt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},b8={exports:{}},Olt=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},Plt=Olt,Clt=Array.prototype.concat,Mlt=Array.prototype.slice,IN=b8.exports=function(e){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];Plt(a)?t=Clt.call(t,Mlt.call(a)):t.push(a)}return t};IN.wrap=function(n){return function(){return n(IN(arguments))}};var Tlt=b8.exports,Mu=_lt,Ch=Tlt,E8=Object.hasOwnProperty,x8=Object.create(null);for(var qE in Mu)E8.call(Mu,qE)&&(x8[Mu[qE]]=qE);var ar=y8.exports={to:{},get:{}};ar.get=function(n){var e=n.substring(0,3).toLowerCase(),t,r;switch(e){case"hsl":t=ar.get.hsl(n),r="hsl";break;case"hwb":t=ar.get.hwb(n),r="hwb";break;default:t=ar.get.rgb(n),r="rgb";break}return t?{model:r,value:t}:null};ar.get.rgb=function(n){if(!n)return null;var e=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^(\w+)$/,s=[0,0,0,1],o,c,l;if(o=n.match(t)){for(l=o[2],o=o[1],c=0;c<3;c++){var u=c*2;s[c]=parseInt(o.slice(u,u+2),16)}l&&(s[3]=parseInt(l,16)/255)}else if(o=n.match(e)){for(o=o[1],l=o[3],c=0;c<3;c++)s[c]=parseInt(o[c]+o[c],16);l&&(s[3]=parseInt(l+l,16)/255)}else if(o=n.match(r)){for(c=0;c<3;c++)s[c]=parseInt(o[c+1],0);o[4]&&(o[5]?s[3]=parseFloat(o[4])*.01:s[3]=parseFloat(o[4]))}else if(o=n.match(i)){for(c=0;c<3;c++)s[c]=Math.round(parseFloat(o[c+1])*2.55);o[4]&&(o[5]?s[3]=parseFloat(o[4])*.01:s[3]=parseFloat(o[4]))}else return(o=n.match(a))?o[1]==="transparent"?[0,0,0,0]:E8.call(Mu,o[1])?(s=Mu[o[1]],s[3]=1,s):null:null;for(c=0;c<3;c++)s[c]=Ra(s[c],0,255);return s[3]=Ra(s[3],0,1),s};ar.get.hsl=function(n){if(!n)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var r=parseFloat(t[4]),i=(parseFloat(t[1])%360+360)%360,a=Ra(parseFloat(t[2]),0,100),s=Ra(parseFloat(t[3]),0,100),o=Ra(isNaN(r)?1:r,0,1);return[i,a,s,o]}return null};ar.get.hwb=function(n){if(!n)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var r=parseFloat(t[4]),i=(parseFloat(t[1])%360+360)%360,a=Ra(parseFloat(t[2]),0,100),s=Ra(parseFloat(t[3]),0,100),o=Ra(isNaN(r)?1:r,0,1);return[i,a,s,o]}return null};ar.to.hex=function(){var n=Ch(arguments);return"#"+jf(n[0])+jf(n[1])+jf(n[2])+(n[3]<1?jf(Math.round(n[3]*255)):"")};ar.to.rgb=function(){var n=Ch(arguments);return n.length<4||n[3]===1?"rgb("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+")":"rgba("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+", "+n[3]+")"};ar.to.rgb.percent=function(){var n=Ch(arguments),e=Math.round(n[0]/255*100),t=Math.round(n[1]/255*100),r=Math.round(n[2]/255*100);return n.length<4||n[3]===1?"rgb("+e+"%, "+t+"%, "+r+"%)":"rgba("+e+"%, "+t+"%, "+r+"%, "+n[3]+")"};ar.to.hsl=function(){var n=Ch(arguments);return n.length<4||n[3]===1?"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)":"hsla("+n[0]+", "+n[1]+"%, "+n[2]+"%, "+n[3]+")"};ar.to.hwb=function(){var n=Ch(arguments),e="";return n.length>=4&&n[3]!==1&&(e=", "+n[3]),"hwb("+n[0]+", "+n[1]+"%, "+n[2]+"%"+e+")"};ar.to.keyword=function(n){return x8[n.slice(0,3)]};function Ra(n,e,t){return Math.min(Math.max(e,n),t)}function jf(n){var e=Math.round(n).toString(16).toUpperCase();return e.length<2?"0"+e:e}var Alt=y8.exports;const Nlt=ah(Alt);function GE(n,e,t){let r=t;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(e-n)*6*r:r<1/2?e:r<2/3?n+(e-n)*(2/3-r)*6:n}function Rlt(n){const e=n[0]/360,t=n[1]/100,r=n[2]/100,i=n[3];if(t===0)return[r*255,r*255,r*255,i];const a=r<.5?r*(1+t):r+t-r*t,s=2*r-a,o=GE(s,a,e+1/3),c=GE(s,a,e),l=GE(s,a,e-1/3);return[o*255,c*255,l*255,i]}function BN(n){const e=Nlt.get(n);if(!e)return null;const{model:t,value:r}=e;return t==="rgb"?r:t==="hsl"?Rlt(r):null}const hp=(n,e)=>t=>n*(1-t)+e*t,klt=(n,e)=>{const t=BN(n),r=BN(e);return t===null||r===null?t?()=>n:()=>e:i=>{const a=new Array(4);for(let u=0;u<4;u+=1){const h=t[u],f=r[u];a[u]=h*(1-i)+f*i}const[s,o,c,l]=a;return`rgba(${Math.round(s)}, ${Math.round(o)}, ${Math.round(c)}, ${l})`}},Dlt=(n,e)=>typeof n=="number"&&typeof e=="number"?hp(n,e):typeof n=="string"&&typeof e=="string"?klt(n,e):()=>n,Llt=(n,e)=>{const t=hp(n,e);return r=>Math.round(t(r))};function FN({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):t}function Ilt({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function Blt({map:n,initKey:e},t){const r=e(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function Flt(n){return typeof n=="object"?n.valueOf():n}class $N extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=Flt,e!==null)for(const[t,r]of e)this.set(t,r)}get(e){return super.get(FN({map:this.map,initKey:this.initKey},e))}has(e){return super.has(FN({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(Ilt({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete(Blt({map:this.map,initKey:this.initKey},e))}}class w8{constructor(e){this.options=Le({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Le({},this.options,e),this.rescale(e)}rescale(e){}}const g_=Symbol("defaultUnknown");function zN(n,e,t){for(let r=0;r<e.length;r+=1)n.has(e[r])||n.set(t(e[r]),r)}function jN(n){const{value:e,from:t,to:r,mapper:i,notFoundReturn:a}=n;let s=i.get(e);if(s===void 0){if(a!==g_)return a;s=t.push(e)-1,i.set(e,s)}return r[s%r.length]}function qN(n){return n instanceof Date?e=>`${e}`:typeof n=="object"?e=>JSON.stringify(e):e=>e}class v_ extends w8{getDefaultOptions(){return{domain:[],range:[],unknown:g_}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&zN(this.domainIndexMap,this.getDomain(),this.domainKey),jN({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&zN(this.rangeIndexMap,this.getRange(),this.rangeKey),jN({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[r]=this.options.range;if(this.domainKey=qN(t),this.rangeKey=qN(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new v_(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function $lt(n){const e=Math.min(...n);return n.map(t=>t/e)}function zlt(n,e){const t=n.length,r=e-t;return r>0?[...n,...new Array(r).fill(1)]:r<0?n.slice(0,e):n}function jlt(n){return Math.round(n*1e12)/1e12}function qlt(n){const{domain:e,range:t,paddingOuter:r,paddingInner:i,flex:a,round:s,align:o}=n,c=e.length,l=zlt(a,c),[u,h]=t,f=h-u,d=2/c*r+1-1/c*i,p=f/d,g=p*i/c,v=p-c*g,m=$lt(l),y=m.reduce((M,T)=>M+T),b=v/y,w=new $N(e.map((M,T)=>{const R=m[T]*b;return[M,s?Math.floor(R):R]})),x=new $N(e.map((M,T)=>{const D=m[T]*b+g;return[M,s?Math.floor(D):D]})),S=Array.from(x.values()).reduce((M,T)=>M+T),E=(f-(S-S/c*i))*o,P=u+E;let O=s?Math.round(P):P;const C=new Array(c);for(let M=0;M<c;M+=1){C[M]=jlt(O);const T=e[M];O+=x.get(T)}return{valueBandWidth:w,valueStep:x,adjustedRange:C}}function Glt(n){var e;const{domain:t}=n,r=t.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=n.flex)===null||e===void 0)&&e.length))return qlt(n);const{range:a,paddingOuter:s,paddingInner:o,round:c,align:l}=n;let u,h,f=a[0];const p=a[1]-f,g=s*2,v=r-o;u=p/Math.max(1,g+v),c&&(u=Math.floor(u)),f+=(p-u*(r-o))*l,h=u*(1-o),c&&(f=Math.round(f),h=Math.round(h));const m=new Array(r).fill(0).map((y,b)=>f+b*u);return{valueStep:u,valueBandWidth:h,adjustedRange:m}}class m_ extends v_{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:g_,flex:[]}}constructor(e){super(e)}clone(){return new m_(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:r,round:i,flex:a}=this.options,{adjustedRange:s,valueBandWidth:o,valueStep:c}=Glt({align:e,range:r,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=c,this.valueBandWidth=o,this.adjustedRange=s}}const Vlt=(n,e,t)=>{let r,i,a=n,s=e;if(a===s&&t>0)return[a];let o=dd(a,s,t);if(o===0||!Number.isFinite(o))return[];if(o>0){a=Math.ceil(a/o),s=Math.floor(s/o),i=new Array(r=Math.ceil(s-a+1));for(let c=0;c<r;c+=1)i[c]=(a+c)*o}else{o=-o,a=Math.ceil(a*o),s=Math.floor(s*o),i=new Array(r=Math.ceil(s-a+1));for(let c=0;c<r;c+=1)i[c]=(a+c)/o}return i},Wlt=(n,e,t)=>{const[r,i]=n,[a,s]=e;let o,c;return r<i?(o=t2(r,i),c=t(a,s)):(o=t2(i,r),c=t(s,a)),up(c,o)},Hlt=(n,e,t)=>{const r=Math.min(n.length,e.length)-1,i=new Array(r),a=new Array(r),s=n[0]>n[r],o=s?[...n].reverse():n,c=s?[...e].reverse():e;for(let l=0;l<r;l+=1)i[l]=t2(o[l],o[l+1]),a[l]=t(c[l],c[l+1]);return l=>{const u=wlt(n,l,1,r)-1,h=i[u],f=a[u];return up(f,h)(l)}},GN=(n,e,t,r)=>(Math.min(n.length,e.length)>2?Hlt:Wlt)(n,e,r?Llt:t);let Ult=class extends w8{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:hp,tickCount:5}}map(e){return LN(e)?this.output(e):this.options.unknown}invert(e){return LN(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,r,...i)}getTicks(){const{tickMethod:e}=this.options,[t,r,i,...a]=this.getTickMethodOptions();return e(t,r,i,...a)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,r=e[0],i=e[e.length-1];return[r,i,t]}chooseNice(){return Slt}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:r}=this.options,i=this.options.domain.map(e),a=Math.min(i.length,r.length);return t?xlt(i[0],i[a-1]):Od}composeOutput(e,t){const{domain:r,range:i,round:a,interpolate:s}=this.options,o=GN(r.map(e),i,s,a);this.output=up(o,t,e)}composeInput(e,t,r){const{domain:i,range:a}=this.options,s=GN(a,i.map(e),hp);this.input=up(t,r,s)}};class ws extends Ult{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Dlt,tickMethod:Vlt,tickCount:5}}chooseTransforms(){return[Od,Od]}clone(){return new ws(this.options)}}var Ylt=function(n){tt(e,n);function e(t){var r=this,i=t.style,a=ie(t,["style"]);return r=n.call(this,Le({},{type:"column"},G({style:i},a)))||this,r.columnsGroup=new Ze({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.columns,i=t.x,a=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),ot(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(s){return s.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(s){return s.each(function(o){this.attr(o)})},function(s){return s.remove()})},e.prototype.update=function(t){this.attr(fe({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(Sn),Klt=function(n){tt(e,n);function e(t){var r=this,i=t.style,a=ie(t,["style"]);return r=n.call(this,Le({},{type:"lines"},G({style:i},a)))||this,r.linesGroup=r.appendChild(new Ze),r.areasGroup=r.appendChild(new Ze),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.lines,i=t.areas,a=t.x,s=t.y;this.style.transform="translate(".concat(a,", ").concat(s,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(fe({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){ot(this.linesGroup).selectAll(".line").data(t).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},e.prototype.renderAreas=function(t){ot(this.linesGroup).selectAll(".area").data(t).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},e}(Sn);function Xlt(n,e){var t,r=e.x,i=e.y,a=N(i.getOptions().range||[0,0],2),s=a[0],o=a[1];return o>s&&(t=N([s,o],2),o=t[0],s=t[1]),n.map(function(c){var l=c.map(function(u,h){return[r.map(h),oe(i.map(u),o,s)]});return l})}function th(n,e){e===void 0&&(e=!1);var t=e?n.length-1:0,r=n.map(function(i,a){return Q([a===t?"M":"L"],N(i),!1)});return e?r.reverse():r}function fp(n,e){if(e===void 0&&(e=!1),n.length<=2)return th(n);for(var t=[],r=n.length,i=0;i<r;i+=1){var a=e?n[r-i-1]:n[i];ve(a,t.slice(-2))||t.push.apply(t,Q([],N(a),!1))}var s=e8(t,!1);return e?s.unshift(Q(["M"],N(n[r-1]),!1)):s.unshift(Q(["M"],N(n[0]),!1)),s}function y_(n,e,t){var r=_s(n);return r.push(["L",e,t],["L",0,t],["Z"]),r}function Zlt(n,e,t,r){return n.map(function(i){return y_(e?fp(i):th(i),t,r)})}function Qlt(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],s=th(a),o=void 0;if(i===0)o=y_(s,e,t);else{var c=n[i-1],l=th(c,!0);l[0][0]="L",o=Q(Q(Q([],N(s),!1),N(l),!1),[["Z"]],!1)}r.push(o)}return r}function Jlt(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],s=fp(a),o=void 0;if(i===0)o=y_(s,e,t);else{var c=n[i-1],l=fp(c,!0),u=a[0];l[0][0]="L",o=Q(Q(Q([],N(s),!1),N(l),!1),[Q(["M"],N(u),!1),["Z"]],!1)}r.push(o)}return r}function VN(n){return n.length===0?[0,0]:[jo(DD(n,function(e){return jo(e)||0})),zo(kD(n,function(e){return zo(e)||0}))]}function WN(n){for(var e=_s(n),t=e[0].length,r=N([Array(t).fill(0),Array(t).fill(0)],2),i=r[0],a=r[1],s=0;s<e.length;s+=1)for(var o=e[s],c=0;c<t;c+=1)o[c]>=0?(o[c]+=i[c],i[c]=o[c]):(o[c]+=a[c],a[c]=o[c]);return e}var S8=function(n){tt(e,n);function e(t){return n.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var r=_s(t);return rt(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?WN(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,r=N(t.getOptions().domain||[0,0],2),i=r[0],a=r[1];return a<0?t.map(a):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,r=t.width,i=t.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,r=this.attributes,i=r.type,a=r.isStack,s=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=pt(this.attributes,"area"),c=pt(this.attributes,"line"),l=this.containerShape.width,u=this.data;if(u[0].length===0)return{lines:[],areas:[]};var h=this.scales,f=h.x,d=h.y,p=Xlt(u,{type:"line",x:f,y:d}),g=[];if(o){var v=this.baseline;a?g=s?Jlt(p,l,v):Qlt(p,l,v):g=Zlt(p,s,l,v)}return{lines:p.map(function(m,y){return G({stroke:t.getColor(y),d:s?fp(m):th(m)},c)}),areas:g.map(function(m,y){return G({d:m,fill:t.getColor(y)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,r=pt(this.attributes,"column"),i=this.attributes,a=i.isStack,s=i.type,o=i.scale;if(s!=="column")throw new Error("columnsStyle can only be used in column type");var c=this.containerShape.height,l=this.rawData;if(!l)return{columns:[]};a&&(l=WN(l));var u=this.createScales(l),h=u.x,f=u.y,d=N(VN(l),2),p=d[0],g=d[1],v=new ws({domain:[0,g-(p>0?0:p)],range:[0,c*o]}),m=h.getBandWidth(),y=this.rawData;return{columns:l.map(function(b,w){return b.map(function(x,S){var _=m/l.length,E=function(){return{x:h.map(S)+_*w,y:x>=0?f.map(x):f.map(0),width:_,height:v.map(Math.abs(x))}},P=function(){return{x:h.map(S),y:f.map(x),width:m,height:v.map(y[w][S])}};return G(G({fill:t.getColor(w)},r),a?P():E())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){Ur(r,".container","rect").attr("className","container").node();var i=t.type,a=t.x,s=t.y,o="spark".concat(i),c=G({x:a,y:s},i==="line"?this.linesStyle:this.columnsStyle);ot(r).selectAll(".spark").data([i]).join(function(l){return l.append(function(u){return u==="line"?new Klt({className:o,style:c}):new Ylt({className:o,style:c})}).attr("className","spark ".concat(o))},function(l){return l.update(c)},function(l){return l.remove()})},e.prototype.getColor=function(t){var r=this.attributes.color;return me(r)?r[t%r.length]:ft(r)?r.call(null,t):r},e.prototype.createScales=function(t){var r,i,a=this.attributes,s=a.type,o=a.scale,c=a.range,l=c===void 0?[]:c,u=a.spacing,h=this.containerShape,f=h.width,d=h.height,p=N(VN(t),2),g=p[0],v=p[1],m=new ws({domain:[(r=l[0])!==null&&r!==void 0?r:g,(i=l[1])!==null&&i!==void 0?i:v],range:[d,d*(1-o)]});return s==="line"?{type:s,x:new ws({domain:[0,t[0].length-1],range:[0,f]}),y:m}:{type:s,x:new m_({domain:t[0].map(function(y,b){return b}),range:[0,f],paddingInner:u,paddingOuter:u/2,align:.5}),y:m}},e.tag="sparkline",e}(Yt);function tut(n){return typeof n=="boolean"?!1:"enter"in n&&"update"in n&&"exit"in n}function HN(n){if(!n)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(n).filter(function(r){var i=N(r,1),a=i[0];return!e.includes(a)}));return Object.fromEntries(e.map(function(r){return tut(n)?n[r]===!1?[r,!1]:[r,G(G({},n[r]),t)]:[r,t]}))}function xc(n,e){n?n.finished.then(e):e()}function eut(n,e){n.length===0?e():Promise.all(n.map(function(t){return t==null?void 0:t.finished})).then(e)}function _8(n,e){"update"in n?n.update(e):n.attr(e)}function O8(n,e,t){if(e.length===0)return null;if(!t){var r=e.slice(-1)[0];return _8(n,{style:r}),null}return n.animate(e,t)}function nut(n,e){return!(n.nodeName!=="text"||e.nodeName!=="text"||n.attributes.text!==e.attributes.text)}function rut(n,e,t,r){if(r===void 0&&(r="destroy"),nut(n,e))return n.remove(),[null];var i=function(){r==="destroy"?n.destroy():r==="hide"&&xn(n),e.isVisible()&&Ha(e)};if(!t)return i(),[null];var a=t.duration,s=a===void 0?0:a,o=t.delay,c=o===void 0?0:o,l=Math.ceil(+s/2),u=+s/4,h=N(n.getGeometryBounds().center,2),f=h[0],d=h[1],p=N(e.getGeometryBounds().center,2),g=p[0],v=p[1],m=N([(f+g)/2-f,(d+v)/2-d],2),y=m[0],b=m[1],w=n.style.opacity,x=w===void 0?1:w,S=e.style.opacity,_=S===void 0?1:S,E=n.style.transform||"",P=e.style.transform||"",O=n.animate([{opacity:x,transform:"translate(0, 0) ".concat(E)},{opacity:0,transform:"translate(".concat(y,", ").concat(b,") ").concat(E)}],G(G({fill:"both"},t),{duration:c+l+u})),C=e.animate([{opacity:0,transform:"translate(".concat(-y,", ").concat(-b,") ").concat(P),offset:.01},{opacity:_,transform:"translate(0, 0) ".concat(P)}],G(G({fill:"both"},t),{duration:l+u,delay:c+l-u}));return xc(C,i),[O,C]}function Kr(n,e,t){var r={},i={};return Object.entries(e).forEach(function(a){var s=N(a,2),o=s[0],c=s[1];if(!gt(c)){var l=n.style[o]||n.parsedStyle[o]||0;l!==c&&(r[o]=l,i[o]=c)}}),t?O8(n,[r,i],G({fill:"both"},t)):(_8(n,i),null)}function i0(n,e){return n.style.opacity||(n.style.opacity=1),Kr(n,{opacity:0},e)}var P8={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},C8={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},M8={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},si=ur({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),ga=ur({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),iut=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=t.y,s=t.size,o=s===void 0?10:s,c=t.radius,l=c===void 0?o/4:c,u=t.orientation,h=ie(t,["x","y","size","radius","orientation"]),f=o,d=f*2.4,p=ot(r).maybeAppendByClassName(ga.iconRect,"rect").styles(G(G({},h),{width:f,height:d,radius:l,x:i-f/2,y:a-d/2,transformOrigin:"center"})),g=i+1/3*f-f/2,v=i+2/3*f-f/2,m=a+1/4*d-d/2,y=a+3/4*d-d/2;p.maybeAppendByClassName("".concat(ga.iconLine,"-1"),"line").styles(G({x1:g,x2:g,y1:m,y2:y},h)),p.maybeAppendByClassName("".concat(ga.iconLine,"-2"),"line").styles(G({x1:v,x2:v,y1:m,y2:y},h)),u==="vertical"&&(p.node().style.transform="rotate(90)")},e}(Yt),T8=function(n){tt(e,n);function e(t){return n.call(this,t,M8)||this}return e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.x,s=i.y,o=i.showLabel,c=pt(this.attributes,"label"),l=c.x,u=l===void 0?0:l,h=c.y,f=h===void 0?0:h,d=c.transform,p=c.transformOrigin,g=ie(c,["x","y","transform","transformOrigin"]),v=N(yi(g,[]),2),m=v[0],y=v[1],b=ot(t).maybeAppendByClassName(ga.labelGroup,"g").styles(y),w=G(G({},C8),m),x=w.text,S=ie(w,["text"]);Nn(!!o,b,function(_){r.label=_.maybeAppendByClassName(ga.label,"text").styles(G(G({},S),{x:a+u,y:s+f,transform:d,transformOrigin:p,text:"".concat(x)})),r.label.on("mousedown",function(E){E.stopPropagation()}),r.label.on("touchstart",function(E){E.stopPropagation()})})},e.prototype.renderIcon=function(t){var r=this.attributes,i=r.x,a=r.y,s=r.orientation,o=r.type,c=G(G({x:i,y:a,orientation:s},P8),pt(this.attributes,"icon")),l=this.attributes.iconShape,u=l===void 0?function(){return new iut({style:c})}:l,h=ot(t).maybeAppendByClassName(ga.iconGroup,"g");h.selectAll(ga.icon.class).data([u]).join(function(f){return f.append(typeof u=="string"?u:function(){return u(o)}).attr("className",ga.icon.name)},function(f){return f.update(c)},function(f){return f.remove()})},e.prototype.render=function(t,r){this.renderIcon(r),this.renderLabel(r)},e}(Yt),b_=function(n){tt(e,n);function e(t){var r=n.call(this,t,G(G(G({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Pr(M8,"handle")),Pr(P8,"handleIcon")),Pr(C8,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(a){a.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(Zu(a));var s=r.availableSpace,o=s.x,c=s.y,l=r.getBBox(),u=l.x,h=l.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([o,c])-r.getOrientVal([+u,+h])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var a=r.attributes,s=a.slidable,o=a.brushable,c=a.type;i.stopPropagation();var l=r.getOrientVal(Zu(i)),u=l-r.prevPos;if(u){var h=r.getRatio(u);switch(r.target){case"start":s&&r.setValuesOffset(h);break;case"end":s&&r.setValuesOffset(0,h);break;case"selection":s&&r.setValuesOffset(h,h);break;case"track":if(!o)return;r.selectionWidth+=h,c==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break}r.prevPos=l}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var a=r.attributes,s=a.onChange,o=a.type,c=o==="range"?i:i[1],l=o==="range"?r.getValues():r.getValues()[1],u=new se("valuechange",{detail:{oldValue:c,value:l}});r.dispatchEvent(u),s==null||s(l)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var r=pt(this.attributes,"sparkline");return G(G({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,r=t.trackLength,i=t.trackSize,a=N(this.getOrientVal([[r,i],[i,r]]),2),s=a[0],o=a[1];return{width:s,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var r=t.padding,i=N(xe(r),4),a=i[0],s=i[1],o=i[2],c=i[3],l=this.shape,u=l.width,h=l.height;return{x:c,y:a,width:u-(c+s),height:h-(a+o)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1),this.attributes.values=t;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(si.selection.class).each(function(i,a){Kr(this,r[a],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&Kr(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&Kr(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1);var i=this.values,a=this.clampValues(t);this.attributes.values=a,this.setValues(a),r&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var r=this.attributes,i=r.x,a=r.y,s=pt(this.attributes,"track");this.trackShape=ot(t).maybeAppendByClassName(si.track,"rect").styles(G(G({x:i,y:a},this.shape),s))},e.prototype.renderBrushArea=function(t){var r=this.attributes,i=r.x,a=r.y,s=r.brushable;this.brushArea=ot(t).maybeAppendByClassName(si.brushArea,"rect").styles(G({x:i,y:a,fill:"transparent",cursor:s?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var r=this,i=this.attributes,a=i.x,s=i.y,o=i.orientation,c=ot(t).maybeAppendByClassName(si.sparklineGroup,"g");Nn(o==="horizontal",c,function(l){var u=G(G({},r.sparklineStyle),{x:a,y:s});l.maybeAppendByClassName(si.sparkline,function(){return new S8({style:u})}).update(u)})},e.prototype.renderHandles=function(){var t=this,r,i=this.attributes,a=i.showHandle,s=i.type,o=s==="range"?["start","end"]:["end"],c=a?o:[],l=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(si.handle.class).data(c.map(function(u){return{type:u}}),function(u){return u.type}).join(function(u){return u.append(function(h){var f=h.type;return new T8({style:t.getHandleStyle(f)})}).each(function(h){var f=h.type;this.attr("class","".concat(si.handle.name," ").concat(f,"-handle"));var d="".concat(f,"Handle");l[d]=this,this.addEventListener("pointerdown",l.onDragStart(f))})},function(u){return u.each(function(h){var f=h.type;this.update(l.getHandleStyle(f))})},function(u){return u.each(function(h){var f=h.type,d="".concat(f,"Handle");l[d]=void 0}).remove()})},e.prototype.renderSelection=function(t){var r=this.attributes,i=r.x,a=r.y,s=r.type,o=r.selectionType;this.foregroundGroup=ot(t).maybeAppendByClassName(si.foreground,"g");var c=pt(this.attributes,"selection"),l=function(h){return h.style("visibility",function(f){return f.show?"visible":"hidden"}).style("cursor",function(f){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(G(G({},c),{transform:"translate(".concat(i,", ").concat(a,")")}))},u=this;this.foregroundGroup.selectAll(si.selection.class).data(s==="value"?[]:this.calcSelectionArea().map(function(h,f){return{style:G({},h),index:f,show:o==="select"?f===1:f!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",si.selection.name).call(l).each(function(f,d){var p=this;d===1?(u.selectionShape=ot(this),this.on("pointerdown",function(g){p.attr("cursor","grabbing"),u.onDragStart("selection")(g)}),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){p.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){p.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){p.attr("cursor","pointer")})):this.on("pointerdown",u.onDragStart("track"))})},function(h){return h.call(l)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(t,r){var i;r===void 0&&(r=4);var a=N(this.range,2),s=a[0],o=a[1],c=N(this.getValues().map(function(v){return Qu(v,r)}),2),l=c[0],u=c[1],h=Array.isArray(t)?t:[l,t??u],f=N((h||[l,u]).map(function(v){return Qu(v,r)}),2),d=f[0],p=f[1];if(this.attributes.type==="value")return[0,oe(p,s,o)];d>p&&(i=N([p,d],2),d=i[0],p=i[1]);var g=p-d;return g>o-s?[s,o]:d<s?l===s&&u===p?[s,p]:[s,g+s]:p>o?u===o&&l===d?[d,o]:[o-g,o]:[d,p]},e.prototype.calcSelectionArea=function(t){var r=N(this.clampValues(t),2),i=r[0],a=r[1],s=this.availableSpace,o=s.x,c=s.y,l=s.width,u=s.height;return this.getOrientVal([[{y:c,height:u,x:o,width:i*l},{y:c,height:u,x:i*l+o,width:(a-i)*l},{y:c,height:u,x:a*l,width:(1-a)*l}],[{x:o,width:l,y:c,height:i*u},{x:o,width:l,y:i*u+c,height:(a-i)*u},{x:o,width:l,y:a*u,height:(1-a)*u}]])},e.prototype.calcHandlePosition=function(t){var r=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,s=i.y,o=i.width,c=i.height,l=N(this.clampValues(),2),u=l[0],h=l[1],f=t==="start"?-r:r,d=(t==="start"?u:h)*this.getOrientVal([o,c])+f;return{x:a+this.getOrientVal([d,o/2]),y:s+this.getOrientVal([c/2,d])}},e.prototype.inferTextStyle=function(t){var r=this.attributes.orientation;return r==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var r,i=this.attributes,a=i.type,s=i.orientation,o=i.formatter,c=i.autoFitLabel,l=pt(this.attributes,"handle"),u=pt(l,"label"),h=l.spacing,f=this.getHandleSize(),d=this.clampValues(),p=t==="start"?d[0]:d[1],g=o(p),v=new Ph({style:G(G(G({},u),this.inferTextStyle(t)),{text:g})}),m=v.getBBox(),y=m.width,b=m.height;if(v.destroy(),!c){if(a==="value")return{text:g,x:0,y:-b-h};var w=h+f+(s==="horizontal"?y/2:0);return r={text:g},r[s==="horizontal"?"x":"y"]=t==="start"?-w:w,r}var x=0,S=0,_=this.availableSpace,E=_.width,P=_.height,O=this.calcSelectionArea()[1],C=O.x,M=O.y,T=O.width,R=O.height,D=h+f;if(s==="horizontal"){var B=D+y/2;if(t==="start"){var j=C-D-y;x=j>0?-B:B}else{var L=E-C-T-D>y;x=L?B:-B}}else{var $=D,V=b+D;t==="start"?S=M-f>b?-V:$:S=P-(M+R)-f>b?V:-$}return{x,y:S,text:g}},e.prototype.getHandleLabelStyle=function(t){var r=pt(this.attributes,"handleLabel");return G(G(G({},r),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,r=pt(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return G({cursor:i,shape:t,size:a},r)},e.prototype.getHandleStyle=function(t){var r=this.attributes,i=r.x,a=r.y,s=r.showLabel,o=r.showLabelOnInteraction,c=r.orientation,l=this.calcHandlePosition(t),u=l.x,h=l.y,f=this.calcHandleText(t),d=s;return!s&&o&&(this.target?d=!0:d=!1),G(G(G({},Pr(this.getHandleIconStyle(),"icon")),Pr(G(G({},this.getHandleLabelStyle(t)),f),"label")),{transform:"translate(".concat(u+i,", ").concat(h+a,")"),orientation:c,showLabel:d,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,r=t.handleIconSize,i=t.width,a=t.height;return r||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var r=N(t,2),i=r[0],a=r[1],s=this.attributes.orientation;return s==="horizontal"?i:a},e.prototype.setValuesOffset=function(t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=this.attributes.type,s=N(this.getValues(),2),o=s[0],c=s[1],l=a==="range"?t:0,u=[o+l,c+r].sort();i?this.setValues(u):this.innerSetValues(u,!0)},e.prototype.getRatio=function(t){var r=this.availableSpace,i=r.width,a=r.height;return t/this.getOrientVal([i,a])},e.prototype.dispatchCustomEvent=function(t,r,i){var a=this;t.on(r,function(s){s.stopPropagation(),a.dispatchEvent(new se(i,{detail:s}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var r=this.attributes.scrollable;if(r){var i=t.deltaX,a=t.deltaY,s=a||i,o=this.getRatio(s);this.setValuesOffset(o,o,!0)}},e.tag="slider",e}(Yt),aut=function(n){tt(e,n);function e(t){var r=n.call(this,t,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(i){var a=r.attributes.value;if(i!==a){var s={detail:{oldValue:i,value:a}};r.dispatchEvent(new se("scroll",s)),r.dispatchEvent(new se("valuechange",s))}},r.onTrackClick=function(i){var a=r.attributes.slidable;if(a){var s=N(r.getLocalPosition(),2),o=s[0],c=s[1],l=N(r.padding,4),u=l[0],h=l[3],f=r.getOrientVal([o+h,c+u]),d=r.getOrientVal(Zu(i)),p=(d-f)/r.trackLength;r.setValue(p,!0)}},r.onThumbMouseenter=function(i){r.dispatchEvent(new se("thumbMouseenter",{detail:i.detail}))},r.onTrackMouseenter=function(i){r.dispatchEvent(new se("trackMouseenter",{detail:i.detail}))},r.onThumbMouseleave=function(i){r.dispatchEvent(new se("thumbMouseleave",{detail:i.detail}))},r.onTrackMouseleave=function(i){r.dispatchEvent(new se("trackMouseleave",{detail:i.detail}))},r}return Object.defineProperty(e.prototype,"padding",{get:function(){var t=this.attributes.padding;return xe(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t=this.attributes.value,r=N(this.range,2),i=r[0],a=r[1];return oe(t,i,a)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLength",{get:function(){var t=this.attributes,r=t.viewportLength,i=t.trackLength,a=i===void 0?r:i;return a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes.trackSize,r=this.trackLength,i=N(this.padding,4),a=i[0],s=i[1],o=i[2],c=i[3],l=N(this.getOrientVal([[r,t],[t,r]]),2),u=l[0],h=l[1];return{x:c,y:a,width:+u-(c+s),height:+h-(a+o)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackRadius",{get:function(){var t=this.attributes,r=t.isRound,i=t.trackSize;return r?i/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbRadius",{get:function(){var t=this.attributes,r=t.isRound,i=t.thumbRadius;if(!r)return 0;var a=this.availableSpace,s=a.width,o=a.height;return i||this.getOrientVal([o,s])/2},enumerable:!1,configurable:!0}),e.prototype.getValues=function(t){t===void 0&&(t=this.value);var r=this.attributes,i=r.viewportLength,a=r.contentLength,s=i/a,o=N(this.range,2),c=o[0],l=o[1],u=t*(l-c-s);return[u,u+s]},e.prototype.getValue=function(){return this.value},e.prototype.renderSlider=function(t){var r=this.attributes,i=r.x,a=r.y,s=r.orientation,o=r.trackSize,c=r.padding,l=r.slidable,u=pt(this.attributes,"track"),h=pt(this.attributes,"thumb"),f=G(G({x:i,y:a,brushable:!1,orientation:s,padding:c,selectionRadius:this.thumbRadius,showHandle:!1,slidable:l,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:o,values:this.getValues()},Pr(u,"track")),Pr(h,"selection"));this.slider=ot(t).maybeAppendByClassName("scrollbar",function(){return new b_({style:f})}).update(f).node()},e.prototype.render=function(t,r){this.renderSlider(r)},e.prototype.setValue=function(t,r){r===void 0&&(r=!1);var i=this.attributes.value,a=N(this.range,2),s=a[0],o=a[1];this.slider.setValues(this.getValues(oe(t,s,o)),r),this.onValueChange(i)},e.prototype.bindEvents=function(){var t=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),t.onTrackClick(r.detail)}),this.onHover()},e.prototype.getOrientVal=function(t){var r=this.attributes.orientation;return r==="horizontal"?t[0]:t[1]},e.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},e.tag="scrollbar",e}(Yt),E_={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Yr({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};Le({},E_,{style:{type:"arc"}});Le({},E_,{style:{}});var re=ur({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),tc=ur({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function A8(n){return n.reduce(function(e,t,r){return e.push(Q([r===0?"M":"L"],N(t),!1)),e},[])}function sut(n,e,t){var r=e.connect,i=r===void 0?"line":r,a=e.center;if(i==="line")return A8(n);if(!a)return[];var s=Qo(n[0],a),o=t?0:1;return n.reduce(function(c,l,u){return u===0?c.push(Q(["M"],N(l),!1)):c.push(Q(["A",s,s,0,0,o],N(l),!1)),c},[])}function e2(n,e,t){return e.type==="surround"?sut(n,e,t):A8(n)}function out(n,e,t){var r=t.type,i=t.connect,a=t.center,s=t.closed,o=s?[["Z"]]:[],c=N([e2(n,t),e2(e.slice().reverse(),t,!0)],2),l=c[0],u=c[1],h=N([n[0],e.slice(-1)[0]],2),f=h[0],d=h[1],p=function(y,b){return[l,y,u,b,o].flat()};if(i==="line"||r==="surround")return p([Q(["L"],N(d),!1)],[Q(["L"],N(f),!1)]);if(!a)throw new Error("Arc grid need to specified center");var g=N([Qo(d,a),Qo(f,a)],2),v=g[0],m=g[1];return p([Q(["A",v,v,0,0,1],N(d),!1),Q(["L"],N(d),!1)],[Q(["A",m,m,0,0,0],N(f),!1),Q(["L"],N(f),!1)])}function cut(n,e,t,r){var i=t.animate,a=t.isBillboard,s=e.map(function(o,c){return{id:o.id||"grid-line-".concat(c),d:e2(o.points,t)}});return n.selectAll(tc.line.class).data(s,function(o){return o.id}).join(function(o){return o.append("path").each(function(c,l){var u=cr(Zw(G({d:c.d},r)),[c,l,s]);this.attr(G({class:tc.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},u))})},function(o){return o.transition(function(c,l){var u=cr(Zw(G({d:c.d},r)),[c,l,s]);return Kr(this,u,i.update)})},function(o){return o.transition(function(){var c=this,l=i0(this,i.exit);return xc(l,function(){return c.remove()}),l})}).transitions()}function lut(n,e,t){var r=t.animate,i=t.connect,a=t.areaFill;if(e.length<2||!a||!i)return[];for(var s=Array.isArray(a)?a:[a,"transparent"],o=function(p){return s[p%s.length]},c=[],l=0;l<e.length-1;l++){var u=N([e[l].points,e[l+1].points],2),h=u[0],f=u[1],d=out(h,f,t);c.push({d,fill:o(l)})}return n.selectAll(tc.region.class).data(c,function(p,g){return g}).join(function(p){return p.append("path").each(function(g,v){var m=cr(g,[g,v,c]);this.attr(m)}).attr("className",tc.region.name)},function(p){return p.transition(function(g,v){var m=cr(g,[g,v,c]);return Kr(this,m,r.update)})},function(p){return p.transition(function(){var g=this,v=i0(this,r.exit);return xc(v,function(){return g.remove()}),v})}).transitions()}function uut(n){var e=n.data,t=e===void 0?[]:e,r=n.closed;return r?t.map(function(i){var a=i.points,s=N(a,1),o=s[0];return G(G({},i),{points:Q(Q([],N(a),!1),[o],!1)})}):t}var hut=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){t.type,t.center,t.areaFill,t.closed;var i=ie(t,["type","center","areaFill","closed"]),a=uut(t),s=ot(r).maybeAppendByClassName(tc.lineGroup,"g"),o=ot(r).maybeAppendByClassName(tc.regionGroup,"g"),c=cut(s,a,t,i),l=lut(o,a,t);return Q(Q([],N(c),!1),N(l),!1)},e}(Yt);function N8(n,e){return Object.fromEntries(Object.entries(n).map(function(t){var r=N(t,2),i=r[0],a=r[1];return[i,cr(a,e)]}))}function x_(n,e){return e&&ft(e)?n.filter(e):n}function R8(n,e){var t=e.startAngle,r=e.endAngle;return(r-t)*n+t}function a0(n,e){if(e.type==="linear"){var t=N(e.startPos,2),r=t[0],i=t[1],a=N(e.endPos,2),s=a[0],o=a[1],c=N([s-r,o-i],2),l=c[0],u=c[1];return f_([l,u])}var h=Ns(R8(n,e));return[-Math.sin(h),Math.cos(h)]}function w_(n,e,t){var r=a0(n,t);return t8(r,e!=="positive")}function Mh(n,e){return w_(n,e.labelDirection,e)}function fut(n,e){var t=N(e.startPos,2),r=t[0],i=t[1],a=N(e.endPos,2),s=a[0],o=a[1],c=N([s-r,o-i],2),l=c[0],u=c[1];return[r+l*n,i+u*n]}function dut(n,e){var t=e.radius,r=N(e.center,2),i=r[0],a=r[1],s=Ns(R8(n,e));return[i+t*Math.cos(s),a+t*Math.sin(s)]}function s0(n,e){return e.type==="linear"?fut(n,e):dut(n,e)}function k8(n){return a0(0,n)[1]===0}function D8(n){return a0(0,n)[0]===0}function L8(n,e){return e-n===360}function UN(n,e,t,r,i){var a=e-n,s=N([i,i],2),o=s[0],c=s[1],l=N([Ns(n),Ns(e)],2),u=l[0],h=l[1],f=function(P){return[t+i*Math.cos(P),r+i*Math.sin(P)]},d=N(f(u),2),p=d[0],g=d[1],v=N(f(h),2),m=v[0],y=v[1];if(L8(n,e)){var b=(h+u)/2,w=N(f(b),2),x=w[0],S=w[1];return[["M",p,g],["A",o,c,0,1,0,x,S],["A",o,c,0,1,0,m,y]]}var _=a>180?1:0,E=n>e?0:1;return"M".concat(p,",").concat(g,",A").concat(o,",").concat(c,",0,").concat(_,",").concat(E,",").concat(m,",").concat(y)}function put(n){var e=n.attributes,t=e.startAngle,r=e.endAngle,i=e.center,a=e.radius;return Q(Q([t,r],N(i),!1),[a],!1)}function gut(n,e,t,r){var i=e.startAngle,a=e.endAngle,s=e.center,o=e.radius;return n.selectAll(re.line.class).data([{d:UN.apply(void 0,Q(Q([i,a],N(s),!1),[o],!1))}],function(c,l){return l}).join(function(c){return c.append("path").attr("className",re.line.name).styles(e).styles({d:function(l){return l.d}})},function(c){return c.transition(function(){var l=this,u=KB(this,put(this),Q(Q([i,a],N(s),!1),[o],!1),r.update);if(u){var h=function(){var f=ln(l.attributes,"__keyframe_data__");l.style.d=UN.apply(void 0,Q([],N(f),!1))};u.onframe=h,u.onfinish=h}return u}).styles(e)},function(c){return c.remove()}).styles(t).transitions()}function vut(n,e){e.truncRange,e.truncShape,e.lineExtension}function mut(n,e,t){t===void 0&&(t=[0,0]);var r=N([n,e,t],3),i=N(r[0],2),a=i[0],s=i[1],o=N(r[1],2),c=o[0],l=o[1],u=N(r[2],2),h=u[0],f=u[1],d=N([c-a,l-s],2),p=d[0],g=d[1],v=Math.sqrt(Math.pow(p,2)+Math.pow(g,2)),m=N([-h/v,f/v],2),y=m[0],b=m[1];return[y*p,y*g,b*p,b*g]}function YN(n){var e=N(n,2),t=N(e[0],2),r=t[0],i=t[1],a=N(e[1],2),s=a[0],o=a[1];return{x1:r,y1:i,x2:s,y2:o}}function yut(n,e,t,r){var i=e.showTrunc,a=e.startPos,s=e.endPos,o=e.truncRange,c=e.lineExtension,l=N([a,s],2),u=N(l[0],2),h=u[0],f=u[1],d=N(l[1],2),p=d[0],g=d[1],v=N(c?mut(a,s,c):new Array(4).fill(0),4),m=v[0],y=v[1],b=v[2],w=v[3],x=function(L){return n.selectAll(re.line.class).data(L,function($,V){return V}).join(function($){return $.append("line").attr("className",function(V){return"".concat(re.line.name," ").concat(V.className)}).styles(t).transition(function(V){return Kr(this,YN(V.line),!1)})},function($){return $.styles(t).transition(function(V){var W=V.line;return Kr(this,YN(W),r.update)})},function($){return $.remove()}).transitions()};if(!i||!o)return x([{line:[[h+m,f+y],[p+b,g+w]],className:re.line.name}]);var S=N(o,2),_=S[0],E=S[1],P=p-h,O=g-f,C=N([h+P*_,f+O*_],2),M=C[0],T=C[1],R=N([h+P*E,f+O*E],2),D=R[0],B=R[1],j=x([{line:[[h+m,f+y],[M,T]],className:re.lineFirst.name},{line:[[D,B],[p+b,g+w]],className:re.lineSecond.name}]);return vut(n,e),j}function but(n,e,t,r){var i=t.showArrow,a=t.showTrunc,s=t.lineArrow,o=t.lineArrowOffset,c=t.lineArrowSize,l;if(e==="arc"?l=n.select(re.line.class):a?l=n.select(re.lineSecond.class):l=n.select(re.line.class),!i||!s||t.type==="arc"&&L8(t.startAngle,t.endAngle)){var u=l.node();u&&(u.style.markerEnd=void 0);return}var h=mi(s);h.attr(r),e0(h,c,!0),l.style("markerEnd",h).style("markerEndOffset",-o)}function Eut(n,e,t){var r=e.type,i,a=pt(e,"line");return r==="linear"?i=yut(n,e,Xw(a,"arrow"),t):i=gut(n,e,Xw(a,"arrow"),t),but(n,r,e,a),i}function xut(n,e){return w_(n,e.gridDirection,e)}function I8(n){var e=n.type,t=n.gridCenter;return e==="linear"?t:t||n.center}function wut(n,e){var t=e.gridLength;return n.map(function(r,i){var a=r.value,s=N(s0(a,e),2),o=s[0],c=s[1],l=N(Wr(xut(a,e),t),2),u=l[0],h=l[1];return{id:i,points:[[o,c],[o+u,c+h]]}})}function Sut(n,e){var t=e.gridControlAngles,r=I8(e);if(!r)throw new Error("grid center is not provide");if(n.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=N(r,2),a=i[0],s=i[1];return n.map(function(o,c){var l=o.value,u=N(s0(l,e),2),h=u[0],f=u[1],d=N([h-a,f-s],2),p=d[0],g=d[1],v=[];return t.forEach(function(m){var y=Ns(m),b=N([Math.cos(y),Math.sin(y)],2),w=b[0],x=b[1],S=p*w-g*x+a,_=p*x+g*w+s;v.push([S,_])}),{points:v,id:c}})}function _ut(n,e,t,r){var i=pt(t,"grid"),a=i.type,s=i.areaFill,o=I8(t),c=x_(e,t.gridFilter),l=a==="segment"?wut(c,t):Sut(c,t),u=G(G({},i),{center:o,areaFill:ft(s)?c.map(function(h,f){return cr(s,[h,f,c])}):s,animate:r,data:l});return n.selectAll(re.grid.class).data([1]).join(function(h){return h.append(function(){return new hut({style:u})}).attr("className",re.grid.name)},function(h){return h.transition(function(){return this.update(u)})},function(h){return h.remove()}).transitions()}var n2=function(){function n(e,t,r,i){this.set(e,t,r,i)}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),n.prototype.rotatedPoints=function(e,t,r){var i=this,a=i.x1,s=i.y1,o=i.x2,c=i.y2,l=Math.cos(e),u=Math.sin(e),h=t-t*l+r*u,f=r-t*u-r*l,d=[[l*a-u*c+h,u*a+l*c+f],[l*o-u*c+h,u*o+l*c+f],[l*a-u*s+h,u*a+l*s+f],[l*o-u*s+h,u*o+l*s+f]];return d},n.prototype.set=function(e,t,r,i){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},n.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},n}();function r2(n,e){var t=n.getEulerAngles()||0;n.setEulerAngles(0);var r=n.getBounds(),i=N(r.min,2),a=i[0],s=i[1],o=N(r.max,2),c=o[0],l=o[1],u=n.getBBox(),h=u.width,f=u.height,d=f,p=0,g=0,v=a,m=s,y=u_(n);if(y){d-=1.5;var b=y.style.textAlign,w=y.style.textBaseline;b==="center"?v=(a+c)/2:(b==="right"||b==="end")&&(v=c),w==="middle"?m=(s+l)/2:w==="bottom"&&(m=l)}var x=N(xe(e),4),S=x[0],_=S===void 0?0:S,E=x[1],P=E===void 0?0:E,O=x[2],C=O===void 0?_:O,M=x[3],T=M===void 0?P:M,R=new n2((p+=a)-T,(g+=s)-_,p+h+P,g+d+C);return n.setEulerAngles(t),R.rotatedPoints(Ns(t),v,m)}function wu(n,e){return e[0]<=Math.max(n[0][0],n[1][0])&&e[0]<=Math.min(n[0][0],n[1][0])&&e[1]<=Math.max(n[0][1],n[1][1])&&e[1]<=Math.min(n[0][1],n[1][1])}function Su(n,e,t){var r=(e[1]-n[1])*(t[0]-e[0])-(e[0]-n[0])*(t[1]-e[1]);return r===0?0:r<0?2:1}function Out(n,e){var t=Su(n[0],n[1],e[0]),r=Su(n[0],n[1],e[1]),i=Su(e[0],e[1],n[0]),a=Su(e[0],e[1],n[1]);return!!(t!==r&&i!==a||t===0&&wu(n,e[0])||r===0&&wu(n,e[1])||i===0&&wu(e,n[0])||a===0&&wu(e,n[1]))}function Put(n,e){var t=n.length;if(t<3)return!1;var r=[e,[9999,e[1]]],i=0,a=0;do{var s=[n[a],n[(a+1)%t]];if(Out(s,r)){if(Su(s[0],e,s[1])===0)return wu(s,e);i++}a=(a+1)%t}while(a!==0);return!!(i&1)}function Cut(n,e){return e.every(function(t){return Put(n,t)})}function Mut(n,e,t){var r=n.x1,i=n.x2,a=n.y1,s=n.y2,o=[[r,a],[i,a],[i,s],[r,s]],c=r2(e,t);return Cut(o,c)}function Tut(n,e){var t=N(n,4),r=t[0],i=t[1],a=t[2],s=t[3],o=N(e,4),c=o[0],l=o[1],u=o[2],h=o[3],f=a-r,d=s-i,p=u-c,g=h-l,v=f*g-p*d;if(v===0)return!1;var m=v>0,y=r-c,b=i-l,w=f*b-d*y;if(w<0===m)return!1;var x=p*b-g*y;return!(x<0===m||w>v===m||x>v===m)}function Aut(n,e){var t=[[n[0],n[1],n[2],n[3]],[n[2],n[3],n[4],n[5]],[n[4],n[5],n[6],n[7]],[n[6],n[7],n[0],n[1]]];return t.some(function(r){return Tut(e,r)})}function Nut(n,e,t){var r,i,a=r2(n,t).flat(1),s=r2(e,t).flat(1),o=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var c=er(o),l=c.next();!l.done;l=c.next()){var u=l.value;if(Aut(s,u))return!0}}catch(h){r={error:h}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return!1}function Rut(n,e){var t=n.type,r=n.labelDirection,i=n.crossSize;if(!i)return!1;if(t==="arc"){var a=n.center,s=n.radius,o=N(a,2),c=o[0],l=o[1],u=r==="negative"?0:i,h=-s-u,f=s+u,d=N(xe(e),4),p=d[0],g=d[1],v=d[2],m=d[3];return new n2(c+h-m,l+h-p,c+f+g,l+f+v)}var y=N(n.startPos,2),b=y[0],w=y[1],x=N(n.endPos,2),S=x[0],_=x[1],E=N(D8(n)?[-e,0,e,0]:[0,e,0,-e],4),P=E[0],O=E[1],C=E[2],M=E[3],T=Mh(0,n),R=Wr(T,i),D=new n2(b,w,S,_);return D.x1+=M,D.y1+=P,D.x2+=O+R[0],D.y2+=C+R[1],D}function o0(n,e,t){var r,i,a=e.crossPadding,s=new Set,o=null,c=Rut(e,a),l=function(p){return c?Mut(c,p):!0},u=function(p,g){return!p||!p.firstChild?!0:!Nut(p.firstChild,g.firstChild,xe(t))};try{for(var h=er(n),f=h.next();!f.done;f=h.next()){var d=f.value;l(d)?!o||u(o,d)?o=d:(s.add(o),s.add(d)):s.add(d)}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return Array.from(s)}function VE(n,e){return e===void 0&&(e={}),gt(n)?0:typeof n=="number"?n:Math.floor(jB(n,e))}function kut(n,e,t,r){if(!(n.length<=1)){var i=e.suffix,a=i===void 0?"...":i,s=e.minLength,o=e.maxLength,c=o===void 0?1/0:o,l=e.step,u=l===void 0?" ":l,h=e.margin,f=h===void 0?[0,0,0,0]:h,d=l_(r.getTextShape(n[0])),p=VE(u,d),g=s?VE(s,d):p,v=VE(c,d);(gt(v)||v===1/0)&&(v=Math.max.apply(null,n.map(function(S){return S.getBBox().width})));var m=n.slice(),y=N(f,4);y[0],y[1],y[2],y[3];for(var b=function(S){if(m.forEach(function(_){r.ellipsis(r.getTextShape(_),S,a)}),m=o0(n,t,f),m.length<1)return{value:void 0}},w=v;w>g+p;w-=p){var x=b(w);if(typeof x=="object")return x.value}}}var Dut={parity:function(n,e){var t=e.seq,r=t===void 0?2:t;return n.filter(function(i,a){return a%r?(xn(i),!1):!0})}},Lut=function(n){return n.filter(c_)};function Iut(n,e,t,r){var i=n.length,a=e.keepHeader,s=e.keepTail;if(!(i<=1||i===2&&a&&s)){var o=Dut.parity,c=function(b){return b.forEach(r.show),b},l=2,u=n.slice(),h=n.slice(),f=Math.min.apply(Math,Q([1],N(n.map(function(b){return b.getBBox().width})),!1));if(t.type==="linear"&&(k8(t)||D8(t))){var d=Qw(n[0]).left,p=Qw(n[i-1]).right,g=Math.abs(p-d)||1;l=Math.max(Math.floor(i*f/g),l)}var v,m;for(a&&(v=u.splice(0,1)[0]),s&&(m=u.splice(-1,1)[0],u.reverse()),c(u);l<n.length&&o0(Lut(m?Q(Q([m],N(h),!1),[v],!1):Q([v],N(h),!1)),t,e==null?void 0:e.margin).length;){if(m&&!v&&l%2===0){var y=u.splice(0,1);y.forEach(r.hide)}else if(m&&v){var y=u.splice(0,1);y.forEach(r.hide)}h=o(c(u),{seq:l}),l++}}}function But(n,e,t,r){var i,a,s=e.optionalAngles,o=s===void 0?[0,45,90]:s,c=e.margin,l=e.recoverWhenFailed,u=l===void 0?!0:l,h=n.map(function(m){return m.getLocalEulerAngles()}),f=function(){return o0(n,t,c).length<1},d=function(m){return n.forEach(function(y,b){var w=Array.isArray(m)?m[b]:m;r.rotate(y,+w)})};try{for(var p=er(o),g=p.next();!g.done;g=p.next()){var v=g.value;if(d(v),f())return}}catch(m){i={error:m}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}u&&d(h)}function Fut(n){var e=n.type,t=n.labelDirection;return e==="linear"&&k8(n)?t==="negative"?"bottom":"top":"middle"}function $ut(n,e,t,r){var i=e.wordWrapWidth,a=i===void 0?50:i,s=e.maxLines,o=s===void 0?3:s,c=e.recoverWhenFailed,l=c===void 0?!0:c,u=e.margin,h=u===void 0?[0,0,0,0]:u,f=n.map(function(y){return y.attr("maxLines")||1}),d=Math.min.apply(Math,Q([],N(f),!1)),p=function(){return o0(n,t,h).length<1},g=Fut(t),v=function(y){return n.forEach(function(b,w){var x=Array.isArray(y)?y[w]:y;r.wrap(b,a,x,g)})};if(!(d>o)){for(var m=d;m<=o;m++)if(v(m),p())return;l&&v(f)}}var zut=new Map([["hide",Iut],["rotate",But],["ellipsis",kut],["wrap",$ut]]);function jut(n,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!$B(n[0]):t==="rotate"?!n.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?n.filter(function(r){return r.querySelector("text")}).length>1:!0}function qut(n,e,t){var r=e.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(a){var s=a.type,o=zut.get(s);jut(n,e,s)&&(o==null||o(n,a,e,t))})}function Gut(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=function(r){return r==="positive"?-1:1};return n.reduce(function(r,i){return r*t(i)},1)}function KN(n){for(var e=n;e<0;)e+=360;return Math.round(e%360)}function i2(n,e){var t=N(n,2),r=t[0],i=t[1],a=N(e,2),s=a[0],o=a[1],c=N([r*s+i*o,r*o-i*s],2),l=c[0],u=c[1];return Math.atan2(u,l)}function Vut(n){var e=(n+360)%180;return Qe(e,-90,90)||(e+=180),e}function Wut(n,e,t){var r,i=t.labelAlign,a=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(a)return e.getLocalEulerAngles();var s=0,o=Mh(n.value,t),c=a0(n.value,t);return i==="horizontal"?0:(i==="perpendicular"?s=i2([1,0],o):s=i2([c[0]<0?-1:1,0],c),Vut(o_(s)))}function B8(n,e,t){var r=t.type,i=t.labelAlign,a=Mh(n,t),s=KN(e),o=KN(o_(i2([1,0],a))),c="center",l="middle";return r==="linear"?[90,270].includes(o)&&s===0?(c="center",l=a[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(s)?c="center":o===0?(Qe(s,0,90,!1,!0)||Qe(s,0,90)||Qe(s,270,360))&&(c="start"):o===90?Qe(s,0,90,!1,!0)?c="start":(Qe(s,90,180)||Qe(s,270,360))&&(c="end"):o===270?Qe(s,0,90,!1,!0)?c="end":(Qe(s,90,180)||Qe(s,270,360))&&(c="start"):o===180&&(s===90?c="start":(Qe(s,0,90)||Qe(s,270,360))&&(c="end")):i==="parallel"?Qe(o,0,180,!0)?l="top":l="bottom":i==="horizontal"?Qe(o,90,270,!1)?c="end":(Qe(o,270,360,!1)||Qe(o,0,90))&&(c="start"):i==="perpendicular"&&(Qe(o,90,270)?c="end":c="start"),{textAlign:c,textBaseline:l}}function Hut(n,e,t){e.setLocalEulerAngles(n);var r=e.__data__.value,i=B8(r,n,t),a=e.querySelector(re.labelItem.class);a&&F8(a,i)}function XN(n,e,t){var r=t.showTick,i=t.tickLength,a=t.tickDirection,s=t.labelDirection,o=t.labelSpacing,c=e.indexOf(n),l=cr(o,[n,c,e]),u=N([Mh(n.value,t),Gut(s,a)],2),h=u[0],f=u[1],d=f===1?cr(r?i:0,[n,c,e]):0,p=N(wo(Wr(h,l+d),s0(n.value,t)),2),g=p[0],v=p[1];return{x:g,y:v}}function Uut(n,e,t,r){var i=r.labelFormatter,a=ft(i)?function(){return mi(cr(i,[n,e,t,Mh(n.value,r)]))}:function(){return mi(n.label||"")};return a}function F8(n,e){n.nodeName==="text"&&n.attr(e)}function ZN(n){qut(this.node().childNodes,n,{hide:xn,show:Ha,rotate:function(e,t){Hut(+t,e,n)},ellipsis:function(e,t,r){e&&cp(e,t||1/0,r)},wrap:function(e,t,r){e&&qB(e,t,r)},getTextShape:function(e){return e.querySelector("text")}})}function QN(n,e,t,r,i){var a=t.indexOf(e),s=ot(n).append(Uut(e,a,t,i)).attr("className",re.labelItem.name).node(),o=N(yi(N8(r,[e,a,t])),2),c=o[0],l=o[1],u=l.transform,h=ie(l,["transform"]);d_(s,u);var f=Wut(e,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(f),F8(s,G(G({},B8(e.value,f,i)),c)),n.attr(h),s}function Yut(n,e,t,r){var i=x_(e,t.labelFilter),a=pt(t,"label");return n.selectAll(re.label.class).data(i,function(s,o){return o}).join(function(s){return s.append("g").attr("className",re.label.name).transition(function(o){QN(this,o,e,a,t);var c=XN(o,e,t),l=c.x,u=c.y;return this.style.transform="translate(".concat(l,", ").concat(u,")"),null}).call(function(){ZN.call(n,t)})},function(s){return s.transition(function(o){var c=this.querySelector(re.labelItem.class),l=QN(this,o,e,a,t),u=rut(c,l,r.update),h=XN(o,e,t),f=h.x,d=h.y,p=Kr(this,{transform:"translate(".concat(f,", ").concat(d,")")},r.update);return Q(Q([],N(u),!1),[p],!1)}).call(function(o){var c=ln(o,"_transitions").flat().filter(c_);eut(c,function(){ZN.call(n,t)})})},function(s){return s.transition(function(){var o=this,c=i0(this.childNodes[0],r.exit);return xc(c,function(){return ot(o).remove()}),c})}).transitions()}function $8(n,e){return w_(n,e.tickDirection,e)}function Kut(n,e){var t=N(n,2),r=t[0],i=t[1];return[[0,0],[r*e,i*e]]}function Xut(n,e,t,r,i){var a=i.tickLength,s=N(Kut(r,cr(a,[n,e,t])),2),o=N(s[0],2),c=o[0],l=o[1],u=N(s[1],2),h=u[0],f=u[1];return{x1:c,x2:h,y1:l,y2:f}}function Zut(n,e,t,r,i){var a=i.tickFormatter,s=$8(e.value,i),o="line";return ft(a)&&(o=function(){return cr(a,[e,t,r,s])}),n.append(o).attr("className",re.tickItem.name)}function Qut(n,e,t,r,i,a,s){var o=$8(n.value,a),c=Xut(n,e,t,o,a),l=c.x1,u=c.x2,h=c.y1,f=c.y2,d=N(yi(N8(s,[n,e,t,o])),2),p=d[0],g=d[1];r.node().nodeName==="line"&&r.styles(G({x1:l,x2:u,y1:h,y2:f},p)),i.attr(g),r.styles(p)}function JN(n,e,t,r,i,a){var s=Zut(ot(this),n,e,t,r);Qut(n,e,t,s,this,r,i);var o=N(s0(n.value,r),2),c=o[0],l=o[1];return Kr(this,{transform:"translate(".concat(c,", ").concat(l,")")},a)}function Jut(n,e,t,r){var i=x_(e,t.tickFilter),a=pt(t,"tick");return n.selectAll(re.tick.class).data(i,function(s){return s.id||s.label}).join(function(s){return s.append("g").attr("className",re.tick.name).transition(function(o,c){return JN.call(this,o,c,i,t,a,!1)})},function(s){return s.transition(function(o,c){return this.removeChildren(),JN.call(this,o,c,i,t,a,r.update)})},function(s){return s.transition(function(){var o=this,c=i0(this.childNodes[0],r.exit);return xc(c,function(){return o.remove()}),c})}).transitions()}var tR=ur({text:"text"},"title");function c0(n){return/\S+-\S+/g.test(n)?n.split("-").map(function(e){return e[0]}):n.length>2?[n[0]]:n.split("")}function tht(n,e){var t=n.attributes,r=t.position,i=t.spacing,a=t.inset,s=t.text,o=n.getBBox(),c=e.getBBox(),l=c0(r),u=N(xe(s?i:0),4),h=u[0],f=u[1],d=u[2],p=u[3],g=N(xe(a),4),v=g[0],m=g[1],y=g[2],b=g[3],w=N([p+f,h+d],2),x=w[0],S=w[1],_=N([b+m,v+y],2),E=_[0],P=_[1];if(l[0]==="l")return new Xt(o.x,o.y,c.width+o.width+x+E,Math.max(c.height+P,o.height));if(l[0]==="t")return new Xt(o.x,o.y,Math.max(c.width+E,o.width),c.height+o.height+S+P);var O=N([e.attributes.width||c.width,e.attributes.height||c.height],2),C=O[0],M=O[1];return new Xt(c.x,c.y,C+o.width+x+E,M+o.height+S+P)}function eht(n,e){var t=Object.entries(e).reduce(function(r,i){var a=N(i,2),s=a[0],o=a[1],c=n.node().attr(s);return c||(r[s]=o),r},{});n.styles(t)}function nht(n){var e,t,r,i,a=n,s=a.width,o=a.height,c=a.position,l=N([+s/2,+o/2],2),u=l[0],h=l[1],f=N([+u,+h,"center","middle"],4),d=f[0],p=f[1],g=f[2],v=f[3],m=c0(c);return m.includes("l")&&(e=N([0,"start"],2),d=e[0],g=e[1]),m.includes("r")&&(t=N([+s,"end"],2),d=t[0],g=t[1]),m.includes("t")&&(r=N([0,"top"],2),p=r[0],v=r[1]),m.includes("b")&&(i=N([+o,"bottom"],2),p=i[0],v=i[1]),{x:d,y:p,textAlign:g,textBaseline:v}}var z8=function(n){tt(e,n);function e(t){return n.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,r=this.attributes,i=r.width,a=r.height,s=r.position,o=r.spacing,c=r.inset,l=t.querySelector(tR.text.class);if(!l)return new Xt(0,0,+i,+a);var u=l.getBBox(),h=u.width,f=u.height,d=N(xe(o),4),p=d[0],g=d[1],v=d[2],m=d[3],y=N([0,0,+i,+a],4),b=y[0],w=y[1],x=y[2],S=y[3],_=c0(s);if(_.includes("i"))return new Xt(b,w,x,S);_.forEach(function(B,j){var L,$,V,W;B==="t"&&(L=N(j===0?[f+v,+a-f-v]:[0,+a],2),w=L[0],S=L[1]),B==="r"&&($=N([+i-h-m],1),x=$[0]),B==="b"&&(V=N([+a-f-p],1),S=V[0]),B==="l"&&(W=N(j===0?[h+g,+i-h-g]:[0,+i],2),b=W[0],x=W[1])});var E=N(xe(c),4),P=E[0],O=E[1],C=E[2],M=E[3],T=N([M+O,P+C],2),R=T[0],D=T[1];return new Xt(b+M,w+P,x-R,S-D)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new Xt(0,0,0,0)},e.prototype.render=function(t,r){var i=this;t.width,t.height,t.position,t.spacing;var a=ie(t,["width","height","position","spacing"]),s=N(yi(a),1),o=s[0],c=nht(t),l=c.x,u=c.y,h=c.textAlign,f=c.textBaseline;Nn(!!a.text,ot(r),function(d){i.title=d.maybeAppendByClassName(tR.text,"text").styles(o).call(eht,{x:l,y:u,textAlign:h,textBaseline:f}).node()})},e}(Yt);function rht(n,e,t){var r=t.titlePosition,i=r===void 0?"lb":r,a=t.titleSpacing,s=c0(i),o=n.node().getLocalBounds(),c=N(o.min,2),l=c[0],u=c[1],h=N(o.halfExtents,2),f=h[0],d=h[1],p=N(e.node().getLocalBounds().halfExtents,2),g=p[0],v=p[1],m=N([l+f,u+d],2),y=m[0],b=m[1],w=N(xe(a),4),x=w[0],S=w[1],_=w[2],E=w[3];if(["start","end"].includes(i)&&t.type==="linear"){var P=t.startPos,O=t.endPos,C=N(i==="start"?[P,O]:[O,P],2),M=C[0],T=C[1],R=f_([-T[0]+M[0],-T[1]+M[1]]),D=N(Wr(R,x),2),B=D[0],j=D[1];return{x:M[0]+B,y:M[1]+j}}return s.includes("t")&&(b-=d+v+x),s.includes("r")&&(y+=f+g+S),s.includes("l")&&(y-=f+g+E),s.includes("b")&&(b+=d+v+_),{x:y,y:b}}function iht(n,e,t){var r=n.getGeometryBounds().halfExtents,i=r[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function eR(n,e,t,r,i){var a=pt(r,"title"),s=N(yi(a),2),o=s[0],c=s[1],l=c.transform,u=c.transformOrigin,h=ie(c,["transform","transformOrigin"]);e.styles(h);var f=l||iht(n.node(),o.direction,o.position);n.styles(G(G({},o),{transformOrigin:u})),d_(n.node(),f);var d=rht(ot(t._offscreen||t.querySelector(re.mainGroup.class)),e,r),p=d.x,g=d.y,v=Kr(e.node(),{transform:"translate(".concat(p,", ").concat(g,")")},i);return v}function aht(n,e,t,r){var i=t.titleText;return n.selectAll(re.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,s){return a.title}).join(function(a){return a.append(function(){return mi(i)}).attr("className",re.title.name).transition(function(){return eR(ot(this),n,e,t,r.enter)})},function(a){return a.transition(function(){return eR(ot(this),n,e,t,r.update)})},function(a){return a.remove()}).transitions()}function nR(n,e,t,r){var i=n.showLine,a=n.showTick,s=n.showLabel,o=e.maybeAppendByClassName(re.lineGroup,"g"),c=Nn(i,o,function(d){return Eut(d,n,r)})||[],l=e.maybeAppendByClassName(re.tickGroup,"g"),u=Nn(a,l,function(d){return Jut(d,t,n,r)})||[],h=e.maybeAppendByClassName(re.labelGroup,"g"),f=Nn(s,h,function(d){return Yut(d,t,n,r)})||[];return Q(Q(Q([],N(c),!1),N(u),!1),N(f),!1).filter(function(d){return!!d})}var S_=function(n){tt(e,n);function e(t){return n.call(this,t,E_)||this}return e.prototype.render=function(t,r,i){var a=this,s=t.titleText,o=t.data,c=t.animate,l=t.showTitle,u=t.showGrid,h=t.dataThreshold,f=t.truncRange,d=i8(o,h).filter(function(x){var S=x.value;return!(f&&S>f[0]&&S<f[1])}),p=HN(i===void 0?c:i),g=ot(r).maybeAppendByClassName(re.gridGroup,"g"),v=Nn(u,g,function(x){return _ut(x,d,t,p)})||[],m=ot(r).maybeAppendByClassName(re.mainGroup,"g");s&&(!this.initialized&&p.enter||this.initialized&&p.update)&&nR(t,ot(this.offscreenGroup),d,HN(!1));var y=nR(t,ot(m.node()),d,p),b=ot(r).maybeAppendByClassName(re.titleGroup,"g"),w=Nn(l,b,function(x){return aht(x,a,t,p)})||[];return Q(Q(Q([],N(v),!1),N(y),!1),N(w),!1).flat().filter(function(x){return!!x})},e}(Yt),sht=function(){function n(){}return n}(),br=ur({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),j8=function(n){tt(e,n);function e(t){var r=n.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:flt(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new Ze({class:br.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new Ze({class:br.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return oe(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,r=N(g8(t.map(function(h){var f=h.getBBox(),d=f.width,p=f.height;return[d,p]})).map(function(h){return Math.max.apply(Math,Q([],N(h),!1))}),2),i=r[0],a=r[1],s=this.attributes,o=s.pageWidth,c=o===void 0?i:o,l=s.pageHeight,u=l===void 0?a:l;return{pageWidth:c,pageHeight:u}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=n.prototype.getBBox.call(this),r=t.x,i=t.y,a=this.controllerShape,s=this.pageShape,o=s.pageWidth,c=s.pageHeight;return new Xt(r,i,o+a.width,c)},e.prototype.goTo=function(t){var r=this,i=this.attributes.animate,a=this,s=a.currPage,o=a.playState,c=a.playWindow,l=a.pageViews;if(o!=="idle"||t<0||l.length<=0||t>=l.length)return null;l[s].setLocalPosition(0,0),this.prepareFollowingPage(t);var u=N(this.getFollowingPageDiff(t),2),h=u[0],f=u[1];this.playState="running";var d=O8(c,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-f,")")}],i);return xc(d,function(){r.innerCurrPage=t,r.playState="idle",r.setVisiblePages([t]),r.updatePageInfo()}),d},e.prototype.prev=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var a=t?(i-1+r)%r:oe(i-1,0,r);return this.goTo(a)},e.prototype.next=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i>=r-1)return null;var a=t?(i+1)%r:oe(i+1,0,r);return this.goTo(a)},e.prototype.renderClipPath=function(t){var r=this.pageShape,i=r.pageWidth,a=r.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(br.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(r,i){t.includes(i)?Ha(r):xn(r)})},e.prototype.adjustControllerLayout=function(){var t=this,r=t.prevBtnGroup,i=t.nextBtnGroup,a=t.pageInfoGroup,s=this.attributes,o=s.orientation,c=s.controllerPadding,l=a.getBBox(),u=l.width;l.height;var h=N(o==="horizontal"?[-180,0]:[-90,90],2),f=h[0],d=h[1];r.setLocalEulerAngles(f),i.setLocalEulerAngles(d);var p=r.getBBox(),g=p.width,v=p.height,m=i.getBBox(),y=m.width,b=m.height,w=Math.max(g,u,y),x=o==="horizontal"?{offset:[[0,0],[g/2+c,0],[g+u+c*2,0]],textAlign:"start"}:{offset:[[w/2,-v-c],[w/2,0],[w/2,b+c]],textAlign:"center"},S=N(x.offset,3),_=N(S[0],2),E=_[0],P=_[1],O=N(S[1],2),C=O[0],M=O[1],T=N(S[2],2),R=T[0],D=T[1],B=x.textAlign,j=a.querySelector("text");j&&(j.style.textAlign=B),r.setLocalPosition(E,P),a.setLocalPosition(C,M),i.setLocalPosition(R,D)},e.prototype.updatePageInfo=function(){var t,r=this,i=r.currPage,a=r.pageViews,s=r.attributes.formatter;a.length<2||((t=this.pageInfoGroup.querySelector(br.pageInfo.class))===null||t===void 0||t.attr("text",s(i+1,a.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var r=this.currPage;if(r===t)return[0,0];var i=this.attributes.orientation,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,c=t<r?-1:1;return i==="horizontal"?[c*s,0]:[0,c*o]},e.prototype.prepareFollowingPage=function(t){var r=this,i=r.currPage,a=r.pageViews;if(this.setVisiblePages([t,i]),t!==i){var s=N(this.getFollowingPageDiff(t),2),o=s[0],c=s[1];a[t].setLocalPosition(o,c)}},e.prototype.renderController=function(t){var r=this,i=this.attributes.controllerSpacing,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,c=this.pageViews.length>=2,l=t.maybeAppendByClassName(br.controller,"g");if(Oh(l.node(),c),!!c){var u=pt(this.attributes,"button"),h=pt(this.attributes,"pageNum"),f=N(yi(u),2),d=f[0],p=f[1],g=d.size,v=ie(d,["size"]),m=!l.select(br.prevBtnGroup.class).node(),y=l.maybeAppendByClassName(br.prevBtnGroup,"g").styles(p);this.prevBtnGroup=y.node();var b=y.maybeAppendByClassName(br.prevBtn,"path"),w=l.maybeAppendByClassName(br.nextBtnGroup,"g").styles(p);this.nextBtnGroup=w.node();var x=w.maybeAppendByClassName(br.nextBtn,"path");[b,x].forEach(function(_){_.styles(G(G({},v),{transformOrigin:"center"})),e0(_.node(),g,!0)});var S=l.maybeAppendByClassName(br.pageInfoGroup,"g");this.pageInfoGroup=S.node(),S.maybeAppendByClassName(br.pageInfo,"text").styles(h),this.updatePageInfo(),l.node().setLocalPosition(s+i,o/2),m&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s;this.attr("transform","translate(".concat(a,", ").concat(o,")"));var c=ot(r);this.renderClipPath(c),this.renderController(c),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,r=ch(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(vt.INSERTED,r),this.playWindow.addEventListener(vt.REMOVED,r)},e}(Yt);function oht(n,e,t){var r=Math.round((n-t)/e);return t+r*e}function cht(n,e,t){var r=1.4,i=r*t;return[["M",n-t,e-i],["L",n+t,e-i],["L",n+t,e+i],["L",n-t,e+i],["Z"]]}var q8=1.4,G8=.4;function lht(n,e,t){var r=t,i=r*q8,a=r/2,s=r/6,o=n+i*G8;return[["M",n,e],["L",o,e+a],["L",n+i,e+a],["L",n+i,e-a],["L",o,e-a],["Z"],["M",o,e+s],["L",n+i-2,e+s],["M",o,e-s],["L",n+i-2,e-s]]}function uht(n,e,t){var r=t,i=r*q8,a=r/2,s=r/6,o=e+i*G8;return[["M",n,e],["L",n-a,o],["L",n-a,e+i],["L",n+a,e+i],["L",n+a,o],["Z"],["M",n-s,o],["L",n-s,e+i-2],["M",n+s,o],["L",n+s,e+i-2]]}Qt.registerSymbol("hiddenHandle",cht);Qt.registerSymbol("verticalHandle",lht);Qt.registerSymbol("horizontalHandle",uht);function hht(n,e,t,r){var i,a=N(n,2),s=a[0],o=a[1],c=N(e,2),l=c[0],u=c[1],h=N(t,2),f=h[0],d=h[1],p=N([l,u],2),g=p[0],v=p[1],m=v-g;return g>v&&(i=N([v,g],2),g=i[0],v=i[1]),m>o-s?[s,o]:g<s?f===s&&d===v?[s,v]:[s,m+s]:v>o?d===o&&f===g?[g,o]:[o-m,o]:[g,v]}function di(n,e,t){return n===void 0&&(n="horizontal"),n==="horizontal"?e:t}var Xn=ur({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function fht(n){var e=n.querySelector(Xn.marker.class);return e?e.style:{}}var dht=function(n){tt(e,n);function e(t){return n.call(this,t,{span:[1,1],marker:function(){return new Zi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,a=t.node().getBBox(),s=a.width,o=a.height,c=r.node().getBBox(),l=c.width,u=c.height;return{markerWidth:i,labelWidth:s,valueWidth:l,height:Math.max(i,o,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var r=N(xe(t),2),i=r[0],a=r[1],s=this.showValue?a:0,o=i+s;return[i/o,s/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,r=this.attributes,i=r.markerSize,a=r.width,s=this.actualSpace,o=s.markerWidth,c=s.height,l=this.actualSpace,u=l.labelWidth,h=l.valueWidth,f=N(this.spacing,2),d=f[0],p=f[1];if(a){var g=a-i-d-p,v=N(this.span,2),m=v[0],y=v[1];t=N([m*g,y*g],2),u=t[0],h=t[1]}var b=o+u+h+d+p;return{width:b,height:c,markerWidth:o,labelWidth:u,valueWidth:h}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var r=N(xe(t),2),i=r[0],a=r[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,r=t.markerWidth,i=t.labelWidth,a=t.valueWidth,s=t.width,o=t.height,c=N(this.spacing,2),l=c[0],u=c[1];return{height:o,width:s,markerWidth:r,labelWidth:i,valueWidth:a,position:[r/2,r+l,r+i+l+u]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=fht(this.markerGroup.node()),r=this.attributes,i=r.markerSize,a=r.markerStrokeWidth,s=a===void 0?t.strokeWidth:a,o=r.markerLineWidth,c=o===void 0?t.lineWidth:o,l=r.markerStroke,u=l===void 0?t.stroke:l,h=+(s||c||(u?1:0))*Math.sqrt(2),f=this.markerGroup.node().getBBox(),d=f.width,p=f.height;return(1-h/Math.max(d,p))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var r=this,i=this.attributes.marker,a=pt(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(Xn.markerGroup,"g").style("zIndex",0),Nn(!!i,this.markerGroup,function(){var s,o=r.markerGroup.node(),c=(s=o.childNodes)===null||s===void 0?void 0:s[0],l=typeof i=="string"?new Qt({style:{symbol:i},className:Xn.marker.name}):i();c?l.nodeName===c.nodeName?c instanceof Qt?c.update(G(G({},a),{symbol:i})):(c8(c,l),ot(c).styles(a)):(c.remove(),ot(l).attr("className",Xn.marker.name).styles(a),o.appendChild(l)):(l instanceof Qt||ot(l).attr("className",Xn.marker.name).styles(a),o.appendChild(l)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var u=e0(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(u,")")})},e.prototype.renderLabel=function(t){var r=pt(this.attributes,"label"),i=r.text,a=ie(r,["text"]);this.labelGroup=t.maybeAppendByClassName(Xn.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Xn.label,function(){return mi(i)}).styles(a)},e.prototype.renderValue=function(t){var r=this,i=pt(this.attributes,"value"),a=i.text,s=ie(i,["text"]);this.valueGroup=t.maybeAppendByClassName(Xn.valueGroup,"g").style("zIndex",0),Nn(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Xn.value,function(){return mi(a)}).styles(s)})},e.prototype.renderBackground=function(t){var r=this.shape,i=r.width,a=r.height,s=pt(this.attributes,"background");this.background=t.maybeAppendByClassName(Xn.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Xn.background,"rect").styles(G({width:i,height:a},s))},e.prototype.adjustLayout=function(){var t=this.layout,r=t.labelWidth,i=t.valueWidth,a=t.height,s=N(t.position,3),o=s[0],c=s[1],l=s[2],u=a/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(u,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(c,", ").concat(u,")")}),cp(this.labelGroup.select(Xn.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(l,", ").concat(u,")")}),cp(this.valueGroup.select(Xn.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,r){var i=ot(r),a=t.x,s=a===void 0?0:a,o=t.y,c=o===void 0?0:o;i.styles({transform:"translate(".concat(s,", ").concat(c,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(Yt),es=ur({page:"item-page",navigator:"navigator",item:"item"},"items"),rR=function(n,e,t){return t===void 0&&(t=!0),n?e(n):t},pht=function(n){tt(e,n);function e(t){var r=n.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Jf,mouseenter:Jf,mouseleave:Jf})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,r=t.gridRow,i=t.gridCol,a=t.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,r=t.data,i=t.layout,a=pt(this.attributes,"item"),s=r.map(function(o,c){var l=o.id,u=l===void 0?c:l,h=o.label,f=o.value;return{id:"".concat(u),index:c,style:G({layout:i,labelText:h,valueText:f},Object.fromEntries(Object.entries(a).map(function(d){var p=N(d,2),g=p[0],v=p[1];return[g,cr(v,[o,c,r])]})))}});return s},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,r=this.attributes,i=r.orientation,a=r.width,s=r.rowPadding,o=r.colPadding,c=N(this.navigatorShape,1),l=c[0],u=N(this.grid,2),h=u[0],f=u[1],d=f*h,p=0;return this.pageViews.children.map(function(g,v){var m,y,b=Math.floor(v/d),w=v%d,x=t.ifHorizontal(f,h),S=[Math.floor(w/x),w%x];i==="vertical"&&S.reverse();var _=N(S,2),E=_[0],P=_[1],O=(a-l-(f-1)*o)/f,C=g.getBBox().height,M=N([0,0],2),T=M[0],R=M[1];return i==="horizontal"?(m=N([p,E*(C+s)],2),T=m[0],R=m[1],p=P===f-1?0:p+O+o):(y=N([P*(O+o),p],2),T=y[0],R=y[1],p=E===h-1?0:p+C+s),{page:b,index:v,row:E,col:P,pageIndex:w,width:O,height:C,x:T,y:R}})},e.prototype.getFlexLayout=function(){var t=this.attributes,r=t.width,i=t.height,a=t.rowPadding,s=t.colPadding,o=N(this.navigatorShape,1),c=o[0],l=N(this.grid,2),u=l[0],h=l[1],f=N([r-c,i],2),d=f[0],p=f[1],g=N([0,0,0,0,0,0,0,0],8),v=g[0],m=g[1],y=g[2],b=g[3],w=g[4],x=g[5],S=g[6],_=g[7];return this.pageViews.children.map(function(E,P){var O,C,M,T,R=E.getBBox(),D=R.width,B=R.height,j=S===0?0:s,L=S+j+D;if(L<=d&&rR(w,function(V){return V<h}))return O=N([S+j,_,L],3),v=O[0],m=O[1],S=O[2],{width:D,height:B,x:v,y:m,page:y,index:P,pageIndex:b++,row:x,col:w++};C=N([x+1,0,0,_+B+a],4),x=C[0],w=C[1],S=C[2],_=C[3];var $=_+B;return $<=p&&rR(x,function(V){return V<u})?(M=N([S,_,D],3),v=M[0],m=M[1],S=M[2],{width:D,height:B,x:v,y:m,page:y,index:P,pageIndex:b++,row:x,col:w++}):(T=N([0,0,D,0,y+1,0,0,0],8),v=T[0],m=T[1],S=T[2],_=T[3],y=T[4],b=T[5],x=T[6],w=T[7],{width:D,height:B,x:v,y:m,page:y,index:P,pageIndex:b++,row:x,col:w++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=t.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,r){var i=this.attributes.orientation;return di(i,t,r)},e.prototype.flattenPage=function(t){t.querySelectorAll(es.item.class).forEach(function(r){t.appendChild(r)}),t.querySelectorAll(es.page.class).forEach(function(r){var i=t.removeChild(r);i.destroy()})},e.prototype.renderItems=function(t){var r=this.attributes,i=r.click,a=r.mouseenter,s=r.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);ot(t).selectAll(es.item.class).data(this.renderData,function(c){return c.id}).join(function(c){return c.append(function(l){var u=l.style;return new dht({style:u})}).attr("className",es.item.name).on("click",function(){i==null||i(this),o("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){s==null||s(this),o("itemMouseleave",{item:this})})},function(c){return c.each(function(l){var u=l.style;this.update(u)})},function(c){return c.remove()})},e.prototype.relayoutNavigator=function(){var t,r=this.attributes,i=r.layout,a=r.width,s=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,o=N(this.navigatorShape,2),c=o[0],l=o[1];this.navigator.update(i==="grid"?{pageWidth:a-c,pageHeight:s-l}:{})},e.prototype.adjustLayout=function(){var t=this,r=Object.entries(VB(this.itemsLayout,"page")).map(function(a){var s=N(a,2),o=s[0],c=s[1];return{page:o,layouts:c}}),i=Q([],N(this.navigator.getContainer().children),!1);r.forEach(function(a){var s=a.layouts,o=t.pageViews.appendChild(new Ze({className:es.page.name}));s.forEach(function(c){var l=c.x,u=c.y,h=c.index,f=c.width,d=c.height,p=i[h];o.appendChild(p),qo(p,"__layout__",c),p.update({x:l,y:u,width:f,height:d})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var r=this.attributes.orientation,i=pt(this.attributes,"nav"),a=fe({orientation:r},i),s=this;return t.selectAll(es.navigator.class).data(["nav"]).join(function(o){return o.append(function(){return new j8({style:a})}).attr("className",es.navigator.name).each(function(){s.navigator=this})},function(o){return o.each(function(){this.update(a)})},function(o){return o.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,r){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(ot(r));this.renderItems(a.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,r){var i=new se(t,{detail:r});this.dispatchEvent(i)},e}(Yt),$c=ur({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),V8={showLabel:!0,formatter:function(n){return n.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},ght=function(n){tt(e,n);function e(t){return n.call(this,t,V8)||this}return e.prototype.render=function(t,r){var i=ot(r).maybeAppendByClassName($c.markerGroup,"g");this.renderMarker(i);var a=ot(r).maybeAppendByClassName($c.labelGroup,"g");this.renderLabel(a)},e.prototype.renderMarker=function(t){var r=this,i=this.attributes,a=i.orientation,s=i.markerSymbol,o=s===void 0?di(a,"horizontalHandle","verticalHandle"):s;Nn(!!o,t,function(c){var l=pt(r.attributes,"marker"),u=G({symbol:o},l);r.marker=c.maybeAppendByClassName($c.marker,function(){return new Qt({style:u})}).update(u)})},e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.showLabel,s=i.orientation,o=i.spacing,c=o===void 0?0:o,l=i.formatter;Nn(a,t,function(u){var h,f=pt(r.attributes,"label"),d=f.text,p=ie(f,["text"]),g=((h=u.select($c.marker.class))===null||h===void 0?void 0:h.node().getBBox())||{},v=g.width,m=v===void 0?0:v,y=g.height,b=y===void 0?0:y,w=N(di(s,[0,b+c,"center","top"],[m+c,0,"start","middle"]),4),x=w[0],S=w[1],_=w[2],E=w[3];u.maybeAppendByClassName($c.label,"text").styles(G(G({},p),{x,y:S,text:l(d).toString(),textAlign:_,textBaseline:E}))})},e}(Yt),W8={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},vht=fe({},W8,{}),mht=fe({},W8,Pr(V8,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),yht=.01,an=ur({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),H8=function(n){tt(e,n);function e(t){return n.call(this,t,vht)||this}return e.prototype.renderTitle=function(t,r,i){var a=this.attributes,s=a.showTitle,o=a.titleText,c=pt(this.attributes,"title"),l=N(yi(c),2),u=l[0],h=l[1];this.titleGroup=t.maybeAppendByClassName(an.titleGroup,"g").styles(h);var f=G(G({width:r,height:i},u),{text:s?o:""});this.title=this.titleGroup.maybeAppendByClassName(an.title,function(){return new z8({style:f})}).update(f)},e.prototype.renderItems=function(t,r){var i=r.x,a=r.y,s=r.width,o=r.height,c=pt(this.attributes,"title",!0),l=N(yi(c),2),u=l[0],h=l[1],f=G(G({},u),{width:s,height:o,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(an.itemsGroup,"g").styles(G(G({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var d=this;this.itemsGroup.selectAll(an.items.class).data(["items"]).join(function(p){return p.append(function(){return new pht({style:f})}).attr("className",an.items.name).each(function(){d.items=ot(this)})},function(p){return p.update(f)},function(p){return p.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var r=this.title.node().getAvailableSpace(),i=r.x,a=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,r=t.showTitle,i=t.width,a=t.height;return r?this.title.node().getAvailableSpace():new Xt(0,0,i,a)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,r,i=(t=this.title)===null||t===void 0?void 0:t.node(),a=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!a?n.prototype.getBBox.call(this):tht(i,a)},e.prototype.render=function(t,r){var i=this.attributes,a=i.width,s=i.height,o=i.x,c=o===void 0?0:o,l=i.y,u=l===void 0?0:l,h=ot(r);r.style.transform="translate(".concat(c,", ").concat(u,")"),this.renderTitle(h,a,s),this.renderItems(h,this.availableSpace),this.adjustLayout()},e}(Yt),bht={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(n){return n.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},WE=ur({background:"background",labelGroup:"label-group",label:"label"},"indicator"),U8=function(n){tt(e,n);function e(t){var r=n.call(this,t,bht)||this;return r.point=[0,0],r.group=r.appendChild(new Ze({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,r=t.position,i=t.padding,a=N(xe(i),4),s=a[0],o=a[1],c=a[2],l=a[3],u=this.label.node().getLocalBounds(),h=u.min,f=u.max,d=new Xt(h[0]-l,h[1]-s,f[0]+o-h[0]+l,f[1]+c-h[1]+s),p=this.getPath(r,d),g=pt(this.attributes,"background");this.background=ot(this.group).maybeAppendByClassName(WE.background,"path").styles(G(G({},g),{d:p})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,r=t.formatter,i=t.labelText,a=pt(this.attributes,"label"),s=N(yi(a),2),o=s[0],c=s[1];o.text;var l=ie(o,["text"]);if(this.label=ot(this.group).maybeAppendByClassName(WE.labelGroup,"g").styles(c),!!i){var u=this.label.maybeAppendByClassName(WE.label,function(){return mi(r(i))}).style("text",r(i).toString());u.selectAll("text").styles(l)}},e.prototype.adjustLayout=function(){var t=N(this.point,2),r=t[0],i=t[1],a=this.attributes,s=a.x,o=a.y;this.group.attr("transform","translate(".concat(s-r,", ").concat(o-i,")"))},e.prototype.getPath=function(t,r){var i=this.attributes.radius,a=r.x,s=r.y,o=r.width,c=r.height,l=[["M",a+i,s],["L",a+o-i,s],["A",i,i,0,0,1,a+o,s+i],["L",a+o,s+c-i],["A",i,i,0,0,1,a+o-i,s+c],["L",a+i,s+c],["A",i,i,0,0,1,a,s+c-i],["L",a,s+i],["A",i,i,0,0,1,a+i,s],["Z"]],u={top:4,right:6,bottom:0,left:2},h=u[t],f=this.createCorner([l[h].slice(-2),l[h+1].slice(-2)]);return l.splice.apply(l,Q([h+1,1],N(f),!1)),l[0][0]="M",l},e.prototype.createCorner=function(t,r){r===void 0&&(r=10);var i=.8,a=o8.apply(void 0,Q([],N(t),!1)),s=N(t,2),o=N(s[0],2),c=o[0],l=o[1],u=N(s[1],2),h=u[0],f=u[1],d=N(a?[h-c,[c,h]]:[f-l,[l,f]],2),p=d[0],g=N(d[1],2),v=g[0],m=g[1],y=p/2,b=p/Math.abs(p),w=r*b,x=w/2,S=w*Math.sqrt(3)/2*i,_=N([v,v+y-x,v+y,v+y+x,m],5),E=_[0],P=_[1],O=_[2],C=_[3],M=_[4];return a?(this.point=[O,l-S],[["L",E,l],["L",P,l],["L",O,l-S],["L",C,l],["L",M,l]]):(this.point=[c+S,O],[["L",c,E],["L",c,P],["L",c+S,O],["L",c,C],["L",c,M]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?xn(this):Ha(this)},e.prototype.bindEvents=function(){this.label.on(vt.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Yt);function Eht(n,e){for(var t=1;t<n.length;t+=1){var r=n[t-1],i=n[t];if(e>=r&&e<=i)return[r,i]}return[e,e]}function xht(n,e,t){var r=Array.from(e),i=n.length;return new Array(i).fill(0).reduce(function(a,s,o){var c=r[o%r.length];return a+=" ".concat(n[o],":").concat(c).concat(o<i-1?" ".concat(n[o+1],":").concat(c):"")},"l(".concat(t==="horizontal"?"0":"270",")"))}function iR(n,e){var t=N(Eht(n,e),2),r=t[0],i=t[1];return{tick:e>(r+i)/2?i:r,range:[r,i]}}var eh=ur({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function Y8(n){var e=n.orientation,t=n.size,r=n.length;return di(e,[r,t],[t,r])}function K8(n){var e=n.type,t=N(Y8(n),2),r=t[0],i=t[1];return e==="size"?[["M",0,i],["L",0+r,0],["L",0+r,i],["Z"]]:[["M",0,i],["L",0,0],["L",0+r,0],["L",0+r,i],["Z"]]}function wht(n){return K8(n)}function Sht(n){var e=n.orientation,t=n.color,r=n.block,i=n.partition,a;if(ft(t)){var s=20;a=new Array(s).fill(0).map(function(l,u,h){return t(u/(h.length-1))})}else a=t;var o=a.length,c=a.map(function(l){return Pa(l).toString()});return o?o===1?c[0]:r?xht(i,c,e):c.reduce(function(l,u,h){return l+=" ".concat(h/(o-1),":").concat(u)},"l(".concat(di(e,"0","270"),")")):""}function _ht(n){var e=n.orientation,t=n.range;if(!t)return[];var r=N(Y8(n),2),i=r[0],a=r[1],s=N(t,2),o=s[0],c=s[1],l=di(e,o*i,0),u=di(e,0,o*a),h=di(e,c*i,i),f=di(e,a,c*a);return[["M",l,u],["L",l,f],["L",h,f],["L",h,u],["Z"]]}function Oht(n,e){var t=pt(e,"track");n.maybeAppendByClassName(eh.track,"path").styles(G({d:K8(e)},t))}function Pht(n,e){var t=pt(e,"selection"),r=Sht(e),i=n.maybeAppendByClassName(eh.selection,"path").styles(G({d:wht(e),fill:r},t)),a=i.maybeAppendByClassName(eh.clipPath,"path").styles({d:_ht(e)}).node();i.style("clipPath",a)}var Cht=function(n){tt(e,n);function e(t){return n.call(this,t,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return e.prototype.render=function(t,r){var i=ot(r).maybeAppendByClassName(eh.trackGroup,"g");Oht(i,t);var a=ot(r).maybeAppendByClassName(eh.selectionGroup,"g");Pht(a,t)},e}(Yt);function Mht(n){return{min:Math.min.apply(Math,Q([],N(n.map(function(e){return e.value})),!1)),max:Math.max.apply(Math,Q([],N(n.map(function(e){return e.value})),!1))}}var Tht=function(n){tt(e,n);function e(t){var r=n.call(this,t,mht)||this;return r.eventToOffsetScale=new ws({}),r.innerRibbonScale=new ws({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(i){var a=r.attributes,s=a.data,o=a.block;i.stopPropagation();var c=r.getValueByCanvasPoint(i);if(o){var l=iR(s.map(function(f){var d=f.value;return d}),c).range,u=r.getRealSelection(l);r.showIndicator((l[0]+l[1])/2,"".concat(u[0],"-").concat(u[1])),r.dispatchIndicated(c,l)}else{var h=r.getTickValue(c);r.showIndicator(h,"".concat(r.getRealValue(h))),r.dispatchIndicated(h)}},r.onDragStart=function(i){return function(a){a.stopPropagation(),r.attributes.slidable&&(r.target=i,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(a)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(i){var a=r.target;r.updateMouse();var s=N(r.selection,2),o=s[0],c=s[1],l=r.getTickValue(r.getValueByCanvasPoint(i)),u=l-r.prevValue;a==="start"?o!==l&&r.updateSelection(l,c):a==="end"?c!==l&&r.updateSelection(o,l):a==="ribbon"&&u!==0&&(r.prevValue=l,r.updateSelection(u,u,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(e.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=this.attributes,r=t.width,i=t.height;return new Xt(0,0,r,i)},e.prototype.render=function(t,r){var i=this,a=t.showLabel;this.renderTitle(ot(r));var s=this.availableSpace,o=s.x,c=s.y,l=ot(r).maybeAppendByClassName(an.contentGroup,"g").styles({transform:"translate(".concat(o,", ").concat(c,")")}),u=l.maybeAppendByClassName(an.labelGroup,"g").styles({zIndex:1});Nn(!!a,u,function(f){i.renderLabel(f)});var h=l.maybeAppendByClassName(an.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=l.maybeAppendByClassName(an.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(h),this.renderIndicator(l),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(e.prototype,"range",{get:function(){var t=this.attributes,r=t.data,i=t.domain;return i?{min:i[0],max:i[1]}:Mht(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonScale",{get:function(){var t=this.range,r=t.min,i=t.max;return this.innerRibbonScale.update({domain:[r,i],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonRange",{get:function(){var t=N(this.selection,2),r=t[0],i=t[1],a=this.ribbonScale;return[a.map(r),a.map(i)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var t=this.range,r=t.min,i=t.max,a=this.attributes.defaultValue,s=a===void 0?[r,i]:a,o=N(s,2),c=o[0],l=o[1];return[c,l]},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,r){return di(this.attributes.orientation,typeof t=="function"?t():t,typeof r=="function"?r():r)},e.prototype.renderTitle=function(t){var r=this.attributes,i=r.showTitle,a=r.titleText,s=r.width,o=r.height,c=pt(this.attributes,"title"),l=G(G({},c),{width:s,height:o,text:a}),u=this;t.selectAll(an.title.class).data(i?[a]:[]).join(function(h){return h.append(function(){return new z8({style:l})}).attr("className",an.title.name).each(function(){u.title=this})},function(h){return h.update(l)},function(h){return h.each(function(){u.title=void 0}).remove()})},Object.defineProperty(e.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var t=this.attributes,r=t.width,i=t.height;return new Xt(0,0,r,i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelFixedSpacing",{get:function(){var t=this.attributes.showTick;return t?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){var t=this.attributes,r=t.orientation,i=t.labelDirection,a={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return a[r][i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelBBox",{get:function(){var t,r=this.attributes.showLabel;if(!r)return new Xt(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var i=((t=this.label.querySelector(re.labelGroup.class))===null||t===void 0?void 0:t.children.slice(-1)[0]).getBBox(),a=i.width,s=i.height;return this.cacheLabelBBox=new Xt(0,0,a,s),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelShape",{get:function(){var t=this.attributes,r=t.showLabel,i=t.labelSpacing,a=i===void 0?0:i;if(!r)return{width:0,height:0,size:0,length:0};var s=this.labelBBox,o=s.width,c=s.height,l=this.ifHorizontal(c,o)+a+this.labelFixedSpacing,u=this.ifHorizontal(o,c);return{width:o,height:c,size:l,length:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonBBox",{get:function(){var t=this.attributes,r=t.showHandle,i=t.ribbonSize,a=this.availableSpace,s=a.width,o=a.height,c=this.labelShape,l=c.size,u=c.length,h=N(this.ifHorizontal([o,s],[s,o]),2),f=h[0],d=h[1],p=r?this.handleShape:{size:0,length:0},g=p.size,v=p.length,m=this.handleOffsetRatio,y=0,b=this.labelPosition;i?y=i:["bottom","right"].includes(b)?y=Math.min(f-l,(f-g)/m):f*(1-m)>g?y=Math.max(f-l,0):y=Math.max((f-l-g)/m,0);var w=Math.max(v,u),x=d-w,S=N(this.ifHorizontal([x,y],[y,x]),2),_=S[0],E=S[1],P=["top","left"].includes(b)?l:0,O=N(this.ifHorizontal([w/2,P],[P,w/2]),2),C=O[0],M=O[1];return new Xt(C,M,_,E)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonShape",{get:function(){var t=this.ribbonBBox,r=t.width,i=t.height;return this.ifHorizontal({size:i,length:r},{size:r,length:i})},enumerable:!1,configurable:!0}),e.prototype.renderRibbon=function(t){var r=this.attributes,i=r.data,a=r.type,s=r.orientation,o=r.color,c=r.block,l=pt(this.attributes,"ribbon"),u=this.range,h=u.min,f=u.max,d=this.ribbonBBox,p=d.x,g=d.y,v=this.ribbonShape,m=v.length,y=v.size,b=fe({transform:"translate(".concat(p,", ").concat(g,")"),length:m,size:y,type:a,orientation:s,color:o,block:c,partition:i.map(function(w){return(w.value-h)/(f-h)}),range:this.ribbonRange},l);this.ribbon=t.maybeAppendByClassName(an.ribbon,function(){return new Cht({style:b})}).update(b)},e.prototype.getHandleClassName=function(t){return"".concat(an.prefix("".concat(t,"-handle")))},e.prototype.renderHandles=function(){var t=this.attributes,r=t.showHandle,i=t.orientation,a=pt(this.attributes,"handle"),s=N(this.selection,2),o=s[0],c=s[1],l=G(G({},a),{orientation:i}),u=a.shape,h=u===void 0?"slider":u,f=h==="basic"?ght:T8,d=this;this.handlesGroup.selectAll(an.handle.class).data(r?[{value:o,type:"start"},{value:c,type:"end"}]:[],function(p){return p.type}).join(function(p){return p.append(function(){return new f({style:l})}).attr("className",function(g){var v=g.type;return"".concat(an.handle," ").concat(d.getHandleClassName(v))}).each(function(g){var v=g.type,m=g.value;this.update({labelText:m});var y="".concat(v,"Handle");d[y]=this,this.addEventListener("pointerdown",d.onDragStart(v))})},function(p){return p.update(l).each(function(g){var v=g.value;this.update({labelText:v})})},function(p){return p.each(function(g){var v=g.type,m="".concat(v,"Handle");d[m]=void 0}).remove()})},e.prototype.adjustHandles=function(){var t=N(this.selection,2),r=t[0],i=t[1];this.setHandlePosition("start",r),this.setHandlePosition("end",i)},Object.defineProperty(e.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new Xt(0,0,0,0);var t=this.startHandle.getBBox(),r=t.width,i=t.height,a=this.endHandle.getBBox(),s=a.width,o=a.height,c=N([Math.max(r,s),Math.max(i,o)],2),l=c[0],u=c[1];return this.cacheHandleBBox=new Xt(0,0,l,u),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"handleShape",{get:function(){var t=this.handleBBox,r=t.width,i=t.height,a=N(this.ifHorizontal([i,r],[r,i]),2),s=a[0],o=a[1];return{width:r,height:i,size:s,length:o}},enumerable:!1,configurable:!0}),e.prototype.setHandlePosition=function(t,r){var i=this.attributes.handleFormatter,a=this.ribbonBBox,s=a.x,o=a.y,c=this.ribbonShape.size,l=this.getOffset(r),u=N(this.ifHorizontal([s+l,o+c*this.handleOffsetRatio],[s+c*this.handleOffsetRatio,o+l]),2),h=u[0],f=u[1],d=this.handlesGroup.select(".".concat(this.getHandleClassName(t))).node();d==null||d.update({transform:"translate(".concat(h,", ").concat(f,")"),formatter:i})},e.prototype.renderIndicator=function(t){var r=pt(this.attributes,"indicator");this.indicator=t.maybeAppendByClassName(an.indicator,function(){return new U8({})}).update(r)},Object.defineProperty(e.prototype,"labelData",{get:function(){var t=this,r=this.attributes.data;return r.reduce(function(i,a,s,o){var c,l,u=(c=a==null?void 0:a.id)!==null&&c!==void 0?c:s.toString();if(i.push(G(G({},a),{id:u,index:s,type:"value",label:(l=a==null?void 0:a.label)!==null&&l!==void 0?l:a.value.toString(),value:t.ribbonScale.map(a.value)})),s<o.length-1){var h=o[s+1],f=N([a.value,h.value],2),d=f[0],p=f[1],g=(d+p)/2;i.push(G(G({},a),{id:u,index:s,type:"range",range:[d,p],label:[d,p].join("~"),value:t.ribbonScale.map(g)}))}return i},[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){var t=N(["center","middle"],2),r=t[0],i=t[1],a=this.labelPosition;return a==="top"?i="bottom":a==="bottom"?i="top":a==="left"?r="end":a==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:i}},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(t){var r=this.attributes,i=r.showTick,a=i===void 0?!1:i,s=r.labelFilter,o=r.labelFormatter,c=pt(this.attributes,"tick"),l=pt(this.attributes,"label"),u=l.align,h=fe(G({showLine:!1,showGrid:!1,showTick:a,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),Pr(c,"tick"),Pr(l,"label"),{data:this.labelData}),f={tickFilter:function(p,g,v){return(p==null?void 0:p.type)!=="value"?!1:s?s(p,p.index,v.filter(function(m){return m.type!=="value"})):!0},labelFilter:function(p,g,v){return(p==null?void 0:p.type)!==u?!1:s?s(p,p.index,v.filter(function(m){return m.type===u})):!0},labelFormatter:o},d=G(G(G({},h),f),{labelOverlap:[{type:"hide"}]});this.label=t.maybeAppendByClassName(an.label,function(){return new S_({style:d})}).node(),this.label.update(d,!1)},Object.defineProperty(e.prototype,"labelAxisStyle",{get:function(){var t=this.attributes,r=t.showTick,i=t.labelDirection,a=t.labelSpacing,s=t.tickLength,o=this.ribbonShape.size,c=this.labelPosition,l=this.labelFixedSpacing,u=N([0,0,0],3),h=u[0],f=u[1],d=u[2],p=s??o;return r?(d=p,f=l,i==="positive"?c==="right"?(h=p,d=p):c==="bottom"&&(h=d):i==="negative"&&(c==="top"||c==="left")&&(h=o)):i==="positive"?c==="right"?f=p:c==="bottom"&&(h=o+l,f=a):i==="negative"&&(c==="left"||c==="top")&&(f=a),{offset:h,spacing:f,tickLength:d}},enumerable:!1,configurable:!0}),e.prototype.adjustLabel=function(){var t=this.attributes.showLabel;if(t){var r=this.ribbonBBox,i=r.x,a=r.y,s=r.width,o=r.height,c=this.labelAxisStyle,l=c.offset,u=c.spacing,h=c.tickLength,f=N(this.ifHorizontal([[i,a+l],[i+s,a+l]],[[i+l,a+o],[i+l,a]]),2),d=f[0],p=f[1];this.label.update({startPos:d,endPos:p,tickLength:h,labelSpacing:u},!1)}},e.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},e.prototype.showIndicator=function(t,r){r===void 0&&(r="".concat(t));var i=this.attributes.showIndicator;if(!i||typeof t!="number"){this.hideIndicator();return}var a=this.range,s=a.min,o=a.max,c=this.ribbonBBox,l=c.x,u=c.y,h=oe(t,s,o),f=this.getOffset(h),d=this.ifHorizontal([f+l,u],[l,f+u]);this.indicator.update({x:d[0],y:d[1],position:this.ifHorizontal("top","left"),labelText:r}),Ha(this.indicator.node())},e.prototype.hideIndicator=function(){xn(this.indicator.node())},e.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},e.prototype.setSelection=function(t,r){this.updateSelection(t,r)},e.prototype.updateSelection=function(t,r,i){var a;i===void 0&&(i=!1);var s=N(this.selection,2),o=s[0],c=s[1],l=N([t,r],2),u=l[0],h=l[1];i&&(u+=o,h+=c);var f=this.range,d=f.min,p=f.max;a=N(hht([d,p],[u,h],this.selection),2),u=a[0],h=a[1],this.update({defaultValue:[u,h]}),this.dispatchSelection()},Object.defineProperty(e.prototype,"step",{get:function(){var t=this.attributes.step,r=t===void 0?1:t,i=this.range,a=i.min,s=i.max;return mt(r)?Qu((s-a)*yht,0):r},enumerable:!1,configurable:!0}),e.prototype.getTickValue=function(t){var r=this.attributes,i=r.data,a=r.block,s=this.range.min;return a?iR(i.map(function(o){var c=o.value;return c}),t).tick:oht(t,this.step,s)},e.prototype.getValueByCanvasPoint=function(t){var r=this.range,i=r.min,a=r.max,s=N(this.ribbon.node().getPosition(),2),o=s[0],c=s[1],l=this.ifHorizontal(o,c),u=this.ifHorizontal.apply(this,Q([],N(Zu(t)),!1)),h=u-l,f=oe(this.getOffset(h,!0),i,a);return f},e.prototype.getOffset=function(t,r){r===void 0&&(r=!1);var i=this.range,a=i.min,s=i.max,o=this.ribbonShape.length,c=this.eventToOffsetScale;return c.update({domain:[a,s],range:[0,o]}),r?c.invert(t):c.map(t)},e.prototype.getRealSelection=function(t){var r=this.range.max,i=N(t,2),a=i[0],s=i[1];return this.ifHorizontal([a,s],[r-s,r-a])},e.prototype.getRealValue=function(t){var r=this.range.max;return this.ifHorizontal(t,r-t)},e.prototype.dispatchSelection=function(){var t=this.getRealSelection(this.selection),r=new se("valuechange",{detail:{value:t}});this.dispatchEvent(r)},e.prototype.dispatchIndicated=function(t,r){var i=this,a=this.range.max,s=this.ifHorizontal(function(){return{value:t,range:r}},function(){return{value:a-t,range:r?i.getRealSelection(r):void 0}}),o=new se("indicate",{detail:s});this.dispatchEvent(o)},e}(Yt);function a2(n){return n===void 0&&(n=""),{CONTAINER:"".concat(n,"tooltip"),TITLE:"".concat(n,"tooltip-title"),LIST:"".concat(n,"tooltip-list"),LIST_ITEM:"".concat(n,"tooltip-list-item"),NAME:"".concat(n,"tooltip-list-item-name"),MARKER:"".concat(n,"tooltip-list-item-marker"),NAME_LABEL:"".concat(n,"tooltip-list-item-name-label"),VALUE:"".concat(n,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(n,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(n,"tooltip-crosshair-y")}}var aR={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function Aht(n){var e;n===void 0&&(n="");var t=a2(n);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=G({flex:1},aR),e[".".concat(t.VALUE)]=G({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},aR),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var X8=function(n){tt(e,n);function e(t){var r=this,i,a,s=(a=(i=t.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,o=a2(s);return r=n.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:Aht(s)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,r=this.element.offsetHeight;return{width:t,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,r=t.data,i=t.template;return r.map(function(a,s){var o=a.name,c=o===void 0?"":o,l=a.color,u=l===void 0?"black":l,h=a.index,f=ie(a,["name","color","index"]),d=G({name:c,color:u,index:h??s},f);return Cd(BD(i.item,d))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),n.prototype.destroy.call(this)},e.prototype.show=function(t,r){var i=this;if(t!==void 0&&r!==void 0){var a=this.element.style.visibility==="hidden",s=function(){i.attributes.x=t??i.attributes.x,i.attributes.y=r??i.attributes.y,i.updatePosition()};a?this.closeTransition(s):s()}this.element.style.visibility="visible"},e.prototype.hide=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=Cd(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:this.element.replaceChildren(t))}},e.prototype.renderHTMLTooltipElement=function(){var t,r,i=this.attributes,a=i.template,s=i.title,o=i.enterable,c=i.style,l=i.content,u=a2(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=o?"auto":"none",l)this.renderCustomContent();else{s?(h.innerHTML=a.title,h.getElementsByClassName(u.TITLE)[0].innerHTML=s):(r=(t=h.getElementsByClassName(u.TITLE))===null||t===void 0?void 0:t[0])===null||r===void 0||r.remove();var f=this.HTMLTooltipItemsElements,d=document.createElement("ul");d.className=u.LIST,d.replaceChildren.apply(d,Q([],N(f),!1));var p=this.element.querySelector(".".concat(u.LIST));p?p.replaceWith(d):h.appendChild(d)}h8(h,c)},e.prototype.getRelativeOffsetFromCursor=function(t){var r=this.attributes,i=r.position,a=r.offset,s=t||i,o=s.split("-"),c={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},l=this.elementSize,u=l.width,h=l.height,f=[-u/2,-h/2];return o.forEach(function(d){var p=N(f,2),g=p[0],v=p[1],m=N(c[d],2),y=m[0],b=m[1];f=[g+(u/2+a[0])*y,v+(h/2+a[1])*b]}),f},e.prototype.setOffsetPosition=function(t){var r=N(t,2),i=r[0],a=r[1],s=this.attributes,o=s.x,c=o===void 0?0:o,l=s.y,u=l===void 0?0:l,h=s.container,f=h.x,d=h.y;this.element.style.left="".concat(+c+f+i,"px"),this.element.style.top="".concat(+u+d+a,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,r=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var r=N(t,2),i=r[0],a=r[1],s=this.attributes,o=s.x,c=s.y,l=s.bounding,u=s.position;if(!l)return[i,a];var h=this.element,f=h.offsetWidth,d=h.offsetHeight,p=N([+o+i,+c+a],2),g=p[0],v=p[1],m={left:"right",right:"left",top:"bottom",bottom:"top"},y=l.x,b=l.y,w=l.width,x=l.height,S={left:g<y,right:g+f>y+w,top:v<b,bottom:v+d>b+x},_=[];u.split("-").forEach(function(P){S[P]?_.push(m[P]):_.push(P)});var E=_.join("-");return this.getRelativeOffsetFromCursor(E)},e.prototype.isCursorEntered=function(t,r){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,s=i.y,o=i.width,c=i.height;return new Xt(a,s,o,c).isPointIn(t,r)}return!1},e.prototype.closeTransition=function(t){var r=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){r.element.style.transition=i},10)},e.tag="tooltip",e}(Yt),sR={default:{sizeStyle:{width:44,height:22,radius:11},tagStyle:{textStyle:{fontSize:12,lineHeight:16,fill:"#fff"},padding:0},markerStyle:{size:11}},small:{sizeStyle:{width:28,height:16,radius:8},tagStyle:{textStyle:{fontSize:10,lineHeight:14,fill:"#fff"},padding:0},markerStyle:{size:8}},mini:{sizeStyle:{width:20,height:14,radius:7},tagStyle:{textStyle:{fontSize:7,lineHeight:10,fill:"#fff"},padding:0},markerStyle:{size:7}}},Nht="#1890FF",Rht="#00000040";function oR(n,e,t){e===void 0&&(e=0),t===void 0&&(t=!0);var r=Number(n.style.height)-e*2;return{x:t?Number(n.style.width)+Number(n.style.x)-e-r:Number(n.style.x)+e,y:Number(n.style.y)+e,width:r,height:r,radius:r/2}}function kht(n,e,t,r){var i=e.width,a=e.height;return t===void 0&&(t=0),r===void 0&&(r=!0),{x:r?Number(n.x)+t:Number(n.width)+Number(n.x)-i,y:Number(n.y)+(Number(n.height)-a)/2}}var Dht=function(n){tt(e,n);function e(t){return n.call(this,t,{x:0,y:0,size:"default",spacing:2,checked:!0,disabled:!1})||this}return e.prototype.render=function(t,r){var i=this,a=t.size,s=t.spacing,o=t.disabled,c=t.checked,l=t.unCheckedChildren,u=t.checkedChildren,h=ot(r).maybeAppendByClassName("switch-content","g").node(),f=h.getLocalBounds(),d=ln(sR,a,sR.default),p=d.sizeStyle,g=d.tagStyle,v=o?"no-drop":"pointer",m=c?Nht:Rht,y=p,b=c?u:l;(u||l)&&ot(h).maybeAppendByClassName("switch-tag",function(){return new r0({})}).call(function(S){var _=S.node();_.update(G(G({cursor:v,backgroundStyle:null,text:!1,marker:!1},g),b));var E=(_==null?void 0:_.getLocalBounds())||{},P=E.max,O=E.min,C=P[0]-O[0]+p.radius,M=P[1]-O[1],T=Math.max(C+p.height+2,p.width);y=G(G({},p),{width:T}),_.update(kht({x:f.min[0],y:f.min[1],width:T,height:y.height},{width:C,height:M},y.radius,c))});var w=ot(h).maybeAppendByClassName("switch-background","rect").styles(G({zIndex:(h.style.zIndex||0)-1,x:f.min[0],y:f.min[1],fill:m,cursor:v,fillOpacity:o?.4:1},y)).node(),x=ot(h).maybeAppendByClassName("switch-background-stroke","rect").styles(G({zIndex:(h.style.zIndex||0)-2,x:f.min[0],y:f.min[1],stroke:m,lineWidth:0},y)).node();ot(h).maybeAppendByClassName("switch-handle","rect").styles({fill:"#fff",cursor:v}).call(function(S){var _,E,P=S.node(),O=oR(w,s,c),C=oR(w,s,!c);P.attr("x")&&!ve(O,C)&&i.checked!==c?(P.attr(C),(_=P.getAnimations()[0])===null||_===void 0||_.cancel(),(E=x.getAnimations()[0])===null||E===void 0||E.cancel(),P.animate([{x:C.x},{x:O.x}],{duration:120,fill:"both"}),x.animate([{lineWidth:0,strokeOpacity:.5},{lineWidth:14,strokeOpacity:0}],{duration:400,easing:"ease-on"})):P.attr(O)}),this.checked=!!c},e.tag="switch",e}(Yt),l0={tagText:"",lineStroke:"#416180",lineStrokeOpacity:.45,lineLineWidth:1,lineLineDash:[5,5]},Lht=fe({},l0,{type:"line",tagPosition:"start",tagAlign:"center",tagVerticalAlign:"bottom"}),Iht=fe({},l0,{type:"circle",defaultRadius:0}),Bht=fe({},l0,{type:"polygon",defaultRadius:0,startAngle:0}),__=function(n){tt(e,n);function e(t){return n.call(this,t,l0)||this}return Object.defineProperty(e.prototype,"localPointer",{get:function(){var t=N(this.getPosition(),2),r=t[0],i=t[1],a=N(this.pointer,2),s=a[0],o=a[1];return[s-r,o-i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagStyle",{get:function(){var t=pt(this.attributes,"tag");return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"crosshairStyle",{get:function(){var t=pt(this.attributes,"line");return G(G({},t),{d:this.crosshairPath})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){var i=ot(r).maybeAppendByClassName(".crosshair-group","g").node();this.shapesGroup=i;var a=this.tagStyle,s=this.crosshairStyle;this.tagShape=ot(i).maybeAppendByClassName("crosshair-tag",function(){return new r0({style:a})}).styles(a).node(),this.crosshairShape=ot(i).maybeAppendByClassName(".crosshair-path","path").styles(s).node(),this.adjustLayout()},e.prototype.setPointer=function(t){this.pointer=t},e.tag="crosshair-base",e}(Yt),Fht=function(n){tt(e,n);function e(t){return n.call(this,fe({},e.defaultOptions,t))||this}return Object.defineProperty(e.prototype,"crosshairPath",{get:function(){var t=this.attributes,r=N(t.startPos,2),i=r[0],a=r[1],s=N(t.endPos,2),o=s[0],c=s[1],l=[["M",0,0],["L",o-i,c-a],["Z"]];return l},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localPointer",{get:function(){if(!this.pointer)return this.attributes.startPos;var t=N(this.getPosition(),2),r=t[0],i=t[1],a=N(this.pointer,2),s=a[0],o=a[1];return[s-r,o-i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){var t=this.attributes,r=N(t.startPos,2),i=r[0],a=r[1],s=N(t.endPos,2),o=s[0],c=s[1];return i===o&&a!==c},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagShapeSpace",{get:function(){var t=s8(this.tagShape),r=t.width,i=t.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),e.prototype.update=function(t){n.prototype.update.call(this,t)},e.prototype.setPointer=function(t){n.prototype.setPointer.call(this,t),this.adjustPosition()},e.prototype.setText=function(t){this.tagShape.update({text:t}),this.adjustTag()},e.prototype.adjustLayout=function(){this.adjustPosition(),this.adjustTag()},e.prototype.adjustPosition=function(){var t=N(this.localPointer,2),r=t[0],i=t[1],a=N(this.attributes.startPos,2),s=a[0],o=a[1],c=this.getOrientVal([s,i],[r,o]);this.shapesGroup.setLocalPosition(c)},e.prototype.adjustTag=function(){var t=this.attributes,r=t.tagText,i=t.tagPosition,a=N(t.startPos,2),s=a[0],o=a[1],c=N(t.endPos,2),l=c[0],u=c[1];if(!r||r===""){xn(this.tagShape);return}Ha(this.tagShape);var h=this.tagShapeSpace,f=h.width,d=h.height,p=N(this.getOrientVal({start:[-f/2,d/2],end:[l-s+f/2,d/2]},{start:[0,0],end:[0,u-o+d]})[i],2),g=p[0],v=p[1];this.tagShape.setLocalPosition(g,v)},e.prototype.getOrientVal=function(t,r){return this.isVertical?r:t},e.tag="line-crosshair",e.defaultOptions={style:Lht},e}(__),$ht=function(n){tt(e,n);function e(t){return n.call(this,fe({},e.defaultOptions,t))||this}return Object.defineProperty(e.prototype,"crosshairPath",{get:function(){return this.createCirclePath()},enumerable:!1,configurable:!0}),e.prototype.update=function(t){n.prototype.update.call(this,t)},e.prototype.setPointer=function(t){var r=N(t,2),i=r[0],a=r[1];n.prototype.setPointer.call(this,[i,a]);var s=N(this.localPointer,2),o=s[0],c=s[1],l=N(this.attributes.center,2),u=l[0],h=l[1],f=this.createCirclePath(Math.pow(Math.pow(o-u,2)+Math.pow(c-h,2),.5));this.crosshairShape.attr({d:f})},e.prototype.adjustLayout=function(){xn(this.tagShape)},e.prototype.createCirclePath=function(t){var r=this.attributes,i=N(r.center,2),a=i[0],s=i[1],o=r.defaultRadius;return p_(a,s,t||o)},e.tag="circle-crosshair",e.defaultOptions={style:Iht},e}(__),zht=function(n){tt(e,n);function e(t){return n.call(this,fe({},e.defaultOptions,t))||this}return Object.defineProperty(e.prototype,"crosshairPath",{get:function(){return this.createPolygonPath()},enumerable:!1,configurable:!0}),e.prototype.update=function(t){n.prototype.update.call(this,t)},Object.defineProperty(e.prototype,"points",{get:function(){for(var t=this.attributes,r=t.startAngle,i=t.sides,a=Math.PI*2/i,s=[1,0],o=[],c=0;c<i;c+=1)o.push(JB(s,[0,0],r/180*Math.PI+a*c));return o},enumerable:!1,configurable:!0}),e.prototype.setPointer=function(t){var r=N(t,2),i=r[0],a=r[1];n.prototype.setPointer.call(this,[i,a]);var s=N(this.localPointer,2),o=s[0],c=s[1],l=this.attributes.center,u=N(this.intersection([o,c]),2),h=u[0],f=u[1];if(!(!h||!f)){var d=Kw(l,[o,c])/Kw(l,[h,f]),p=this.createPolygonPath(d);this.crosshairShape.attr({d:p})}},e.prototype.adjustLayout=function(){xn(this.tagShape)},e.prototype.createPolygonPath=function(t){var r=this.attributes,i=r.defaultRadius,a=N(r.center,2),s=a[0],o=a[1],c=this.points.map(function(l,u){var h=N(l,2),f=h[0],d=h[1],p=N(Wr([f,d],t||i),2),g=p[0],v=p[1];return[u===0?"M":"L",s+g,o+v]});return c.push(["Z"]),c},e.prototype.intersection=function(t){for(var r,i=N(t,2),a=i[0],s=i[1],o=this.points,c=N(this.attributes.center,2),l=c[0],u=c[1],h,f,d=1;d<=o.length;d+=1){var p=N(o[d-1],2),g=p[0],v=p[1],m=N(o[d%o.length],2),y=m[0],b=m[1],w=GB([a,s],[l,u],[g+l,v+u],[y+l,b+u]);w.length!==0&&(r=N(w,2),h=r[0],f=r[1])}return[h,f]},e.tag="polygon-crosshair",e.defaultOptions={style:Bht},e}(__),jht=Pr({fill:"rgba(0,0,0,0.45)",fontSize:10,textAlign:"start",textBaseline:"middle",overflow:"clip"},"label"),cR={default:{width:12,height:12,radius:2,stroke:"#dadada",lineWidth:1,fill:"#ffffff",cursor:"pointer"},selected:{width:12,height:12,radius:2,stroke:"#3471F9",lineWidth:1,fill:"#3471F9",cursor:"pointer"}},qht=[["M",3,6],["L","5","8.5"],["L","8.5","4"]],Ght={d:qht,lineWidth:1,cursor:"pointer"};function Vht(n,e){var t=n.getLocalBounds();return{x:t.halfExtents[0]?t.max[0]+(e||0):n.style.x,y:t.halfExtents[1]?(t.min[1]+t.max[1])/2:n.style.y}}var Wht=function(n){tt(e,n);function e(t){return n.call(this,t,G({labelText:"",spacing:4,checked:!1},jht))||this}return e.prototype.render=function(t,r){var i=t.checked,a=t.spacing;this.checked=!!i;var s=Ur(r,".checkbox-content","g").attr("className","checkbox-content").node(),o=pt(t,"box"),c=pt(t,"checked"),l=pt(t,"label"),u=G(G({},this.checked?cR.selected:cR.default),o),h=G(G({},Ght),c);this.checkboxBoxShape=Ur(s,".checkbox-box","rect").styles(G({className:"checkbox-box",zIndex:(s.style.zIndex||0)-1},u)).node(),Ur(this.checkboxBoxShape,".checkbox-checked","path").styles(G({className:"checkbox-box-checked",stroke:"#fff"},h));var f=Vht(this.checkboxBoxShape,Number(a)),d=f.x,p=f.y;Ur(s,".checkbox-label","text").styles(G({className:"checkbox-label",x:d,y:p},l))},e.tag="checkbox",e}(Yt),Pt,Hht="component-poptip",wt={CONTAINER:"component-poptip",ARROW:"component-poptip-arrow",TEXT:"component-poptip-text"},lR=(Pt={},Pt[".".concat(wt.CONTAINER)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},Pt[".".concat(wt.TEXT)]={"text-align":"center"},Pt[".".concat(wt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, -100%)"},Pt[".".concat(wt.CONTAINER,"[data-position='left']")]={transform:"translate(-100%, -50%)"},Pt[".".concat(wt.CONTAINER,"[data-position='right']")]={transform:"translate(0, -50%)"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},Pt[".".concat(wt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0,-100%)"},Pt[".".concat(wt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},Pt[".".concat(wt.CONTAINER,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},Pt[".".concat(wt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},Pt[".".concat(wt.CONTAINER,"[data-position='right-top']")]={transform:"translate(0, 0)"},Pt[".".concat(wt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},Pt[".".concat(wt.ARROW)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},Pt[".".concat(wt.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},Pt["[data-position='top'] .".concat(wt.ARROW)]={bottom:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},Pt["[data-position='left'] .".concat(wt.ARROW)]={right:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='right']")]={transform:"translate(5px, -50%)"},Pt["[data-position='right'] .".concat(wt.ARROW)]={left:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},Pt["[data-position='bottom'] .".concat(wt.ARROW)]={top:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},Pt["[data-position='top-left'] .".concat(wt.ARROW)]={left:"10px",bottom:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},Pt["[data-position='top-right'] .".concat(wt.ARROW)]={right:"10px",bottom:"-2px"},Pt[".".concat(wt.CONTAINER,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},Pt["[data-position='left-top'] .".concat(wt.ARROW)]={right:"-2px",top:"8px"},Pt[".".concat(wt.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},Pt["[data-position='left-bottom'] .".concat(wt.ARROW)]={right:"-2px",bottom:"8px"},Pt[".".concat(wt.CONTAINER,"[data-position='right-top']")]={transform:"translate(5px, 0)"},Pt["[data-position='right-top'] .".concat(wt.ARROW)]={left:"-2px",top:"8px"},Pt[".".concat(wt.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},Pt["[data-position='right-bottom'] .".concat(wt.ARROW)]={left:"-2px",bottom:"8px"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},Pt["[data-position='bottom-left'] .".concat(wt.ARROW)]={top:"-2px",left:"8px"},Pt[".".concat(wt.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},Pt["[data-position='bottom-right'] .".concat(wt.ARROW)]={top:"-2px",right:"8px"},Pt),Uht=void 0;function Yht(n,e,t,r,i,a){if(i===void 0&&(i=!1),a===void 0&&(a=!1),a)return[n,e];var s=t.getBoundingClientRect(),o=s.x,c=s.y,l=s.width,u=s.height;switch(r){case"top":return i?[o+l/2,c]:[n,c];case"left":return i?[o,c+u/2]:[o,e];case"bottom":return i?[o+l/2,c+u]:[n,c+u];case"right":return i?[o+l,c+u/2]:[o+l,e];case"top-right":case"right-top":return[o+l,c];case"left-bottom":case"bottom-left":return[o,c+u];case"right-bottom":case"bottom-right":return[o+l,c+u];case"top-left":case"left-top":default:return[o,c]}}var Kht=function(n){var e;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e||(e=n.apply(Uht,t)),e}};function Xht(n){var e=n&&document.getElementById(n);return e||(e=document.createElement("div"),e.setAttribute("id",n),document.body.appendChild(e)),e}function Zht(n){var e=Kht(Xht)(n);return e}var Qht=function(n){tt(e,n);function e(t){var r=n.call(this,Le({style:{id:Hht}},e.defaultOptions,t))||this;return r.visibility="visible",r.map=new Map,r.domStyles="",r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"visible",{get:function(){return this.visibility==="visible"},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){this.visibility=this.style.visibility,this.updatePoptipElement()},e.prototype.update=function(t){this.attr(Le({},this.style,t)),this.render(this.attributes,this)},e.prototype.bind=function(t,r){var i=this;if(t){var a=this.style.text,s=function(c){var l=t,u=i.style,h=a;if(r){var f=typeof r=="function"?r.call(null,c):r,d=f.html,p=f.target,g=ie(f,["html","target"]);u=ms({},i.style,g),(p||p===!1)&&(l=p),typeof d=="string"&&(h=d)}var v=u.position,m=u.arrowPointAtCenter,y=u.follow,b=u.offset;if(l){var w=c,x=w.clientX,S=w.clientY,_=N(Yht(x,S,l,v,m,y),2),E=_[0],P=_[1];i.showTip(E,P,{text:h,position:v,offset:b})}else i.hideTip()},o=function(){i.hideTip()};t.addEventListener("mousemove",s),t.addEventListener("mouseleave",o),this.map.set(t,[s,o])}},e.prototype.unbind=function(t){if(this.map.has(t)){var r=N(this.map.get(t)||[],2),i=r[0],a=r[1];i&&t.removeEventListener("mousemove",i),a&&t.removeEventListener("mouseleave",a),this.map.delete(t)}},e.prototype.clear=function(){this.container.innerHTML=""},e.prototype.destroy=function(){var t=this,r;Q([],N(this.map.keys()),!1).forEach(function(i){return t.unbind(i)}),(r=this.container)===null||r===void 0||r.remove(),n.prototype.destroy.call(this)},e.prototype.showTip=function(t,r,i){var a=ln(i,"text");if(!(a&&typeof a!="string")&&(this.applyStyles(),t&&r&&i)){var s=i.offset,o=i.position;if(o&&this.container.setAttribute("data-position",o),this.setOffsetPosition(t,r,s),typeof a=="string"){var c=this.container.querySelector(".".concat(wt.TEXT));c&&(c.innerHTML=a)}this.visibility="visible",this.container.style.visibility="visible"}},e.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},e.prototype.getContainer=function(){return this.container},e.prototype.getClassName=function(){var t=this.style.containerClassName;return"".concat(wt.CONTAINER).concat(t?" ".concat(t):"")},e.prototype.initShape=function(){var t=this,r=this.style.id;this.container=Zht(r),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",function(){return t.showTip()}),this.container.addEventListener("mouseleave",function(){return t.hideTip()})},e.prototype.updatePoptipElement=function(){var t=this.container;this.clear();var r=this.style,i=r.id,a=r.template,s=r.text;this.container.setAttribute("id",i),this.container.className=this.getClassName();var o='<span class="'.concat(wt.ARROW,'"></span>');t.innerHTML=o,At(a)?t.innerHTML+=a:a&&qD(a)&&t.appendChild(a),s&&(t.getElementsByClassName(wt.TEXT)[0].textContent=s),this.applyStyles(),this.container.style.visibility=this.visibility},e.prototype.applyStyles=function(){var t=fe({},lR,this.style.domStyles),r=Object.entries(t).reduce(function(a,s){var o=N(s,2),c=o[0],l=o[1],u=Object.entries(l).reduce(function(h,f){var d=N(f,2),p=d[0],g=d[1];return"".concat(h).concat(p,": ").concat(g,";")},"");return"".concat(a).concat(c,"{").concat(u,"}")},"");if(this.domStyles!==r){this.domStyles=r;var i=this.container.querySelector("style");i&&this.container.removeChild(i),i=document.createElement("style"),i.innerHTML=r,this.container.appendChild(i)}},e.prototype.setOffsetPosition=function(t,r,i){i===void 0&&(i=this.style.offset);var a=N(i,2),s=a[0],o=s===void 0?0:s,c=a[1],l=c===void 0?0:c;this.container.style.left="".concat(t+o,"px"),this.container.style.top="".concat(r+l,"px")},e.tag="poptip",e.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:lR,template:'<div class="'.concat(wt.TEXT,'"></div>')}},e}(Yt),Z8=function(n){tt(e,n);function e(t){var r=n.call(this,t)||this;r.layoutEvents=[vt.BOUNDS_CHANGED,vt.INSERTED,vt.REMOVED],r.$margin=xe(0),r.$padding=xe(0);var i=t.style||{},a=i.margin,s=a===void 0?0:a,o=i.padding,c=o===void 0?0:o;return r.margin=s,r.padding=c,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(t){this.$margin=xe(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding=xe(t)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=this.attributes,r=t.x,i=r===void 0?0:r,a=t.y,s=a===void 0?0:a,o=t.width,c=t.height,l=N(this.$margin,4),u=l[0],h=l[1],f=l[2],d=l[3];return new Xt(i-d,s-u,o+d+h,c+u+f)},e.prototype.appendChild=function(t,r){return t.isMutationObserved=!0,n.prototype.appendChild.call(this,t,r),t},e.prototype.getAvailableSpace=function(){var t=this.attributes,r=t.width,i=t.height,a=N(this.$padding,4),s=a[0],o=a[1],c=a[2],l=a[3],u=N(this.$margin,4),h=u[0],f=u[3];return new Xt(l+f,s+h,r-l-o,i-s-c)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(s){return!s.isConnected}))try{var t=this.attributes,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var a=QB(this.getAvailableSpace(),this.children.map(function(s){return s.getBBox()}),this.attributes);this.children.forEach(function(s,o){var c=a[o],l=c.x,u=c.y;s.style.transform="translate(".concat(l,", ").concat(u,")")})}catch{}},e.prototype.bindEvents=function(){var t=this;this.layoutEvents.forEach(function(r){t.addEventListener(r,function(i){i.target.isMutationObserved=!0,t.layout()})})},e.prototype.attributeChangedCallback=function(t,r,i){t==="margin"?this.margin=i:t==="padding"&&(this.padding=i),this.layout()},e}(Ze),Jht=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},e.defaultOptions,t))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new kn({})),r.label=r.background.appendChild(new Ze({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return xe(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,r=t.label,i=t.value,a=pt(this.attributes,"label");ot(this.label).maybeAppend(".label",function(){return mi(r)}).attr("className","label").styles(a),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),r=N(this.padding,4),i=r[0],a=r[1],s=r[2],o=r[3],c=t.width,l=t.height,u=c+o+a,h=l+i+s,f=pt(this.attributes,"background"),d=this.style,p=d.width,g=p===void 0?0:p,v=d.height,m=v===void 0?0:v,y=d.selected;this.background.attr(G(G({},f),{width:Math.max(u,g),height:Math.max(h,m),fill:y?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((h-l)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var r=this;this.addEventListener("click",function(){var i=t.style,a=i.label,s=i.value,o=i.onClick;o==null||o(s,{label:a,value:s},r)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(Yt),Q8=function(n){tt(e,n);function e(t){var r,i,a=n.call(this,fe({},e.defaultOptions,t))||this;a.currentValue=(r=e.defaultOptions.style)===null||r===void 0?void 0:r.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new kn({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new kn({className:"dropdown"}));var s=a.style.defaultValue;return s&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(o){return o.value===s}))&&(a.currentValue=s),a}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return xe(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,r,i=this.style,a=i.x,s=i.y,o=i.width,c=i.height,l=i.bordered,u=i.showDropdownIcon,h=pt(this.attributes,"select"),f=pt(this.attributes,"placeholder");this.select.attr(G(G({x:a,y:s,width:o,height:c},h),{fill:"#fff",strokeWidth:l?1:0}));var d=this.dropdownPadding,p=10;u&&ot(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+o-p-d[1]-d[3],", ").concat(s+c/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var g=(r=this.style.options)===null||r===void 0?void 0:r.find(function(b){return b.value===t.currentValue}),v=G({x:a+d[3]},f);ot(this.select).selectAll(".placeholder").data(g?[]:[1]).join(function(b){return b.append("text").attr("className","placeholder").styles(v).style("y",function(){var w=this.getBBox();return s+(c-w.height)/2})},function(b){return b.styles(v)},function(b){return b.remove()});var m=pt(this.attributes,"optionLabel"),y=G({x:a+d[3]},m);ot(this.select).selectAll(".value").data(g?[g]:[]).join(function(b){return b.append(function(w){return mi(w.label)}).attr("className","value").styles(y).style("y",function(){var w=this.getBBox();return s+(c-w.height)/2})},function(b){return b.styles(y)},function(b){return b.remove()})},e.prototype.renderDropdown=function(){var t=this,r,i,a=this.style,s=a.x,o=a.y,c=a.width,l=a.height,u=a.options,h=a.onSelect,f=a.open,d=pt(this.attributes,"dropdown"),p=pt(this.attributes,"option"),g=this.dropdownPadding;ot(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,function(y){return y.value}).join(function(y){return y.append(function(b){return new Jht({className:"dropdown-item",style:G(G(G({},b),p),{width:c-g[1]-g[3],selected:b.value===t.currentValue,onClick:function(w,x,S){t.setValue(w),h==null||h(w,x,S),t.dispatchEvent(new se("change",{detail:{value:w,option:x,item:S}})),xn(t.dropdown)}})})}).each(function(b,w){var x,S=(x=this.parentNode)===null||x===void 0?void 0:x.children,_=S.reduce(function(E,P,O){return O<w&&(E+=P.getBBox().height),E},0);this.attr("transform","translate(".concat(g[3],", ").concat(g[0]+_,")"))})},function(y){return y.update(function(b){return{selected:b.value===t.currentValue}})},function(y){return y.remove()});var v=(i=(r=this.dropdown.getElementsByClassName("dropdown-container"))===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.getBBox(),m=d.spacing;this.dropdown.attr(G({transform:"translate(".concat(s,", ").concat(o+l+m,")"),width:v.width+g[1]+g[3],height:v.height+g[0]+g[2]},d)),!f&&xn(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(r){r.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?xn(t.dropdown):Ha(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||xn(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(Yt),ti=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return r.showBackground=!0,r.background=r.appendChild(new kn({})),r.icon=r.appendChild(new Ze({})),r}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return xe(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,r=N(this.padding,4),i=r[0],a=r[1],s=r[2],o=r[3];return Math.max(t-Math.max(o+a,i+s),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.size,s=a/2,o=pt(this.attributes,"background");this.background.attr(G({x:r-s,y:i-s,width:a,height:a},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,r=this.background.getBBox(),i=r.x,a=r.y;this.indicator.update({x:i+t/2,y:a-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;n.prototype.connectedCallback.call(this);var r=this.attributes.size,i=this.background.getBBox(),a=i.x,s=i.y,o=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;o&&(this.indicator=o.appendChild(new U8({style:{x:a+r/2,y:s-r/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onClick;if(this.addEventListener("click",function(){r==null||r(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},s=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){s()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(Yt),nh=function(n,e){return e===void 0&&(e="#565758"),new Yr({style:{fill:e,d:"M ".concat(n,",").concat(n," L -").concat(n,",0 L ").concat(n,",-").concat(n," Z"),transformOrigin:"center"}})},tft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.arcPath=function(t,r,i){var a=N([i,i],2),s=a[0],o=a[1],c=function(g){return[t+i*Math.cos(g),r+i*Math.sin(g)]},l=N(c(-5/4*Math.PI),2),u=l[0],h=l[1],f=N(c(1/4*Math.PI),2),d=f[0],p=f[1];return"M".concat(u,",").concat(h,",A").concat(s,",").concat(o,",0,1,1,").concat(d,",").concat(p)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this.iconSize,o=this.lineWidth,c=o+.5;ot(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:o,d:this.arcPath(r,i,s/2-o),markerStart:nh(c,a)})},e}(ti),eft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,c=s/2/Math.pow(3,.5),l=[[r,i],[r,i-c],[r-o,i],[r,i+c],[r,i],[r+o,i-c],[r+o,i+c],[r,i]];ot(this.icon).maybeAppend(".backward","polygon").styles({points:l,fill:a})},e}(ti),nft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,c=s/2/Math.pow(3,.5),l=[[r,i],[r,i-c],[r+o,i],[r,i+c],[r,i],[r-o,i-c],[r-o,i+c],[r,i]];ot(this.icon).maybeAppend(".forward","polygon").styles({points:l,fill:a})},e}(ti),rft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3*Math.pow(3,.5)*.8,c=[[r+o,i],[r-o/2,i-s/2*.8],[r-o/2,i+s/2*.8],[r+o,i]];ot(this.icon).maybeAppend(".play","polygon").styles({points:c,fill:a})},e}(ti),ift=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3,c=[[r-o,i-s/2],[r-o,i+s/2],[r-o/2,i+s/2],[r-o/2,i-s/2],[r-o,i-s/2],[r+o/2,i-s/2],[r+o/2,i+s/2],[r+o,i+s/2],[r+o,i-s/2]];ot(this.icon).maybeAppend(".pause","polygon").styles({points:c,fill:a})},e}(ti),aft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,c=s.lineWidth,l=c;ot(this.icon).maybeAppend(".left-line","line").styles({x1:r-o/2,y1:i-o/2,x2:r-o/2,y2:i+o/2,stroke:a,lineWidth:c}),ot(this.icon).maybeAppend(".right-line","line").styles({x1:r+o/2,y1:i-o/2,x2:r+o/2,y2:i+o/2,stroke:a,lineWidth:c}),ot(this.icon).maybeAppend(".left-arrow","line").styles({x1:r,y1:i,x2:r-o/2+l*2,y2:i,stroke:a,lineWidth:c,markerEnd:nh(c*2,a)}),ot(this.icon).maybeAppend(".right-arrow","line").styles({x1:r,y1:i,x2:r+o/2-l*2,y2:i,stroke:a,lineWidth:c,markerEnd:nh(c*2,a)})},e}(ti),sft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,c=s.lineWidth;ot(this.icon).maybeAppend(".line","line").styles({x1:r,y1:i-o/2,x2:r,y2:i+o/2,stroke:a,lineWidth:c});var l=c;ot(this.icon).maybeAppend(".left-arrow","line").styles({x1:r-o/2-l*2,y1:i,x2:r-l*2,y2:i,stroke:a,lineWidth:c,markerEnd:nh(c*2,a)}),ot(this.icon).maybeAppend(".right-arrow","line").styles({x1:r+o/2+l*2,y1:i,x2:r+l*2,y2:i,stroke:a,lineWidth:c,markerEnd:nh(c*2,a)})},e}(ti),J8=function(n){return[[-n/2,-n/2],[-n/2,n/2],[n/2,n/2]]},oft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,c=s.lineWidth,l=c,u=(o-l*2-c)/4,h=(o-l*2-c)/2,f=N([r-o/2+l,i+o/2-l*2],2),d=f[0],p=f[1];ot(this.icon).maybeAppend(".coordinate","polyline").styles({points:J8(o).map(function(g){var v=N(g,2),m=v[0],y=v[1];return[m+r,y+i]}),stroke:a,lineWidth:c}),ot(this.icon).maybeAppend(".line","polyline").styles({points:[[d,p],[d+u,p-h],[d+u*2,p],[d+u*4,p-h*2]],stroke:a,lineWidth:c})},e}(ti),cft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,r=this.attributes,i=r.x,a=r.y,s=r.color,o=this,c=o.iconSize,l=o.lineWidth,u=l,h=(c-u)/t.length,f=(c-u*2)/4,d=N([i-c/2+u*2,a+c/2-u],2),p=d[0],g=d[1];ot(this.icon).maybeAppend(".coordinate","polyline").styles({points:J8(c).map(function(v){var m=N(v,2),y=m[0],b=m[1];return[y+i,b+a]}),stroke:s,lineWidth:l}),ot(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(v,m){return{value:v,index:m}})).join(function(v){return v.append("line").attr("className","column").style("x1",function(m){var y=m.index;return p+h*y}).style("y1",g).style("x2",function(m){var y=m.index;return p+h*y}).style("y2",function(m){var y=m.value;return g-f*y}).styles({y1:g,stroke:s,lineWidth:l})})},e}(ti),lft=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},{style:{color:"#d8d9d9"}},t))||this;return r.showBackground=!1,r}return e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,c=s.lineWidth;ot(this.icon).maybeAppend(".split","line").styles({x1:r,y1:i-o/2,x2:r,y2:i+o/2,stroke:a,lineWidth:c})},e}(ti),s2=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return xe(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,r=this.attributes,i=r.x,a=r.y,s=r.speed,o=s===void 0?1:s,c=lg(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),l=oe(t,20,1/0),u=20,h=G(G({},c),{x:i-l/2,y:a-u/2,width:l,height:u,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});ot(this.icon).maybeAppend(".speed",function(){return new Q8({style:h})}).attr("className","speed").each(function(){this.update(h)})},e.tag="SpeedSelect",e}(ti),O_=function(n){tt(e,n);function e(t){var r=n.call(this,t)||this;return r.icon=r.appendChild(new Ze({})),r.currentType=r.attributes.type,r}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,r=this.attributes;r.onChange;var i=ie(r,["onChange"]);ot(this.icon).selectAll(".icon").data([this.currentType]).join(function(a){return a.append(function(s){var o,c=(o=t.toggles.find(function(l){var u=N(l,1),h=u[0];return h===s}))===null||o===void 0?void 0:o[1];if(!c)throw new Error("Invalid type: ".concat(s));return new c({})}).attr("className","icon").styles(i,!1).update({})},function(a){return a.styles({restStyles:i}).update({})},function(a){return a.remove()})},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(t.toggles.findIndex(function(o){var c=N(o,1),l=c[0];return l===t.currentType})+1)%t.toggles.length,s=t.toggles[a][0];r==null||r(t.currentType),t.currentType=s,t.render()})},e.tag="ToggleIcon",e}(Yt),o2=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},{style:{type:"play"}},t))||this;return r.toggles=[["play",rft],["pause",ift]],r}return e}(O_),c2=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},{style:{type:"range"}},t))||this;return r.toggles=[["range",aft],["value",sft]],r}return e}(O_),l2=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},{style:{type:"column"}},t))||this;return r.toggles=[["line",oft],["column",cft]],r}return e}(O_),uft={reset:tft,speed:s2,backward:eft,playPause:o2,forward:nft,selectionType:c2,chartType:l2,split:lft},hft=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},e.defaultOptions,t))||this;return r.background=r.appendChild(new kn({})),r.functions=r.appendChild(new Ze({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return xe(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,r=t.x,i=t.y,a=t.width,s=t.height,o=pt(this.attributes,"background");this.background.attr(G({x:r,y:i,width:a,height:s},o))},e.prototype.renderFunctions=function(){var t=this,r,i=this.attributes,a=i.functions,s=i.iconSize,o=i.iconSpacing,c=i.x,l=i.y,u=i.width,h=i.height,f=i.align,d=N(this.padding,4),p=d[1],g=d[3],v=a.reduce(function(b,w){return b.length&&w.length?b.concat.apply(b,Q(["split"],N(w),!1)):b.concat.apply(b,Q([],N(w),!1))},[]),m=v.length*(s+o)-o,y={left:g+s/2,center:(u-m)/2+s/2,right:u-m-g-p+s/2}[f]||0;(r=this.speedSelect)===null||r===void 0||r.destroy(),this.functions.removeChildren(),v.forEach(function(b,w){var x,S=uft[b],_={x:c+w*(s+o)+y,y:l+h/2,size:s};if(S===s2?(_.speed=t.attributes.speed,_.onSelect=function(P){return t.handleFunctionChange(b,{value:P})}):[o2,c2,l2].includes(S)?(_.onChange=function(P){return t.handleFunctionChange(b,{value:P})},S===o2&&(_.type=t.attributes.state==="play"?"pause":"play"),S===c2&&(_.type=t.attributes.selectionType==="range"?"value":"range"),S===l2&&(_.type=t.attributes.chartType==="line"?"column":"line")):_.onClick=function(){return t.handleFunctionChange(b,{value:b})},S===s2){var E=(x=t.ownerDocument)===null||x===void 0?void 0:x.defaultView;E&&(t.speedSelect=new S({style:G(G({},_),{zIndex:100})}),E.appendChild(t.speedSelect))}else t.functions.appendChild(new S({style:_}))})},e.prototype.disconnectedCallback=function(){var t;n.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,r){var i=this.attributes.onChange;i==null||i(t,r)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(Yt),fft=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},e.defaultOptions,t))||this;return r.bindEvents(),r}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Zi),dft=function(n){tt(e,n);function e(t){return n.call(this,fe({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,s=t.height,o=pt(this.attributes,"background");ot(this).maybeAppend("background","rect").attr("className","background").styles(G({x:r-a/2,y:i-s/2,width:a,height:s},o))},e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.iconSize,s=pt(this.attributes,"icon"),o=1,c=a/2;ot(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(G({x1:r-o,y1:i-c,x2:r-o,y2:i+c},s)),ot(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(G({x1:r+o,y1:i-c,x2:r+o,y2:i+c},s))},e.prototype.renderBorder=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,s=t.height,o=t.type,c=pt(this.attributes,"border"),l=o==="start"?+a/2:-a/2;ot(this).maybeAppend("border","line").attr("className","border").styles(G({x1:l+r,y1:i-s/2,x2:l+r,y2:i+s/2},c))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(Yt);function pft(n,e){return typeof n=="number"?t9(n):gft(n,e)}function gft(n,e){var t=new Date(n);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?pn(t,`HH:mm
YYYY-MM-DD`):pn(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(pn(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?pn(t,`DD
YYYY-MM`):pn(t,"DD");case"week":return t.getDate()<=7?pn(t,`DD
YYYY-MM`):pn(t,"DD");case"month":return[0,6].includes(t.getMonth())?pn(t,`MM
YYYY`):pn(t,"MM");case"season":return[0].includes(t.getMonth())?pn(t,`MM
YYYY`):pn(t,"MM");case"year":return pn(t,"YYYY");default:return pn(t,"YYYY-MM-DD HH:mm")}}function t9(n){var e=String(Math.floor(n/3600)).padStart(2,"0"),t=String(Math.floor(n%3600/60)).padStart(2,"0"),r=String(Math.floor(n%60)).padStart(2,"0");return n<3600?"".concat(t,":").concat(r):"".concat(e,":").concat(t,":").concat(r)}var e9=function(n){tt(e,n);function e(t){var r=n.call(this,fe({},e.defaultOptions,t))||this;r.axis=r.appendChild(new S_({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new b_({style:{onChange:function(h){r.handleSliderChange(h)}}})),r.controller=r.appendChild(new hft({})),r.states={},r.handleSliderChange=function(h){var f=function(){var d=r.states.values;return Array.isArray(d)?Q([],N(d),!1):d}();r.setBySliderValues(h),r.dispatchOnChange(f)};var i=r.attributes,a=i.selectionType,s=i.chartType,o=i.speed,c=i.state,l=i.playMode,u=i.values;return r.states={chartType:s,playMode:l,selectionType:a,speed:o,state:c},r.setByTimebarValues(u),r}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,r=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return t.sort(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,s=t.height,o=t.type,c=t.controllerHeight,l=oe(+s-c,0,+s),u=new Xt(r,i+ +s-c,+a,c),h,f=0;o==="chart"?(f=35,h=new Xt(r,i+l-f,+a,f)):h=new Xt;var d=o==="time"?10:l,p=new Xt(r,i+(o==="time"?l:l-d),+a,d-f);return{axisBBox:h,controllerBBox:u,timelineBBox:p}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var r,i,a=this.data,s=N(Array.isArray(t)?t:[0,t],2),o=s[0],c=s[1],l=a.length,u=a[Math.floor(o*l)],h=a[Math.ceil(c*l)-(Array.isArray(t)?0:1)];this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var r,i,a,s=this.data,o=N(Array.isArray(t)?t:[void 0,t],2),c=o[0],l=o[1],u=s.find(function(f){var d=f.time;return d===c}),h=s.find(function(f){var d=f.time;return d===l});this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:(i=s[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},e.prototype.setByIndex=function(t){var r,i,a,s,o=this.data,c=N(t,2),l=c[0],u=c[1];this.states.values=[(i=(r=o[l])===null||r===void 0?void 0:r.time)!==null&&i!==void 0?i:o[0].time,(s=(a=this.data[u])===null||a===void 0?void 0:a.time)!==null&&s!==void 0?s:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=N(Array.isArray(r)?r:[void 0,r],2),s=a[0],o=a[1],c=this.data,l=c.length,u=i==="value",h=function(){var d=c.findIndex(function(p){var g=p.time;return g===s});return u?0:d>-1?d/l:0},f=function(){if(o===1/0)return 1;var d=c.findIndex(function(p){var g=p.time;return g===o});return d>-1?d/l:u?.5:1};return[h(),f()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=N(Array.isArray(r)?r:[this.data[0].time,r],2),s=a[0],o=a[1];return i==="value"?o:[s,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var r=this.data,i=r.length,a=Math.floor(t*(i-1));return r[a]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,r=this.space.timelineBBox.height;return t==="range"?function(i){return new dft({style:{type:i,height:r,iconSize:r/6}})}:function(){return new bg({style:{x1:0,y1:-r/2,x2:0,y2:r/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var r=this,i=t.x,a=t.y,s=t.width,o=t.height,c=this.states,l=c.selectionType,u=c.chartType,h=this.data,f=this.attributes,d=f.type,p=f.labelFormatter,g=pt(this.attributes,"chart");g.type;var v=ie(g,["type"]),m=l==="range";if(d==="time")return G({handleIconShape:function(){return new fft({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:m?-15:0,autoFitLabel:m,handleSpacing:m?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:l,values:this.sliderValues,formatter:function(w){if(p)return p(w);var x=r.getDatumByRatio(w).time;return typeof x=="number"?t9(x):pn(x,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},v);var y=l==="range"?5:0,b=h.map(function(w){var x=w.value;return x});return G({handleIconOffset:y,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:b,sparklineType:u,sparklineScale:.8,trackLength:s,trackSize:o,type:l,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},v)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var r=this.data,i=this.attributes,a=i.interval,s=i.labelFormatter,o=pt(this.attributes,"axis"),c=t.x,l=t.y,u=t.width,h=Q(Q([],N(r),!1),[{time:0}],!1).map(function(d,p,g){var v=d.time;return{label:"".concat(v),value:p/(g.length-1),time:v}}),f=G({startPos:[c,l],endPos:[c+u,l],data:h,labelFilter:function(d,p){return p<h.length-1},labelFormatter:function(d){var p=d.time;return s?s(p):pft(p,a)}},o);return f},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var r=this.attributes.type;r==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var r=this.attributes.type,i=this.states,a=i.state,s=i.speed,o=i.selectionType,c=i.chartType,l=pt(this.attributes,"controller"),u=this,h=G(G(G({},t),{iconSize:20,speed:s,state:a,selectionType:o,chartType:c,onChange:function(f,d){var p=d.value;switch(f){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(p);break;case"backward":u.internalBackward();break;case"playPause":p==="play"?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(p);break;case"chartType":u.handleChartTypeChange(p);break}}}),l);r==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},e.prototype.dispatchOnChange=function(t){var r=this.data,i=this.attributes.onChange,a=this.states,s=a.values,o=a.selectionType,c=N(s,2),l=c[0],u=c[1],h=u===1/0?r.at(-1).time:u,f=o==="range"?[l,h]:h,d=function(p,g){return Array.isArray(p)?Array.isArray(g)?p[0]===g[0]&&(p[1]===g[1]||p[1]===1/0||g[1]===1/0):!1:Array.isArray(g)?!1:p===g};(!t||!d(t,f))&&(i==null||i(o==="range"?[l,h]:h))},e.prototype.internalReset=function(t){var r,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onReset)===null||i===void 0||i.call(r),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,r){var i=this.data,a=i.length,s=this.states,o=s.values,c=s.selectionType,l=s.playMode,u=N(o,2),h=u[0],f=u[1],d=i.findIndex(function(b){var w=b.time;return w===h}),p=i.findIndex(function(b){var w=b.time;return w===f});p===-1&&(p=a);var g=t==="backward"?-1:1,v;c==="range"?l==="acc"?(v=[d,p+g],g===-1&&d===p&&(v=[d,a])):v=[d+g,p+g]:v=[d,p+g];var m=function(b){var w=N(b.sort(function(E,P){return E-P}),2),x=w[0],S=w[1],_=function(E){return oe(E,0,a)};return S>a?c==="value"?[0,0]:l==="acc"?[_(x),_(x)]:[0,_(S-x)]:x<0?l==="acc"?[0,_(S)]:[_(x+a-S),a]:[_(x),_(S)]},y=m(v);return this.setByIndex(y),this.updateSelection(),y},e.prototype.internalBackward=function(t){var r,i,a=this.moveSelection("backward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onBackward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var r=this,i,a,s=this.data,o=this.attributes.loop,c=this.states.speed,l=c===void 0?1:c;this.playInterval=window.setInterval(function(){var u=r.internalForward();u[1]===s.length&&!o&&(r.internalPause(),r.renderController())},1e3/l),this.states.state="play",!t&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var r,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(r=this.attributes)===null||r===void 0?void 0:r.onPause)===null||i===void 0||i.call(r))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var r,i,a=this.moveSelection("forward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onForward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var r,i;this.states.speed=t;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSpeedChange)===null||i===void 0||i.call(r,t)},e.prototype.handleSelectionTypeChange=function(t){var r,i;this.states.selectionType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSelectionTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.handleChartTypeChange=function(t){var r,i;this.states.chartType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onChartTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.render=function(){var t=this.space,r=t.axisBBox,i=t.controllerBBox,a=t.timelineBBox;this.renderController(i),this.renderAxis(r),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(Yt);const vft=Object.freeze(Object.defineProperty({__proto__:null,Axis:S_,BBox:Xt,Breadcrumb:Elt,Button:blt,Category:H8,Checkbox:Wht,CircleCrosshair:$ht,Continuous:Tht,Layout:Z8,LineCrosshair:Fht,Marker:Qt,Navigator:j8,PRIMILTIVE_ATTRIBUTES:n8,PolygonCrosshair:zht,Poptip:Qht,Scrollbar:aut,Select:Q8,Selection:a8,Slider:b_,Sparkline:S8,Switch:Dht,Tag:r0,Timebar:e9,Timeline:sht,Tooltip:X8,add:wo,addPrefix:u8,applyStyleSheet:h8,applyToText:h_,arrayInterpolate:UB,calcLayout:QB,catmullRom2Bezier:e8,classNames:ur,copyAttributes:c8,createOffscreenGroup:s_,createTempText:kct,deepAssign:fe,defined:c_,degToRad:Ns,distance:Qo,ellipsisIt:cp,flex:XB,formatTime:pn,getCallbackValue:cr,getEventPos:Zu,getFont:l_,getLocalBBox:Qw,getMask:d8,getPrimitiveAttributes:Zw,getRenderBBox:bct,getShapeSpace:s8,getTimeDiff:Vct,getTimeScale:Wct,getTimeStart:Hct,getTranslate:p8,grid:ZB,groupBy:VB,hide:xn,ifNegative:Pct,ifPositive:Cct,ifShow:Nn,inRange:Qe,interpolate:t0,intersection:GB,isHorizontal:o8,isInOffscreenGroup:$B,isPrimitiveAttribute:r8,isVertical:Dct,keyframeInterpolate:KB,lineLen:Kw,max:ha,maybeAppend:Ur,measureTextWidth:jB,mid:Tct,min:ua,multi:Mct,normalize:f_,numberInterpolate:HB,objectInterpolate:YB,omit:Xw,parseDate:Ju,parseHTML:wct,parseSeriesAttr:xe,path2marker:f8,percentTransform:d_,radToDeg:o_,removePrefix:Jw,renderExtDo:mi,rotate:JB,sampling:i8,scale:Wr,scaleToPixel:e0,select:ot,setMockMeasureTextWidth:xct,show:Ha,splitStyle:yi,stringToHTML:WB,sub:fd,subStyleProps:pt,superStyleProps:Pr,svg2marker:jct,textOf:u_,throttle:qct,timer:Uct,toKNotation:Oct,toLowercaseFirstLetter:l8,toPrecision:Qu,toScientificNotation:_ct,toThousands:Sct,toUppercaseFirstLetter:n0,transpose:g8,traverse:a_,vertical:t8,visibility:Oh,wrapIt:qB},Symbol.toStringTag,{value:"Module"})),Zp=class Zp extends kr{constructor(t,r){super(t,Object.assign({},Zp.defaultOptions,r));A(this,"typePrefix","__data__");A(this,"element",null);A(this,"draw",!1);A(this,"fieldMap",{node:new Map,edge:new Map,combo:new Map});A(this,"selectedItems",[]);A(this,"bindEvents",()=>{const{graph:t}=this.context;t.on(dt.AFTER_DRAW,this.createElement)});A(this,"changeState",(t,r)=>{const{graph:i}=this.context,{typePrefix:a}=this,s=ln(t,[a,"id"]),o=ln(t,[a,"style","labelText"]),[c]=s.split("__"),l=this.fieldMap[c].get(o)||[];i.setElementState(Object.fromEntries(l==null?void 0:l.map(u=>[u,r])))});A(this,"click",t=>{if(this.options.trigger==="hover")return;const r=ln(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?(this.selectedItems=this.selectedItems.filter(i=>i!==r),this.changeState(t,[])):(this.selectedItems.push(r),this.changeState(t,"selected"))});A(this,"mouseleave",t=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(t,[]))});A(this,"mouseenter",t=>{if(this.options.trigger==="click")return;const r=ln(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?this.selectedItems=this.selectedItems.filter(i=>i!==r):(this.selectedItems.push(r),this.changeState(t,"active"))});A(this,"setFieldMap",(t,r,i)=>{if(!t)return;const a=this.fieldMap[i];if(a)if(!a.has(t))a.set(t,[r]);else{const s=a.get(t);s&&(s.push(r),a.set(t,s))}});A(this,"getEvents",()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}));A(this,"getMarkerData",(t,r)=>{if(!t)return[];const{model:i,element:a,graph:s}=this.context,{nodes:o,edges:c,combos:l}=i.getData(),u={},h=v=>ft(t)?t(v):t,f={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},p=(v,m)=>a==null?void 0:a.getElementComputedStyle(v,m),g=(v,m)=>{v.forEach(y=>{const{id:b}=y,w=ln(y,["data",h(y)]),x=(a==null?void 0:a.getElementType(m,y))||"circle",S=p(m,y),_=(m==="edge"?S==null?void 0:S.stroke:S==null?void 0:S.fill)||"#1783ff";b&&w&&w.replace(/\s+/g,"")&&(this.setFieldMap(w,b,m),u[w]||(u[w]={id:`${m}__${b}`,label:w,marker:d[x]||f[m],elementType:m,lineWidth:1,stroke:_,fill:_}))})};switch(r){case"node":g(o,"node");break;case"edge":g(c,"edge");break;case"combo":g(l,"combo");break;default:return[]}return Object.values(u)});A(this,"layout",t=>{const r={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"};let{flexDirection:i,alignItems:a,justifyContent:s}=r;const o={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in o&&([i,a,s]=o[t]),{display:"flex",flexDirection:i,justifyContent:s,alignItems:a}});A(this,"createElement",()=>{if(this.draw){this.updateElement();return}const{canvas:t}=this.context,[r,i]=t.getSize(),{width:a=r,height:s=i,nodeField:o,edgeField:c,comboField:l,trigger:u,position:h,...f}=this.options,d=this.getMarkerData(o,"node"),p=this.getMarkerData(c,"edge"),g=this.getMarkerData(l,"combo"),v=[...d,...g,...p],m=this.layout(h),y=new Z8({style:{width:a,height:s,...m}}),b=Object.assign({width:a,height:s,data:v,itemMarkerLineWidth:({lineWidth:x})=>x,itemMarker:({marker:x})=>x,itemMarkerStroke:({stroke:x})=>x,itemMarkerFill:({fill:x})=>x,gridCol:d.length},f,this.getEvents()),w=new H8({className:"legend",style:b});y.appendChild(w),t.appendChild(y),this.element=y,this.draw=!0});this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;(t=this.element)==null||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;this.element.getChildByIndex(0).update({itemMarkerOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5,itemLabelOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5})}destroy(){this.clear(),this.context.graph.off(dt.AFTER_DRAW,this.createElement),super.destroy()}};A(Zp,"defaultOptions",{position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16});let u2=Zp;function mft(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.r;n.arc(r,a,s,0,Math.PI*2,!1)}function yft(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.rx,o=e.ry;if(n.ellipse)n.ellipse(r,a,s,o,0,0,Math.PI*2,!1);else{var c=s>o?s:o,l=s>o?1:s/o,u=s>o?o/s:1;n.save(),n.scale(l,u),n.arc(r,a,c,0,Math.PI*2)}}function bft(n,e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,s=e.markerStart,o=e.markerEnd,c=e.markerStartOffset,l=e.markerEndOffset,u=0,h=0,f=0,d=0,p=0,g,v;s&&zt(s)&&c&&(g=i-t,v=a-r,p=Math.atan2(v,g),u=Math.cos(p)*(c||0),h=Math.sin(p)*(c||0)),o&&zt(o)&&l&&(g=t-i,v=r-a,p=Math.atan2(v,g),f=Math.cos(p)*(l||0),d=Math.sin(p)*(l||0)),n.moveTo(t+u,r+h),n.lineTo(i+f,a+d)}function Eft(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.d,o=s.absolutePath,c=s.segments,l=0,u=0,h=0,f=0,d=0,p,g;if(t&&zt(t)&&i){var v=N(t.parentNode.getStartTangent(),2),m=v[0],y=v[1];p=m[0]-y[0],g=m[1]-y[1],d=Math.atan2(g,p),l=Math.cos(d)*(i||0),u=Math.sin(d)*(i||0)}if(r&&zt(r)&&a){var b=N(r.parentNode.getEndTangent(),2),m=b[0],y=b[1];p=m[0]-y[0],g=m[1]-y[1],d=Math.atan2(g,p),h=Math.cos(d)*(a||0),f=Math.sin(d)*(a||0)}for(var w=0;w<o.length;w++){var x=o[w],S=x[0],_=o[w+1],E=w===0&&(l!==0||u!==0),P=(w===o.length-1||_&&(_[0]==="M"||_[0]==="Z"))&&h!==0&&f!==0;switch(S){case"M":E?(n.moveTo(x[1]+l,x[2]+u),n.lineTo(x[1],x[2])):n.moveTo(x[1],x[2]);break;case"L":P?n.lineTo(x[1]+h,x[2]+f):n.lineTo(x[1],x[2]);break;case"Q":n.quadraticCurveTo(x[1],x[2],x[3],x[4]),P&&n.lineTo(x[3]+h,x[4]+f);break;case"C":n.bezierCurveTo(x[1],x[2],x[3],x[4],x[5],x[6]),P&&n.lineTo(x[5]+h,x[6]+f);break;case"A":{var O=c[w].arcParams,C=O.cx,M=O.cy,T=O.rx,R=O.ry,D=O.startAngle,B=O.endAngle,j=O.xRotation,L=O.sweepFlag;if(n.ellipse)n.ellipse(C,M,T,R,j,D,B,!!(1-L));else{var $=T>R?T:R,V=T>R?1:T/R,W=T>R?R/T:1;n.translate(C,M),n.rotate(j),n.scale(V,W),n.arc(0,0,$,D,B,!!(1-L)),n.scale(1/V,1/W),n.rotate(-j),n.translate(-C,-M)}P&&n.lineTo(x[6]+h,x[7]+f);break}case"Z":n.closePath();break}}}function xft(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,c=s[0][0],l=s[0][1],u=s[o-1][0],h=s[o-1][1],f=0,d=0,p=0,g=0,v=0,m,y;t&&zt(t)&&i&&(m=s[1][0]-s[0][0],y=s[1][1]-s[0][1],v=Math.atan2(y,m),f=Math.cos(v)*(i||0),d=Math.sin(v)*(i||0)),r&&zt(r)&&a&&(m=s[o-1][0]-s[0][0],y=s[o-1][1]-s[0][1],v=Math.atan2(y,m),p=Math.cos(v)*(a||0),g=Math.sin(v)*(a||0)),n.moveTo(c+(f||p),l+(d||g));for(var b=1;b<o-1;b++){var w=s[b];n.lineTo(w[0],w[1])}n.lineTo(u,h)}function wft(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,c=s[0][0],l=s[0][1],u=s[o-1][0],h=s[o-1][1],f=0,d=0,p=0,g=0,v=0,m,y;t&&zt(t)&&i&&(m=s[1][0]-s[0][0],y=s[1][1]-s[0][1],v=Math.atan2(y,m),f=Math.cos(v)*(i||0),d=Math.sin(v)*(i||0)),r&&zt(r)&&a&&(m=s[o-2][0]-s[o-1][0],y=s[o-2][1]-s[o-1][1],v=Math.atan2(y,m),p=Math.cos(v)*(a||0),g=Math.sin(v)*(a||0)),n.moveTo(c+f,l+d);for(var b=1;b<o-1;b++){var w=s[b];n.lineTo(w[0],w[1])}n.lineTo(u+p,h+g)}function Sft(n,e){var t=e.x,r=t===void 0?0:t,i=e.y,a=i===void 0?0:i,s=e.radius,o=e.width,c=e.height,l=o,u=c,h=s&&s.some(function(w){return w!==0});if(!h)n.rect(r,a,l,u);else{var f=o>0?1:-1,d=c>0?1:-1,p=f+d===0,g=N(s.map(function(w){return oe(w,0,Math.min(Math.abs(l)/2,Math.abs(u)/2))}),4),v=g[0],m=g[1],y=g[2],b=g[3];n.moveTo(f*v+r,a),n.lineTo(l-f*m+r,a),m!==0&&n.arc(l-f*m+r,d*m+a,m,-d*Math.PI/2,f>0?0:Math.PI,p),n.lineTo(l+r,u-d*y+a),y!==0&&n.arc(l-f*y+r,u-d*y+a,y,f>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,p),n.lineTo(f*b+r,u+a),b!==0&&n.arc(f*b+r,u-d*b+a,b,d>0?Math.PI/2:-Math.PI/2,f>0?Math.PI:0,p),n.lineTo(r,d*v+a),v!==0&&n.arc(f*v+r,d*v+a,v,f>0?Math.PI:0,d>0?Math.PI*1.5:Math.PI/2,p)}}var n9=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="canvas-path-generator",t}return e.prototype.init=function(){var t,r=(t={},t[X.CIRCLE]=mft,t[X.ELLIPSE]=yft,t[X.RECT]=Sft,t[X.LINE]=bft,t[X.POLYLINE]=wft,t[X.POLYGON]=xft,t[X.PATH]=Eft,t[X.TEXT]=void 0,t[X.GROUP]=void 0,t[X.IMAGE]=void 0,t[X.HTML]=void 0,t[X.MESH]=void 0,t);this.context.pathGeneratorFactory=r},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(Xi);const _ft=Object.freeze(Object.defineProperty({__proto__:null,Plugin:n9},Symbol.toStringTag,{value:"Module"}));var Oft=Ct(),Pft=Ct(),Cft=Ct(),Mft=le(),Tft=function(){function n(){var e=this;this.isHit=function(t,r,i,a){var s=e.context.pointInPathPickerFactory[t.nodeName];if(s){var o=li(Mft,i),c=Ye(Pft,qr(Cft,r[0],r[1],0),o);if(s(t,new tn(c[0],c[1]),a,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),a=e.context.pathGeneratorFactory[t.nodeName];return a&&(i.beginPath(),a(i,t.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return n.prototype.apply=function(e,t){var r=this,i,a=e.renderingService,s=e.renderingContext;this.context=e,this.runtime=t;var o=(i=s.root)===null||i===void 0?void 0:i.ownerDocument;a.hooks.pick.tapPromise(n.tag,function(c){return Et(r,void 0,void 0,function(){return Io(this,function(l){return[2,this.pick(o,c)]})})}),a.hooks.pickSync.tap(n.tag,function(c){return r.pick(o,c)})},n.prototype.pick=function(e,t){var r,i,a=t.topmost,s=t.position,o=s.x,c=s.y,l=qr(Oft,o,c,0),u=e.elementsFromBBox(l[0],l[1],l[0],l[1]),h=[];try{for(var f=er(u),d=f.next();!d.done;d=f.next()){var p=d.value,g=p.getWorldTransform(),v=this.isHit(p,l,g,!1);if(v){var m=$2(p);if(m){var y=m.parsedStyle.clipPath,b=this.isHit(y,l,y.getWorldTransform(),!0);if(b){if(a)return t.picked=[p],t;h.push(p)}}else{if(a)return t.picked=[p],t;h.push(p)}}}}catch(w){r={error:w}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return t.picked=h,t},n.tag="CanvasPicker",n}();function Aft(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,s=r.cy,o=s===void 0?0:s,c=r.r,l=r.fill,u=r.stroke,h=r.lineWidth,f=h===void 0?1:h,d=r.increasedLineWidthForHitTesting,p=d===void 0?0:d,g=r.pointerEvents,v=g===void 0?"auto":g,m=(f+p)/2,y=ji(a,o,e.x,e.y),b=N(qa(v,l,u),2),w=b[0],x=b[1];return w&&x||t?y<=c+m:w?y<=c:x?y>=c-m&&y<=c+m:!1}function qf(n,e,t,r){return n/(t*t)+e/(r*r)}function Nft(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,s=r.cy,o=s===void 0?0:s,c=r.rx,l=r.ry,u=r.fill,h=r.stroke,f=r.lineWidth,d=f===void 0?1:f,p=r.increasedLineWidthForHitTesting,g=p===void 0?0:p,v=r.pointerEvents,m=v===void 0?"auto":v,y=e.x,b=e.y,w=N(qa(m,u,h),2),x=w[0],S=w[1],_=(d+g)/2,E=(y-a)*(y-a),P=(b-o)*(b-o);return x&&S||t?qf(E,P,c+_,l+_)<=1:x?qf(E,P,c,l)<=1:S?qf(E,P,c-_,l-_)>=1&&qf(E,P,c+_,l+_)<=1:!1}function hs(n,e,t,r,i,a){return i>=n&&i<=n+t&&a>=e&&a<=e+r}function Rft(n,e,t,r,i,a,s){var o=i/2;return hs(n-o,e-o,t,i,a,s)||hs(n+t-o,e-o,i,r,a,s)||hs(n+o,e+r-o,t,i,a,s)||hs(n-o,e+o,i,r,a,s)}function Gf(n,e,t,r,i,a,s,o){var c=(Math.atan2(o-e,s-n)+Math.PI*2)%(Math.PI*2),l={x:n+t*Math.cos(c),y:e+t*Math.sin(c)};return ji(l.x,l.y,s,o)<=a/2}function Sa(n,e,t,r,i,a,s){var o=Math.min(n,t),c=Math.max(n,t),l=Math.min(e,r),u=Math.max(e,r),h=i/2;return a>=o-h&&a<=c+h&&s>=l-h&&s<=u+h?CG(n,e,t,r,a,s)<=i/2:!1}function r9(n,e,t,r,i){var a=n.length;if(a<2)return!1;for(var s=0;s<a-1;s++){var o=n[s][0],c=n[s][1],l=n[s+1][0],u=n[s+1][1];if(Sa(o,c,l,u,e,t,r))return!0}if(i){var h=n[0],f=n[a-1];if(Sa(h[0],h[1],f[0],f[1],e,t,r))return!0}return!1}var kft=1e-6;function HE(n){return Math.abs(n)<kft?0:n<0?-1:1}function Dft(n,e,t){return(t[0]-n[0])*(e[1]-n[1])===(e[0]-n[0])*(t[1]-n[1])&&Math.min(n[0],e[0])<=t[0]&&t[0]<=Math.max(n[0],e[0])&&Math.min(n[1],e[1])<=t[1]&&t[1]<=Math.max(n[1],e[1])}function i9(n,e,t){var r=!1,i=n.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=n[a],o=n[(a+1)%i];if(Dft(s,o,[e,t]))return!0;HE(s[1]-t)>0!=HE(o[1]-t)>0&&HE(e-(t-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(r=!r)}return r}function uR(n,e,t){for(var r=!1,i=0;i<n.length;i++){var a=n[i];if(r=i9(a,e,t),r)break}return r}function Lft(n,e,t){var r=n.parsedStyle,i=r.x1,a=r.y1,s=r.x2,o=r.y2,c=r.lineWidth,l=c===void 0?1:c,u=r.increasedLineWidthForHitTesting,h=u===void 0?0:u,f=r.pointerEvents,d=f===void 0?"auto":f,p=r.fill,g=r.stroke,v=N(qa(d,p,g),2),m=v[1];return!m&&!t||!l?!1:Sa(i,a,s,o,l+h,e.x,e.y)}function Ift(n,e,t,r,i){for(var a=!1,s=e/2,o=0;o<n.length;o++){var c=n[o],l=c.currentPoint,u=c.params,h=c.prePoint,f=c.box;if(!(f&&!hs(f.x-s,f.y-s,f.width+e,f.height+e,t,r)))switch(c.command){case"L":case"Z":if(a=Sa(h[0],h[1],l[0],l[1],e,t,r),a)return!0;break;case"Q":var d=DG(h[0],h[1],u[1],u[2],u[3],u[4],t,r);if(a=d<=e/2,a)return!0;break;case"C":var p=B3(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],t,r,i);if(a=p<=e/2,a)return!0;break;case"A":c.cubicParams||(c.cubicParams=hg(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var g=c.cubicParams,v=h,m=0;m<g.length;m+=6){var y=B3(v[0],v[1],g[m],g[m+1],g[m+2],g[m+3],g[m+4],g[m+5],t,r,i);if(v=[g[m+4],g[m+5]],a=y<=e/2,a)return!0}break}}return a}function Bft(n,e,t,r,i,a){var s=n.parsedStyle,o=s.lineWidth,c=o===void 0?1:o,l=s.increasedLineWidthForHitTesting,u=l===void 0?0:l,h=s.stroke,f=s.fill,d=s.d,p=s.pointerEvents,g=p===void 0?"auto":p,v=d.segments,m=d.hasArc,y=d.polylines,b=d.polygons,w=N(qa(g,(b==null?void 0:b.length)&&f,h),2),x=w[0],S=w[1],_=Rd(n),E=!1;return x||t?(m?E=r(n,e):E=uR(b,e.x,e.y)||uR(y,e.x,e.y),E):((S||t)&&(E=Ift(v,c+u,e.x,e.y,_)),E)}function Fft(n,e,t){var r=n.parsedStyle,i=r.stroke,a=r.fill,s=r.lineWidth,o=s===void 0?1:s,c=r.increasedLineWidthForHitTesting,l=c===void 0?0:c,u=r.points,h=r.pointerEvents,f=h===void 0?"auto":h,d=N(qa(f,a,i),2),p=d[0],g=d[1],v=!1;return(g||t)&&(v=r9(u.points,o+l,e.x,e.y,!0)),!v&&(p||t)&&(v=i9(u.points,e.x,e.y)),v}function $ft(n,e,t){var r=n.parsedStyle,i=r.lineWidth,a=i===void 0?1:i,s=r.increasedLineWidthForHitTesting,o=s===void 0?0:s,c=r.points,l=r.pointerEvents,u=l===void 0?"auto":l,h=r.fill,f=r.stroke,d=N(qa(u,h,f),2),p=d[1];return!p&&!t||!a?!1:r9(c.points,a+o,e.x,e.y,!1)}function zft(n,e,t,r,i){var a=n.parsedStyle,s=a.radius,o=a.fill,c=a.stroke,l=a.lineWidth,u=l===void 0?1:l,h=a.increasedLineWidthForHitTesting,f=h===void 0?0:h,d=a.x,p=d===void 0?0:d,g=a.y,v=g===void 0?0:g,m=a.width,y=a.height,b=a.pointerEvents,w=b===void 0?"auto":b,x=N(qa(w,o,c),2),S=x[0],_=x[1],E=s&&s.some(function(M){return M!==0}),P=u+f;if(E){var C=!1;return(_||t)&&(C=jft(p,v,m,y,s.map(function(M){return oe(M,0,Math.min(Math.abs(m)/2,Math.abs(y)/2))}),P,e.x,e.y)),!C&&(S||t)&&(C=r(n,e)),C}else{var O=P/2;if(S&&_||t)return hs(p-O,v-O,m+O,y+O,e.x,e.y);if(S)return hs(p,v,m,y,e.x,e.y);if(_)return Rft(p,v,m,y,P,e.x,e.y)}return!1}function jft(n,e,t,r,i,a,s,o){var c=N(i,4),l=c[0],u=c[1],h=c[2],f=c[3];return Sa(n+l,e,n+t-u,e,a,s,o)||Sa(n+t,e+u,n+t,e+r-h,a,s,o)||Sa(n+t-h,e+r,n+f,e+r,a,s,o)||Sa(n,e+r-f,n,e+l,a,s,o)||Gf(n+t-u,e+u,u,1.5*Math.PI,2*Math.PI,a,s,o)||Gf(n+t-h,e+r-h,h,0,.5*Math.PI,a,s,o)||Gf(n+f,e+r-f,f,.5*Math.PI,Math.PI,a,s,o)||Gf(n+l,e+l,l,Math.PI,1.5*Math.PI,a,s,o)}function qft(n,e,t,r,i,a){var s=n.parsedStyle,o=s.pointerEvents,c=o===void 0?"auto":o,l=s.x,u=l===void 0?0:l,h=s.y,f=h===void 0?0:h,d=s.width,p=s.height;if(c==="non-transparent-pixel"){var g=i.config.offscreenCanvas,v=a.offscreenCanvasCreator.getOrCreateCanvas(g),m=a.offscreenCanvasCreator.getOrCreateContext(g,{willReadFrequently:!0});v.width=d,v.height=p,i.defaultStyleRendererFactory[X.IMAGE].render(m,G(G({},n.parsedStyle),{x:0,y:0}),n,void 0,void 0,void 0);var y=m.getImageData(e.x-u,e.y-f,1,1).data;return y.every(function(b){return b!==0})}return!0}var a9=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="canvas-picker",t}return e.prototype.init=function(){var t,r=function(){return!0},i=(t={},t[X.CIRCLE]=Aft,t[X.ELLIPSE]=Nft,t[X.RECT]=zft,t[X.LINE]=Lft,t[X.POLYLINE]=$ft,t[X.POLYGON]=Fft,t[X.PATH]=Bft,t[X.TEXT]=r,t[X.GROUP]=null,t[X.IMAGE]=qft,t[X.HTML]=null,t[X.MESH]=null,t);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new Tft)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(Xi);const Gft=Object.freeze(Object.defineProperty({__proto__:null,Plugin:a9},Symbol.toStringTag,{value:"Module"}));var Vft=function(){function n(e){this.canvasRendererPluginOptions=e,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=le(),this.dprMatrix=le(),this.tmpMat4=le(),this.vec3a=Ct(),this.vec3b=Ct(),this.vec3c=Ct(),this.vec3d=Ct()}return n.prototype.apply=function(e,t){var r=this;this.context=e;var i=e.config,a=e.camera,s=e.renderingService,o=e.renderingContext,c=e.rBushRoot,l=e.pathGeneratorFactory;this.rBush=c,this.pathGeneratorFactory=l;var u=e.contextService,h=o.root.ownerDocument.defaultView,f=function(g){var v=g.target,m=v.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)},d=function(g){var v=g.target,m=v.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)};s.hooks.init.tap(n.tag,function(){h.addEventListener(vt.UNMOUNTED,f),h.addEventListener(vt.CULLED,d);var g=u.getDPR(),v=i.width,m=i.height,y=u.getContext();r.clearRect(y,0,0,v*g,m*g,i.background)}),s.hooks.destroy.tap(n.tag,function(){h.removeEventListener(vt.UNMOUNTED,f),h.removeEventListener(vt.CULLED,d),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),s.hooks.beginFrame.tap(n.tag,function(){var g,v=u.getContext(),m=u.getDPR(),y=i.width,b=i.height,w=r.canvasRendererPluginOptions,x=w.dirtyObjectNumThreshold,S=w.dirtyObjectRatioThreshold,_=s.getStats(),E=_.total,P=_.rendered,O=P/E;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((g=h.context.renderingPlugins[1])===null||g===void 0)&&g.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||P>x&&O>S,v&&(v.resetTransform?v.resetTransform():v.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(v,0,0,y*m,b*m,i.background))});var p=function(g,v){g.isVisible()&&!g.isCulled()&&r.renderDisplayObject(g,v,r.context,r.restoreStack,t);var m=g.sortable.sorted||g.childNodes;m.forEach(function(y){p(y,v)})};s.hooks.endFrame.tap(n.tag,function(){if(o.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var g=u.getContext(),v=u.getDPR();if(ss(r.dprMatrix,[v,v,1]),En(r.vpMatrix,r.dprMatrix,a.getOrthoMatrix()),r.clearFullScreen)p(o.root,g);else{var m=r.safeMergeAABB.apply(r,Q([r.mergeDirtyAABBs(r.renderQueue)],N(r.removedRBushNodeAABBs.map(function(W){var Y=W.minX,U=W.minY,J=W.maxX,at=W.maxY,ht=new ue;return ht.setMinMax([Y,U,0],[J,at,0]),ht})),!1));if(r.removedRBushNodeAABBs=[],ue.isEmpty(m)){r.renderQueue=[];return}var y=r.convertAABB2Rect(m),b=y.x,w=y.y,x=y.width,S=y.height,_=Ye(r.vec3a,[b,w,0],r.vpMatrix),E=Ye(r.vec3b,[b+x,w,0],r.vpMatrix),P=Ye(r.vec3c,[b,w+S,0],r.vpMatrix),O=Ye(r.vec3d,[b+x,w+S,0],r.vpMatrix),C=Math.min(_[0],E[0],O[0],P[0]),M=Math.min(_[1],E[1],O[1],P[1]),T=Math.max(_[0],E[0],O[0],P[0]),R=Math.max(_[1],E[1],O[1],P[1]),D=Math.floor(C),B=Math.floor(M),j=Math.ceil(T-C),L=Math.ceil(R-M);g.save(),r.clearRect(g,D,B,j,L,i.background),g.beginPath(),g.rect(D,B,j,L),g.clip(),g.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var $=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;$&&h.dispatchEvent(new se(yn.DIRTY_RECTANGLE,{dirtyRect:{x:D,y:B,width:j,height:L}}));var V=r.searchDirtyObjects(m);V.sort(function(W,Y){return W.sortable.renderOrder-Y.sortable.renderOrder}).forEach(function(W){W&&W.isVisible()&&!W.isCulled()&&r.renderDisplayObject(W,g,r.context,r.restoreStack,t)}),g.restore(),r.renderQueue.forEach(function(W){r.saveDirtyAABB(W)}),r.renderQueue=[]}r.restoreStack.forEach(function(){g.restore()}),r.restoreStack=[]}),s.hooks.render.tap(n.tag,function(g){r.clearFullScreen||r.renderQueue.push(g)})},n.prototype.clearRect=function(e,t,r,i,a,s){e.clearRect(t,r,i,a),s&&(e.fillStyle=s,e.fillRect(t,r,i,a))},n.prototype.renderDisplayObject=function(e,t,r,i,a){var s=e.nodeName,o=i[i.length-1];o&&!(e.compareDocumentPosition(o)&Ue.DOCUMENT_POSITION_CONTAINS)&&(t.restore(),i.pop());var c=this.context.styleRendererFactory[s],l=this.pathGeneratorFactory[s],u=e.parsedStyle.clipPath;if(u){this.applyWorldTransform(t,u);var h=this.pathGeneratorFactory[u.nodeName];h&&(t.save(),i.push(e),t.beginPath(),h(t,u.parsedStyle),t.closePath(),t.clip())}c&&(this.applyWorldTransform(t,e),t.save(),this.applyAttributesToContext(t,e)),l&&(t.beginPath(),l(t,e.parsedStyle),e.nodeName!==X.LINE&&e.nodeName!==X.PATH&&e.nodeName!==X.POLYLINE&&t.closePath()),c&&(c.render(t,e.parsedStyle,e,r,this,a),t.restore()),e.renderable.dirty=!1},n.prototype.convertAABB2Rect=function(e){var t=e.getMin(),r=e.getMax(),i=Math.floor(t[0]),a=Math.floor(t[1]),s=Math.ceil(r[0]),o=Math.ceil(r[1]),c=s-i,l=o-a;return{x:i,y:a,width:c,height:l}},n.prototype.mergeDirtyAABBs=function(e){var t=new ue;return e.forEach(function(r){var i=r.getRenderBounds();t.add(i);var a=r.renderable.dirtyRenderBounds;a&&t.add(a)}),t},n.prototype.searchDirtyObjects=function(e){var t=N(e.getMin(),2),r=t[0],i=t[1],a=N(e.getMax(),2),s=a[0],o=a[1],c=this.rBush.search({minX:r,minY:i,maxX:s,maxY:o});return c.map(function(l){var u=l.displayObject;return u})},n.prototype.saveDirtyAABB=function(e){var t=e.renderable;t.dirtyRenderBounds||(t.dirtyRenderBounds=new ue);var r=e.getRenderBounds();r&&t.dirtyRenderBounds.update(r.center,r.halfExtents)},n.prototype.applyAttributesToContext=function(e,t){var r=t.parsedStyle,i=r.stroke,a=r.fill,s=r.opacity,o=r.lineDash,c=r.lineDashOffset;o&&e.setLineDash(o),gt(c)||(e.lineDashOffset=c),gt(s)||(e.globalAlpha*=s),!gt(i)&&!Array.isArray(i)&&!i.isNone&&(e.strokeStyle=t.attributes.stroke),!gt(a)&&!Array.isArray(a)&&!a.isNone&&(e.fillStyle=t.attributes.fill)},n.prototype.applyWorldTransform=function(e,t,r){r?(Bo(this.tmpMat4,t.getLocalTransform()),En(this.tmpMat4,r,this.tmpMat4),En(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Bo(this.tmpMat4,t.getWorldTransform()),En(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},n.prototype.safeMergeAABB=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new ue;return e.forEach(function(i){r.add(i)}),r},n.tag="CanvasRenderer",n}(),Ua=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,s){var o=t.fill,c=t.fillRule,l=t.opacity,u=l===void 0?1:l,h=t.fillOpacity,f=h===void 0?1:h,d=t.stroke,p=t.strokeOpacity,g=p===void 0?1:p,v=t.lineWidth,m=v===void 0?1:v,y=t.lineCap,b=t.lineJoin,w=t.shadowType,x=t.shadowColor,S=t.shadowBlur,_=t.filter,E=t.miterLimit,P=o&&!o.isNone,O=d&&!d.isNone&&m>0,C=(o==null?void 0:o.alpha)===0,M=!!(_&&_.length),T=!gt(x)&&S>0,R=r.nodeName,D=w==="inner",B=O&&T&&(R===X.PATH||R===X.LINE||R===X.POLYLINE||C||D);P&&(e.globalAlpha=u*f,B||dp(r,e,T),c9(e,r,o,c,i,a,s,this.imagePool),B||this.clearShadowAndFilter(e,M,T)),O&&(e.globalAlpha=u*g,e.lineWidth=m,gt(E)||(e.miterLimit=E),gt(y)||(e.lineCap=y),gt(b)||(e.lineJoin=b),B&&(D&&(e.globalCompositeOperation="source-atop"),dp(r,e,!0),D&&(h2(e,r,d,i,a,s,this.imagePool),e.globalCompositeOperation="source-over",this.clearShadowAndFilter(e,M,!0))),h2(e,r,d,i,a,s,this.imagePool))},n.prototype.clearShadowAndFilter=function(e,t,r){if(r&&(e.shadowColor="transparent",e.shadowBlur=0),t){var i=e.filter;!gt(i)&&i.indexOf("drop-shadow")>-1&&(e.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},n}();function dp(n,e,t){var r=n.parsedStyle,i=r.filter,a=r.shadowColor,s=r.shadowBlur,o=r.shadowOffsetX,c=r.shadowOffsetY;i&&i.length&&(e.filter=n.style.filter),t&&(e.shadowColor=a.toString(),e.shadowBlur=s||0,e.shadowOffsetX=o||0,e.shadowOffsetY=c||0)}function s9(n,e,t,r,i,a,s){var o,c;if(n.image.nodeName==="rect"){var l=n.image.parsedStyle,u=l.width,h=l.height;c=r.contextService.getDPR();var f=r.config.offscreenCanvas;o=a.offscreenCanvasCreator.getOrCreateCanvas(f),o.width=u*c,o.height=h*c;var d=a.offscreenCanvasCreator.getOrCreateContext(f),p=[];n.image.forEach(function(v){i.renderDisplayObject(v,d,r,p,a)}),p.forEach(function(){d.restore()})}var g=s.getOrCreatePatternSync(n,t,o,c,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,r.renderingService.dirtify()});return g}function o9(n,e,t,r){var i;if(n.type===Hr.LinearGradient||n.type===Hr.RadialGradient){var a=e.getGeometryBounds(),s=a&&a.halfExtents[0]*2||1,o=a&&a.halfExtents[1]*2||1,c=a&&a.min||[0,0];i=r.getOrCreateGradient(G(G({type:n.type},n.value),{min:c,width:s,height:o}),t)}return i}function c9(n,e,t,r,i,a,s,o,c){c===void 0&&(c=!1),Array.isArray(t)?t.forEach(function(l){n.fillStyle=o9(l,e,n,o),c||(r?n.fill(r):n.fill())}):(Wo(t)&&(n.fillStyle=s9(t,e,n,i,a,s,o)),c||(r?n.fill(r):n.fill()))}function h2(n,e,t,r,i,a,s,o){o===void 0&&(o=!1),Array.isArray(t)?t.forEach(function(c){n.strokeStyle=o9(c,e,n,s),o||n.stroke()}):(Wo(t)&&(n.strokeStyle=s9(t,e,n,r,i,a,s)),o||n.stroke())}var l9=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,c=t.width,l=t.height,u=t.src,h=t.shadowColor,f=t.shadowBlur,d,p=c,g=l;if(At(u)?d=this.imagePool.getImageSync(u):(p||(p=u.width),g||(g=u.height),d=u),d){var v=!gt(h)&&f>0;dp(r,e,v);try{e.drawImage(d,a,o,p,g)}catch{}}},n}(),u9=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,s){r.getBounds();var o=t,c=o.lineWidth,l=c===void 0?1:c,u=o.textAlign,h=u===void 0?"start":u,f=o.textBaseline,d=f===void 0?"alphabetic":f,p=o.lineJoin,g=p===void 0?"miter":p,v=o.miterLimit,m=v===void 0?10:v,y=o.letterSpacing,b=y===void 0?0:y,w=o.stroke,x=o.fill,S=o.fillRule,_=o.fillOpacity,E=_===void 0?1:_,P=o.strokeOpacity,O=P===void 0?1:P,C=o.opacity,M=C===void 0?1:C,T=o.metrics,R=o.x,D=R===void 0?0:R,B=o.y,j=B===void 0?0:B,L=o.dx,$=o.dy,V=o.shadowColor,W=o.shadowBlur,Y=T.font,U=T.lines,J=T.height,at=T.lineHeight,ht=T.lineMetrics;e.font=Y,e.lineWidth=l,e.textAlign=h==="middle"?"center":h;var lt=d;!s.enableCSSParsing&&lt==="alphabetic"&&(lt="bottom"),e.lineJoin=g,gt(m)||(e.miterLimit=m);var Nt=j;d==="middle"?Nt+=-J/2-at/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?Nt+=-J:(d==="top"||d==="hanging")&&(Nt+=-at);var pe=D+(L||0);Nt+=$||0,U.length===1&&(lt==="bottom"?(lt="middle",Nt-=.5*J):lt==="top"&&(lt="middle",Nt+=.5*J)),e.textBaseline=lt;var Be=!gt(V)&&W>0;dp(r,e,Be);for(var nn=0;nn<U.length;nn++){var ri=l/2+pe;Nt+=at,!gt(w)&&!w.isNone&&l&&this.drawLetterSpacing(e,r,U[nn],ht[nn],h,ri,Nt,b,x,S,E,w,O,M,!0,i,a,s),gt(x)||this.drawLetterSpacing(e,r,U[nn],ht[nn],h,ri,Nt,b,x,S,E,w,O,M,!1,i,a,s)}},n.prototype.drawLetterSpacing=function(e,t,r,i,a,s,o,c,l,u,h,f,d,p,g,v,m,y){if(c===0){g?this.strokeText(e,t,r,s,o,f,d,v,m,y):this.fillText(e,t,r,s,o,l,u,h,p,v,m,y);return}var b=e.textAlign;e.textAlign="left";var w=s;a==="center"||a==="middle"?w=s-i.width/2:(a==="right"||a==="end")&&(w=s-i.width);for(var x=Array.from(r),S=e.measureText(r).width,_=0,E=0;E<x.length;++E){var P=x[E];g?this.strokeText(e,t,P,w,o,f,d,v,m,y):this.fillText(e,t,P,w,o,l,u,h,p,v,m,y),_=e.measureText(r.substring(E+1)).width,w+=S-_+c,S=_}e.textAlign=b},n.prototype.fillText=function(e,t,r,i,a,s,o,c,l,u,h,f){c9(e,t,s,o,u,h,f,this.imagePool,!0);var d,p=!gt(c)&&c!==1;p&&(d=e.globalAlpha,e.globalAlpha=c*l),e.fillText(r,i,a),p&&(e.globalAlpha=d)},n.prototype.strokeText=function(e,t,r,i,a,s,o,c,l,u){h2(e,t,s,c,l,u,this.imagePool,!0);var h,f=!gt(o)&&o!==1;f&&(h=e.globalAlpha,e.globalAlpha=o),e.strokeText(r,i,a),f&&(e.globalAlpha=h)},n}(),Wft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Hft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Uft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Yft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Kft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Xft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),Zft=function(n){tt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Ua),h9=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="canvas-renderer",r}return e.prototype.init=function(){var t,r=G({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,a=new Ua(i),s=(t={},t[X.CIRCLE]=a,t[X.ELLIPSE]=a,t[X.RECT]=a,t[X.IMAGE]=new l9(i),t[X.TEXT]=new u9(i),t[X.LINE]=a,t[X.POLYLINE]=a,t[X.POLYGON]=a,t[X.PATH]=a,t[X.GROUP]=void 0,t[X.HTML]=void 0,t[X.MESH]=void 0,t);this.context.defaultStyleRendererFactory=s,this.context.styleRendererFactory=s,this.addRenderingPlugin(new Vft(r))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(Xi);const Qft=Object.freeze(Object.defineProperty({__proto__:null,CircleRenderer:Hft,EllipseRenderer:Uft,ImageRenderer:l9,LineRenderer:Yft,PathRenderer:Zft,Plugin:h9,PolygonRenderer:Xft,PolylineRenderer:Kft,RectRenderer:Wft,TextRenderer:u9},Symbol.toStringTag,{value:"Module"}));var Jft=function(){function n(){}return n.prototype.apply=function(e,t){var r=this,i=e.renderingService,a=e.renderingContext,s=e.config;this.context=e;var o=a.root.ownerDocument.defaultView,c=function(S){i.hooks.pointerMove.call(S)},l=function(S){i.hooks.pointerUp.call(S)},u=function(S){i.hooks.pointerDown.call(S)},h=function(S){i.hooks.pointerOver.call(S)},f=function(S){i.hooks.pointerOut.call(S)},d=function(S){i.hooks.pointerCancel.call(S)},p=function(S){i.hooks.pointerWheel.call(S)},g=function(S){i.hooks.click.call(S)},v=function(S){t.globalThis.document.addEventListener("pointermove",c,!0),S.addEventListener("pointerdown",u,!0),S.addEventListener("pointerleave",f,!0),S.addEventListener("pointerover",h,!0),t.globalThis.addEventListener("pointerup",l,!0),t.globalThis.addEventListener("pointercancel",d,!0)},m=function(S){S.addEventListener("touchstart",u,!0),S.addEventListener("touchend",l,!0),S.addEventListener("touchmove",c,!0),S.addEventListener("touchcancel",d,!0)},y=function(S){t.globalThis.document.addEventListener("mousemove",c,!0),S.addEventListener("mousedown",u,!0),S.addEventListener("mouseout",f,!0),S.addEventListener("mouseover",h,!0),t.globalThis.addEventListener("mouseup",l,!0)},b=function(S){t.globalThis.document.removeEventListener("pointermove",c,!0),S.removeEventListener("pointerdown",u,!0),S.removeEventListener("pointerleave",f,!0),S.removeEventListener("pointerover",h,!0),t.globalThis.removeEventListener("pointerup",l,!0)},w=function(S){S.removeEventListener("touchstart",u,!0),S.removeEventListener("touchend",l,!0),S.removeEventListener("touchmove",c,!0),S.removeEventListener("touchcancel",d,!0)},x=function(S){t.globalThis.document.removeEventListener("mousemove",c,!0),S.removeEventListener("mousedown",u,!0),S.removeEventListener("mouseout",f,!0),S.removeEventListener("mouseover",h,!0),t.globalThis.removeEventListener("mouseup",l,!0)};i.hooks.init.tap(n.tag,function(){var S=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(S.style.msContentZooming="none",S.style.msTouchAction="none"):o.supportsPointerEvents&&(S.style.touchAction="none"),o.supportsPointerEvents?v(S):y(S),o.supportsTouchEvents&&m(S),s.useNativeClickEvent&&S.addEventListener("click",g,!0),S.addEventListener("wheel",p,{passive:!0,capture:!0})}),i.hooks.destroy.tap(n.tag,function(){var S=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(S.style.msContentZooming="",S.style.msTouchAction=""):o.supportsPointerEvents&&(S.style.touchAction=""),o.supportsPointerEvents?b(S):x(S),o.supportsTouchEvents&&w(S),s.useNativeClickEvent&&S.removeEventListener("click",g,!0),S.removeEventListener("wheel",p,!0)})},n.tag="DOMInteraction",n}(),f9=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="dom-interaction",t}return e.prototype.init=function(){this.addRenderingPlugin(new Jft)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xi);const tdt=Object.freeze(Object.defineProperty({__proto__:null,Plugin:f9},Symbol.toStringTag,{value:"Module"}));var edt="g-canvas-camera",ndt=function(){function n(){this.displayObjectHTMLElementMap=new WeakMap}return n.prototype.joinTransformMatrix=function(e){return"matrix(".concat([e[0],e[1],e[4],e[5],e[12],e[13]].join(","),")")},n.prototype.apply=function(e,t){var r=this,i=e.camera,a=e.renderingContext,s=e.renderingService;this.context=e;var o=a.root.ownerDocument.defaultView,c=o.context.eventService.nativeHTMLMap,l=function(g,v){v.style.transform=r.joinTransformMatrix(g.getWorldTransform())},u=function(g){var v=g.target;if(v.nodeName===X.HTML){r.$camera||(r.$camera=r.createCamera(i));var m=r.getOrCreateEl(v);if(r.$camera.appendChild(m),t.enableCSSParsing){var y=v.ownerDocument.documentElement.attributes;Object.keys(y).forEach(function(b){m.style[b]=y[b]})}Object.keys(v.attributes).forEach(function(b){r.updateAttribute(b,v)}),l(v,m),c.set(m,v)}},h=function(g){var v=g.target;if(v.nodeName===X.HTML&&r.$camera){var m=r.getOrCreateEl(v);m&&(m.remove(),c.delete(m))}},f=function(g){var v=g.target;if(v.nodeName===X.HTML){var m=g.attrName;r.updateAttribute(m,v)}},d=function(g){var v=g.target;if(v.nodeName===X.HTML){var m=r.getOrCreateEl(v);l(v,m)}},p=function(){if(r.$camera){var g=r.context.config,v=g.width,m=g.height;r.$camera.style.width="".concat(v||0,"px"),r.$camera.style.height="".concat(m||0,"px")}};s.hooks.init.tap(n.tag,function(){o.addEventListener(yn.RESIZE,p),o.addEventListener(vt.MOUNTED,u),o.addEventListener(vt.UNMOUNTED,h),o.addEventListener(vt.ATTR_MODIFIED,f),o.addEventListener(vt.BOUNDS_CHANGED,d)}),s.hooks.endFrame.tap(n.tag,function(){r.$camera&&a.renderReasons.has(qi.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),s.hooks.destroy.tap(n.tag,function(){r.$camera&&r.$camera.remove(),o.removeEventListener(yn.RESIZE,p),o.removeEventListener(vt.MOUNTED,u),o.removeEventListener(vt.UNMOUNTED,h),o.removeEventListener(vt.ATTR_MODIFIED,f),o.removeEventListener(vt.BOUNDS_CHANGED,d)})},n.prototype.createCamera=function(e){var t=this.context.config,r=t.document,i=t.width,a=t.height,s=this.context.contextService.getDomElement(),o=s.parentNode;if(o){var c=edt,l=o.querySelector("#"+c);if(!l){var u=(r||document).createElement("div");l=u,u.id=c,u.style.position="absolute",u.style.left="".concat(s.offsetLeft||0,"px"),u.style.top="".concat(s.offsetTop||0,"px"),u.style.transformOrigin="left top",u.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),u.style.overflow="hidden",u.style.pointerEvents="none",u.style.width="".concat(i||0,"px"),u.style.height="".concat(a||0,"px"),o.appendChild(u)}return l}return null},n.prototype.getOrCreateEl=function(e){var t=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(t||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform())),r},n.prototype.updateAttribute=function(e,t){var r=this.getOrCreateEl(t);switch(e){case"innerHTML":var i=t.parsedStyle.innerHTML;At(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(t.parsedStyle.x,"px");break;case"y":r.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var a=t.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(a[0].value," ").concat(a[1].value);break;case"width":if(this.context.enableCSSParsing){var s=t.computedStyleMap().get("width");r.style.width=s.toString()}else{var s=t.parsedStyle.width;r.style.width=rt(s)?"".concat(s,"px"):s.toString()}break;case"height":if(this.context.enableCSSParsing){var o=t.computedStyleMap().get("height");r.style.height=o.toString()}else{var o=t.parsedStyle.height;r.style.height=rt(o)?"".concat(o,"px"):o.toString()}break;case"zIndex":var c=t.parsedStyle.zIndex;r.style["z-index"]="".concat(c);break;case"visibility":var l=t.parsedStyle.visibility;r.style.visibility=l;break;case"pointerEvents":var u=t.parsedStyle.pointerEvents,h=u===void 0?"auto":u;r.style.pointerEvents=h;break;case"opacity":var f=t.parsedStyle.opacity;r.style.opacity="".concat(f);break;case"fill":var d=t.parsedStyle.fill,p="";Lu(d)?d.isNone?p="transparent":p=t.getAttribute("fill"):Array.isArray(d)?p=t.getAttribute("fill"):Wo(d),r.style.background=p;break;case"stroke":var g=t.parsedStyle.stroke,v="";Lu(g)?g.isNone?v="transparent":v=t.getAttribute("stroke"):Array.isArray(g)?v=t.getAttribute("stroke"):Wo(g),r.style["border-color"]=v,r.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;r.style["border-width"]="".concat(m||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var y=t.style.filter;r.style.filter=y;break;default:!gt(t.style[e])&&t.style[e]!==""&&(r.style[e]=t.style[e])}},n.tag="HTMLRendering",n}(),d9=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="html-renderer",t}return e.prototype.init=function(){this.addRenderingPlugin(new ndt)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xi);const rdt=Object.freeze(Object.defineProperty({__proto__:null,Plugin:d9},Symbol.toStringTag,{value:"Module"}));var p9=function(){function n(e){this.canvasConfig=e,this.imageCache={},this.gradientCache={},this.patternCache={}}return n.prototype.getImageSync=function(e,t){return this.imageCache[e]?t&&t(this.imageCache[e]):this.getOrCreateImage(e).then(function(r){t&&t(r)}),this.imageCache[e]},n.prototype.getOrCreateImage=function(e){var t=this;if(this.imageCache[e])return Promise.resolve(this.imageCache[e]);var r=this.canvasConfig.createImage;return new Promise(function(i,a){var s;r?s=r(e):oc&&(s=new window.Image),s&&(s.onload=function(){t.imageCache[e]=s,i(s)},s.onerror=function(o){a(o)},s.crossOrigin="Anonymous",s.src=e)})},n.prototype.getOrCreatePatternSync=function(e,t,r,i,a,s){var o=this.generatePatternKey(e);if(o&&this.patternCache[o])return this.patternCache[o];var c=e.image,l=e.repetition,u=e.transform,h,f=!1;At(c)?h=this.getImageSync(c,s):r?(h=r,f=!0):h=c;var d=h&&t.createPattern(h,l);if(d){var p=void 0;u?p=j2(gg(u),new Sn({})):p=ks(le()),f&&oD(p,p,[1/i,1/i,1]),d.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+a[0],f:p[13]+a[1]})}return o&&d&&(this.patternCache[o]=d),d},n.prototype.getOrCreateGradient=function(e,t){var r=this.generateGradientKey(e),i=e.type,a=e.steps,s=e.min,o=e.width,c=e.height,l=e.angle,u=e.cx,h=e.cy,f=e.size;if(this.gradientCache[r])return this.gradientCache[r];var d=null;if(i===Hr.LinearGradient){var p=yL(s,o,c,l),g=p.x1,v=p.y1,m=p.x2,y=p.y2;d=t.createLinearGradient(g,v,m,y)}else if(i===Hr.RadialGradient){var b=bL(s,o,c,u,h,f),w=b.x,x=b.y,S=b.r;d=t.createRadialGradient(w,x,0,w,x,S)}return d&&(a.forEach(function(_){var E=_.offset,P=_.color;E.unit===st.kPercentage&&(d==null||d.addColorStop(E.value/100,P.toString()))}),this.gradientCache[r]=d),this.gradientCache[r]},n.prototype.generateGradientKey=function(e){var t=e.type,r=e.min,i=e.width,a=e.height,s=e.steps,o=e.angle,c=e.cx,l=e.cy,u=e.size;return"gradient-".concat(t,"-").concat((o==null?void 0:o.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(a,"-").concat(s.map(function(h){var f=h.offset,d=h.color;return"".concat(f).concat(d)}).join("-"))},n.prototype.generatePatternKey=function(e){var t=e.image,r=e.repetition;if(At(t))return"pattern-".concat(t,"-").concat(r);if(t.nodeName==="rect")return"pattern-".concat(t.entity,"-").concat(r)},n}(),idt=function(){function n(){}return n.prototype.apply=function(e){var t=e.renderingService,r=e.renderingContext,i=e.imagePool,a=r.root.ownerDocument.defaultView,s=function(l,u,h){var f=l.parsedStyle,d=f.width,p=f.height;d&&!p?l.setAttribute("height",h/u*d):!d&&p&&l.setAttribute("width",u/h*p)},o=function(l){var u=l.target,h=u.nodeName,f=u.attributes;if(h===X.IMAGE){var d=f.src,p=f.keepAspectRatio;At(d)&&i.getImageSync(d,function(g){var v=g.width,m=g.height;p&&s(u,v,m),u.renderable.dirty=!0,t.dirtify()})}},c=function(l){var u=l.target,h=l.attrName,f=l.newValue;u.nodeName===X.IMAGE&&h==="src"&&At(f)&&i.getOrCreateImage(f).then(function(d){var p=d.width,g=d.height;u.attributes.keepAspectRatio&&s(u,p,g),u.renderable.dirty=!0,t.dirtify()})};t.hooks.init.tap(n.tag,function(){a.addEventListener(vt.MOUNTED,o),a.addEventListener(vt.ATTR_MODIFIED,c)}),t.hooks.destroy.tap(n.tag,function(){a.removeEventListener(vt.MOUNTED,o),a.removeEventListener(vt.ATTR_MODIFIED,c)})},n.tag="LoadImage",n}(),g9=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="image-loader",t}return e.prototype.init=function(){this.context.imagePool=new p9(this.context.config),this.addRenderingPlugin(new idt)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xi);const adt=Object.freeze(Object.defineProperty({__proto__:null,ImagePool:p9,Plugin:g9},Symbol.toStringTag,{value:"Module"}));var sdt=function(){function n(e){this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return n.prototype.init=function(){var e=this.canvasConfig,t=e.container,r=e.canvas;if(r)this.$canvas=r,t&&r.parentElement!==t&&t.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=At(t)?document.getElementById(t):t,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},n.prototype.getContext=function(){return this.context},n.prototype.getDomElement=function(){return this.$canvas},n.prototype.getDPR=function(){return this.dpr},n.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},n.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},n.prototype.resize=function(e,t){var r=this.canvasConfig.devicePixelRatio,i=r||oc&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*t,kL(this.$canvas,e,t)),this.renderingContext.renderReasons.add(qi.CAMERA_CHANGED)},n.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},n.prototype.toDataURL=function(e){return e===void 0&&(e={}),Et(this,void 0,void 0,function(){var t,r;return Io(this,function(i){return t=e.type,r=e.encoderOptions,[2,this.context.canvas.toDataURL(t,r)]})})},n}(),odt=function(n){tt(e,n);function e(){var t=n.apply(this,Q([],N(arguments),!1))||this;return t.name="canvas-context-register",t}return e.prototype.init=function(){this.context.ContextService=sdt},e.prototype.destroy=function(){delete this.context.ContextService},e}(Xi),u0=function(n){tt(e,n);function e(t){var r=n.call(this,t)||this;return r.registerPlugin(new odt),r.registerPlugin(new g9),r.registerPlugin(new n9),r.registerPlugin(new h9),r.registerPlugin(new f9),r.registerPlugin(new a9),r.registerPlugin(new d9),r}return e}(hL);const cdt=Object.freeze(Object.defineProperty({__proto__:null,CanvasPathGenerator:_ft,CanvasPicker:Gft,CanvasRenderer:Qft,DomInteraction:tdt,HTMLRenderer:rdt,ImageLoader:adt,Renderer:u0},Symbol.toStringTag,{value:"Module"})),ldt=["timestamp","time","date","datetime"],Qp=class Qp extends kr{constructor(t,r){super(t,Object.assign({},Qp.defaultOptions,r));A(this,"timebar");A(this,"canvas");A(this,"wrapper");A(this,"originalData");this.backup(),this.upsertTimebar()}get padding(){return ph(this.options.padding)}play(){var t;(t=this.timebar)==null||t.play()}pause(){var t;(t=this.timebar)==null||t.pause()}forward(){var t;(t=this.timebar)==null||t.forward()}backward(){var t;(t=this.timebar)==null||t.backward()}reset(){var t;(t=this.timebar)==null||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach(r=>{switch(r){case"position":this.upsertWrapper();break;default:this.upsertTimebar();break}})}backup(){this.originalData=hR(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,{onChange:r,timebarType:i,data:a,x:s,y:o,width:c,height:l,mode:u,...h}=this.options,f=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const p={x:f[0]/2-c/2,y:d,onChange:v=>{const m=(me(v)?v:[v,v]).map(y=>$D(y)?y.getTime():y);this.options.mode==="modify"?this.filterElements(m):this.hiddenElements(m),r==null||r(m)},...h,data:a.map(v=>rt(v)?{time:v,value:0}:v),width:c,height:l,type:i};this.timebar?this.timebar.update(p):(this.timebar=new e9({style:p}),(g=this.canvas)==null||g.appendChild(this.timebar))})}upsertWrapper(){var s;if(!this.wrapper){const o=document.createElement("div");o.style.position="absolute",this.wrapper=o}const{x:t,y:r,className:i,position:a}=this.options;return i&&(this.wrapper.className=i),rt(t)||rt(r)?Object.assign(this.wrapper.style,{left:`${t??0}px`,top:`${r??0}px`}):Object.assign(this.wrapper.style,{[a==="top"?"bottom":"top"]:"unset",[a==="top"?"top":"bottom"]:"0px"}),(s=this.context.canvas.getContainer())==null||s.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var o,c;const t=this.upsertWrapper();if(this.canvas)return this.canvas;const{height:r}=this.options,[i]=this.context.canvas.getSize(),[a,,s]=this.padding;return this.canvas=new Fd({container:t,width:i,height:r+a+s,renderer:((c=(o=this.context.options).renderer)==null?void 0:c.call(o,"main"))||new u0,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}async filterElements(t){var l;if(!this.originalData)return;const{elementTypes:r,getTime:i}=this.options,{graph:a,element:s}=this.context,o=hR(this.originalData);r.forEach(u=>{const h=`${u}s`;o[h]=(this.originalData[h]||[]).filter(f=>{const d=i(f);return!!fR(d,t)})});const c=[...o.nodes,...o.combos].map(u=>Z(u));o.edges=o.edges.filter(u=>{const h=u.source,f=u.target;return c.includes(h)&&c.includes(f)}),a.setData(o),await((l=s.draw({animation:!1,silence:!0}))==null?void 0:l.finished)}hiddenElements(t){const{graph:r}=this.context,{elementTypes:i,getTime:a}=this.options,s=[],o=[];i.forEach(c=>{var h;const l=`${c}s`;(((h=this.originalData)==null?void 0:h[l])||[]).forEach(f=>{const d=Z(f),p=a(f);fR(p,t)?o.push(d):s.push(d)})}),r.hideElement(s,!1),r.showElement(o,!1)}destroy(){var r,i,a;const{graph:t}=this.context;this.originalData&&t.setData({...this.originalData}),(r=this.timebar)==null||r.destroy(),(i=this.canvas)==null||i.destroy(),(a=this.wrapper)==null||a.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}};A(Qp,"defaultOptions",{position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>udt(t,ldt,void 0),loop:!1});let f2=Qp;const hR=n=>{const{nodes:e=[],edges:t=[],combos:r=[]}=n;return{nodes:[...e],edges:[...t],combos:[...r]}},fR=(n,e)=>{if(rt(e))return n===e;const[t,r]=e;return n>=t&&n<=r},udt=(n,e,t)=>{var r;for(let i=0;i<e.length;i++){const a=e[i],s=(r=n.data)==null?void 0:r[a];if(s)return s}return t};function hdt(n){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return n.split("-").forEach(r=>{e[r]="8px"}),e.flexDirection=n.startsWith("top")||n.startsWith("bottom")?"row":"column",e}const fdt=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,ddt=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`,Jp=class Jp extends kr{constructor(t,r){super(t,Object.assign({},Jp.defaultOptions,r));A(this,"$element",_h("toolbar",!1));A(this,"onToolbarItemClick",t=>{const{onClick:r}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const i=t.target.getAttribute("value");r==null||r(i,t.target)}});const i=this.context.canvas.getContainer();this.$element.style.display="flex",i.appendChild(this.$element),Fw("g6-toolbar-css","style",{},fdt,document.head),Fw("g6-toolbar-svgicon","div",{display:"none"},ddt),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(r)}async update(t){super.update(t);const{className:r,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${r||""}`,Object.assign(this.$element.style,a,hdt(i)),this.$element.innerHTML=await this.getDOMContent()}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}async getDOMContent(){return(await this.options.getItems()).map(r=>`
          <div class="g6-toolbar-item" value="${r.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${r.id}"></use>
            </svg>
          </div>`).join("")}};A(Jp,"defaultOptions",{position:"top-left"});let d2=Jp;const tg=class tg extends kr{constructor(t,r){super(t,Object.assign({},tg.defaultOptions,r));A(this,"currentTarget",null);A(this,"tooltipElement",null);A(this,"container",null);A(this,"isEnable",t=>{const{enable:r}=this.options;return typeof r=="function"?r(t):r});A(this,"onClick",t=>{const{target:{id:r}}=t;this.currentTarget===r?(this.currentTarget=null,this.hide(t)):(this.currentTarget=r,this.show(t))});A(this,"onPointerMove",t=>{const{target:r}=t;!this.currentTarget||r.id===this.currentTarget||this.show(t)});A(this,"onPointerLeave",t=>{this.hide(t),this.currentTarget=null});A(this,"onCanvasMove",t=>{this.hide(t),this.currentTarget=null});A(this,"onPointerEnter",t=>{this.show(t)});A(this,"showById",t=>{const r={target:{id:t}};this.show(r)});A(this,"getElementData",(t,r)=>{const{model:i}=this.context;switch(r){case"node":return i.getNodeData([t]);case"edge":return i.getEdgeData([t]);case"combo":return i.getComboData([t]);default:return[]}});A(this,"show",t=>{const{client:r,target:{id:i}}=t,a=this.context.graph.getElementType(i);if(!this.tooltipElement||!this.isEnable(t))return;const{getContent:s,title:o}=this.options;this.currentTarget=i;const c=this.getElementData(i,a);let l,u;if(r)l=r.x,u=r.y;else{const f=ln(c,"0.style",{x:0,y:0});l=f.x,u=f.y}let h={};if(s)h.content=s(t,c);else{const f=this.context.graph.getElementRenderStyle(i),d=a==="node"?f.fill:f.stroke;h={title:o||a,data:c.map(p=>({name:"ID",value:p.id||`${p.source} -> ${p.target}`,color:d}))}}this.tooltipElement.update({x:l,y:u,style:{".tooltip":{visibility:"visible"}},...h})});A(this,"hide",t=>{var a;if(!t){(a=this.tooltipElement)==null||a.hide();return}if(!this.tooltipElement||!this.isEnable(t))return;const{client:{x:r,y:i}}=t;this.tooltipElement.hide(r,i)});A(this,"initTooltip",()=>{var y;const{canvas:t}=this.context,{center:r}=t.getBounds(),i=t.getContainer(),{top:a,left:s}=i.getBoundingClientRect(),{style:o,position:c,enterable:l,container:u={x:-s,y:-a},title:h,offset:f}=this.options,[d,p]=r,[g,v]=t.getSize(),m=new X8({className:"tooltip",style:{x:d,y:p,container:u,title:h,bounding:{x:0,y:0,width:g,height:v},position:c,enterable:l,offset:f,style:o}});return(y=this.container)==null||y.appendChild(m.HTMLTooltipElement),m});this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var r;this.unbindEvents(),super.update(t),this.tooltipElement&&((r=this.container)==null||r.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,r=t.getContainer();r&&(this.container=r,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.off(i,r[i])})}bindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.on(i,r[i])})}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)==null||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}};A(tg,"defaultOptions",{trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}});let p2=tg,so;function v9(n,e){return so||(so=document.createElement("canvas")),so.width=n,so.height=e,so.getContext("2d").clearRect(0,0,n,e),so}async function pdt(n,e,t,r){const i=v9(n,e),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:c,textFontSize:l,textFontFamily:u,textFontVariant:h,textFontWeight:f,textAlign:d,textBaseline:p}=r;return a.textAlign=d,a.textBaseline=p,a.translate(n/2,e/2),a.font=`${l}px ${u} ${h} ${f}`,s&&a.rotate(s),o&&(a.globalAlpha=o),c&&(a.fillStyle=c,a.fillText(`${t}`,0,0)),i.toDataURL()}async function gdt(n,e,t,r){const i=v9(n,e),a=i.getContext("2d"),{rotate:s,opacity:o}=r;s&&a.rotate(s),o&&(a.globalAlpha=o);const c=new Image;return c.crossOrigin="anonymous",c.src=t,new Promise(l=>{c.onload=function(){const u=n>c.width?(n-c.width)/2:0,h=e>c.height?(e-c.height)/2:0;a.drawImage(c,0,0,c.width,c.height,u,h,n-u*2,e-h*2),l(i.toDataURL())}})}const eg=class eg extends kr{constructor(t,r){super(t,Object.assign({},eg.defaultOptions,r));A(this,"$element",_h("watermark"));this.context.canvas.getContainer().appendChild(this.$element),this.update(r)}async update(t){super.update(t);const{width:r,height:i,text:a,imageURL:s,...o}=this.options;Object.keys(o).forEach(l=>{l.startsWith("background")&&(this.$element.style[l]=t[l])});const c=s?await gdt(r,i,s,o):await pdt(r,i,a,o);this.$element.style.backgroundImage=`url(${c})`}destroy(){super.destroy(),this.$element.remove()}};A(eg,"defaultOptions",{width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"});let g2=eg;const vdt=["#7E92B5","#F4664A","#FFBE3A"],mdt={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},ydt={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function m9(n){const{bgColor:e,textColor:t,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:c=.06,nodeIconOpacityInactive:l=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=vdt,nodePaletteOptions:f=mdt,edgeColor:d,edgeColorDisabled:p,edgePaletteOptions:g=ydt,comboColor:v,comboColorDisabled:m,comboStroke:y,comboStrokeDisabled:b,edgeColorInactive:w}=n;return{background:e,node:{palette:f,style:{badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:l,labelFill:t,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:c,fill:i,fillOpacity:c,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:c}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:w,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:v,halo:!1,haloLineWidth:12,haloStroke:y,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:y},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const bdt={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},Edt={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:bdt,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},xdt=m9(Edt),wdt={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},Sdt=m9(wdt);class wc extends J2{beforeDraw(e,t){return e}}class _dt extends wc{beforeDraw(e){const{model:t}=this.context,r=e.add.combos,i=a=>{const s=[];return a.forEach((o,c)=>{const u=t.getAncestorsData(c,"combo").map(h=>Z(h)).reverse();s.push([c,o,u.length])}),new Map(s.sort(([,,o],[,,c])=>c-o).map(([o,c])=>[o,c]))};return e.add.combos=i(r),e.update.combos=i(e.update.combos),e}}function _a(n,e,t,r,i){const a=Z(r),s=`${t}s`,o=n.add[s].get(a)||n.update[s].get(a)||n.remove[s].get(a)||r;Object.entries(n).forEach(([c,l])=>{e===c?l[s].set(a,o):l[s].delete(a)})}class Odt extends wc{beforeDraw(e,t){if(t.stage==="visibility")return e;const{model:r}=this.context,{add:i,update:a}=e,s=[...e.update.combos.entries(),...e.add.combos.entries()];for(;s.length;){const[o,c]=s.pop();if(nr(c)){const l=r.getDescendantsData(o),u=l.map(Z),{internal:h,external:f}=TO(u,d=>r.getRelatedEdgesData(d));l.forEach(d=>{const p=Z(d),g=s.findIndex(([m])=>m===p);g!==-1&&s.splice(g,1);const v=r.getElementType(p);_a(e,"remove",v,d)}),h.forEach(d=>_a(e,"remove","edge",d)),f.forEach(d=>{var v;const p=Z(d);((v=this.context.element)==null?void 0:v.getElement(p))?a.edges.set(p,d):i.edges.set(p,d)})}else{const l=r.getChildrenData(o),u=l.map(Z),{edges:h}=TO(u,f=>r.getRelatedEdgesData(f));[...l,...h].forEach(f=>{var v;const d=Z(f),p=r.getElementType(d);((v=this.context.element)==null?void 0:v.getElement(d))?_a(e,"update",p,f):_a(e,"add",p,f),p==="combo"&&s.push([d,f])})}}return e}}const dR=(n,e,t,r)=>{const i=`${t}s`,a=Z(r);!n.add[i].has(a)&&!n.update[i].has(a)&&n[e][i].set(Z(r),r)};class Pdt extends wc{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(dR(t,"add","node",e),nr(e))return;const r=Z(e);dR(t,"add","node",e),this.context.model.getRelatedEdgesData(r,"out").forEach(s=>{_a(t,"add","edge",s)}),this.context.model.getChildrenData(r).forEach(s=>{this.handleExpand(s,t)})}beforeDraw(e){const{graph:t,model:r}=this.context,{add:{nodes:i,edges:a},update:{nodes:s}}=e,o=new Map,c=new Map;i.forEach((u,h)=>{nr(u)&&o.set(h,u)}),a.forEach(u=>{if(t.getElementType(u.source)!=="node")return;const h=t.getNodeData(u.source);nr(h)&&o.set(u.source,h)}),s.forEach((u,h)=>{const f=this.getElement(h);if(!f)return;const d=f.attributes.collapsed;nr(u)?d||o.set(h,u):d&&c.set(h,u)});const l=new Set;return o.forEach((u,h)=>{r.getDescendantsData(h).forEach(d=>{const p=Z(d);if(l.has(p))return;_a(e,"remove","node",d),r.getRelatedEdgesData(p).forEach(v=>{_a(e,"remove","edge",v)}),l.add(p)})}),c.forEach((u,h)=>{if(r.getAncestorsData(h,Ca).some(nr)){_a(e,"remove","node",u);return}this.handleExpand(u,e)}),e}}let h0=class{constructor(e){A(this,"type");this.type=e}},Je=class extends h0{constructor(t,r){super(t);A(this,"data");this.data=r}},Er=class extends h0{constructor(t,r,i,a){super(t);A(this,"animationType");A(this,"animation");A(this,"data");this.animationType=r,this.animation=i,this.data=a}},oo=class extends h0{constructor(t,r,i){super(t);A(this,"elementType");A(this,"data");this.elementType=r,this.data=i}},Vf=class extends h0{constructor(t,r){super(t);A(this,"data");this.data=r}};function on(n,e){n.emit(e.type,e)}function Cdt(n){if(!n)return null;if(n instanceof H2)return{type:"canvas",element:n};let e=n;for(;e;){if(mh(e))return{type:"node",element:e};if(YI(e))return{type:"edge",element:e};if(aS(e))return{type:"combo",element:e};e=e.parentElement}return null}class Mdt{constructor(e){A(this,"context");A(this,"tasks",[]);A(this,"animations",new Set);this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,r){var s,o,c;(s=t==null?void 0:t.before)==null||s.call(t);const i=this.getTasks().map(([l,u])=>{var v,m,y;const{element:h,elementType:f,stage:d}=l,p=fU(this.context.options,f,d,e);(v=u==null?void 0:u.before)==null||v.call(u);const g=dU(h,this.inferStyle(l,r),p);return g?((m=u==null?void 0:u.beforeAnimate)==null||m.call(u,g),g.finished.then(()=>{var b,w;(b=u==null?void 0:u.afterAnimate)==null||b.call(u,g),(w=u==null?void 0:u.after)==null||w.call(u),this.animations.delete(g)})):(y=u==null?void 0:u.after)==null||y.call(u),g}).filter(Boolean);i.forEach(l=>this.animations.add(l));const a=Z2(i);return a?((o=t==null?void 0:t.beforeAnimate)==null||o.call(t,a),a.finished.then(()=>{var l,u;(l=t==null?void 0:t.afterAnimate)==null||l.call(t,a),(u=t==null?void 0:t.after)==null||u.call(t),this.release()})):(c=t==null?void 0:t.after)==null||c.call(t),a}inferStyle(e,t){const{element:r,elementType:i,stage:a,originalStyle:s,modifiedStyle:o}=e,c={...s},l={...o},u=()=>Yo(r,"opacity")??jd("opacity");if(a==="enter")Object.assign(c,{opacity:0});else if(a==="exit")Object.assign(l,{opacity:0});else if(a==="show")Object.assign(c,{opacity:0}),Object.assign(l,{opacity:u()});else if(a==="hide")Object.assign(c,{opacity:u()}),Object.assign(l,{opacity:0});else if(a==="collapse"){const{collapse:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(d.includes(r.id)){const[g,v,m]=p;Object.assign(l,{x:g,y:v,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[g,v]=p;Object.assign(l,{x:g,y:v,childrenNode:c.childrenNode})}}else i==="edge"&&Object.assign(l,{sourceNode:c.sourceNode,targetNode:c.targetNode})}else if(a==="expand"){const{expand:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(r.id===f||d.includes(r.id)){const[g,v,m]=p;Object.assign(c,{x:g,y:v,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[g,v,m]=p;Object.assign(c,{x:g,y:v,z:m,childrenNode:l.childrenNode})}}else i==="edge"&&Object.assign(c,{sourceNode:l.sourceNode,targetNode:l.targetNode})}return[c,l]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var r,i;const{canvas:e}=this.context,t=(i=(r=e.document)==null?void 0:r.timeline)==null?void 0:i.animationsWithPromises;t&&(e.document.timeline.animationsWithPromises=t.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class Tdt{constructor(e){A(this,"context");A(this,"batchCount",0);this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Je(dt.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Je(dt.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class Adt extends Q2{constructor(t){super(t);A(this,"currentTarget",null);A(this,"currentTargetType",null);A(this,"category","behavior");A(this,"forwardCanvasEvents",t=>{const{target:r}=t,i=Cdt(r);if(!i)return;const{graph:a,canvas:s}=this.context,{type:o,element:c}=i;if("destroyed"in c&&(ZI(c)||c.destroyed))return;const{type:l,detail:u,button:h}=t,f={...t,target:c,targetType:o,originalTarget:r};l===nt.POINTER_MOVE&&(this.currentTarget!==c&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${nt.POINTER_LEAVE}`,{...f,type:nt.POINTER_LEAVE,target:this.currentTarget}),c&&(Object.assign(f,{type:nt.POINTER_ENTER}),a.emit(`${o}:${nt.POINTER_ENTER}`,f))),this.currentTarget=c,this.currentTargetType=o),l===nt.CLICK&&h===2||(a.emit(`${o}:${l}`,f),a.emit(l,f)),l===nt.CLICK&&u===2&&(Object.assign(f,{type:nt.DBLCLICK}),a.emit(`${o}:${nt.DBLCLICK}`,f),a.emit(nt.DBLCLICK,f)),l===nt.POINTER_DOWN&&h===2&&(Object.assign(f,{type:nt.CONTEXT_MENU,preventDefault:()=>{var d;(d=s.getContainer())==null||d.addEventListener(nt.CONTEXT_MENU,p=>p.preventDefault(),{once:!0})}}),a.emit(`${o}:${nt.CONTEXT_MENU}`,f),a.emit(nt.CONTEXT_MENU,f))});A(this,"forwardContainerEvents",t=>{this.context.graph.emit(t.type,t)});this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[yo.KEY_DOWN,yo.KEY_UP].forEach(i=>{t.addEventListener(i,this.forwardContainerEvents)});const r=this.context.canvas.document;r&&[nt.CLICK,nt.DBLCLICK,nt.POINTER_OVER,nt.POINTER_LEAVE,nt.POINTER_ENTER,nt.POINTER_MOVE,nt.POINTER_OUT,nt.POINTER_DOWN,nt.POINTER_UP,nt.CONTEXT_MENU,nt.DRAG_START,nt.DRAG,nt.DRAG_END,nt.DRAG_ENTER,nt.DRAG_OVER,nt.DRAG_LEAVE,nt.DROP,nt.WHEEL].forEach(i=>{r.addEventListener(i,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[yo.KEY_DOWN,yo.KEY_UP].forEach(r=>{t.removeEventListener(r,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var Ndt=function(){function n(e){this.dragndropPluginOptions=e}return n.prototype.apply=function(e){var t=this,r=e.renderingService,i=e.renderingContext,a=i.root.ownerDocument,s=a.defaultView,o=function(c){var l=c.target,u=l===a,h=u&&t.dragndropPluginOptions.isDocumentDraggable?a:l.closest&&l.closest("[draggable=true]");if(h){var f=!1,d=c.timeStamp,p=[c.clientX,c.clientY],g=null,v=[c.clientX,c.clientY],m=function(b){return Et(t,void 0,void 0,function(){var w,x,S,_,E,P;return Io(this,function(O){switch(O.label){case 0:if(!f){if(w=b.timeStamp-d,x=Mn([b.clientX,b.clientY],p),w<=this.dragndropPluginOptions.dragstartTimeThreshold||x<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];b.type="dragstart",h.dispatchEvent(b),f=!0}return b.type="drag",b.dx=b.clientX-v[0],b.dy=b.clientY-v[1],h.dispatchEvent(b),v=[b.clientX,b.clientY],u?[3,2]:(S=this.dragndropPluginOptions.overlap==="pointer"?[b.canvasX,b.canvasY]:l.getBounds().center,[4,a.elementsFromPoint(S[0],S[1])]);case 1:_=O.sent(),E=_[_.indexOf(l)+1],P=(E==null?void 0:E.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?a:null),g!==P&&(g&&(b.type="dragleave",b.target=g,g.dispatchEvent(b)),P&&(b.type="dragenter",b.target=P,P.dispatchEvent(b)),g=P,g&&(b.type="dragover",b.target=g,g.dispatchEvent(b))),O.label=2;case 2:return[2]}})})};s.addEventListener("pointermove",m);var y=function(b){if(f){b.detail={preventClick:!0};var w=b.clone();g&&(w.type="drop",w.target=g,g.dispatchEvent(w)),w.type="dragend",h.dispatchEvent(w),f=!1}s.removeEventListener("pointermove",m)};l.addEventListener("pointerup",y,{once:!0}),l.addEventListener("pointerupoutside",y,{once:!0})}};r.hooks.init.tap(n.tag,function(){s.addEventListener("pointerdown",o)}),r.hooks.destroy.tap(n.tag,function(){s.removeEventListener("pointerdown",o)})},n.tag="Dragndrop",n}(),y9=function(n){tt(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="dragndrop",r}return e.prototype.init=function(){this.addRenderingPlugin(new Ndt(G({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},e}(Xi);const Rdt=Object.freeze(Object.defineProperty({__proto__:null,Plugin:y9},Symbol.toStringTag,{value:"Module"})),b9=["background","main","label","transient"];let pR=class{constructor(e){A(this,"extends");A(this,"config");this.config=e;const{renderer:t,background:r,cursor:i,...a}=e,s=gR(t),o=Object.fromEntries(b9.map(c=>{const l=new Fd({...a,supportsMutipleCanvasesInOneContainer:!0,renderer:s[c],background:c==="background"?r:void 0});return[c,l]}));vR(o),this.extends={config:e,renderer:t,renderers:s,layers:o}}getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(r=>r.resize(e,t))}getBounds(){return gh(Object.values(this.getLayers()).map(e=>e.document.documentElement).filter(e=>e.childNodes.length>0).map(e=>e.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var i;const r=((i=e.style)==null?void 0:i.$layer)||"main";return this.getLayer(r).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=gR(e);this.extends.renderers=t,Object.entries(t).forEach(([r,i])=>this.getLayer(r).setRenderer(i)),vR(this.getLayers())}getCanvasByViewport(e){return Vr(this.getLayer().viewport2Canvas(Lc(e)))}getViewportByCanvas(e){return Vr(this.getLayer().canvas2Viewport(Lc(e)))}getViewportByClient(e){return Vr(this.getLayer().client2Viewport(Lc(e)))}getClientByViewport(e){return Vr(this.getLayer().viewport2Client(Lc(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),r=t.client2Viewport(Lc(e));return Vr(t.viewport2Canvas(r))}async toDataURL(e={}){const t=window.devicePixelRatio||1,{mode:r="viewport",...i}=e;let[a,s,o,c]=[0,0,0,0];if(r==="viewport")[o,c]=this.getSize();else if(r==="overall"){const m=this.getBounds(),y=Ls(m);[a,s]=m.min,[o,c]=y}const l=Cd('<div id="virtual-image"></div>'),u=new Fd({width:o,height:c,renderer:new u0,devicePixelRatio:t,container:l,background:this.extends.config.background});await u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),f=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);h.translate([d[0]-f.x,d[1]-f.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const p=this.getCamera(),g=u.getCamera();if(r==="viewport")g.setZoom(p.getZoom()),g.setPosition(p.getPosition()),g.setFocalPoint(p.getFocalPoint());else if(r==="overall"){const[m,y,b]=g.getPosition(),[w,x,S]=g.getFocalPoint();g.setPosition([m+a,y+s,b]),g.setFocalPoint([w+a,x+s,S])}const v=u.getContextService();return new Promise(m=>{u.addEventListener(yn.RERENDER,async()=>{await new Promise(b=>setTimeout(b,300));const y=await v.toDataURL(i);m(y)})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}};function gR(n){return Object.fromEntries(b9.map(e=>{const t=(n==null?void 0:n(e))||new u0;return e==="main"?t.registerPlugin(new y9({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):t.unregisterPlugin(t.getPlugin("dom-interaction")),[e,t]}))}function vR(n){Object.entries(n).forEach(([e,t])=>{const r=t.getContextService().getDomElement();r.style.position="absolute",r.style.outline="none",r.tabIndex=1,e!=="main"&&(r.style.pointerEvents="none")})}function oa(n,e){const{data:t,style:r,...i}=n,{data:a,style:s,...o}=e,c={...i,...o};return(t||a)&&Object.assign(c,{data:{...t,...a}}),(r||s)&&Object.assign(c,{style:{...r,...s}}),c}function UE(n){const{data:e,style:t,...r}=n,i=r;return e&&(i.data={...e}),t&&(i.style={...t}),i}function YE(n){const{id:e=Z(n),style:t,data:r,...i}=n,a={...n,style:{...t},data:{...r}};return EU(n)?{id:e,data:a,...i}:{id:e,data:a}}function rn(n){return n.data}function kdt(n){if(n.hasTreeStructure(Ca))return;n.attachTreeStructure(Ca);const e=n.getAllEdges();for(const t of e){const{source:r,target:i}=t;n.setParent(i,r,Ca)}}let Ddt=class{constructor(){A(this,"model");A(this,"latestRemovedComboIds",new Set);A(this,"comboIds",new Set);A(this,"changes",[]);A(this,"batchCount",0);A(this,"isTraceless",!1);A(this,"enableUpdateNodeLikeHierarchy",!0);this.model=new qe}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===Se.NodeUpdated||t===Se.EdgeUpdated||t===Se.ComboUpdated){const{value:r,original:i}=e;this.changes.push({value:UE(r),original:UE(i),type:t})}else this.changes.push({value:UE(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=rn(r);return this.isCombo(Z(i))||(e===void 0||e.includes(Z(i)))&&t.push(i),t},[])}getEdgeDatum(e){return rn(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,r)=>{const i=rn(r);return(e===void 0||e.includes(Z(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=rn(r);return this.isCombo(Z(i))&&(e===void 0||e.includes(Z(i)))&&t.push(i),t},[])}getAncestorsData(e,t){const{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getAncestors(e,t).map(rn)}getDescendantsData(e){const t=this.getElementDataById(e),r=[];return Ro(t,i=>{i!==t&&r.push(i)},i=>this.getChildrenData(Z(i)),"TB"),r}getParentData(e,t){const{model:r}=this;if(!t){Qi.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(e)||!r.hasTreeStructure(t))return;const i=r.getParent(e,t);return i?rn(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?Ca:Oe,{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getChildren(e,t).map(rn)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return rn(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=rn(r);return e?e.includes(Z(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)==null?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))==null?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(rn)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(rn)}setData(e){const{nodes:t=[],edges:r=[],combos:i=[]}=e,{nodes:a,edges:s,combos:o}=this.getData(),c=No(a,t,h=>Z(h)),l=No(s,r,h=>Z(h)),u=No(o,i,h=>Z(h));this.batch(()=>{this.addData({nodes:c.enter,edges:l.enter,combos:u.enter}),this.updateData({nodes:c.update,edges:l.update,combos:u.update}),this.removeData({nodes:c.exit.map(Z),edges:l.exit.map(Z),combos:u.exit.map(Z)})})}addData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(r)})}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:Se.NodeAdded}),YE(t)))),this.updateNodeLikeHierarchy(e))}addEdgeData(e=[]){e.length&&this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:Se.EdgeAdded}),YE(t))))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(Oe)||t.attachTreeStructure(Oe),t.addNodes(e.map(r=>(this.comboIds.add(Z(r)),this.pushChange({value:r,type:Se.ComboAdded}),YE(r)))),this.updateNodeLikeHierarchy(e)}addChildrenData(e,t){const r=this.getNodeLikeDatum(e),i=t.map(Z);this.addNodeData(t),this.updateNodeData([{id:e,children:[...r.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(r=>{const i=Z(r);t.attachTreeStructure(Oe),this.setParent(i,Tv(r),Oe);const a=r.children;if(a!==void 0){t.attachTreeStructure(Ca);const s=a.filter(o=>t.hasNode(o));s.forEach(o=>this.setParent(o,i,Ca)),s.length!==a.length&&this.updateNodeData([{id:i,children:s}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(r)})}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const r=[];e.forEach(i=>{const a=Z(i),s=rn(t.getNode(a));if(ve(s,i))return;const o=oa(s,i);this.pushChange({value:o,original:s,type:Se.NodeUpdated}),t.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)})}refreshData(){const{nodes:e,edges:t,combos:r}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:Se.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:Se.EdgeUpdated})}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Se.ComboUpdated})})}syncNodeDatum(e){const{model:t}=this,r=Z(e),i=rn(t.getNode(r)),a=oa(i,e);t.mergeNodeData(r,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(r=>{const i=Z(r),a=rn(t.getEdge(i));if(ve(a,r))return;r.source&&a.source!==r.source&&t.updateEdgeSource(i,r.source),r.target&&a.target!==r.target&&t.updateEdgeTarget(i,r.target);const s=oa(a,r);this.pushChange({value:s,original:a,type:Se.EdgeUpdated}),t.mergeEdgeData(i,s)})})}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const r=[];e.forEach(i=>{const a=Z(i),s=rn(t.getNode(a));if(ve(s,i))return;const o=oa(s,i);this.pushChange({value:o,original:s,type:Se.ComboUpdated}),t.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)})}setParent(e,t,r,i=!0){if(e===t)return;const a=Tv(this.getNodeLikeDatum(e));if(a!==t&&r===Oe){const s={id:e,combo:t};this.isCombo(e)?this.syncComboDatum(s):this.syncNodeDatum(s)}this.model.setParent(e,t,r),i&&r===Oe&&T2([a,t]).forEach(s=>{s!==void 0&&this.refreshComboData(s)})}refreshComboData(e){const t=this.getComboData([e])[0],r=this.getAncestorsData(e,Oe);t&&this.pushChange({value:t,original:t,type:Se.ComboUpdated}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Se.ComboUpdated})})}syncComboDatum(e){const{model:t}=this,r=Z(e);if(!t.hasNode(r))return;const i=rn(t.getNode(r)),a=oa(i,e);t.mergeNodeData(r,a)}getElementPosition(e){const t=this.getElementDataById(e);return hi(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const r=this.getElementPosition(e),i=qt(r,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[r=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:r,y:i,z:a}}])})}translateComboBy(e,t){const[r=0,i=0,a=0]=t;if([r,i,a].some(isNaN)||[r,i,a].every(o=>o===0))return;const s=this.getComboData([e])[0];s&&Ro(s,o=>{const c=Z(o),[l,u,h]=hi(o),f=oa(o,{style:{x:l+r,y:u+i,z:h+a}});this.pushChange({value:f,original:o,type:this.isCombo(c)?Se.ComboUpdated:Se.NodeUpdated}),this.model.mergeNodeData(c,f)},o=>this.getChildrenData(Z(o)),"BT")}translateComboTo(e,t){var d;if(t.some(isNaN))return;const[r=0,i=0,a=0]=t,s=(d=this.getComboData([e]))==null?void 0:d[0];if(!s)return;const[o,c,l]=hi(s),u=r-o,h=i-c,f=a-l;Ro(s,p=>{const g=Z(p),[v,m,y]=hi(p),b=oa(p,{style:{x:v+u,y:m+h,z:y+f}});this.pushChange({value:b,original:p,type:this.isCombo(g)?Se.ComboUpdated:Se.NodeUpdated}),this.model.mergeNodeData(g,b)},p=>this.getChildrenData(Z(p)),"BT")}removeData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(Z)),this.pushChange({value:this.getNodeData([t])[0],type:Se.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Se.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Se.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(Oe)){const t=Tv(this.getNodeLikeDatum(e));this.setParent(e,void 0,Oe,!1),this.model.getChildren(e,Oe).forEach(r=>{const i=rn(r),a=Z(i);this.setParent(Z(i),t,Oe,!1);const s=oa(i,{id:Z(i),combo:t});this.pushChange({value:s,original:i,type:this.isCombo(a)?Se.ComboUpdated:Se.NodeUpdated}),this.model.mergeNodeData(Z(i),s)}),mt(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(ya(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),r=e.getAllEdges();e.removeEdges(r.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}};class Ldt{constructor(e){A(this,"context");A(this,"container");A(this,"elementMap",{});A(this,"shapeTypeMap",{});A(this,"paletteStyle",{});A(this,"defaultStyle",{});A(this,"stateStyle",{});this.context=e}init(){if(!this.container){const{canvas:e}=this.context;this.container=e.appendChild(new Ze)}}emit(e,t){t.silence||on(this.context.graph,e)}forEachElementData(e){Ts.forEach(t=>{const r=this.context.model.getElementsDataByType(t);e(t,r)})}getElementType(e,t){var s;const{options:r,graph:i}=this.context,a=((s=r[e])==null?void 0:s.type)||t.type;return a?typeof a=="string"?a:a.call(i,t):e==="edge"?"line":"circle"}getTheme(e){return yI(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:r={}}=this.getTheme(e);return Object.assign({},...t.map(i=>r[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,r)=>{var a,s;const i=Object.assign({},OO((a=this.getTheme(t))==null?void 0:a.palette),OO((s=e[t])==null?void 0:s.palette));i!=null&&i.field&&Object.assign(this.paletteStyle,WU(r,i))})}getPaletteStyle(e,t){const r=this.paletteStyle[t];return r?e==="edge"?{stroke:r}:{fill:r}:{}}computeElementDefaultStyle(e,t){var a;const{options:r}=this.context,i=((a=r[e])==null?void 0:a.style)||{};this.defaultStyle[Z(t.datum)]=_O(i,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];(e===void 0||e.includes(Z(o)))&&this.computeElementDefaultStyle(r,{datum:o,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch{return[]}}getElementStateStyle(e,t,r){var s,o;const{options:i}=this.context,a=((o=(s=i[e])==null?void 0:s.state)==null?void 0:o[t])||{};return _O(a,r)}computeElementStatesStyle(e,t,r){this.stateStyle[Z(r.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,r)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];if(e===void 0||e.includes(Z(o))){const c=this.getElementState(Z(o));this.computeElementStatesStyle(r,c,{datum:o,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getElementZIndex(e){const t=this.getElement(e);return t?t.style.zIndex??0:0}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[Z(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const r=Z(t),i=this.getThemeStyle(e),a=this.getPaletteStyle(e,r),s=t.style||{},o=this.getDefaultStyle(r),c=this.getThemeStateStyle(e,this.getElementState(r)),l=this.getStateStyle(r),u=Object.assign({},i,a,s,o,c,l);if(e==="combo"){const h=this.context.model.getChildrenData(r),d=!!u.collapsed?[]:h.map(Z).filter(p=>this.getElement(p));Object.assign(u,{childrenNode:d,childrenData:h})}return u}draw(e={animation:!0}){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{dataChanges:r,drawData:i}=t;this.markDestroyElement(i),this.computeStyle(e.stage);const{add:a,update:s,remove:o}=i;this.destroyElements(o,e),this.createElements(a,e),this.updateElements(s,e);const{animation:c,silence:l}=e;return this.context.animation.animate(c,l?{}:{before:()=>this.emit(new Je(dt.BEFORE_DRAW,{dataChanges:r,animation:c}),e),beforeAnimate:u=>this.emit(new Er(dt.BEFORE_ANIMATE,Bn.DRAW,u,i),e),afterAnimate:u=>this.emit(new Er(dt.AFTER_ANIMATE,Bn.DRAW,u,i),e),after:()=>this.emit(new Je(dt.AFTER_DRAW,{dataChanges:r,animation:c}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,r=t.getChanges(),i=i_(r);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:c=[],EdgeUpdated:l=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:f=[],ComboRemoved:d=[]}=sh(i,m=>m.type),p=m=>new Map(m.map(y=>{const b=y.value;return[Z(b),b]})),g={add:{nodes:p(a),edges:p(c),combos:p(h)},update:{nodes:p(s),edges:p(l),combos:p(f)},remove:{nodes:p(o),edges:p(u),combos:p(d)}},v=this.transformData(g,e);return t.clearChanges(),{dataChanges:r,drawData:v}}transformData(e,t){const r=this.context.transform.getTransformInstance();return Object.values(r).reduce((i,a)=>a.beforeDraw(i,t),e)}createElement(e,t,r){var h;const i=Z(t);if(this.getElement(i))return;const s=this.getElementType(e,t),o=this.getElementComputedStyle(e,t),c=$a(e,s);if(!c)return Qi.warn(`The element ${s} of ${e} is not registered.`);this.emit(new oo(dt.BEFORE_ELEMENT_CREATE,e,t),r);const l=this.container.appendChild(new c({id:i,style:{context:this.context,...o}}));this.shapeTypeMap[i]=s,this.elementMap[i]=l;const{stage:u="enter"}=r;(h=this.context.animation)==null||h.add({element:l,elementType:e,stage:u,originalStyle:{...l.attributes},modifiedStyle:{...l.attributes,...o}},{after:()=>{var f;this.emit(new oo(dt.AFTER_ELEMENT_CREATE,e,t),r),(f=l.onCreate)==null||f.call(l)}})}createElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([o,c])=>{c.forEach(l=>this.createElement(o,l,t))})}updateElement(e,t,r){var u;const i=Z(t),a=this.getElement(i);if(!a)return()=>null;this.emit(new oo(dt.BEFORE_ELEMENT_UPDATE,e,t),r);const s=this.getElementType(e,t),o=this.getElementComputedStyle(e,t);this.shapeTypeMap[i]!==s&&(a.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(e,t,{animation:!1,silence:!0}));const{stage:c="update"}=r,l=c!=="visibility"?c:o.visibility==="hidden"?"hide":"show";(u=this.context.animation)==null||u.add({element:a,elementType:e,stage:l,originalStyle:{...a.attributes},modifiedStyle:{...a.attributes,...o}},{before:()=>{const h=this.elementMap[i];c!=="collapse"&&uu(h,o),c==="visibility"&&(iS(h,"opacity")||rS(h,"opacity"),tw(h,"visibility",l==="show"?"visible":"hidden"),l==="show"&&uu(h,{visibility:"visible"}))},after:()=>{var f;const h=this.elementMap[i];c==="collapse"&&uu(h,o),l==="hide"&&uu(h,{visibility:Yo(h,"visibility")}),this.emit(new oo(dt.AFTER_ELEMENT_UPDATE,e,t),r),(f=h.onUpdate)==null||f.call(h)}})}updateElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([o,c])=>{c.forEach(l=>this.updateElement(o,l,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(r=>{const i=Z(r),a=this.getElement(i);a&&jY(a)})})}destroyElement(e,t,r){var o;const{stage:i="exit"}=r,a=Z(t),s=this.elementMap[a];if(!s)return()=>null;this.emit(new oo(dt.BEFORE_ELEMENT_DESTROY,e,t),r),(o=this.context.animation)==null||o.add({element:s,elementType:e,stage:i,originalStyle:{...s.attributes},modifiedStyle:{...s.attributes}},{after:()=>{var c;this.clearElement(a),s.destroy(),(c=s.onDestroy)==null||c.call(s),this.emit(new oo(dt.AFTER_ELEMENT_DESTROY,e,t),r)}})}destroyElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["combo",a],["edge",i],["node",r]].forEach(([o,c])=>{c.forEach(l=>this.destroyElement(o,l,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}async collapseNode(e,t){var f;const{model:r,layout:i}=this.context,a=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(a.drawData);const s=await i.simulate();r.updateData(s);const{drawData:o}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{add:c,remove:l,update:u}=o;this.markDestroyElement(o);const h={animation:t,stage:"collapse",data:o};this.destroyElements(l,h),this.createElements(c,h),this.updateElements(u,h),await((f=this.context.animation.animate(t,{beforeAnimate:d=>this.emit(new Er(dt.BEFORE_ANIMATE,Bn.COLLAPSE,d,o),h),afterAnimate:d=>this.emit(new Er(dt.AFTER_ANIMATE,Bn.COLLAPSE,d,o),h)},{collapse:{target:e,descendants:Array.from(l.nodes).map(([,d])=>Z(d)),position:hi(u.nodes.get(e))}}))==null?void 0:f.finished)}async expandNode(e,t){var h;const{model:r,layout:i}=this.context;if(!r.getAncestorsData(e,Oe).every(f=>nr(f)))return;const a=hi(r.getNodeData([e])[0]),{drawData:{add:s}}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.createElements(s,{animation:!1,stage:"expand"}),this.context.animation.clear();const o=await i.simulate();r.updateData(o),this.computeStyle("expand");const{drawData:c}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{update:l}=c,u={animation:t,stage:"expand",data:c};s.edges.forEach(f=>{const d=Z(f);l.edges.has(d)||l.edges.set(d,f)}),this.updateElements(l,u),await((h=this.context.animation.animate(t,{beforeAnimate:f=>this.emit(new Er(dt.BEFORE_ANIMATE,Bn.EXPAND,f,c),u),afterAnimate:f=>this.emit(new Er(dt.AFTER_ANIMATE,Bn.EXPAND,f,c),u)},{expand:{target:e,descendants:Array.from(s.nodes).map(([,f])=>Z(f)),position:a}}))==null?void 0:h.finished)}async collapseCombo(e,t){var d;const{model:r,element:i}=this.context;if(r.getAncestorsData(e,Oe).some(p=>nr(p)))return;const a=i.getElement(e),s=a.getComboPosition({...a.attributes,collapsed:!0}),{dataChanges:o,drawData:c}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(c);const{update:l,remove:u}=c,h={animation:t,stage:"collapse",data:c};this.destroyElements(u,h),this.updateElements(l,h);const f=p=>Array.from(p).map(([,g])=>Z(g));await((d=this.context.animation.animate(t,{before:()=>this.emit(new Je(dt.BEFORE_DRAW,{dataChanges:o,animation:t}),h),beforeAnimate:p=>this.emit(new Er(dt.BEFORE_ANIMATE,Bn.COLLAPSE,p,c),h),afterAnimate:p=>this.emit(new Er(dt.AFTER_ANIMATE,Bn.COLLAPSE,p,c),h),after:()=>this.emit(new Je(dt.AFTER_DRAW,{dataChanges:o,animation:t}),h)},{collapse:{target:e,descendants:[...f(u.nodes),...f(u.combos)],position:s}}))==null?void 0:d.finished)}async expandCombo(e,t){var h;const{model:r}=this.context,i=hi(r.getComboData([e])[0]);this.computeStyle("expand");const{dataChanges:a,drawData:s}=this.computeChangesAndDrawData({stage:"expand",animation:t}),{add:o,update:c}=s,l={animation:t,stage:"expand",data:s};this.createElements(o,l),this.updateElements(c,l);const u=f=>Array.from(f).map(([,d])=>Z(d));await((h=this.context.animation.animate(t,{before:()=>this.emit(new Je(dt.BEFORE_DRAW,{dataChanges:a,animation:t}),l),beforeAnimate:f=>this.emit(new Er(dt.BEFORE_ANIMATE,Bn.EXPAND,f,s),l),afterAnimate:f=>this.emit(new Er(dt.AFTER_ANIMATE,Bn.EXPAND,f,s),l),after:()=>this.emit(new Je(dt.AFTER_DRAW,{dataChanges:a,animation:t}),l)},{expand:{target:e,descendants:[...u(o.nodes),...u(o.combos)],position:i}}))==null?void 0:h.finished)}getFrontZIndex(e){const{model:t}=this.context,r=t.getElementType(e),i=t.getElementDataById(e),a=t.getData();if(Object.assign(a,{[`${r}s`]:a[`${r}s`].filter(s=>Z(s)!==e)}),r==="combo"&&!nr(i)){const s=t.getAncestorsData(e,Oe).map(Z);a.nodes=a.nodes.filter(o=>!s.includes(Z(o))),a.combos=a.combos.filter(o=>!s.includes(Z(o))),a.edges=a.edges.filter(({source:o,target:c})=>s.includes(o)&&s.includes(c))}return Math.max(0,...Object.values(a).flat().map(s=>{const o=Z(s);return this.getElementZIndex(o)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}class Idt{constructor(e){A(this,"context");A(this,"supervisor");A(this,"instance");A(this,"instances",[]);A(this,"animationResult");this.context=e}get presetOptions(){return{animation:!!bI(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}getLayoutInstance(){return this.instances}async layout(){if(!this.options)return;const e=Array.isArray(this.options)?this.options:[this.options],{graph:t}=this.context;on(t,new Je(dt.BEFORE_LAYOUT));for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r),s={...this.presetOptions,...r};on(t,new Je(dt.BEFORE_STAGE_LAYOUT,{options:s,index:i}));const o=await this.stepLayout(a,s,i);on(t,new Je(dt.AFTER_STAGE_LAYOUT,{options:s,index:i})),r.animation||this.updateElementPosition(o,!1)}on(t,new Je(dt.AFTER_LAYOUT))}async simulate(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r);t=await this.stepLayout(a,{...this.presetOptions,...r,animation:!1},i)}return t}async stepLayout(e,t,r){return HY(t)?await this.treeLayout(e,t,r):await this.graphLayout(e,t,r)}async graphLayout(e,t,r){const{animation:i,enableWorker:a,iterations:s=300}=t,o=this.initGraphLayout(t);if(!o)return{};if(this.instances[r]=o,this.instance=o,a){const l=o;return this.supervisor=new _B(l.graphData2LayoutModel(e),l.instance,{iterations:s}),sd(await this.supervisor.execute())}if(Iw(o))return i?await o.execute(e,{onTick:l=>{this.updateElementPosition(l,!1)}}):(o.execute(e),o.stop(),o.tick(s));const c=await o.execute(e);return i&&this.updateElementPosition(c,i),c}async treeLayout(e,t,r){const{type:i,animation:a}=t,s=$a("layout",i);if(!s)return{};const{nodes:o=[],edges:c=[]}=e,l=new qe({nodes:o.map(f=>({id:Z(f),data:f.data||{}})),edges:c.map(f=>({id:Z(f),source:f.source,target:f.target,data:f.data||{}}))});kdt(l);const u={nodes:[],edges:[]};return l.getRoots(Ca).forEach(f=>{Ro(f,p=>{p.children=l.getSuccessors(p.id)},p=>l.getSuccessors(p.id),"TB");const d=s(f,t);Ro(d,p=>{const{id:g,x:v,y:m,z:y=0}=p;u.nodes.push({id:g,style:{x:v,y:m,z:y}})},p=>p.children,"TB")}),a&&this.updateElementPosition(u,a),u}stopLayout(){this.instance&&Iw(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0}=e,{nodes:r,edges:i,combos:a}=this.context.model.getData(),s=u=>this.context.element.getElement(u),o=r.filter(u=>{const h=Z(u),f=s(h);return!f||ZI(f)?!1:t(u)}),c=new Map(o.map(u=>[Z(u),u])),l=i.filter(u=>{const{source:h,target:f}=u;return!(!c.has(h)||!c.has(f))});return{nodes:o,edges:l,combos:a}}initGraphLayout(e){const{element:t,viewport:r}=this.context,{type:i,enableWorker:a,animation:s,iterations:o,...c}=e,[l,u]=r.getCanvasSize(),h=[l/2,u/2],f=(e==null?void 0:e.nodeSize)??(m=>{const y=t==null?void 0:t.getElement(m.id),{size:b}=(y==null?void 0:y.attributes)||{};return Math.max(...Vi(b))}),d=$a("layout",i);if(!d)return Qi.warn(`The layout of ${i} is not registered.`);const p=Object.getPrototypeOf(d.prototype)===t5.prototype?d:UY(d,this.context),g=new p(this.context),v={nodeSize:f,width:l,height:u,center:h};switch(g.id){case"d3-force":case"d3-force-3d":Object.assign(v,{center:{x:l/2,y:u/2,z:0}});break}return Le(g.options,v,c),g}updateElementPosition(e,t){const{model:r,element:i}=this.context;return i?(r.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)==null||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}class Bdt extends Q2{constructor(t){super(t);A(this,"category","plugin");this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){return this.extensionMap[t]}}const Wf=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class Fdt extends Q2{constructor(t){super(t);A(this,"category","transform");this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...Wf.slice(0,Wf.length-1),...t,Wf[Wf.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}class $dt{constructor(e){A(this,"context");A(this,"landmarkCounter",0);A(this,"transformResolver");this.context=e;const[t,r]=this.paddingOffset,{zoom:i,rotation:a,x:s=t,y:o=r}=e.options;this.transform({mode:"absolute",scale:i,translate:[s,o],rotate:a},!1)}get padding(){return ph(this.context.options.padding)}get paddingOffset(){const[e,t,r,i]=this.padding,[a,s,o]=[(i-t)/2,(e-r)/2,0];return[a,s,o]}get camera(){return this.context.canvas.getCamera()}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=bI(this.context.options,e);return t?Os({...t},["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t,r]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t/2,r/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:r,translate:i=[]}=e,a=this.getZoom(),s=t.getPosition(),o=t.getFocalPoint(),[c,l]=this.getCanvasCenter(),[u=0,h=0,f=0]=i,d=$u([-u,-h,-f],a);return r==="relative"?{position:qt(s,d),focalPoint:qt(o,d)}:{position:qt([c,l,s[2]],d),focalPoint:qt([c,l,o[2]],d)}}getRotateOptions(e){const{mode:t,rotate:r=0}=e;return{roll:t==="relative"?this.camera.getRoll()+r:r}}getZoomOptions(e){const{zoomRange:t}=this.context.options,r=this.camera.getZoom(),{mode:i,scale:a=1}=e;return oe(i==="relative"?r*a:a,...t)}async transform(e,t){const{graph:r}=this.context,{translate:i,rotate:a,scale:s,origin:o}=e;this.cancelAnimation();const c=this.getAnimation(t);if(on(r,new Vf(dt.BEFORE_TRANSFORM,e)),!a&&s&&!i&&o&&!c){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),o),on(r,new Vf(dt.AFTER_TRANSFORM,e));return}const l={};if(i&&Object.assign(l,this.getTranslateOptions(e)),rt(a)&&Object.assign(l,this.getRotateOptions(e)),rt(s)&&Object.assign(l,{zoom:this.getZoomOptions(e)}),c)return on(r,new Er(dt.BEFORE_ANIMATE,Bn.TRANSFORM,null,e)),new Promise(u=>{this.transformResolver=u,this.camera.gotoLandmark(this.createLandmark(l),{...c,onfinish:()=>{on(r,new Er(dt.AFTER_ANIMATE,Bn.TRANSFORM,null,e)),on(r,new Vf(dt.AFTER_TRANSFORM,e)),this.transformResolver=void 0,u()}})});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),on(r,new Vf(dt.AFTER_TRANSFORM,e))}async fitView(e,t){const[r,i,a,s]=this.padding,{when:o="always",direction:c="both"}=e||{},[l,u]=this.context.canvas.getSize(),h=l-s-i,f=u-r-a,d=this.context.canvas.getBounds(),p=this.getBBoxInViewport(d),[g,v]=Ls(p),m=c==="x"&&g>=h||c==="y"&&v>=f||c==="both"&&g>=h&&v>=f;if(o==="overflow"&&!m)return await this.fitCenter(t);const y=h/g,b=f/v,w=c==="x"?y:c==="y"?b:Math.min(y,b),x=this.getAnimation(t);await this.transform({mode:"relative",scale:w,translate:qt(We(this.getCanvasCenter(),this.getBBoxInViewport(d).center),$u(this.paddingOffset,w))},x)}async fitCenter(e){const t=this.context.canvas.getBounds();await this.focus(t,e)}async focusElements(e,t){const{element:r}=this.context;if(!r)return;const i=gh(e.map(a=>r.getElement(a).getRenderBounds()));await this.focus(i,t)}async focus(e,t){const r=this.context.graph.getViewportByCanvas(e.center),i=this.getCanvasCenter(),a=We(i,r);await this.transform({mode:"relative",translate:qt(a,this.paddingOffset)},t)}getBBoxInViewport(e){const{min:t,max:r}=e,{graph:i}=this.context,[a,s]=i.getViewportByCanvas(t),[o,c]=i.getViewportByCanvas(r),l=new ue;return l.setMinMax([a,s,0],[o,c,0]),l}cancelAnimation(){var e,t;(e=this.camera.landmarks)!=null&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)==null||t.call(this)}}const ng=class ng extends yh{constructor(t){super();A(this,"options");A(this,"destroyed",!1);A(this,"context",{model:new Ddt});A(this,"isCollapsingExpanding",!1);A(this,"onResize",ch(()=>{this.resize()},300));this.options=Object.assign({},ng.defaultOptions,t),this.setOptions(this.options),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}getOptions(){return this.options}setOptions(t){const{behaviors:r,combo:i,data:a,edge:s,height:o,layout:c,node:l,plugins:u,theme:h,transforms:f,width:d,renderer:p}=t;if(p){const g=this.context.canvas;g&&(this.emit(dt.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),g.setRenderer(p),this.emit(dt.AFTER_RENDERER_CHANGE,{renderer:p}))}Object.assign(this.options,t),r&&this.setBehaviors(r),i&&this.setCombo(i),a&&this.setData(a),s&&this.setEdge(s),c&&this.setLayout(c),l&&this.setNode(l),h&&this.setTheme(h),u&&this.setPlugins(u),f&&this.setTransforms(f),(rt(d)||rt(o))&&this.setSize(d??this.options.width??0,o??this.options.height??0)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,r){var i;Object.assign(this.options,{width:t,height:r}),(i=this.context.canvas)==null||i.resize(t,r)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=ft(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=ft(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var r;this.options.behaviors=ft(t)?t(this.getBehaviors()):t,(r=this.context.behavior)==null||r.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(r=>r.map(i=>typeof i=="object"&&i.key===t.key?{...i,...t}:i))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var r;this.options.plugins=ft(t)?t(this.getPlugins()):t,(r=this.context.plugin)==null||r.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(r=>r.map(i=>typeof i=="object"&&i.key===t.key?{...i,...t}:i))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var r;this.options.transforms=ft(t)?t(this.getTransforms()):t,(r=this.context.transform)==null||r.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(r=>r.map(i=>typeof i=="object"&&i.key===t.key?{...i,...t}:i)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(r=>this.context.model.getElementDataById(r)):this.context.model.getElementDataById(t)}getNodeData(t){var r;return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):(r=this.context.model.getNodeData([t]))==null?void 0:r[0]}getEdgeData(t){var r;return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):(r=this.context.model.getEdgeData([t]))==null?void 0:r[0]}getComboData(t){var r;return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):(r=this.context.model.getComboData([t]))==null?void 0:r[0]}setData(t){this.context.model.setData(ft(t)?t(this.getData()):t)}addData(t){this.context.model.addData(ft(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(ft(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(ft(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(ft(t)?t(this.getComboData()):t)}addChildrenData(t,r){this.context.model.addChildrenData(t,r)}updateData(t){this.context.model.updateData(ft(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(ft(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(ft(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(ft(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(ft(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(ft(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(ft(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(ft(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,r="both"){return this.context.model.getRelatedEdgesData(t,r)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,r){return this.context.model.getAncestorsData(t,r)}getParentData(t,r){return this.context.model.getParentData(t,r)}getChildrenData(t){return this.context.model.getChildrenData(t)}getElementDataByState(t,r){return this.context.model.getElementDataByState(t,r)}async initCanvas(){if(this.context.canvas)return await this.context.canvas.ready;const{container:t="container",width:r,height:i,renderer:a,background:s}=this.options;if(t instanceof pR)this.context.canvas=t,await t.ready;else{const o=At(t)?document.getElementById(t):t,c=SN(o);this.emit(dt.BEFORE_CANVAS_INIT,{container:o,width:r,height:i});const l=new pR({container:o,width:r||c[0],height:i||c[1],background:s,renderer:a});this.context.canvas=l,await l.ready,this.emit(dt.AFTER_CANVAS_INIT,{canvas:l})}}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new Tdt(this.context)),this.context.plugin||(this.context.plugin=new Bdt(this.context)),this.context.viewport||(this.context.viewport=new $dt(this.context)),this.context.transform||(this.context.transform=new Fdt(this.context)),this.context.element||(this.context.element=new Ldt(this.context)),this.context.animation||(this.context.animation=new Mdt(this.context)),this.context.layout||(this.context.layout=new Idt(this.context)),this.context.behavior||(this.context.behavior=new Adt(this.context))}async prepare(){if(await Promise.resolve(),this.destroyed)throw new Error(ya("The graph instance has been destroyed"));await this.initCanvas(),this.initRuntime()}async render(){await this.prepare(),on(this,new Je(dt.BEFORE_RENDER));const t=this.context.element.draw();await Promise.all([t==null?void 0:t.finished,this.context.layout.layout()]),await this.autoFit(),on(this,new Je(dt.AFTER_RENDER))}async draw(){var t;await this.prepare(),await((t=this.context.element.draw())==null?void 0:t.finished)}async layout(){await this.context.layout.layout()}stopLayout(){this.context.layout.stopLayout()}async clear(){this.context.model.setData({}),await this.draw()}destroy(){on(this,new Je(dt.BEFORE_DESTROY));const{layout:t,animation:r,element:i,model:a,canvas:s,behavior:o,plugin:c}=this.context;c==null||c.destroy(),o==null||o.destroy(),t==null||t.destroy(),r==null||r.destroy(),i==null||i.destroy(),a.destroy(),s==null||s.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,on(this,new Je(dt.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,r){const i=!t||!r?SN(this.context.canvas.getContainer()):[t,r];ve(i,this.getSize())||(on(this,new Je(dt.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),on(this,new Je(dt.AFTER_SIZE_CHANGE,{size:i})))}async fitView(t,r){var i;await((i=this.context.viewport)==null?void 0:i.fitView(t,r))}async fitCenter(t){var r;await((r=this.context.viewport)==null?void 0:r.fitCenter(t))}async autoFit(){const{autoFit:t}=this.context.options;if(t)if(At(t))t==="view"?await this.fitView():t==="center"&&await this.fitCenter();else{const{type:r,animation:i}=t;r==="view"?await this.fitView(t.options,i):r==="center"&&await this.fitCenter(i)}}async focusElement(t,r){var i;await((i=this.context.viewport)==null?void 0:i.focusElements(Array.isArray(t)?t:[t],r))}async zoomBy(t,r,i){await this.context.viewport.transform({mode:"relative",scale:t,origin:i},r)}async zoomTo(t,r,i){this.context.viewport.transform({mode:"absolute",scale:t,origin:i},r)}getZoom(){return this.context.viewport.getZoom()}async rotateBy(t,r,i){await this.context.viewport.transform({mode:"relative",rotate:t,origin:i},r)}async rotateTo(t,r,i){await this.context.viewport.transform({mode:"absolute",rotate:t,origin:i},r)}getRotation(){return this.context.viewport.getRotation()}async translateBy(t,r){await this.context.viewport.transform({mode:"relative",translate:t},r)}async translateTo(t,r){await this.context.viewport.transform({mode:"absolute",translate:t},r)}getPosition(){return We([0,0],this.getCanvasByViewport([0,0]))}async translateElementBy(t,r,i=!0){var o;const[a,s]=ne(t)?[t,r??!0]:[{[t]:r},i];Object.entries(a).forEach(([c,l])=>this.context.model.translateNodeLikeBy(c,l)),await((o=this.context.element.draw({animation:s,stage:"translate"}))==null?void 0:o.finished)}async translateElementTo(t,r,i=!0){var o;const[a,s]=ne(t)?[t,r??!0]:[{[t]:r},i];Object.entries(a).forEach(([c,l])=>this.context.model.translateNodeLikeTo(c,l)),await((o=this.context.element.draw({animation:s,stage:"translate"}))==null?void 0:o.finished)}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return lg(this.context.element.getElement(t).attributes,["context"])}async setElementVisibility(t,r,i=!0){var u;const[a,s]=ne(t)?[t,r??!0]:[{[t]:r},i],o={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([h,f])=>{const d=this.getElementType(h);o[`${d}s`].push({id:h,style:{visibility:f}})});const{model:c,element:l}=this.context;c.preventUpdateNodeLikeHierarchy(()=>{c.updateData(o)}),await((u=l.draw({animation:s,stage:"visibility"}))==null?void 0:u.finished)}async showElement(t,r){const i=Array.isArray(t)?t:[t];await this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"visible"])),r)}async hideElement(t,r){const i=Array.isArray(t)?t:[t];await this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"hidden"])),r)}getElementVisibility(t){var i;const r=this.context.element.getElement(t);return((i=r==null?void 0:r.style)==null?void 0:i.visibility)??"visible"}async setElementZIndex(t,r){var c;const i={nodes:[],edges:[],combos:[]},a=ne(t)?t:{[t]:r};Object.entries(a).forEach(([l,u])=>{const h=this.getElementType(l);i[`${h}s`].push({id:l,style:{zIndex:u}})});const{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(i)),await((c=o.draw({animation:!1,stage:"zIndex"}))==null?void 0:c.finished)}async frontElement(t){const r=Array.isArray(t)?t:[t],{model:i,element:a}=this.context,s={};r.map(o=>{const c=a.getFrontZIndex(o);if(i.getElementType(o)==="combo"){const u=i.getAncestorsData(o,Oe).at(-1)||this.getComboData(o),h=[u,...i.getDescendantsData(Z(u))],f=c-a.getElementZIndex(o);h.forEach(d=>{s[Z(d)]=this.getElementZIndex(Z(d))+f})}else s[o]=c}),await this.setElementZIndex(s)}getElementZIndex(t){var a,s;const{model:r,element:i}=this.context;return((s=(a=r.getElementDataById(t))==null?void 0:a.style)==null?void 0:s.zIndex)??i.getElementZIndex(t)}async setElementState(t,r,i=!0){var l;const[a,s]=ne(t)?[t,r??!0]:[{[t]:r},i],o=u=>u?Array.isArray(u)?u:[u]:[],c={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([u,h])=>{const f=this.getElementType(u);c[`${f}s`].push({id:u,states:o(h)})}),this.updateData(c),await((l=this.context.element.draw({animation:s}))==null?void 0:l.finished)}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}async collapseElement(t,r=!0){const{model:i,element:a}=this.context;if(nr(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const s=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),s==="node"?await a.collapseNode(t,r):s==="combo"&&await a.collapseCombo(t,r),this.isCollapsingExpanding=!1}async expandElement(t,r=!0){const{model:i,element:a}=this.context;if(!nr(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const s=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),s==="node"?await a.expandNode(t,r):s==="combo"&&await a.expandCombo(t,r),this.isCollapsingExpanding=!1}setElementCollapsibility(t,r){const i=this.getElementType(t);i==="node"?this.updateNodeData([{id:t,style:{collapsed:r}}]):i==="combo"&&this.updateComboData([{id:t,style:{collapsed:r}}])}async toDataURL(t={}){return this.context.canvas.toDataURL(t)}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,r,i){return super.on(t,r,i)}once(t,r){return super.once(t,r)}off(t,r){return super.off(t,r)}};A(ng,"defaultOptions",{autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]});let v2=ng;class zdt extends wc{beforeDraw(e){const{add:t,update:r}=e,{model:i}=this.context;return[...t.edges.entries(),...r.edges.entries()].forEach(([,a])=>{E9(i,a)}),e}}const E9=(n,e)=>{const{source:t,target:r}=e,i=n.getElementDataById(t),a=n.getElementDataById(r),s=AO(i,h=>n.getParentData(h,Oe)),o=AO(a,h=>n.getParentData(h,Oe)),c=Z(s),l=Z(o),u={sourceNode:c,targetNode:l};return e.style?Object.assign(e.style,u):e.style=u,e},jdt="quadratic",mR=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"],rg=class rg extends wc{constructor(t,r){super(t,Object.assign({},rg.defaultOptions,r));A(this,"cacheMergeStyle",new Map);A(this,"getAffectedParallelEdges",t=>{const{add:{edges:r},update:{nodes:i,edges:a,combos:s},remove:{edges:o}}=t,{model:c}=this.context,l=new Map,u=(d,p)=>{c.getRelatedEdgesData(p).forEach(v=>!l.has(Z(v))&&l.set(Z(v),v))};i.forEach(u),s.forEach(u);const h=d=>{const p=c.getEdgeData().map(v=>E9(c,v));qdt(d,p).forEach(v=>!l.has(Z(v))&&l.set(Z(v),v))};if(o.size&&o.forEach(h),r.size&&r.forEach(h),a.size){const d=kB(i_(c.getChanges())).update.edges;a.forEach(p=>{var v;h(p);const g=(v=d.find(m=>Z(m.value)===Z(p)))==null?void 0:v.original;g&&!P_(p,g)&&h(g)})}cg(this.options.edges)||l.forEach((d,p)=>!this.options.edges.includes(p)&&l.delete(p));const f=c.getEdgeData().map(Z);return new Map([...l].sort((d,p)=>f.indexOf(d[0])-f.indexOf(p[0])))});A(this,"applyBundlingStyle",(t,r,i)=>{const{edgeMap:a,reverses:s}=yR(r);a.forEach(o=>{o.forEach((c,l,u)=>{var p;const f=Object.assign(c,{type:jdt,style:(()=>{const g=u.length,v={};if(c.source===c.target){const m=mR.length;v.loopPlacement=mR[l%m],v.loopDist=Math.floor(l/m)*i+50}else if(g===1)v.curveOffset=0;else{const m=(l%2===0?1:-1)*(s[`${c.source}|${c.target}|${l}`]?-1:1);v.curveOffset=g%2===1?m*Math.ceil(l/2)*i*2:m*(Math.floor(l/2)*i*2+i)}return Object.assign({},c.style,v)})()});((p=this.context.element)==null?void 0:p.getElement(Z(c)))?Dc(t,"update","edge",f,!0):Dc(t,"add","edge",f,!0)})})});A(this,"resetEdgeStyle",t=>{const r=t.style||{},i=this.cacheMergeStyle.get(Z(t))||{};return Object.keys(i).forEach(a=>{ve(r[a],i[a])&&(t[a]?r[a]=t[a]:delete r[a])}),Object.assign(t,{style:r})});A(this,"applyMergingStyle",(t,r)=>{const{edgeMap:i,reverses:a}=yR(r);i.forEach(s=>{var c;if(s.length===1){const l=s[0],u=(c=this.context.element)==null?void 0:c.getElement(Z(l));Dc(t,u?"update":"add","edge",this.resetEdgeStyle(l),!0);return}const o=s.map(({source:l,target:u,style:h={}},f)=>{const{startArrow:d,endArrow:p}=h,g={},[v,m]=a[`${l}|${u}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return Ru(d)&&(g[v]=d),Ru(p)&&(g[m]=p),g}).reduce((l,u)=>({...l,...u}),{});s.forEach((l,u,h)=>{var f;if(u===0){const d=Object.assign({},ft(this.options.style)?this.options.style(h):this.options.style,{childrenData:h});this.cacheMergeStyle.set(Z(l),d);const p={...l,type:"line",style:{...o,...d}},g=(f=this.context.element)==null?void 0:f.getElement(Z(l));Dc(t,g?"update":"add","edge",p,!0)}else Dc(t,"remove","edge",l)})})})}beforeDraw(t){const r=this.getAffectedParallelEdges(t);return r.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,r,this.options.distance):this.applyMergingStyle(t,r)),t}};A(rg,"defaultOptions",{mode:"bundle",edges:void 0,distance:15});let m2=rg;const yR=n=>{const e=new Map,t=new Set,r={};for(const[i,a]of n){if(t.has(i))continue;const{source:s,target:o}=a,c=`${s}-${o}`;e.has(c)||e.set(c,[]),e.get(c).push(a),t.add(i);for(const[l,u]of n)t.has(l)||P_(a,u)&&(e.get(c).push(u),t.add(l),s===u.target&&o===u.source&&(r[`${u.source}|${u.target}|${e.get(c).length-1}`]=!0))}return{edgeMap:e,reverses:r}},qdt=(n,e,t)=>e.filter(r=>P_(r,n)),P_=(n,e)=>{const{sourceNode:t,targetNode:r}=n.style||{},{sourceNode:i,targetNode:a}=e.style||{};return t===i&&r===a||t===a&&r===i};class Gdt extends wc{beforeDraw(e,t){const{stage:r}=t;if(r==="visibility")return e;const{model:i}=this.context,{update:{nodes:a,edges:s,combos:o}}=e,c=(l,u)=>{i.getRelatedEdgesData(u).forEach(f=>!s.has(Z(f))&&s.set(Z(f),f))};return a.forEach(c),o.forEach(c),e}}const Vdt={animation:{"combo-collapse":SI,"combo-expand":yU,"node-collapse":xI,"node-expand":vU,"path-in":wI,"path-out":mU,fade:pU,translate:gU},behavior:{"brush-select":qd,"click-select":Qx,"collapse-expand":fw,"create-edge":dw,"drag-canvas":pw,"drag-element-force":YY,"drag-element":Yd,"fix-element-size":vw,"focus-element":mw,"hover-activate":yw,"lasso-select":KY,"optimize-viewport-transform":bw,"scroll-canvas":Ew,"zoom-canvas":xw},combo:{circle:sY,rect:oY},edge:{cubic:qu,line:AY,polyline:lw,quadratic:uw,"cubic-horizontal":ow,"cubic-vertical":cw},layout:{"antv-dagre":gS,"combo-combined":wS,"compact-box":du.compactBox,"force-atlas2":KS,circular:vS,concentric:Wu,"d3-force":Dg,dagre:Ec,dendrogram:du.dendrogram,force:Mg,fruchterman:XS,grid:ZS,indented:du.indented,mds:Rg,mindmap:du.mindmap,radial:QS,random:JS},node:{circle:jI,diamond:ZU,ellipse:nw,hexagon:eY,html:rw,image:nY,rect:rY,star:iY,donut:ew,triangle:iw},palette:{spectral:hot,tableau:fot,oranges:dot,greens:pot,blues:got},theme:{dark:xdt,light:Sdt},plugin:{"bubble-sets":jw,"grid-line":Vw,background:$w,contextmenu:qw,fullscreen:Gw,history:Ww,hull:Uw,legend:u2,timebar:f2,toolbar:d2,tooltip:p2,watermark:g2},transform:{"update-related-edges":Gdt,"arrange-draw-order":_dt,"collapse-expand-combo":Odt,"collapse-expand-node":Pdt,"process-parallel-edges":m2,"get-edge-actual-ends":zdt}},y2={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{}};function C_(n,e,t,r=!1){const i=y2[n][e];!r&&i?i!==t&&Qi.warn(`The extension ${e} of ${n} has been registered before.`):Object.assign(y2[n],{[e]:t})}function $a(n,e){var r;const t=(r=y2[n])==null?void 0:r[e];if(t)return t}function Wdt(){Object.entries(Vdt).forEach(([n,e])=>{Object.entries(e).forEach(([t,r])=>{C_(n,t,r)})})}K.enableCSSParsing=!1;Wdt();var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.computeElementCallbackStyle=Udt;var Hdt=Ne.mergeOptions=Ydt;Ne.getSubShapeStyle=Kdt;function Udt(n,e){const{datum:t,graph:r}=e;return typeof n=="function"?n.call(r,t):Object.fromEntries(Object.entries(n).map(([i,a])=>typeof a=="function"?[i,a.call(r,t)]:[i,a]))}function Ydt(n,e){const t=(n==null?void 0:n.style)||{},r=(e==null?void 0:e.style)||{};return Object.assign({},n,e,{style:Object.assign({},t,r)})}function Kdt(n){const{x:e,y:t,z:r,class:i,className:a,transform:s,transformOrigin:o,context:c,zIndex:l,...u}=n;return u}var wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.ELEMENT_TYPES=x9=wn.ICON_SIZE_RATIO=void 0;var x9=wn.ICON_SIZE_RATIO=.8;wn.ELEMENT_TYPES=["node","edge","combo"];function Xdt(n){return n.max[0]-n.min[0]}function Zdt(n){return n.max[1]-n.min[1]}function Qdt(n,e){return n.map((t,r)=>t-e[r])}function Jdt(n,e){const t=e.center,r=Qdt(n,e.center),i=Math.atan2(r[1],r[0]);if(isNaN(i))return t;const a=Xdt(e)/2,s=Zdt(e)/2,o=t[0]+a*Math.cos(i),c=t[1]+s*Math.sin(i);return[o,c]}var ae={};const bt=Zr(oG);var KE={},XE={},zc={};const Pe=Zr(sU);var Ft={},ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.DEFAULT_ELEMENTS_ANIMATION_OPTIONS=ec.DEFAULT_ANIMATION_OPTIONS=void 0;ec.DEFAULT_ANIMATION_OPTIONS={duration:500};ec.DEFAULT_ELEMENTS_ANIMATION_OPTIONS={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.ChangeType=nc.ChangeEvent=void 0;nc.ChangeEvent={CHANGE:"change"};var bR;(function(n){n.NodeAdded="NodeAdded",n.NodeUpdated="NodeUpdated",n.NodeRemoved="NodeRemoved",n.EdgeAdded="EdgeAdded",n.EdgeUpdated="EdgeUpdated",n.EdgeRemoved="EdgeRemoved",n.ComboAdded="ComboAdded",n.ComboUpdated="ComboUpdated",n.ComboRemoved="ComboRemoved"})(bR||(nc.ChangeType=bR={}));var w9={},f0={};Object.defineProperty(f0,"__esModule",{value:!0});f0.AnimationType=void 0;var ER;(function(n){n.DRAW="draw",n.COLLAPSE="collapse",n.EXPAND="expand",n.TRANSFORM="transform"})(ER||(f0.AnimationType=ER={}));var d0={};Object.defineProperty(d0,"__esModule",{value:!0});d0.CanvasEvent=void 0;var xR;(function(n){n.CLICK="canvas:click",n.DBLCLICK="canvas:dblclick",n.POINTER_OVER="canvas:canvas:pointerover",n.POINTER_LEAVE="canvas:pointerleave",n.POINTER_ENTER="canvas:pointerenter",n.POINTER_MOVE="canvas:pointermove",n.POINTER_OUT="canvas:pointerout",n.POINTER_DOWN="canvas:pointerdown",n.POINTER_UP="canvas:pointerup",n.CONTEXT_MENU="canvas:contextmenu",n.DRAG_START="canvas:dragstart",n.DRAG="canvas:drag",n.DRAG_END="canvas:dragend",n.DRAG_ENTER="canvas:dragenter",n.DRAG_OVER="canvas:dragover",n.DRAG_LEAVE="canvas:dragleave",n.DROP="canvas:drop",n.WHEEL="canvas:wheel"})(xR||(d0.CanvasEvent=xR={}));var p0={};Object.defineProperty(p0,"__esModule",{value:!0});p0.ComboEvent=void 0;var wR;(function(n){n.CLICK="combo:click",n.DBLCLICK="combo:dblclick",n.POINTER_OVER="combo:pointerover",n.POINTER_LEAVE="combo:pointerleave",n.POINTER_ENTER="combo:pointerenter",n.POINTER_MOVE="combo:pointermove",n.POINTER_OUT="combo:pointerout",n.POINTER_DOWN="combo:pointerdown",n.POINTER_UP="combo:pointerup",n.CONTEXT_MENU="combo:contextmenu",n.DRAG_START="combo:dragstart",n.DRAG="combo:drag",n.DRAG_END="combo:dragend",n.DRAG_ENTER="combo:dragenter",n.DRAG_OVER="combo:dragover",n.DRAG_LEAVE="combo:dragleave",n.DROP="combo:drop"})(wR||(p0.ComboEvent=wR={}));var g0={};Object.defineProperty(g0,"__esModule",{value:!0});g0.CommonEvent=void 0;var SR;(function(n){n.CLICK="click",n.DBLCLICK="dblclick",n.POINTER_OVER="pointerover",n.POINTER_LEAVE="pointerleave",n.POINTER_ENTER="pointerenter",n.POINTER_MOVE="pointermove",n.POINTER_OUT="pointerout",n.POINTER_DOWN="pointerdown",n.POINTER_UP="pointerup",n.CONTEXT_MENU="contextmenu",n.DRAG_START="dragstart",n.DRAG="drag",n.DRAG_END="dragend",n.DRAG_ENTER="dragenter",n.DRAG_OVER="dragover",n.DRAG_LEAVE="dragleave",n.DROP="drop",n.KEY_DOWN="keydown",n.KEY_UP="keyup",n.WHEEL="wheel"})(SR||(g0.CommonEvent=SR={}));var v0={};Object.defineProperty(v0,"__esModule",{value:!0});v0.ContainerEvent=void 0;var _R;(function(n){n.KEY_DOWN="keydown",n.KEY_UP="keyup"})(_R||(v0.ContainerEvent=_R={}));var m0={};Object.defineProperty(m0,"__esModule",{value:!0});m0.EdgeEvent=void 0;var OR;(function(n){n.CLICK="edge:click",n.DBLCLICK="edge:dblclick",n.POINTER_OVER="edge:pointerover",n.POINTER_LEAVE="edge:pointerleave",n.POINTER_ENTER="edge:pointerenter",n.POINTER_MOVE="edge:pointermove",n.POINTER_OUT="edge:pointerout",n.POINTER_DOWN="edge:pointerdown",n.POINTER_UP="edge:pointerup",n.CONTEXT_MENU="edge:contextmenu",n.DRAG_ENTER="edge:dragenter",n.DRAG_OVER="edge:dragover",n.DRAG_LEAVE="edge:dragleave",n.DROP="edge:drop"})(OR||(m0.EdgeEvent=OR={}));var y0={};Object.defineProperty(y0,"__esModule",{value:!0});y0.GraphEvent=void 0;var PR;(function(n){n.BEFORE_CANVAS_INIT="beforecanvasinit",n.AFTER_CANVAS_INIT="aftercanvasinit",n.BEFORE_SIZE_CHANGE="beforesizechange",n.AFTER_SIZE_CHANGE="aftersizechange",n.BEFORE_ELEMENT_CREATE="beforeelementcreate",n.AFTER_ELEMENT_CREATE="afterelementcreate",n.BEFORE_ELEMENT_UPDATE="beforeelementupdate",n.AFTER_ELEMENT_UPDATE="afterelementupdate",n.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",n.AFTER_ELEMENT_DESTROY="afterelementdestroy",n.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",n.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",n.BEFORE_DRAW="beforedraw",n.AFTER_DRAW="afterdraw",n.BEFORE_RENDER="beforerender",n.AFTER_RENDER="afterrender",n.BEFORE_ANIMATE="beforeanimate",n.AFTER_ANIMATE="afteranimate",n.BEFORE_LAYOUT="beforelayout",n.AFTER_LAYOUT="afterlayout",n.BEFORE_STAGE_LAYOUT="beforestagelayout",n.AFTER_STAGE_LAYOUT="afterstagelayout",n.BEFORE_TRANSFORM="beforetransform",n.AFTER_TRANSFORM="aftertransform",n.BATCH_START="batchstart",n.BATCH_END="batchend",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.BEFORE_RENDERER_CHANGE="beforerendererchange",n.AFTER_RENDERER_CHANGE="afterrendererchange"})(PR||(y0.GraphEvent=PR={}));var Th={};Object.defineProperty(Th,"__esModule",{value:!0});Th.HistoryEvent=void 0;var CR;(function(n){n.UNDO="undo",n.REDO="redo",n.CANCEL="cancel",n.ADD="add",n.CLEAR="clear",n.CHANGE="change"})(CR||(Th.HistoryEvent=CR={}));var b0={};Object.defineProperty(b0,"__esModule",{value:!0});b0.NodeEvent=void 0;var MR;(function(n){n.CLICK="node:click",n.DBLCLICK="node:dblclick",n.POINTER_OVER="node:pointerover",n.POINTER_LEAVE="node:pointerleave",n.POINTER_ENTER="node:pointerenter",n.POINTER_MOVE="node:pointermove",n.POINTER_OUT="node:pointerout",n.POINTER_DOWN="node:pointerdown",n.POINTER_UP="node:pointerup",n.CONTEXT_MENU="node:contextmenu",n.DRAG_START="node:dragstart",n.DRAG="node:drag",n.DRAG_END="node:dragend",n.DRAG_ENTER="node:dragenter",n.DRAG_OVER="node:dragover",n.DRAG_LEAVE="node:dragleave",n.DROP="node:drop"})(MR||(b0.NodeEvent=MR={}));(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.NodeEvent=n.HistoryEvent=n.GraphEvent=n.EdgeEvent=n.ContainerEvent=n.CommonEvent=n.ComboEvent=n.CanvasEvent=n.AnimationType=void 0;var e=f0;Object.defineProperty(n,"AnimationType",{enumerable:!0,get:function(){return e.AnimationType}});var t=d0;Object.defineProperty(n,"CanvasEvent",{enumerable:!0,get:function(){return t.CanvasEvent}});var r=p0;Object.defineProperty(n,"ComboEvent",{enumerable:!0,get:function(){return r.ComboEvent}});var i=g0;Object.defineProperty(n,"CommonEvent",{enumerable:!0,get:function(){return i.CommonEvent}});var a=v0;Object.defineProperty(n,"ContainerEvent",{enumerable:!0,get:function(){return a.ContainerEvent}});var s=m0;Object.defineProperty(n,"EdgeEvent",{enumerable:!0,get:function(){return s.EdgeEvent}});var o=y0;Object.defineProperty(n,"GraphEvent",{enumerable:!0,get:function(){return o.GraphEvent}});var c=Th;Object.defineProperty(n,"HistoryEvent",{enumerable:!0,get:function(){return c.HistoryEvent}});var l=b0;Object.defineProperty(n,"NodeEvent",{enumerable:!0,get:function(){return l.NodeEvent}})})(w9);var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.TREE_KEY=rc.COMBO_KEY=void 0;rc.COMBO_KEY="combo";rc.TREE_KEY="tree";var E0={};Object.defineProperty(E0,"__esModule",{value:!0});E0.ExtensionCategory=void 0;var TR;(function(n){n.NODE="node",n.EDGE="edge",n.COMBO="combo",n.THEME="theme",n.PALETTE="palette",n.LAYOUT="layout",n.BEHAVIOR="behavior",n.PLUGIN="plugin",n.ANIMATION="animation",n.TRANSFORM="transform"})(TR||(E0.ExtensionCategory=TR={}));(function(n){var e=jt&&jt.__createBinding||(Object.create?function(r,i,a,s){s===void 0&&(s=a);var o=Object.getOwnPropertyDescriptor(i,a);(!o||("get"in o?!i.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(r,s,o)}:function(r,i,a,s){s===void 0&&(s=a),r[s]=i[a]}),t=jt&&jt.__exportStar||function(r,i){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,r,a)};Object.defineProperty(n,"__esModule",{value:!0}),t(ec,n),t(nc,n),t(w9,n),t(rc,n),t(E0,n)})(Ft);var de={},na={};Object.defineProperty(na,"__esModule",{value:!0});na.isEdgeData=tpt;na.isVector2=ept;na.isVector3=npt;na.isPoint=rpt;function tpt(n){return"source"in n&&"target"in n}function ept(n){return n.length===2}function npt(n){return n.length===3}function rpt(n){return n instanceof Float32Array?!0:Array.isArray(n)&&(n.length===2||n.length===3)?n.every(e=>typeof e=="number"):!1}var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.isBetween=ipt;function ipt(n,e,t){return n>=e&&n<=t}var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.parsePadding=apt;function apt(n=0){if(Array.isArray(n)){const[e=0,t=e,r=e,i=t]=n;return[e,t,r,i]}return[n,n,n,n]}Object.defineProperty(de,"__esModule",{value:!0});de.getBBoxWidth=S9;de.getBBoxHeight=_9;de.getBBoxSize=M_;de.getNodeBBox=lpt;de.getPointBBox=O9;de.getExpandedBBox=P9;de.getCombinedBBox=upt;de.isPointInBBox=T_;de.isPointOnBBoxBoundary=hpt;de.isPointOutsideBBox=fpt;de.getNearestSideToPoint=C9;de.getNearestPointToPoint=dpt;de.getTriangleCenter=ppt;de.getIncircleRadius=gpt;const pp=Pe,spt=bt,opt=na,ic=Sc,cpt=qs;function S9(n){return n.max[0]-n.min[0]}function _9(n){return n.max[1]-n.min[1]}function M_(n){return[S9(n),_9(n)]}function lpt(n,e){const t=(0,opt.isPoint)(n)?O9(n):n.getShape("key").getBounds();return e?P9(t,e):t}function O9(n){const[e,t,r=0]=n,i=new pp.AABB;return i.setMinMax([e,t,r],[e,t,r]),i}function P9(n,e){const[t,r,i,a]=(0,cpt.parsePadding)(e),[s,o,c]=n.min,[l,u,h]=n.max,f=new pp.AABB;return f.setMinMax([s-a,o-t,c],[l+r,u+i,h]),f}function upt(n){if(n.length===0)return new pp.AABB;if(n.length===1)return n[0];const e=new pp.AABB;e.setMinMax(n[0].min,n[0].max);for(let t=1;t<n.length;t++){const r=n[t];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function T_(n,e){return(0,ic.isBetween)(n[0],e.min[0],e.max[0])&&(0,ic.isBetween)(n[1],e.min[1],e.max[1])}function hpt(n,e,t=!1){const{min:[r,i],max:[a,s]}=e,o=(n[1]===i||n[1]===s)&&(t||(0,ic.isBetween)(n[0],r,a)),c=(n[0]===r||n[0]===a)&&(t||(0,ic.isBetween)(n[1],i,s));return o||c}function fpt(n,e){return!T_(n,e)}function C9(n,e){const[t,r]=e,[i,a]=n.min,[s,o]=n.max,c=t-i,l=s-t,u=r-a,h=o-r,f=Math.min(c,l,u,h);return f===c?"left":f===l?"right":f===u?"top":f===h?"bottom":"left"}function dpt(n,e){const t=(0,spt.clone)(e);if(T_(e,n))switch(C9(n,e)){case"left":t[0]=n.min[0];break;case"right":t[0]=n.max[0];break;case"top":t[1]=n.min[1];break;case"bottom":t[1]=n.max[1];break}else{const[r,i]=e,[a,s]=n.min,[o,c]=n.max;t[0]=(0,ic.isBetween)(r,a,o)?r:r<a?a:o,t[1]=(0,ic.isBetween)(i,s,c)?i:i<s?s:c}return t}function ppt(n,e){const{center:t}=n,[r,i]=M_(n),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-r/6:t[0]+r/6,s=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,s]}function gpt(n,e){let[t,r]=M_(n);return[t,r]=e==="up"||e==="down"?[t,r]:[r,t],(r**2-(Math.sqrt((t/2)**2+r**2)-t/2)**2)/(2*r)}var Gt={},hr={},x0={};Object.defineProperty(x0,"__esModule",{value:!0});x0.version=void 0;x0.version="5.0.10";(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.print=void 0,n.format=r;const e=x0,t="G6";function r(i){return`[${t} v${e.version}] ${i}`}n.print={mute:!1,debug:i=>{!n.print.mute&&console.debug(r(i))},info:i=>{!n.print.mute&&console.info(r(i))},warn:i=>{!n.print.mute&&console.warn(r(i))},error:i=>{!n.print.mute&&console.error(r(i))}}})(hr);Object.defineProperty(Gt,"__esModule",{value:!0});Gt.idOf=pd;Gt.parentIdOf=mpt;Gt.idsOf=ypt;const vpt=hr;function pd(n){if(n.id!==void 0)return n.id;if(n.source!==void 0&&n.target!==void 0)return`${n.source}-${n.target}`;throw new Error((0,vpt.format)("The datum does not have available id."))}function mpt(n){return n.combo}function ypt(n,e){const t={nodes:(n.nodes||[]).map(pd),edges:(n.edges||[]).map(pd),combos:(n.combos||[]).map(pd)};return e?Object.values(t).flat():t}var Un={},A_={};Object.defineProperty(A_,"__esModule",{value:!0});A_.parseAnchor=bpt;const AR=Sc;function bpt(n){const e=typeof n=="string"?n.split(" ").map(t=>parseFloat(t)):n.slice(0,2);return!(0,AR.isBetween)(e[0],0,1)||!(0,AR.isBetween)(e[1],0,1)?[.5,.5]:e}var N_={};Object.defineProperty(N_,"__esModule",{value:!0});N_.parsePlacement=Ept;const NR=Sc;function Ept(n){if(Array.isArray(n))return(0,NR.isBetween)(n[0],0,1)&&(0,NR.isBetween)(n[1],0,1)?n:[.5,.5];const e=n.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,r=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,r]}Object.defineProperty(Un,"__esModule",{value:!0});Un.getPositionByRectPoints=void 0;Un.positionOf=Spt;Un.getXYByRelativePlacement=R_;Un.getXYByPlacement=_pt;Un.getXYByAnchor=Opt;const xpt=A_,wpt=N_;function Spt(n){const{x:e=0,y:t=0,z:r=0}=n.style||{};return[+e,+t,+r]}function R_(n,e){const[t,r]=e,{min:i,max:a}=n;return[i[0]+t*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function _pt(n,e="center"){const t=(0,wpt.parsePlacement)(e);return R_(n,t)}function Opt(n,e){const t=(0,xpt.parseAnchor)(e);return R_(n,t)}const Ppt=n=>{const[e,t]=n;return{left:Math.min(e[0],t[0]),right:Math.max(e[0],t[0]),top:Math.min(e[1],t[1]),bottom:Math.max(e[1],t[1])}};Un.getPositionByRectPoints=Ppt;var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.startsWith=w0;Ie.addPrefix=k_;Ie.removePrefix=D_;Ie.subStyleProps=Cpt;Ie.subObject=Mpt;Ie.omitStyleProps=Tpt;Ie.replacePrefix=Apt;const M9=bt;function w0(n,e){if(!n.startsWith(e))return!1;const t=n[e.length];return t>="A"&&t<="Z"}function k_(n,e){return`${e}${(0,M9.upperFirst)(n)}`}function D_(n,e,t=!0){if(!e||!w0(n,e))return n;const r=n.slice(e.length);return t?(0,M9.lowerFirst)(r):r}function Cpt(n,e){const t=Object.entries(n).reduce((r,[i,a])=>(i==="className"||i==="class"||w0(i,e)&&Object.assign(r,{[D_(i,e)]:a}),r),{});if("opacity"in n){const r=k_("opacity",e),i=n.opacity;if(r in n){const a=n[r];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function Mpt(n,e){const t=e.length;return Object.keys(n).reduce((r,i)=>{if(i.startsWith(e)){const a=i.slice(t);r[a]=n[i]}return r},{})}function Tpt(n,e){const t=typeof e=="string"?[e]:e,r={};return Object.keys(n).forEach(i=>{t.find(a=>i.startsWith(a))||(r[i]=n[i])}),r}function Apt(n,e,t){return Object.entries(n).reduce((r,[i,a])=>(w0(i,e)?r[k_(D_(i,e,!1),t)]=a:r[i]=a,r),{})}var Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.parseSize=Npt;function Npt(n=0){if(typeof n=="number")return[n,n,n];const[e,t=e,r=e]=n;return[e,t,r]}var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.add=kpt;Kt.subtract=Dpt;Kt.multiply=T9;Kt.divide=Lpt;Kt.dot=Ipt;Kt.cross=Bpt;Kt.scale=Fpt;Kt.distance=b2;Kt.manhattanDistance=$pt;Kt.normalize=zpt;Kt.angle=jpt;Kt.exactEquals=qpt;Kt.perpendicular=Gpt;Kt.mod=Vpt;Kt.toVector2=Wpt;Kt.toVector3=E2;const Rpt=na,RR=[0,0,0];function kpt(n,e){return n.map((t,r)=>t+e[r])}function Dpt(n,e){return n.map((t,r)=>t-e[r])}function T9(n,e){return typeof e=="number"?n.map(t=>t*e):n.map((t,r)=>t*e[r])}function Lpt(n,e){return typeof e=="number"?n.map(t=>t/e):n.map((t,r)=>t/e[r])}function Ipt(n,e){return n.reduce((t,r,i)=>t+r*e[i],0)}function Bpt(n,e){const t=E2(n),r=E2(e);return[t[1]*r[2]-t[2]*r[1],t[2]*r[0]-t[0]*r[2],t[0]*r[1]-t[1]*r[0]]}function Fpt(n,e){return n.map(t=>t*e)}function b2(n,e){return Math.sqrt(n.reduce((t,r,i)=>t+(r-e[i]||0)**2,0))}function $pt(n,e){return n.reduce((t,r,i)=>t+Math.abs(r-e[i]),0)}function zpt(n){const e=n.reduce((t,r)=>t+r**2,0);return n.map(t=>t/Math.sqrt(e))}function jpt(n,e,t=!1){const r=n[0]*e[1]-n[1]*e[0];let i=Math.acos(T9(n,e).reduce((a,s)=>a+s,0)/(b2(n,RR)*b2(e,RR)));return t&&r<0&&(i=2*Math.PI-i),i}function qpt(n,e){return n.every((t,r)=>t===e[r])}function Gpt(n,e=!0){return e?[-n[1],n[0]]:[n[1],-n[0]]}function Vpt(n,e){return n.map(t=>t%e)}function Wpt(n){return[n[0],n[1]]}function E2(n){return(0,Rpt.isVector2)(n)?[n[0],n[1],0]:n}var Ah={},_i={};Object.defineProperty(_i,"__esModule",{value:!0});_i.cacheStyle=Hpt;_i.getCachedStyle=Upt;_i.hasCachedStyle=Ypt;_i.setCacheStyle=Kpt;const fs=bt,Do="cachedStyle",S0=n=>`__${n}__`;function Hpt(n,e){const t=Array.isArray(e)?e:[e];(0,fs.get)(n,Do)||(0,fs.set)(n,Do,{}),t.forEach(r=>{(0,fs.set)((0,fs.get)(n,Do),S0(r),n.attributes[r])})}function Upt(n,e){return(0,fs.get)(n,[Do,S0(e)])}function Ypt(n,e){return S0(e)in((0,fs.get)(n,Do)||{})}function Kpt(n,e,t){(0,fs.set)(n,[Do,S0(e)],t)}Object.defineProperty(Ah,"__esModule",{value:!0});Ah.effect=Xpt;const Hf=_i;function Xpt(n){return function(e,t,r){const i=r.value;return r.value=function(a,...s){const o=`${t}_invoke`;if(!(0,Hf.getCachedStyle)(this,o))return(0,Hf.setCacheStyle)(this,o,!0),i.call(this,a,...s);const c=`${t}_style`,l=(0,Hf.getCachedStyle)(this,c),u=n(this,a);return(0,Hf.setCacheStyle)(this,c,u),A9(l,u)?null:i.call(this,a,...s)},r}}const A9=(n,e,t=2)=>{if(typeof n!="object"||typeof e!="object")return n===e;const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r){const s=n[a],o=e[a];if(t>1&&typeof s=="object"&&typeof o=="object"){if(!A9(s,o,t-1))return!1}else if(s!==o)return!1}return!0};var ZE={},jc={},L_={};Object.defineProperty(L_,"__esModule",{value:!0});L_.inferIconStyle=Qpt;const Zpt=Si;function Qpt(n,e){const t=(0,Zpt.parseSize)(n);let r={};return e.text&&!e.fontSize&&(r={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(r={width:t[0]*.5,height:t[1]*.5}),r}var co={},ns={},qc={},QE={},Gc={},ca={},Uf={},kR;function N9(){if(kR)return Uf;kR=1,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.themeOf=r;const n=Ft,e=Ys(),t=hr;function r(i){const{theme:a}=i;if(!a)return{};const s=(0,e.getExtension)(n.ExtensionCategory.THEME,a);return s||(t.print.warn(`The theme of ${a} is not registered.`),{})}return Uf}var DR;function _c(){if(DR)return ca;DR=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.createAnimationsProxy=a,ca.preprocessKeyframes=s,ca.inferDefaultValue=o,ca.getAnimationOptions=c,ca.getElementAnimationOptions=u;const n=bt,e=Ft,t=Ys(),r=hr,i=N9();function a(h,f){if(Array.isArray(h)&&h.length===0)return null;const d=Array.isArray(h)?h[0]:h,p=Array.isArray(h)?h.slice(1):f||[];return new Proxy(d,{get(g,v){return typeof g[v]=="function"&&!["onframe","onfinish"].includes(v)?(...m)=>{g[v](...m),p.forEach(y=>{var b;return(b=y[v])==null?void 0:b.call(y,...m)})}:v==="finished"?Promise.all([d.finished,...p.map(m=>m.finished)]):Reflect.get(g,v)},set(g,v,m){return["onframe","onfinish"].includes(v)||p.forEach(y=>{y[v]=m}),Reflect.set(g,v,m)}})}function s(h){const f=h.reduce((p,g)=>(Object.entries(g).forEach(([v,m])=>{p[v]===void 0?p[v]=[m]:p[v].push(m)}),p),{});Object.entries(f).forEach(([p,g])=>{(g.length!==h.length||g.some(v=>(0,n.isNil)(v))||g.every(v=>!["sourceNode","targetNode","childrenNode"].includes(p)&&(0,n.isEqual)(v,g[0])))&&delete f[p]});const d=Object.entries(f).reduce((p,[g,v])=>(v.forEach((m,y)=>{p[y]?p[y][g]=m:p[y]={[g]:m}}),p),[]);return h.length!==0&&d.length===0&&d.push({_:0},{_:0}),d}function o(h){switch(h){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function c(h,f){const{animation:d}=h;if(d===!1||f===!1)return!1;const p={...e.DEFAULT_ANIMATION_OPTIONS};return(0,n.isObject)(d)&&Object.assign(p,d),(0,n.isObject)(f)&&Object.assign(p,f),p}function l(h){if(typeof h=="string"){const f=(0,t.getExtension)(e.ExtensionCategory.ANIMATION,h);return f||(r.print.warn(`The animation of ${h} is not registered.`),[])}return h}function u(h,f,d,p){var x,S;const{animation:g}=h,v=(x=h==null?void 0:h[f])==null?void 0:x.animation;if(v===!1)return[];const m=v==null?void 0:v[d];if(m===!1)return[];if(g===!1||p===!1)return[];const y=(S=(0,i.themeOf)(h)[f])==null?void 0:S.animation,b=(_=[])=>l(_).map(E=>({...e.DEFAULT_ELEMENTS_ANIMATION_OPTIONS,...(0,n.isObject)(g)&&g,...E,...(0,n.isObject)(p)&&p}));if(m)return b(m);if(!y)return[];const w=y[d];return w===!1?[]:b(w)}return ca}var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.reassignTo=void 0;Gs.replaceTranslateInTransform=egt;const Jpt=bt,tgt=Gt;function egt(n,e,t,r){const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${n}, ${e})${i}`:`translate3d(${n}, ${e}, ${t})${i}`}const ngt=(n,e,t,r,i=!1)=>{const a=(0,tgt.idOf)(r),s=`${t}s`,o=n.add[s].get(a)||n.update[s].get(a)||n.remove[s].get(a)||r;Object.entries(n).forEach(([c,l])=>{e===c?l[s].set(a,i?(0,Jpt.deepMix)(o,r):o):l[s].delete(a)})};Gs.reassignTo=ngt;var LR;function R9(){if(LR)return Gc;LR=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.executor=void 0;const n=bt,e=_c(),t=Gs,r=(i,a,s)=>{if(!s.length)return null;const[o,c]=a,l=d=>{var p;if(d){const g=i.getShape(d);if(!g)return null;const v=`get${(0,n.upperFirst)(d)}Style`,m=((p=i==null?void 0:i[v])==null?void 0:p.bind(i))||(w=>w),y=(m==null?void 0:m(o))||{},b=(m==null?void 0:m(c))||{};return{shape:g,fromStyle:y,toStyle:b}}else return{shape:i,fromStyle:o,toStyle:c}};let u;const h=s.map(({fields:d,shape:p,states:g,...v})=>{const m=l(p);if(!m)return null;const{shape:y,fromStyle:b,toStyle:w}=m,x=[{},{}];if(d.forEach(_=>{Object.assign(x[0],{[_]:b[_]??(0,e.inferDefaultValue)(_)}),Object.assign(x[1],{[_]:w[_]??(0,e.inferDefaultValue)(_)})}),x.some(_=>Object.keys(_).some(E=>["x","y","z"].includes(E)))){const{x:_=0,y:E=0,z:P=0,transform:O=""}=y.attributes||{};x.forEach(C=>{C.transform=(0,t.replaceTranslateInTransform)(C.x||_,C.y||E,C.z||P,O)})}const S=y.animate((0,e.preprocessKeyframes)(x),v);return p===void 0&&(u=S),S}).filter(Boolean),f=u||(h==null?void 0:h[0]);return f?(0,e.createAnimationsProxy)(f,h.filter(d=>d!==d)):null};return Gc.executor=r,Gc}var IR;function rgt(){return IR||(IR=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComboCollapseExpand=n.ComboExpand=n.ComboCollapse=n.PathOut=n.PathIn=n.NodeExpand=n.NodeCollapse=n.Translate=n.Fade=n.executor=void 0;var e=R9();Object.defineProperty(n,"executor",{enumerable:!0,get:function(){return e.executor}}),n.Fade=[{fields:["opacity"]}],n.Translate=[{fields:["x","y"]}],n.NodeCollapse=[{fields:["x","y"]}],n.NodeExpand=n.NodeCollapse,n.PathIn=[{fields:["sourceNode","targetNode"]}],n.PathOut=n.PathIn,n.ComboCollapse=[{fields:["childrenNode","x","y"]}],n.ComboExpand=n.ComboCollapse,n.ComboCollapseExpand=[{fields:["childrenNode","x","y"]}]}(QE)),QE}var JE={},Vc={},rs={},Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.arrayDiff=agt;const igt=bt;function agt(n,e,t){const r=new Map(n.map(h=>[t(h),h])),i=new Map(e.map(h=>[t(h),h])),a=new Set(r.keys()),s=new Set(i.keys()),o=[],c=[],l=[],u=[];return s.forEach(h=>{a.has(h)?(0,igt.isEqual)(r.get(h),i.get(h))?u.push(i.get(h)):c.push(i.get(h)):o.push(i.get(h))}),a.forEach(h=>{s.has(h)||l.push(r.get(h))}),{enter:o,exit:l,keep:u,update:c}}var I_={};Object.defineProperty(I_,"__esModule",{value:!0});I_.parseExtensions=sgt;function sgt(n,e,t){const r={},i=a=>(a in r||(r[a]=0),`${e}-${a}-${r[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(n):a.key?a:{...a,key:i(a.type)})}var BR;function Oc(){if(BR)return rs;BR=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.BaseExtension=rs.ExtensionController=void 0;const n=Ys(),e=Nh,t=I_,r=hr;class i{constructor(o){A(this,"context");A(this,"extensions",[]);A(this,"extensionMap",{});this.context=o}setExtensions(o){const c=(0,t.parseExtensions)(this.context.graph,this.category,o),{enter:l,update:u,exit:h,keep:f}=(0,e.arrayDiff)(this.extensions,c,d=>d.key);this.createExtensions(l),this.updateExtensions([...u,...f]),this.destroyExtensions(h),this.extensions=c}createExtension(o){const{category:c}=this,{key:l,type:u}=o,h=(0,n.getExtension)(c,u);if(!h)return r.print.warn(`The extension ${u} of ${c} is not registered.`);const f=new h(this.context,o);this.extensionMap[l]=f}createExtensions(o){o.forEach(c=>this.createExtension(c))}updateExtension(o){const{key:c}=o,l=this.extensionMap[c];l&&l.update(o)}updateExtensions(o){o.forEach(c=>this.updateExtension(c))}destroyExtension(o){const c=this.extensionMap[o];c&&(c.destroy(),delete this.extensionMap[o])}destroyExtensions(o){o.forEach(({key:c})=>this.destroyExtension(c))}destroy(){Object.values(this.extensionMap).forEach(o=>o.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}rs.ExtensionController=i;class a{constructor(o,c){A(this,"context");A(this,"options");A(this,"events",[]);A(this,"destroyed",!1);this.context=o,this.options=c}update(o){this.options=Object.assign(this.options,o)}destroy(){this.context={},this.options={},this.destroyed=!0}}return rs.BaseExtension=a,rs}var FR;function fr(){if(FR)return Vc;FR=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.BaseBehavior=void 0;const n=Oc();class e extends n.BaseExtension{}return Vc.BaseBehavior=e,Vc}var tx={},It={},Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.isLinesParallel=k9;Rh.getLinesIntersection=ogt;const $R=Sc,ex=Kt;function k9(n,e){const[t,r]=n,[i,a]=e,s=(0,ex.subtract)(t,r),o=(0,ex.subtract)(i,a);return(0,ex.cross)(s,o).every(c=>c===0)}function ogt(n,e,t=!1){if(k9(n,e))return;const[r,i]=n,[a,s]=e,o=((r[0]-a[0])*(a[1]-s[1])-(r[1]-a[1])*(a[0]-s[0]))/((r[0]-i[0])*(a[1]-s[1])-(r[1]-i[1])*(a[0]-s[0])),c=s[0]-a[0]?(r[0]-a[0]+o*(i[0]-r[0]))/(s[0]-a[0]):(r[1]-a[1]+o*(i[1]-r[1]))/(s[1]-a[1]);if(!(!t&&(!(0,$R.isBetween)(o,0,1)||!(0,$R.isBetween)(c,0,1))))return[r[0]+o*(i[0]-r[0]),r[1]+o*(i[1]-r[1])]}Object.defineProperty(It,"__esModule",{value:!0});It.parsePoint=cgt;It.toPointObject=lgt;It.sortByX=ugt;It.deduplicate=hgt;It.round=fgt;It.moveTo=dgt;It.isHorizontal=L9;It.isVertical=I9;It.isOrthogonal=pgt;It.isCollinear=ggt;It.getPolygonIntersectPoint=B9;It.isPointInPolygon=vgt;It.getRectIntersectPoint=mgt;It.getEllipseIntersectPoint=ygt;It.findNearestPoints=bgt;It.findNearestLine=Egt;It.getDistanceToLine=F9;It.findNearestPointOnLine=$9;It.centerOf=z9;It.sortByClockwise=xgt;It.getBoundingPoints=wgt;const zR=de,D9=Rh,Wc=Un,Cr=Kt;function cgt(n){return[n.x,n.y,n.z??0]}function lgt(n){return{x:n[0],y:n[1],z:n[2]??0}}function ugt(n){return n.sort((e,t)=>e[0]-t[0]||e[1]-t[1])}function hgt(n){const e=new Set;return n.filter(t=>{const r=t.join(",");return e.has(r)?!1:(e.add(r),!0)})}function fgt(n,e=0){return n.map(t=>parseFloat(t.toFixed(e)))}function dgt(n,e,t,r=!1){const i=r?(0,Cr.subtract)(n,e):(0,Cr.subtract)(e,n),a=(0,Cr.normalize)(i),s=[a[0]*t,a[1]*t];return(0,Cr.add)((0,Cr.toVector2)(n),s)}function L9(n,e){return n[1]===e[1]}function I9(n,e){return n[0]===e[0]}function pgt(n,e){return L9(n,e)||I9(n,e)}function ggt(n,e,t){return(0,D9.isLinesParallel)([n,e],[e,t])}function B9(n,e,t,r=!0){for(let i=0;i<t.length;i++){let a=t[i],s=t[(i+1)%t.length];r&&(a=(0,Cr.add)(e,a),s=(0,Cr.add)(e,s));const o=(0,D9.getLinesIntersection)([e,n],[a,s]);if(o)return{point:o,line:[a,s]}}return{point:e,line:void 0}}function vgt(n,e,t,r){const i=n[0],a=n[1];let s=!1;t===void 0&&(t=0),r===void 0&&(r=e.length);const o=r-t;for(let c=0,l=o-1;c<o;l=c++){const u=e[c+t][0],h=e[c+t][1],f=e[l+t][0],d=e[l+t][1];h>a!=d>a&&i<(f-u)*(a-h)/(d-h)+u&&(s=!s)}return s}function mgt(n,e){const t=(0,Wc.getXYByPlacement)(e,"center"),r=[(0,Wc.getXYByPlacement)(e,"left-top"),(0,Wc.getXYByPlacement)(e,"right-top"),(0,Wc.getXYByPlacement)(e,"right-bottom"),(0,Wc.getXYByPlacement)(e,"left-bottom")];return B9(n,t,r,!1).point}function ygt(n,e){const t=e.center,r=(0,Cr.subtract)(n,e.center),i=Math.atan2(r[1],r[0]);if(isNaN(i))return t;const a=(0,zR.getBBoxWidth)(e)/2,s=(0,zR.getBBoxHeight)(e)/2,o=t[0]+a*Math.cos(i),c=t[1]+s*Math.sin(i);return[o,c]}function bgt(n,e){let t=1/0,r=[n[0],e[0]];return n.forEach(i=>{e.forEach(a=>{const s=(0,Cr.distance)(i,a);s<t&&(t=s,r=[i,a])})}),r}function Egt(n,e){let t=1/0,r=[[0,0],[0,0]];return e.forEach(i=>{const a=F9(n,i);a<t&&(t=a,r=i)}),r}function F9(n,e){const t=$9(n,e);return(0,Cr.distance)(n,t)}function $9(n,e){const[t,r]=e[0],[i,a]=e[1],[s,o]=n,c=i-t,l=a-r;if(c===0&&l===0)return[t,r];let u=((s-t)*c+(o-r)*l)/(c*c+l*l);u>1?u=1:u<0&&(u=0);const h=t+u*c,f=r+u*l;return[h,f]}function z9(n){const e=n.reduce((t,r)=>(0,Cr.add)(t,r),[0,0]);return(0,Cr.divide)(e,n.length)}function xgt(n,e=!0){const t=z9(n);return n.sort(([r,i],[a,s])=>{const o=Math.atan2(i-t[1],r-t[0]),c=Math.atan2(s-t[1],a-t[0]);return e?c-o:o-c})}function wgt(n,e){return[n,[n[0],e[1]],e,[e[0],n[1]]]}var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.Shortcut=void 0;const gd=bt,oi=Ft,jR=n=>n.map(e=>(0,gd.isString)(e)?e.toLocaleLowerCase():e);class Sgt{constructor(e){A(this,"map",new Map);A(this,"emitter");A(this,"recordKey",new Set);A(this,"onKeyDown",e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))});A(this,"onKeyUp",e=>{e!=null&&e.key&&this.recordKey.delete(e.key)});A(this,"onWheel",e=>{this.triggerExtendKey(oi.CommonEvent.WHEEL,e)});A(this,"onDrag",e=>{this.triggerExtendKey(oi.CommonEvent.DRAG,e)});A(this,"onFocus",()=>{this.recordKey.clear()});this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&this.map.set(e,t)}unbind(e,t){this.map.forEach((r,i)=>{(0,gd.isEqual)(i,e)&&(!t||t===r)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=jR(Array.from(this.recordKey)).sort(),r=jR(e).sort();return(0,gd.isEqual)(t,r)}bindEvents(){const{emitter:e}=this;e.on(oi.CommonEvent.KEY_DOWN,this.onKeyDown),e.on(oi.CommonEvent.KEY_UP,this.onKeyUp),e.on(oi.CommonEvent.WHEEL,this.onWheel),e.on(oi.CommonEvent.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(e){this.map.forEach((t,r)=>{this.match(r)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((r,i)=>{i.includes(e)&&(0,gd.isEqual)(Array.from(this.recordKey),i.filter(a=>a!==e))&&r(t)})}destroy(){this.unbindAll(),this.emitter.off(oi.CommonEvent.KEY_DOWN,this.onKeyDown),this.emitter.off(oi.CommonEvent.KEY_UP,this.onKeyUp),this.emitter.off(oi.CommonEvent.WHEEL,this.onWheel),this.emitter.off(oi.CommonEvent.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}}Oi.Shortcut=Sgt;var qR;function j9(){return qR||(qR=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCursorPoint=n.BrushSelect=void 0;const e=Pe,t=bt,r=Ft,i=Gt,a=It,s=Oi,o=fr(),u=class u extends o.BaseBehavior{constructor(d,p){super(d,(0,t.deepMix)({},u.defaultOptions,p));A(this,"startPoint");A(this,"endPoint");A(this,"rectShape");A(this,"shortcut");this.shortcut=new s.Shortcut(d.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(d){if(!this.validate(d)||!this.isKeydown()||this.startPoint)return;const{canvas:p}=this.context;this.rectShape=new e.Rect({id:"g6-brush-select",style:this.options.style}),p.appendChild(this.rectShape),this.startPoint=[d.canvas.x,d.canvas.y]}onPointerMove(d){var v;if(!this.startPoint)return;const{immediately:p,mode:g}=this.options;this.endPoint=(0,n.getCursorPoint)(d),(v=this.rectShape)==null||v.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),p&&g==="default"&&this.updateElementsStates((0,a.getBoundingPoints)(this.startPoint,this.endPoint))}onPointerUp(d){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=(0,n.getCursorPoint)(d),this.updateElementsStates((0,a.getBoundingPoints)(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:d}=this.context,p=Object.values(d.getData()).reduce((g,v)=>Object.assign({},g,v.reduce((m,y)=>(m[(0,i.idOf)(y)]=[],m),{})),{});d.setElementState(p,this.options.animation)}updateElementsStates(d){const{graph:p}=this.context,{enableElements:g,state:v,mode:m,onSelect:y}=this.options,b=this.selector(p,d,g);let w={};switch(m){case"union":b.forEach(x=>{w[x]=[...p.getElementState(x),v]});break;case"diff":b.forEach(x=>{const S=p.getElementState(x);w[x]=S.includes(v)?S.filter(_=>_!==v):[...S,v]});break;case"intersect":b.forEach(x=>{const S=p.getElementState(x);w[x]=S.includes(v)?[v]:[]});break;case"default":default:b.forEach(x=>{w[x]=[v]});break}(0,t.isFunction)(y)&&(w=y(w)),p.setElementState(w,this.options.animation)}selector(d,p,g){if(!g||g.length===0)return[];const v=[],m=d.getData();if(g.forEach(y=>{m[`${y}s`].forEach(b=>{const w=(0,i.idOf)(b);d.getElementVisibility(w)!=="hidden"&&(0,a.isPointInPolygon)(d.getElementPosition(w),p)&&v.push(w)})}),g.includes("edge")){const y=m.edges;y==null||y.forEach(b=>{const{source:w,target:x}=b;v.includes(w)&&v.includes(x)&&v.push((0,i.idOf)(b))})}return v}clearBrush(){var d;(d=this.rectShape)==null||d.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:d}=this.options,p=Array.isArray(d)?d:[d];return!d||p.includes("drag")?!0:this.shortcut.match(p)}validate(d){if(this.destroyed)return!1;const{enable:p}=this.options;return(0,t.isFunction)(p)?p(d):!!p}bindEvents(){const{graph:d}=this.context;this.unbindEvents(),d.on(r.CommonEvent.POINTER_DOWN,this.onPointerDown),d.on(r.CommonEvent.POINTER_MOVE,this.onPointerMove),d.on(r.CommonEvent.POINTER_UP,this.onPointerUp),d.on(r.CanvasEvent.CLICK,this.clearStates)}unbindEvents(){const{graph:d}=this.context;d.off(r.CommonEvent.POINTER_DOWN,this.onPointerDown),d.off(r.CommonEvent.POINTER_MOVE,this.onPointerMove),d.off(r.CommonEvent.POINTER_UP,this.onPointerUp),d.off(r.CanvasEvent.CLICK,this.clearStates)}update(d){this.options=(0,t.deepMix)(this.options,d)}destroy(){this.unbindEvents(),super.destroy()}};A(u,"defaultOptions",{animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}});let c=u;n.BrushSelect=c;const l=h=>[h.canvas.x,h.canvas.y];n.getCursorPoint=l}(tx)),tx}var Hc={},kh={},Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.dfs=q9;Vs.bfs=_gt;function q9(n,e,t,r,i=0){r==="TB"&&e(n,i);const a=t(n);if(a)for(const s of a)q9(s,e,t,r,i+1);r==="BT"&&e(n,i)}function _gt(n,e,t){const r=[[n,0]];for(;r.length;){const[i,a]=r.shift();e(i,a);const s=t(i);if(s)for(const o of s)r.push([o,a+1])}}Object.defineProperty(kh,"__esModule",{value:!0});kh.getElementNthDegreeIds=Cgt;kh.getNodeNthDegreeIds=vd;const Ogt=Gt,Pgt=Vs;function Cgt(n,e,t,r){if(e==="combo"||e==="node")return vd(n,t,r);const i=n.getEdgeData(t);if(!i)return[];const a=vd(n,i.source,r-1),s=vd(n,i.target,r-1);return Array.from(new Set([...a,...s,t]))}function vd(n,e,t){const r=new Set,i=new Set,a=new Set;return(0,Pgt.bfs)(e,(s,o)=>{o>t||(a.add(s),n.getRelatedEdgesData(s).forEach(c=>{const l=(0,Ogt.idOf)(c);!i.has(l)&&o<t&&(a.add(l),i.add(l))}))},s=>n.getRelatedEdgesData(s).map(o=>o.source===s?o.target:o.source).filter(o=>r.has(o)?!1:(r.add(o),!0))),Array.from(a)}var B_={};Object.defineProperty(B_,"__esModule",{value:!0});B_.statesOf=Mgt;function Mgt(n){return n.states||[]}var GR;function Tgt(){if(GR)return Hc;GR=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.ClickSelect=void 0;const n=bt,e=Ft,t=wn,r=Gt,i=kh,a=Oi,s=B_,o=fr(),l=class l extends o.BaseBehavior{constructor(f,d){super(f,Object.assign({},l.defaultOptions,d));A(this,"shortcut");A(this,"onClickSelect",async f=>{var d,p;this.validate(f)&&(await this.updateState(f),(p=(d=this.options).onClick)==null||p.call(d,f))});A(this,"onClickCanvas",async f=>{var d,p;this.validate(f)&&(await this.clearState(),(p=(d=this.options).onClick)==null||p.call(d,f))});this.shortcut=new a.Shortcut(f.graph),this.bindEvents()}bindEvents(){const{graph:f}=this.context;this.unbindEvents(),t.ELEMENT_TYPES.forEach(d=>{f.on(`${d}:${e.CommonEvent.CLICK}`,this.onClickSelect)}),f.on(e.CanvasEvent.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:f,trigger:d}=this.options;return f&&this.shortcut.match(d)}getNeighborIds(f){const{target:d,targetType:p}=f,{graph:g}=this.context,{degree:v}=this.options;return(0,i.getElementNthDegreeIds)(g,p,d.id,typeof v=="function"?v(f):v).filter(m=>m!==d.id)}async updateState(f){const{state:d,unselectedState:p,neighborState:g,animation:v}=this.options;if(!d&&!g&&!p)return;const{target:m}=f,{graph:y}=this.context,b=y.getElementData(m.id),w=(0,s.statesOf)(b).includes(d)?"unselect":"select",x={},S=this.isMultipleSelect,_=[m.id],E=this.getNeighborIds(f);if(S)if(Object.assign(x,this.getDataStates()),w==="select"){const P=(O,C)=>{O.forEach(M=>{const T=y.getElementData(M),R=new Set((0,s.statesOf)(T));R.add(C),R.delete(p),x[M]=Array.from(R)})};P(_,d),P(E,g),p&&Object.keys(x).forEach(O=>{const C=x[O];!C.includes(d)&&!C.includes(g)&&!C.includes(p)&&x[O].push(p)})}else{const P=x[m.id];x[m.id]=P.filter(O=>O!==d&&O!==g),P.includes(p)||x[m.id].push(p),E.forEach(O=>{x[O]=x[O].filter(C=>C!==g),x[O].includes(d)||x[O].push(p)})}else if(w==="select"){Object.assign(x,this.getClearStates(!!p));const P=(O,C)=>{O.forEach(M=>{x[M]||(x[M]=[]),x[M].push(C)})};P(_,d),P(E,g),p&&Object.keys(x).forEach(O=>{!_.includes(O)&&!E.includes(O)&&x[O].push(p)})}else Object.assign(x,this.getClearStates());await y.setElementState(x,v)}getDataStates(){const{graph:f}=this.context,{nodes:d,edges:p,combos:g}=f.getData(),v={};return[...d,...p,...g].forEach(m=>{v[(0,r.idOf)(m)]=(0,s.statesOf)(m)}),v}getClearStates(f=!1){const{graph:d}=this.context,{state:p,unselectedState:g,neighborState:v}=this.options,m=new Set([p,g,v]),{nodes:y,edges:b,combos:w}=d.getData(),x={};return[...y,...b,...w].forEach(S=>{const _=(0,s.statesOf)(S),E=_.filter(P=>!m.has(P));(f||E.length!==_.length)&&(x[(0,r.idOf)(S)]=E)}),x}async clearState(){const{graph:f}=this.context;await f.setElementState(this.getClearStates(),this.options.animation)}validate(f){if(this.destroyed)return!1;const{enable:d}=this.options;return(0,n.isFunction)(d)?d(f):!!d}unbindEvents(){const{graph:f}=this.context;t.ELEMENT_TYPES.forEach(d=>{f.off(`${d}:${e.CommonEvent.CLICK}`,this.onClickSelect)}),f.off(e.CanvasEvent.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}};A(l,"defaultOptions",{animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0});let c=l;return Hc.ClickSelect=c,Hc}var Uc={},ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.isCollapsed=Agt;function Agt(n){var e;return!!((e=n.style)!=null&&e.collapsed)}var VR;function Ngt(){if(VR)return Uc;VR=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.CollapseExpand=void 0;const n=bt,e=Ft,t=ra,r=Ln(),i=fr(),s=class s extends i.BaseBehavior{constructor(l,u){super(l,Object.assign({},s.defaultOptions,u));A(this,"onCollapseExpand",async l=>{if(!this.validate(l))return;const{target:u}=l;if(!(0,r.isElement)(u))return;const h=u.id,{model:f,graph:d}=this.context,p=f.getElementDataById(h);if(!p)return!1;const{onCollapse:g,onExpand:v,animation:m}=this.options;(0,t.isCollapsed)(p)?(await d.expandElement(h,m),v==null||v(h)):(await d.collapseElement(h,m),g==null||g(h))});this.bindEvents()}update(l){this.unbindEvents(),super.update(l),this.bindEvents()}bindEvents(){const{graph:l}=this.context,{trigger:u}=this.options;l.on(`node:${u}`,this.onCollapseExpand),l.on(`combo:${u}`,this.onCollapseExpand)}unbindEvents(){const{graph:l}=this.context,{trigger:u}=this.options;l.off(`node:${u}`,this.onCollapseExpand),l.off(`combo:${u}`,this.onCollapseExpand)}validate(l){if(this.destroyed)return!1;const{enable:u}=this.options;return(0,n.isFunction)(u)?u(l):!!u}destroy(){this.unbindEvents(),super.destroy()}};A(s,"defaultOptions",{enable:!0,animation:!0,trigger:e.CommonEvent.DBLCLICK});let a=s;return Uc.CollapseExpand=a,Uc}var Yc={},WR;function Rgt(){if(WR)return Yc;WR=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.CreateEdge=void 0;const n=bt,e=Ft,t=fr(),r="g6-create-edge-assist-edge-id",i="g6-create-edge-assist-node-id",s=class s extends t.BaseBehavior{constructor(l,u){super(l,Object.assign({},s.defaultOptions,u));A(this,"source");A(this,"drop",async l=>{const{targetType:u}=l;["combo","node"].includes(u)&&this.source?await this.handleCreateEdge(l):await this.cancelEdge()});A(this,"handleCreateEdge",async l=>{var g;if(!this.validate(l))return;const{graph:u,canvas:h,batch:f,element:d}=this.context,{style:p}=this.options;if(this.source){this.createEdge(l),await this.cancelEdge();return}f.startBatch(),h.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([l.target.id])[0],u.addNodeData([{id:i,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),u.addEdgeData([{id:r,source:this.source,target:i,style:{pointerEvents:"none",...p}}]),await((g=d.draw({animation:!1}))==null?void 0:g.finished)});A(this,"updateAssistEdge",async l=>{var f;if(!this.source)return;const{model:u,element:h}=this.context;u.translateNodeTo(i,[l.canvas.x,l.canvas.y]),await((f=h.draw({animation:!1,silence:!0}))==null?void 0:f.finished)});A(this,"createEdge",l=>{var y,b;const{graph:u}=this.context,{style:h,onFinish:f,onCreate:d}=this.options;if(((y=l.target)==null?void 0:y.id)===void 0||this.source===void 0)return;const g=(b=this.getSelectedNodeIDs([l.target.id]))==null?void 0:b[0],v=`${this.source}-${g}-${(0,n.uniqueId)()}`,m=d({id:v,source:this.source,target:g,style:h});u.addEdgeData([m]),f(m)});A(this,"cancelEdge",async()=>{var f;if(!this.source)return;const{graph:l,element:u,batch:h}=this.context;l.removeNodeData([i]),this.source=void 0,await((f=u.draw({animation:!1}))==null?void 0:f.finished),h.endBatch()});this.bindEvents()}update(l){super.update(l),this.bindEvents()}bindEvents(){const{graph:l}=this.context,{trigger:u}=this.options;this.unbindEvents(),u==="click"?(l.on(e.NodeEvent.CLICK,this.handleCreateEdge),l.on(e.ComboEvent.CLICK,this.handleCreateEdge),l.on(e.CanvasEvent.CLICK,this.cancelEdge),l.on(e.EdgeEvent.CLICK,this.cancelEdge)):(l.on(e.NodeEvent.DRAG_START,this.handleCreateEdge),l.on(e.ComboEvent.DRAG_START,this.handleCreateEdge),l.on(e.CommonEvent.POINTER_UP,this.drop)),l.on(e.CommonEvent.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(l){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(u=>u.id).concat(l)))}validate(l){if(this.destroyed)return!1;const{enable:u}=this.options;return(0,n.isFunction)(u)?u(l):!!u}unbindEvents(){const{graph:l}=this.context;l.off(e.NodeEvent.CLICK,this.handleCreateEdge),l.off(e.ComboEvent.CLICK,this.handleCreateEdge),l.off(e.CanvasEvent.CLICK,this.cancelEdge),l.off(e.EdgeEvent.CLICK,this.cancelEdge),l.off(e.NodeEvent.DRAG_START,this.handleCreateEdge),l.off(e.ComboEvent.DRAG_START,this.handleCreateEdge),l.off(e.CommonEvent.POINTER_UP,this.drop),l.off(e.CommonEvent.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}};A(s,"defaultOptions",{animation:!0,enable:!0,style:{},trigger:"drag",onCreate:l=>l,onFinish:()=>{}});let a=s;return Yc.CreateEdge=a,Yc}var Kc={},HR;function kgt(){if(HR)return Kc;HR=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.DragCanvas=void 0;const n=bt,e=Ft,t=Oi,r=Kt,i=fr(),s=class s extends i.BaseBehavior{constructor(l,u){super(l,Object.assign({},s.defaultOptions,u));A(this,"shortcut");A(this,"defaultCursor");A(this,"isDragging",!1);A(this,"onDragStart",l=>{this.validate(l)&&l.targetType==="canvas"&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))});A(this,"onDrag",l=>{if(!this.isDragging)return;const{x:u,y:h}=l.movement;u|h&&this.translate([u,h],!1)});A(this,"onDragEnd",()=>{var l,u;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(u=(l=this.options).onFinish)==null||u.call(l)});A(this,"invokeOnFinish",(0,n.debounce)(()=>{var l,u;(u=(l=this.options).onFinish)==null||u.call(l)},300));this.shortcut=new t.Shortcut(l.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(l){this.unbindEvents(),super.update(l),this.bindEvents()}bindEvents(){const{trigger:l}=this.options,{graph:u}=this.context;if((0,n.isObject)(l)){const{up:h=[],down:f=[],left:d=[],right:p=[]}=l;this.shortcut.bind(h,g=>this.onTranslate([0,1],g)),this.shortcut.bind(f,g=>this.onTranslate([0,-1],g)),this.shortcut.bind(d,g=>this.onTranslate([1,0],g)),this.shortcut.bind(p,g=>this.onTranslate([-1,0],g))}else u.on(e.CanvasEvent.DRAG_START,this.onDragStart),u.on(e.CanvasEvent.DRAG,this.onDrag),u.on(e.CanvasEvent.DRAG_END,this.onDragEnd)}async onTranslate(l,u){if(!this.validate(u))return;const{sensitivity:h}=this.options,f=h*-1;await this.translate((0,r.multiply)(l,f),this.options.animation),this.invokeOnFinish()}async translate(l,u){await this.context.graph.translateBy(l,u)}validate(l){if(this.destroyed)return!1;const{enable:u}=this.options;return(0,n.isFunction)(u)?u(l):!!u}unbindEvents(){this.shortcut.unbindAll();const{graph:l}=this.context;l.off(e.CanvasEvent.DRAG_START,this.onDragStart),l.off(e.CanvasEvent.DRAG,this.onDrag),l.off(e.CanvasEvent.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}};A(s,"defaultOptions",{enable:!0,sensitivity:10});let a=s;return Kc.DragCanvas=a,Kc}var Xc={},UR;function G9(){if(UR)return Xc;UR=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.DragElement=void 0;const n=Pe,e=bt,t=Ft,r=de,i=Gt,a=Ie,s=Kt,o=fr(),l=class l extends o.BaseBehavior{constructor(f,d){super(f,Object.assign({},l.defaultOptions,d));A(this,"enable",!1);A(this,"enableElements",["node","combo"]);A(this,"target",[]);A(this,"shadow");A(this,"shadowOrigin",[0,0]);A(this,"hiddenEdges",[]);A(this,"isDragging",!1);A(this,"onDrop",async f=>{var v;if(this.options.dropEffect!=="link")return;const{model:d,element:p}=this.context,g=f.target.id;this.target.forEach(m=>{const y=d.getParentData(m,t.COMBO_KEY);y&&(0,i.idOf)(y)===g&&d.refreshComboData(g),d.setParent(m,g,t.COMBO_KEY)}),await((v=p==null?void 0:p.draw({animation:!0}))==null?void 0:v.finished)});A(this,"setCursor",f=>{if(this.isDragging)return;const{type:d}=f,{canvas:p}=this.context,{cursor:g}=this.options;d===t.CommonEvent.POINTER_ENTER?p.setCursor((g==null?void 0:g.grab)||"grab"):p.setCursor((g==null?void 0:g.default)||"default")});this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}get animation(){return this.options.shadow?this.options.animation:!1}update(f){this.unbindEvents(),super.update(f),this.bindEvents()}bindEvents(){const{graph:f}=this.context;this.enableElements.forEach(d=>{f.on(`${d}:${t.CommonEvent.DRAG_START}`,this.onDragStart),f.on(`${d}:${t.CommonEvent.DRAG}`,this.onDrag),f.on(`${d}:${t.CommonEvent.DRAG_END}`,this.onDragEnd),f.on(`${d}:${t.CommonEvent.POINTER_ENTER}`,this.setCursor),f.on(`${d}:${t.CommonEvent.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(f.on(t.ComboEvent.DROP,this.onDrop),f.on(t.CanvasEvent.DROP,this.onDrop))}getSelectedNodeIDs(f){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(d=>d.id).concat(f)))}getDelta(f){const d=this.context.graph.getZoom();return(0,s.divide)([f.dx,f.dy],d)}onDragStart(f){var g;if(this.enable=this.validate(f),!this.enable)return;const{batch:d,canvas:p}=this.context;p.setCursor(((g=this.options.cursor)==null?void 0:g.grabbing)||"grabbing"),this.isDragging=!0,d.startBatch(),this.target=this.getSelectedNodeIDs([f.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(f){if(!this.enable)return;const d=this.getDelta(f);this.options.shadow?this.moveShadow(d):this.moveElement(this.target,d)}onDragEnd(){var p,g,v;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:m=0,y=0}=this.shadow.attributes,[b,w]=(0,s.subtract)([+m,+y],this.shadowOrigin);this.moveElement(this.target,[b,w])}this.showEdges(),(g=(p=this.options).onFinish)==null||g.call(p,this.target);const{batch:f,canvas:d}=this.context;f.endBatch(),d.setCursor(((v=this.options.cursor)==null?void 0:v.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(f){if(this.destroyed)return!1;const{enable:d}=this.options;return(0,e.isFunction)(d)?d(f):!!d}async moveElement(f,d){const{graph:p,model:g}=this.context,{dropEffect:v}=this.options;v==="move"&&f.forEach(m=>g.refreshComboData(m)),p.translateElementBy(Object.fromEntries(f.map(m=>[m,d])),!1)}moveShadow(f){if(!this.shadow)return;const{x:d=0,y:p=0}=this.shadow.attributes,[g,v]=f;this.shadow.attr({x:+d+g,y:+p+v})}createShadow(f){const d=(0,a.subStyleProps)(this.options,"shadow"),p=(0,r.getCombinedBBox)(f.map(w=>this.context.element.getElement(w).getBounds())),[g,v]=p.min;this.shadowOrigin=[g,v];const[m,y]=(0,r.getBBoxSize)(p),b={width:m,height:y,x:g,y:v};this.shadow?this.shadow.attr({...d,...b,visibility:"visible"}):(this.shadow=new n.Rect({style:{$layer:"transient",...d,...b,pointerEvents:"none"}}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:f,shadow:d}=this.options;if(f==="none"||d)return;const{graph:p}=this.context;f==="all"?this.hiddenEdges=p.getEdgeData().map(i.idOf):this.hiddenEdges=Array.from(new Set(this.target.map(g=>p.getRelatedEdgesData(g,f).map(i.idOf)).flat())),p.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:f}=this.context;this.enableElements.forEach(d=>{f.off(`${d}:${t.CommonEvent.DRAG_START}`,this.onDragStart),f.off(`${d}:${t.CommonEvent.DRAG}`,this.onDrag),f.off(`${d}:${t.CommonEvent.DRAG_END}`,this.onDragEnd),f.off(`${d}:${t.CommonEvent.POINTER_ENTER}`,this.setCursor),f.off(`${d}:${t.CommonEvent.POINTER_LEAVE}`,this.setCursor)}),f.off(`combo:${t.CommonEvent.DROP}`,this.onDrop),f.off(`canvas:${t.CommonEvent.DROP}`,this.onDrop)}destroy(){var f;this.unbindEvents(),(f=this.shadow)==null||f.destroy(),super.destroy()}};A(l,"defaultOptions",{animation:!0,enable:f=>["node","combo"].includes(f.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}});let c=l;return Xc.DragElement=c,Xc}var Zc={},ei={};const F_=Zr(WY);var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.BaseLayout=void 0;class Dgt{constructor(e,t){A(this,"options");A(this,"context");A(this,"stop");A(this,"tick");this.context=e,this.options=t||{}}}Dh.BaseLayout=Dgt;Object.defineProperty(ei,"__esModule",{value:!0});ei.isComboLayout=Fgt;ei.isTreeLayout=$gt;ei.isPositionSpecified=zgt;ei.layoutMapping2GraphData=md;ei.layoutAdapter=jgt;ei.invokeLayoutMethod=qgt;ei.getLayoutProperty=Ggt;const Lgt=F_,x2=bt,Yf=Ft,Igt=Dh,nx=Gt,Bgt=It;function Fgt(n){const{type:e}=n;return!!(["comboCombined","comboForce"].includes(e)||e==="antv-dagre"&&n.sortByCombo)}function $gt(n){const{type:e}=n;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function zgt(n){return(0,x2.isNumber)(n.x)&&(0,x2.isNumber)(n.y)}function md(n){const{nodes:e,edges:t}=n,r={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?r.combos:r.nodes,{x:s,y:o,z:c=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:c}})}),t.forEach(i=>{const{id:a,source:s,target:o,data:{points:c=[],controlPoints:l=c.slice(1,c.length-1)}}=i;r.edges.push({id:a,source:s,target:o,style:{...l!=null&&l.length?{controlPoints:l.map(Bgt.parsePoint)}:{}}})}),r}function jgt(n,e){class t extends Igt.BaseLayout{constructor(a,s){super(a,s);A(this,"instance");A(this,"id");if(this.instance=new n({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const o=this.instance;this.stop=o.stop.bind(o),this.tick=c=>{const l=o.tick(c);return md(l)}}}async execute(a,s){return md(await this.instance.execute(this.graphData2LayoutModel(a),this.transformOptions((0,x2.deepMix)({},this.options,s))))}transformOptions(a){const{onTick:s}=a;return s&&(a.onTick=o=>s(md(o))),a}graphData2LayoutModel(a){const{nodes:s=[],edges:o=[],combos:c=[]}=a,l=s.map(p=>{const g=(0,nx.idOf)(p),{data:v,style:m,combo:y}=p,b={id:g,data:{...v,...y?{parentId:y}:{}},style:{...m}};return m!=null&&m.x&&Object.assign(b.data,{x:m.x}),m!=null&&m.y&&Object.assign(b.data,{y:m.y}),m!=null&&m.z&&Object.assign(b.data,{z:m.z}),b}),u=new Map(l.map(p=>[p.id,p])),h=o.filter(p=>{const{source:g,target:v}=p;return u.has(g)&&u.has(v)}).map(p=>{const{source:g,target:v,data:m,style:y}=p;return{id:(0,nx.idOf)(p),source:g,target:v,data:{...m},style:{...y}}}),f=c.map(p=>({id:(0,nx.idOf)(p),data:{_isCombo:!0,...p.data},style:{...p.style}})),d=new Lgt.Graph({nodes:[...l,...f],edges:h});return e.model.model.hasTreeStructure(Yf.COMBO_KEY)&&(d.attachTreeStructure(Yf.COMBO_KEY),l.forEach(p=>{const g=e.model.model.getParent(p.id,Yf.COMBO_KEY);g&&d.hasNode(g.id)&&d.setParent(p.id,g.id,Yf.COMBO_KEY)})),d}}return t}function qgt(n,e,...t){if(e in n)return n[e](...t);if("instance"in n){const r=n.instance;if(e in r)return r[e](...t)}return null}function Ggt(n,e){if(e in n)return n[e];if("instance"in n){const t=n.instance;if(e in t)return t[e]}return null}var YR;function Vgt(){if(YR)return Zc;YR=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.DragElementForce=void 0;const n=Gt,e=ei,t=hr,r=Kt,i=G9();class a extends i.DragElement{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(o=>["d3-force","d3-force-3d"].includes(o==null?void 0:o.id))}validate(o){return this.context.layout?this.forceLayoutInstance?super.validate(o):(t.print.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}async moveElement(o,c){const l=this.forceLayoutInstance;this.context.graph.getNodeData(o).forEach((u,h)=>{const{x:f=0,y:d=0}=u.style||{};l&&(0,e.invokeLayoutMethod)(l,"setFixedPosition",o[h],[...(0,r.add)([+f,+d],c)])})}onDragStart(o){if(this.enable=this.validate(o),!this.enable)return;this.target=this.getSelectedNodeIDs([o.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const c=this.forceLayoutInstance;c&&(0,e.getLayoutProperty)(c,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(l=>{const{x:u=0,y:h=0}=l.style||{};c&&(0,e.invokeLayoutMethod)(c,"setFixedPosition",(0,n.idOf)(l),[+u,+h])})}onDrag(o){if(!this.enable)return;const c=this.getDelta(o);this.moveElement(this.target,c)}onDragEnd(){const o=this.forceLayoutInstance;o&&(0,e.getLayoutProperty)(o,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(c=>{o&&(0,e.invokeLayoutMethod)(o,"setFixedPosition",(0,n.idOf)(c),[null,null,null])})}}return Zc.DragElementForce=a,Zc}var Qc={},_0={};Object.defineProperty(_0,"__esModule",{value:!0});_0.getDescendantShapes=Wgt;function Wgt(n){const e=[],t=r=>{r!=null&&r.children.length&&r.children.forEach(i=>{e.push(i),t(i)})};return t(n),e}var KR;function Hgt(){if(KR)return Qc;KR=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.FixElementSize=void 0;const n=bt,e=Ft,t=_i,r=Gt,i=_0,a=fr(),o=class o extends a.BaseBehavior{constructor(u,h){super(u,Object.assign({},o.defaultOptions,h));A(this,"elementCache",new Map);A(this,"isZoomEvent",u=>"scale"in u.data);A(this,"fixElementSize",async u=>{if(!this.isZoomEvent(u)||!this.validate(u))return;const{graph:h,element:f}=this.context,{node:d,edge:p,state:g}=this.options,v=[...h.getElementDataByState("node",g),...h.getElementDataByState("edge",g)];if(!v.length)return;const m=u.data.scale||h.getZoom();v.forEach(y=>{const b=(0,r.idOf)(y),w=f==null?void 0:f.getElement(b),x=h.getElementType(b),S=x==="edge"?p:d;if(!S){this.elementCache.set(b,w),x==="edge"&&(w.style.transformOrigin="center"),w.setLocalScale(1/m);return}const _=(0,i.getDescendantShapes)(w);(Array.isArray(S)?S:[S]).forEach(P=>{const{shape:O,fields:C}=P,M=O(_);C.forEach(T=>{(0,t.hasCachedStyle)(M,T)||(0,t.cacheStyle)(M,T);const R=(0,t.getCachedStyle)(M,T);(0,n.isNumber)(R)&&(M.style[T]=R/m)})})})});A(this,"resetTransform",async()=>{this.elementCache&&(this.elementCache.forEach(u=>u.setLocalScale(1)),this.elementCache.clear())});this.bindEvents()}bindEvents(){const{graph:u}=this.context;u.on(e.GraphEvent.AFTER_TRANSFORM,this.fixElementSize),u.on(e.GraphEvent.BEFORE_DRAW,this.resetTransform)}unbindEvents(){const{graph:u}=this.context;u.off(e.GraphEvent.AFTER_TRANSFORM,this.fixElementSize),u.off(e.GraphEvent.BEFORE_DRAW,this.resetTransform)}validate(u){if(this.destroyed)return!1;const{enable:h}=this.options;return(0,n.isFunction)(h)?h(u):!!h}destroy(){this.unbindEvents(),super.destroy()}};A(o,"defaultOptions",{enable:u=>u.data.scale<1,state:"selected",edge:[{shape:u=>u.find(h=>h.className==="key"),fields:["lineWidth"]},{shape:u=>u.find(h=>{var f;return((f=h.parentElement)==null?void 0:f.className)==="label"&&h.className==="text"}),fields:["fontSize"]}]});let s=o;return Qc.FixElementSize=s,Qc}var Jc={},XR;function Ugt(){if(XR)return Jc;XR=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.FocusElement=void 0;const n=bt,e=Ft,t=wn,r=fr(),a=class a extends r.BaseBehavior{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"focus",async c=>{if(!this.validate(c))return;const{graph:l}=this.context;await l.focusElement(c.target.id,this.options.animation)});this.bindEvents()}bindEvents(){const{graph:c}=this.context;this.unbindEvents(),t.ELEMENT_TYPES.forEach(l=>{c.on(`${l}:${e.CommonEvent.CLICK}`,this.focus)})}validate(c){if(this.destroyed)return!1;const{enable:l}=this.options;return(0,n.isFunction)(l)?l(c):!!l}unbindEvents(){const{graph:c}=this.context;t.ELEMENT_TYPES.forEach(l=>{c.off(`${l}:${e.CommonEvent.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}};A(a,"defaultOptions",{animation:{easing:"ease-in",duration:500},enable:!0});let i=a;return Jc.FocusElement=i,Jc}var tl={},ZR;function Ygt(){if(ZR)return tl;ZR=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.HoverActivate=void 0;const n=bt,e=Ft,t=wn,r=Gt,i=kh,a=fr(),o=class o extends a.BaseBehavior{constructor(u,h){super(u,Object.assign({},o.defaultOptions,h));A(this,"isFrozen",!1);A(this,"toggleFrozen",u=>{this.isFrozen=u.type==="dragstart"});A(this,"hoverElement",u=>{if(!this.validate(u))return;const h=u.type===e.CommonEvent.POINTER_OVER;this.updateElementsState(u,h);const{onHover:f,onHoverEnd:d}=this.options;h?f==null||f(u):d==null||d(u)});A(this,"updateElementsState",(u,h)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:f}=this.context,{state:d,degree:p,animation:g,inactiveState:v}=this.options,{targetType:m,target:y}=u,b=p?(0,i.getElementNthDegreeIds)(f,m,y.id,p):[y.id],w={};if(d&&Object.assign(w,this.getElementsState(b,d,h)),v){const x=(0,r.idsOf)(f.getData(),!0).filter(S=>!b.includes(S));Object.assign(w,this.getElementsState(x,v,h))}f.setElementState(w,g)});A(this,"getElementsState",(u,h,f)=>{const{graph:d}=this.context,p={};return u.forEach(g=>{const v=d.getElementState(g),m=f?[...v,h]:v.filter(y=>y!==h);p[g]=m}),p});this.bindEvents()}bindEvents(){const{graph:u}=this.context;this.unbindEvents(),t.ELEMENT_TYPES.forEach(f=>{u.on(`${f}:${e.CommonEvent.POINTER_OVER}`,this.hoverElement),u.on(`${f}:${e.CommonEvent.POINTER_OUT}`,this.hoverElement)});const h=this.context.canvas.document;h.addEventListener(`${e.CommonEvent.DRAG_START}`,this.toggleFrozen),h.addEventListener(`${e.CommonEvent.DRAG_END}`,this.toggleFrozen)}validate(u){if(this.destroyed||this.isFrozen)return!1;const{enable:h}=this.options;return(0,n.isFunction)(h)?h(u):!!h}unbindEvents(){const{graph:u}=this.context;t.ELEMENT_TYPES.forEach(f=>{u.off(`${f}:${e.CommonEvent.POINTER_OVER}`,this.hoverElement),u.off(`${f}:${e.CommonEvent.POINTER_OUT}`,this.hoverElement)});const h=this.context.canvas.document;h.removeEventListener(`${e.CommonEvent.DRAG_START}`,this.toggleFrozen),h.removeEventListener(`${e.CommonEvent.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}};A(o,"defaultOptions",{animation:!1,enable:!0,degree:0,state:"active",inactiveState:void 0});let s=o;return tl.HoverActivate=s,tl}var el={},Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.getClosedSpline=void 0;Pi.pointsToPath=Kgt;Pi.parsePath=V9;Pi.pathToPoints=Xgt;function Kgt(n,e=!0){const t=[];return n.forEach((r,i)=>{t.push([i===0?"M":"L",...r])}),e&&t.push(["Z"]),t}const QR={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function V9(n){const e=n.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let r="",i={};for(;e.length>0;){let a=e.shift();a in QR?r=a:e.unshift(a),i={type:r},QR[r].forEach(c=>{a=e.shift(),i[c]=a}),r==="M"?r="L":r==="m"&&(r="l");const[s,...o]=Object.values(i);t.push([s,...o.map(Number)])}return t}function Xgt(n){const e=[];return(typeof n=="string"?V9(n):n).forEach(r=>{const i=r[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<r.length;a=a+2)e.push([r[a],r[a+1],0]);else{const a=r.length;e.push([r[a-2],r[a-1],0])}}),e}const Zgt=n=>{if(n.length<2)return[["M",0,0],["L",0,0]];const e=n[0],t=n[1],r=n[n.length-1],i=n[n.length-2];n.unshift(i,r),n.push(e,t);const a=[["M",r[0],r[1]]];for(let s=1;s<n.length-2;s+=1){const[o,c]=n[s-1],[l,u]=n[s],[h,f]=n[s+1],[d,p]=s!==n.length-2?n[s+2]:[h,f],g=l+(h-o)/6,v=u+(f-c)/6,m=h-(d-l)/6,y=f-(p-u)/6;a.push(["C",g,v,m,y,h,f])}return a};Pi.getClosedSpline=Zgt;var JR;function Qgt(){if(JR)return el;JR=1,Object.defineProperty(el,"__esModule",{value:!0}),el.LassoSelect=void 0;const n=Pe,e=Pi,t=j9();class r extends t.BrushSelect{constructor(){super(...arguments);A(this,"points");A(this,"pathShape")}onPointerDown(s){if(!super.validate(s)||!super.isKeydown()||this.points)return;const{canvas:o}=this.context;this.pathShape=new n.Path({id:"g6-lasso-select",style:this.options.style}),o.appendChild(this.pathShape),this.points=[(0,t.getCursorPoint)(s)]}onPointerMove(s){var l;if(!this.points)return;const{immediately:o,mode:c}=this.options;this.points.push((0,t.getCursorPoint)(s)),(l=this.pathShape)==null||l.setAttribute("d",(0,e.pointsToPath)(this.points)),o&&c==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var s;(s=this.pathShape)==null||s.remove(),this.pathShape=void 0,this.points=void 0}}return el.LassoSelect=r,el}var nl={},O0={};Object.defineProperty(O0,"__esModule",{value:!0});O0.setVisibility=t0t;const rx=_i,Jgt=_0,ix="visibility";function t0t(n,e,t){let r=[n,...(0,Jgt.getDescendantShapes)(n)];t&&(r=t==null?void 0:t(r)),r.forEach(i=>{(0,rx.hasCachedStyle)(i,ix)||(0,rx.cacheStyle)(i,ix);const a=(0,rx.getCachedStyle)(i,ix);n!==i&&a==="hidden"||(i.style.visibility=e)})}var t6;function e0t(){if(t6)return nl;t6=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.OptimizeViewportTransform=void 0;const n=bt,e=Ft,t=O0,r=fr(),a=class a extends r.BaseBehavior{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"isVisible",!0);A(this,"filterShapes",(c,l)=>c.filter(u=>u.className&&!(l!=null&&l.includes(u.className))));A(this,"setElementsVisibility",(c,l,u)=>{c.forEach(h=>{(0,t.setVisibility)(h,l,u&&(f=>this.filterShapes(f,u)))})});A(this,"hideShapes",c=>{if(!this.validate(c)||!this.isVisible)return;const{element:l}=this.context,{shapes:u={}}=this.options;this.setElementsVisibility(l.getNodes(),"hidden",u.node),this.setElementsVisibility(l.getEdges(),"hidden",u.edge),this.setElementsVisibility(l.getCombos(),"hidden",u.combo),this.isVisible=!1});A(this,"showShapes",(0,n.debounce)(c=>{if(!this.validate(c)||this.isVisible)return;const{element:l}=this.context;this.setElementsVisibility(l.getNodes(),"visible"),this.setElementsVisibility(l.getEdges(),"visible"),this.setElementsVisibility(l.getCombos(),"visible"),this.isVisible=!0},this.options.debounce));this.bindEvents()}bindEvents(){const{graph:c}=this.context;c.on(e.GraphEvent.BEFORE_TRANSFORM,this.hideShapes),c.on(e.GraphEvent.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:c}=this.context;c.off(e.GraphEvent.BEFORE_TRANSFORM,this.hideShapes),c.off(e.GraphEvent.AFTER_TRANSFORM,this.showShapes)}validate(c){if(this.destroyed)return!1;const{enable:l}=this.options;return(0,n.isFunction)(l)?l(c):!!l}destroy(){this.unbindEvents(),super.destroy()}};A(a,"defaultOptions",{enable:!0,debounce:200,shapes:{node:["key"]}});let i=a;return nl.OptimizeViewportTransform=i,nl}var rl={},e6;function n0t(){if(e6)return rl;e6=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.ScrollCanvas=void 0;const n=bt,e=Ft,t=Oi,r=fr(),a=class a extends r.BaseBehavior{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"shortcut");A(this,"onWheel",async c=>{c.preventDefault();const l=c.deltaX,u=c.deltaY;await this.scroll([-l,-u],c)});this.shortcut=new t.Shortcut(c.graph),this.bindEvents()}update(c){super.update(c),this.bindEvents()}bindEvents(){var l,u;const{trigger:c}=this.options;if(this.shortcut.unbindAll(),(0,n.isObject)(c)){(l=this.graphDom)==null||l.removeEventListener(e.CommonEvent.WHEEL,this.onWheel);const{up:h=[],down:f=[],left:d=[],right:p=[]}=c;this.shortcut.bind(h,g=>this.scroll([0,-10],g)),this.shortcut.bind(f,g=>this.scroll([0,10],g)),this.shortcut.bind(d,g=>this.scroll([-10,0],g)),this.shortcut.bind(p,g=>this.scroll([10,0],g))}else(u=this.graphDom)==null||u.addEventListener(e.CommonEvent.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement([c,l]){const{direction:u,sensitivity:h}=this.options;return c=c*h,l=l*h,u==="x"?l=0:u==="y"&&(c=0),[c,l]}async scroll(c,l){if(!this.validate(l))return;const{onFinish:u}=this.options,h=this.context.graph,f=this.formatDisplacement(c);await h.translateBy(f,!1),u==null||u()}validate(c){if(this.destroyed)return!1;const{enable:l}=this.options;return(0,n.isFunction)(l)?l(c):!!l}destroy(){var c;this.shortcut.destroy(),(c=this.graphDom)==null||c.removeEventListener(e.CommonEvent.WHEEL,this.onWheel),super.destroy()}};A(a,"defaultOptions",{enable:!0,sensitivity:1});let i=a;return rl.ScrollCanvas=i,rl}var il={},n6;function r0t(){if(n6)return il;n6=1,Object.defineProperty(il,"__esModule",{value:!0}),il.ZoomCanvas=void 0;const n=bt,e=Ft,t=It,r=Oi,i=fr(),s=class s extends i.BaseBehavior{constructor(l,u){super(l,Object.assign({},s.defaultOptions,u));A(this,"shortcut");A(this,"zoom",async(l,u,h)=>{if(!this.validate(u))return;const{graph:f}=this.context;let d;"viewport"in u&&(d=(0,t.parsePoint)(u.viewport));const{sensitivity:p,onFinish:g}=this.options,v=1+(0,n.clamp)(l,-50,50)*p/100,m=f.getZoom();await f.zoomTo(m*v,h,d),g==null||g()});A(this,"onReset",async()=>{await this.context.graph.zoomTo(1,this.options.animation)});this.shortcut=new r.Shortcut(l.graph),this.bindEvents()}update(l){super.update(l),this.bindEvents()}bindEvents(){const{trigger:l}=this.options;if(this.shortcut.unbindAll(),(0,n.isArray)(l)&&(this.preventDefault(e.CommonEvent.WHEEL),this.shortcut.bind([...l,e.CommonEvent.WHEEL],u=>{const{deltaX:h,deltaY:f}=u;this.zoom(-(f??h),u,!1)})),(0,n.isObject)(l)){const{zoomIn:u=[],zoomOut:h=[],reset:f=[]}=l;this.shortcut.bind(u,d=>this.zoom(10,d,this.options.animation)),this.shortcut.bind(h,d=>this.zoom(-10,d,this.options.animation)),this.shortcut.bind(f,this.onReset)}}validate(l){if(this.destroyed)return!1;const{enable:u}=this.options;return(0,n.isFunction)(u)?u(l):!!u}preventDefault(l){const u=f=>f.preventDefault(),h=this.context.canvas.getContainer();h&&h.addEventListener(l,u)}destroy(){this.shortcut.destroy(),super.destroy()}};A(s,"defaultOptions",{animation:{duration:200},enable:!0,sensitivity:1,trigger:[]});let a=s;return il.ZoomCanvas=a,il}var r6;function W9(){return r6||(r6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ZoomCanvas=n.ScrollCanvas=n.OptimizeViewportTransform=n.LassoSelect=n.HoverActivate=n.FocusElement=n.FixElementSize=n.DragElementForce=n.DragElement=n.DragCanvas=n.CreateEdge=n.CollapseExpand=n.ClickSelect=n.BrushSelect=n.BaseBehavior=void 0;var e=fr();Object.defineProperty(n,"BaseBehavior",{enumerable:!0,get:function(){return e.BaseBehavior}});var t=j9();Object.defineProperty(n,"BrushSelect",{enumerable:!0,get:function(){return t.BrushSelect}});var r=Tgt();Object.defineProperty(n,"ClickSelect",{enumerable:!0,get:function(){return r.ClickSelect}});var i=Ngt();Object.defineProperty(n,"CollapseExpand",{enumerable:!0,get:function(){return i.CollapseExpand}});var a=Rgt();Object.defineProperty(n,"CreateEdge",{enumerable:!0,get:function(){return a.CreateEdge}});var s=kgt();Object.defineProperty(n,"DragCanvas",{enumerable:!0,get:function(){return s.DragCanvas}});var o=G9();Object.defineProperty(n,"DragElement",{enumerable:!0,get:function(){return o.DragElement}});var c=Vgt();Object.defineProperty(n,"DragElementForce",{enumerable:!0,get:function(){return c.DragElementForce}});var l=Hgt();Object.defineProperty(n,"FixElementSize",{enumerable:!0,get:function(){return l.FixElementSize}});var u=Ugt();Object.defineProperty(n,"FocusElement",{enumerable:!0,get:function(){return u.FocusElement}});var h=Ygt();Object.defineProperty(n,"HoverActivate",{enumerable:!0,get:function(){return h.HoverActivate}});var f=Qgt();Object.defineProperty(n,"LassoSelect",{enumerable:!0,get:function(){return f.LassoSelect}});var d=e0t();Object.defineProperty(n,"OptimizeViewportTransform",{enumerable:!0,get:function(){return d.OptimizeViewportTransform}});var p=n0t();Object.defineProperty(n,"ScrollCanvas",{enumerable:!0,get:function(){return p.ScrollCanvas}});var g=r0t();Object.defineProperty(n,"ZoomCanvas",{enumerable:!0,get:function(){return g.ZoomCanvas}})}(JE)),JE}var P0={};const H9=Zr(uot);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseLayout=n.RandomLayout=n.RadialLayout=n.MDSLayout=n.GridLayout=n.FruchtermanLayout=n.ForceLayout=n.ForceAtlas2Layout=n.DagreLayout=n.D3ForceLayout=n.ConcentricLayout=n.ComboCombinedLayout=n.CircularLayout=n.AntVDagreLayout=n.mindmap=n.indented=n.dendrogram=n.compactBox=void 0;var e=du;Object.defineProperty(n,"compactBox",{enumerable:!0,get:function(){return e.compactBox}}),Object.defineProperty(n,"dendrogram",{enumerable:!0,get:function(){return e.dendrogram}}),Object.defineProperty(n,"indented",{enumerable:!0,get:function(){return e.indented}}),Object.defineProperty(n,"mindmap",{enumerable:!0,get:function(){return e.mindmap}});var t=H9;Object.defineProperty(n,"AntVDagreLayout",{enumerable:!0,get:function(){return t.AntVDagreLayout}}),Object.defineProperty(n,"CircularLayout",{enumerable:!0,get:function(){return t.CircularLayout}}),Object.defineProperty(n,"ComboCombinedLayout",{enumerable:!0,get:function(){return t.ComboCombinedLayout}}),Object.defineProperty(n,"ConcentricLayout",{enumerable:!0,get:function(){return t.ConcentricLayout}}),Object.defineProperty(n,"D3ForceLayout",{enumerable:!0,get:function(){return t.D3ForceLayout}}),Object.defineProperty(n,"DagreLayout",{enumerable:!0,get:function(){return t.DagreLayout}}),Object.defineProperty(n,"ForceAtlas2Layout",{enumerable:!0,get:function(){return t.ForceAtlas2Layout}}),Object.defineProperty(n,"ForceLayout",{enumerable:!0,get:function(){return t.ForceLayout}}),Object.defineProperty(n,"FruchtermanLayout",{enumerable:!0,get:function(){return t.FruchtermanLayout}}),Object.defineProperty(n,"GridLayout",{enumerable:!0,get:function(){return t.GridLayout}}),Object.defineProperty(n,"MDSLayout",{enumerable:!0,get:function(){return t.MDSLayout}}),Object.defineProperty(n,"RadialLayout",{enumerable:!0,get:function(){return t.RadialLayout}}),Object.defineProperty(n,"RandomLayout",{enumerable:!0,get:function(){return t.RandomLayout}});var r=Dh;Object.defineProperty(n,"BaseLayout",{enumerable:!0,get:function(){return r.BaseLayout}})})(P0);var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.blues=Mr.greens=Mr.oranges=Mr.tableau=Mr.spectral=void 0;Mr.spectral=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"];Mr.tableau=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"];Mr.oranges=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"];Mr.greens=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"];Mr.blues=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];var ax={},al={},ni={};Object.defineProperty(ni,"__esModule",{value:!0});ni.sizeOf=a0t;ni.createPluginContainer=s0t;ni.insertDOM=o0t;ni.insertBefore=c0t;const i6=bt,lo=n=>n?parseInt(n):0;function i0t(n){const e=getComputedStyle(n),t=n.clientWidth||lo(e.width),r=n.clientHeight||lo(e.height),i=lo(e.paddingLeft)+lo(e.paddingRight),a=lo(e.paddingTop)+lo(e.paddingBottom);return[t-i,r-a]}function a0t(n){let e=640,t=480;const[r,i]=i0t(n);e=r||e,t=i||t;const a=1,s=1;return[Math.max((0,i6.isNumber)(e)?e:a,a),Math.max((0,i6.isNumber)(t)?t:s,s)]}function s0t(n,e=!0){const t=document.createElement("div");return t.setAttribute("class",`g6-${n}`),t.style.position="absolute",t.style.display="block",e&&(t.style.inset="0px",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none"),t}function o0t(n,e="div",t={},r="",i=document.body){const a=document.getElementById(n);a&&a.remove();const s=document.createElement(e);return s.innerHTML=r,s.id=n,Object.assign(s.style,t),i.appendChild(s),s}function c0t(n,e){const t=n.firstChild;t?n.insertBefore(e,t):n.appendChild(e)}var sl={},a6;function Yn(){if(a6)return sl;a6=1,Object.defineProperty(sl,"__esModule",{value:!0}),sl.BasePlugin=void 0;const n=Oc();class e extends n.BaseExtension{}return sl.BasePlugin=e,sl}var s6;function l0t(){if(s6)return al;s6=1,Object.defineProperty(al,"__esModule",{value:!0}),al.Background=void 0;const n=bt,e=ni,t=Yn(),i=class i extends t.BasePlugin{constructor(o,c){super(o,Object.assign({},i.defaultOptions,c));A(this,"$element",(0,e.createPluginContainer)("background"));this.context.canvas.getContainer().prepend(this.$element),this.update(c)}async update(o){super.update(o),Object.assign(this.$element.style,(0,n.omit)(this.options,["key","type"]))}destroy(){super.destroy(),this.$element.remove()}};A(i,"defaultOptions",{transition:"background 0.5s",backgroundSize:"cover"});let r=i;return al.Background=r,al}var ol={};const u0t=Zr(zot);var sx={},cl={},ll={},o6;function Lh(){if(o6)return ll;o6=1,Object.defineProperty(ll,"__esModule",{value:!0}),ll.BaseShape=void 0;const n=Pe,e=bt,t=_c(),r=Ln(),i=Ie,a=Ne,s=Gs,o=O0;class c extends n.CustomElement{constructor(f){super(f);A(this,"shapeMap",{});A(this,"animateMap",{});this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(f,d,p,g){const v=this.shapeMap[f];if(p===!1){v&&(g.removeChild(v),delete this.shapeMap[f]);return}if(!v||v.destroyed){const m=new d({className:f,style:p});return g.appendChild(m),this.shapeMap[f]=m,m}return(0,r.updateStyle)(v,p),v}transformPosition(f){const{x:d=0,y:p=0,z:g=0,transform:v}=f;(d!==0||p!==0||g!==0)&&(this.style.transform=(0,s.replaceTranslateInTransform)(+d,+p,+g,v))}update(f={}){const d=Object.assign({},this.attributes,f);this.attr(d),this.render(d,this),this.transformPosition(d),this.setVisibility()}bindEvents(){}getGraphicStyle(f){return(0,a.getSubShapeStyle)(f)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(f,d){if(f.length===0)return null;const p=[];if(f[0].x!==void 0||f[0].y!==void 0||f[0].z!==void 0){const{x:v=0,y:m=0,z:y=0}=this.attributes;f.forEach(b=>{const{x:w=v,y:x=m,z:S=y}=b;Object.assign(b,{transform:(0,s.replaceTranslateInTransform)(+w,+x,+S)})})}const g=super.animate(f,d);if(g&&(l(this,g),p.push(g)),Array.isArray(f)&&f.length>0){const v=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(f[0]).some(m=>!v.includes(m))){Object.entries(this.shapeMap).forEach(([y,b])=>{const w=`get${(0,e.upperFirst)(y)}Style`,x=this[w];if((0,e.isFunction)(x)){const S=f.map(E=>x.call(this,{...this.attributes,...E})),_=b.animate((0,t.preprocessKeyframes)(S),d);_&&(l(b,_),p.push(_))}});const m=(y,b)=>{if(!(0,e.isEmpty)(y)){const w=`get${(0,e.upperFirst)(b)}Style`,x=this[w];if((0,e.isFunction)(x)){const S=f.map(_=>x.call(this,{...this.attributes,..._}));Object.entries(S[0]).map(([_])=>{const E=S.map(O=>O[_]),P=y[_];if(P){const O=P.animate((0,t.preprocessKeyframes)(E),d);O&&(l(P,O),p.push(O))}})}}};this.compositeShapes.forEach(([y,b])=>{const w=(0,i.subObject)(this.shapeMap,b);m(w,y)})}}return(0,t.createAnimationsProxy)(p)}getShape(f){return this.shapeMap[f]}setVisibility(){const{visibility:f}=this.attributes;(0,o.setVisibility)(this,f)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}ll.BaseShape=c;function l(u,h){h.oncancel=()=>console.log("cancel"),h==null||h.finished.then(()=>{const f=u.activeAnimations.findIndex(d=>d===h);f>-1&&u.activeAnimations.splice(f,1)})}return ll}var ul={},c6;function $_(){if(c6)return ul;c6=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.Label=void 0;const n=Pe,e=qs,t=Ie,r=Ne,i=Lh(),s=class s extends i.BaseShape{constructor(c){super((0,r.mergeOptions)({style:s.defaultStyleProps},c))}isTextStyle(c){return(0,t.startsWith)(c,"label")}isBackgroundStyle(c){return(0,t.startsWith)(c,"background")}getTextStyle(c){const{padding:l,...u}=this.getGraphicStyle(c);return(0,t.omitStyleProps)(u,"background")}getBackgroundStyle(c){if(c.background===!1)return!1;const l=this.getGraphicStyle(c),{wordWrap:u,wordWrapWidth:h,padding:f}=l,d=(0,t.subStyleProps)(l,"background"),{min:[p,g],center:[v,m],halfExtents:[y,b]}=this.shapeMap.text.getGeometryBounds(),[w,x,S,_]=(0,e.parsePadding)(f),E=y*2+_+x,{width:P,height:O}=d;P&&O?Object.assign(d,{x:v-Number(P)/2,y:m-Number(O)/2}):Object.assign(d,{x:p-_,y:g-w,width:u?Math.min(E,h+_+x):E,height:b*2+w+S});const{radius:C}=d;if(typeof C=="string"&&C.endsWith("%")){const M=Number(C.replace("%",""))/100;d.radius=Math.min(+d.width,+d.height)*M}return d}render(c=this.parsedAttributes,l=this){this.upsert("text",n.Text,this.getTextStyle(c),l),this.upsert("background",n.Rect,this.getBackgroundStyle(c),l)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}};A(s,"defaultStyleProps",{padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0});let a=s;return ul.Label=a,ul}var l6;function h0t(){if(l6)return cl;l6=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.Badge=void 0;const n=Ne,e=Lh(),t=$_(),i=class i extends e.BaseShape{constructor(s){super((0,n.mergeOptions)({style:i.defaultStyleProps},s))}getBadgeStyle(s){return this.getGraphicStyle(s)}render(s=this.parsedAttributes,o=this){this.upsert("label",t.Label,this.getBadgeStyle(s),o)}getGeometryBounds(){const s=this.getShape("label");return(s.getShape("background")||s.getShape("text")).getGeometryBounds()}};A(i,"defaultStyleProps",{padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1});let r=i;return cl.Badge=r,cl}var hl={},z_={};Object.defineProperty(z_,"__esModule",{value:!0});z_.getPolygonTextStyleByPlacement=g0t;const f0t=bt,d0t=Pi,u6=It,p0t=Un;function g0t(n,e,t,r,i,a,s){const[o,c]=(0,p0t.getXYByPlacement)(n,e),l={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:`translate(${o+t}, ${c+r})`};if(e==="center"||!i)return l;const u=(0,d0t.pathToPoints)(a);if(!u||u.length<=3)return l;const h=u.map((p,g)=>{const v=p,m=u[(g+1)%u.length];return(0,f0t.isEqual)(v,m)?null:[v,m]}).filter(Boolean),f=(0,u6.findNearestLine)([o,c],h),d=(0,u6.findNearestPointOnLine)([o,c],f);if(d&&f&&(l.transform=`translate(${d[0]+t}, ${d[1]+r})`,s)){const p=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));l.transform+=`rotate(${p/Math.PI*180}deg)`,l.textAlign="center",(e==="right"||e==="left")&&(p>0?l.textBaseline=e==="right"?"bottom":"top":l.textBaseline=e==="right"?"top":"bottom")}return l}var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.getWordWrapWidthWithBase=j_;var v0t=Ws.getWordWrapWidthByBox=y0t;Ws.getWordWrapWidthByEnds=b0t;const m0t=Kt;function j_(n,e){let t=2*n;return typeof e=="string"?t=n*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*n),t}function y0t(n,e,t=1,r=!1){const i=r?t:1,a=(n.max[0]-n.min[0])*i;return j_(a,e)}function b0t(n,e,t=1){const r=(0,m0t.distance)(n[0],n[1])*t;return j_(r,e)}var h6;function E0t(){if(h6)return hl;h6=1,Object.defineProperty(hl,"__esModule",{value:!0}),hl.Contour=void 0;const n=Pe,e=z_,t=Ie,r=Ne,i=Ws,a=Lh(),s=$_(),c=class c extends a.BaseShape{constructor(u){super((0,r.mergeOptions)({style:c.defaultStyleProps},u))}getLabelStyle(u){if(!u.label||!u.d||u.d.length===0)return!1;const{maxWidth:h,offsetX:f,offsetY:d,autoRotate:p,placement:g,closeToPath:v,...m}=(0,t.subStyleProps)(this.getGraphicStyle(u),"label"),y=this.shapeMap.key,b=y==null?void 0:y.getRenderBounds();return Object.assign((0,e.getPolygonTextStyleByPlacement)(b,g,f,d,v,u.d,p),{wordWrapWidth:(0,i.getWordWrapWidthByBox)(b,h)},m)}getKeyStyle(u){return this.getGraphicStyle(u)}render(u,h){this.upsert("key",n.Path,this.getKeyStyle(u),h),this.upsert("label",s.Label,this.getLabelStyle(u),h)}};A(c,"defaultStyleProps",{label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0});let o=c;return hl.Contour=o,hl}var fl={},f6;function x0t(){if(f6)return fl;f6=1,Object.defineProperty(fl,"__esModule",{value:!0}),fl.Icon=void 0;const n=Pe,e=Lh();class t extends e.BaseShape{constructor(i){super(i)}isGImage(){return!!this.getAttribute("src")}getIconStyle(i=this.attributes){const{width:a=0,height:s=0}=i,o=this.getGraphicStyle(i);return this.isGImage()?{x:-a/2,y:-s/2,...o}:{textBaseline:"middle",textAlign:"center",...o}}render(i=this.attributes,a=this){this.upsert("icon",this.isGImage()?n.Image:n.Text,this.getIconStyle(i),a)}}return fl.Icon=t,fl}var d6;function Hs(){return d6||(d6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Label=n.Icon=n.Contour=n.BaseShape=n.Badge=void 0;var e=h0t();Object.defineProperty(n,"Badge",{enumerable:!0,get:function(){return e.Badge}});var t=Lh();Object.defineProperty(n,"BaseShape",{enumerable:!0,get:function(){return t.BaseShape}});var r=E0t();Object.defineProperty(n,"Contour",{enumerable:!0,get:function(){return r.Contour}});var i=x0t();Object.defineProperty(n,"Icon",{enumerable:!0,get:function(){return i.Icon}});var a=$_();Object.defineProperty(n,"Label",{enumerable:!0,get:function(){return a.Label}})}(sx)),sx}var p6;function w0t(){if(p6)return ol;p6=1,Object.defineProperty(ol,"__esModule",{value:!0}),ol.BubbleSets=void 0;const n=bt,e=u0t,t=Ft,r=Hs(),i=de,a=Nh,s=Gt,o=Pi,c=It,l=Yn(),d=class d extends l.BasePlugin{constructor(v,m){super(v,(0,n.deepMix)({},d.defaultOptions,m));A(this,"shape");A(this,"bubbleSets");A(this,"path");A(this,"members",new Map);A(this,"avoidMembers",new Map);A(this,"bubbleSetOptions",{});A(this,"drawBubbleSets",()=>{const{style:v,bubbleSetOptions:m}=this.parseOptions();(0,n.isEqual)(this.bubbleSetOptions,m)||this.init(),this.bubbleSetOptions={...m};const y={...v,d:this.getPath()};this.shape?this.shape.update(y):(this.shape=new r.Contour({style:y}),this.context.canvas.appendChild(this.shape))});A(this,"updateBubbleSetsPath",v=>{if(!this.shape)return;const m=(0,s.idOf)(v.data);[...this.options.members,...this.options.avoidMembers].includes(m)&&this.shape.update({...this.parseOptions().style,d:this.getPath(m)})});A(this,"getPath",v=>{const{graph:m}=this.context,y=this.options.members,b=[...this.members.keys()],w=this.options.avoidMembers,x=[...this.avoidMembers.keys()];if(!v&&(0,n.isEqual)(y,b)&&(0,n.isEqual)(w,x))return this.path;const{enter:S=[],exit:_=[]}=(0,a.arrayDiff)(b,y,T=>T),{enter:E=[],exit:P=[]}=(0,a.arrayDiff)(x,w,T=>T);v&&(_.push(v),S.push(v));const O=(T,R,D)=>{T.forEach(B=>{const j=D?this.members:this.avoidMembers,L=D?"pushMember":"pushNonMember",$=D?"removeMember":"removeNonMember";if(R){let V;m.getElementType(B)==="edge"?([V]=f(m,B),this.bubbleSets.pushEdge(V)):([V]=h(m,B),this.bubbleSets[L](V)),j.set(B,V)}else{const V=j.get(B);V&&(m.getElementType(B)==="edge"?this.bubbleSets.removeEdge(V):this.bubbleSets[$](V),j.delete(B))}})};O(_,!1,!0),O(S,!0,!0),O(P,!1,!1),O(E,!0,!1);const M=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=(0,o.getClosedSpline)(M.points.map(c.parsePoint)),this.path});this.bindEvents(),this.bubbleSets=new e.BubbleSets(this.options)}bindEvents(){this.context.graph.on(t.GraphEvent.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new e.BubbleSets(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const{type:v,key:m,members:y,avoidMembers:b,...w}=this.options,x=Object.keys(w).reduce((S,_)=>(_ in e.defaultOptions?S.bubbleSetOptions[_]=w[_]:S.style[_]=w[_],S),{style:{},bubbleSetOptions:{}});return{type:v,key:m,members:y,avoidMembers:b,...x}}addMember(v){const m=Array.isArray(v)?v:[v];m.some(y=>this.options.avoidMembers.includes(y))&&(this.options.avoidMembers=this.options.avoidMembers.filter(y=>!m.includes(y))),this.options.members=[...new Set([...this.options.members,...m])],this.drawBubbleSets()}removeMember(v){const m=Array.isArray(v)?v:[v];this.options.members=this.options.members.filter(y=>!m.includes(y)),this.drawBubbleSets()}updateMember(v){this.options.members=(0,n.isFunction)(v)?v(this.options.members):v,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(v){const m=Array.isArray(v)?v:[v];m.some(y=>this.options.members.includes(y))&&(this.options.members=this.options.members.filter(y=>!m.includes(y))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...m])],this.drawBubbleSets()}removeAvoidMember(v){const m=Array.isArray(v)?v:[v];this.options.avoidMembers.some(y=>m.includes(y))&&(this.options.avoidMembers=this.options.avoidMembers.filter(y=>!m.includes(y)),this.drawBubbleSets())}updateAvoidMember(v){this.options.avoidMembers=Array.isArray(v)?v:[v],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(t.GraphEvent.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}};A(d,"defaultOptions",{members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2,...e.defaultOptions});let u=d;ol.BubbleSets=u;const h=(p,g)=>(Array.isArray(g)?g:[g]).map(m=>{const y=p.getElementRenderBounds(m);return new e.Rectangle(y.min[0],y.min[1],(0,i.getBBoxWidth)(y),(0,i.getBBoxHeight)(y))}),f=(p,g)=>(Array.isArray(g)?g:[g]).map(m=>{const y=p.getEdgeData(m),b=p.getElementPosition(y.source),w=p.getElementPosition(y.target);return e.Line.from({x1:b[0],y1:b[1],x2:w[0],y2:w[1]})});return ol}var dl={},g6;function S0t(){if(g6)return dl;g6=1,Object.defineProperty(dl,"__esModule",{value:!0}),dl.CameraSetting=void 0;const n=Ft,e=Yn();class t extends e.BasePlugin{constructor(a,s){super(a,s);A(this,"setOptions",a=>{const s={cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"},o=(c,l)=>{switch(c){case"projectionMode":return l==="perspective"?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[l];case"aspect":return typeof l=="number"?l:this.getCanvasAspect();default:return l}};Object.entries(s).forEach(([c,l])=>{const u=a[c];if(u!==void 0){const h=o(c,u);this.context.canvas.getCamera()[l](h)}})});this.bindEvents()}update(a){this.setOptions(a),super.update(a)}bindEvents(){this.context.graph.once(n.GraphEvent.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[a,s]=this.context.viewport.getCanvasSize();return a/s}}return dl.CameraSetting=t,dl}var pl={},Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.CONTEXTMENU_CSS=void 0;Ih.getContentFromItems=_0t;function _0t(n){return`
    <ul class="g6-contextmenu-ul">
      ${n.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}Ih.CONTEXTMENU_CSS=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var v6;function O0t(){if(v6)return pl;v6=1,Object.defineProperty(pl,"__esModule",{value:!0}),pl.Contextmenu=void 0;const n=ni,e=Yn(),t=Ih,i=class i extends e.BasePlugin{constructor(o,c){super(o,Object.assign({},i.defaultOptions,c));A(this,"$element");A(this,"onTriggerEvent",o=>{var c;(c=o.preventDefault)==null||c.call(o),this.show(o)});A(this,"onMenuItemClick",o=>{const{onClick:c,trigger:l}=this.options;if(o.target instanceof HTMLElement&&o.target.className.includes("g6-contextmenu-li")){const u=o.target.getAttribute("value");c==null||c(u,o.target),this.hide()}l!=="click"&&this.hide()});this.initElement(),this.update(c)}initElement(){this.$element=(0,n.createPluginContainer)("contextmenu",!1);const{className:o}=this.options;o&&this.$element.classList.add(o),this.context.canvas.getContainer().appendChild(this.$element),(0,n.insertDOM)("g6-contextmenu-css","style",{},t.CONTEXTMENU_CSS,document.head)}async show(o){const{enable:c,offset:l}=this.options;if(typeof c=="function"&&!c(o)||!c){this.hide();return}const u=await this.getDOMContent(o);u instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(u)):this.$element.innerHTML=u;const h=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${o.client.x-h.left+l[0]}px`,this.$element.style.top=`${o.client.y-h.top+l[1]}px`,this.$element.style.display="block"}hide(){this.$element.style.display="none"}update(o){this.unbindEvents(),super.update(o),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}async getDOMContent(o){const{getContent:c,getItems:l}=this.options;return l?(0,t.getContentFromItems)(await l(o)):await c(o)}bindEvents(){const{graph:o}=this.context,{trigger:c}=this.options;o.on(`canvas:${c}`,this.onTriggerEvent),o.on(`node:${c}`,this.onTriggerEvent),o.on(`edge:${c}`,this.onTriggerEvent),o.on(`combo:${c}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:o}=this.context,{trigger:c}=this.options;o.off(`canvas:${c}`,this.onTriggerEvent),o.off(`node:${c}`,this.onTriggerEvent),o.off(`edge:${c}`,this.onTriggerEvent),o.off(`combo:${c}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}};A(i,"defaultOptions",{trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0});let r=i;return pl.Contextmenu=r,pl}var gl={},m6;function P0t(){if(m6)return gl;m6=1,Object.defineProperty(gl,"__esModule",{value:!0}),gl.Fullscreen=void 0;const n=hr,e=Oi,t=Yn(),a=class a extends t.BasePlugin{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"shortcut");A(this,"style");A(this,"$el",this.context.canvas.getContainer());A(this,"graphSize",[0,0]);A(this,"onFullscreenChange",()=>{var l,u,h,f;const c=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(c),c?(u=(l=this.options).onEnter)==null||u.call(l):(f=(h=this.options).onExit)==null||f.call(h)});this.shortcut=new e.Shortcut(c.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:c=[],exit:l=[]}=this.options.trigger;this.shortcut.bind(c,this.request),this.shortcut.bind(l,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(h=>{document.addEventListener(h,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(l=>{document.removeEventListener(l,this.onFullscreenChange,!1)})}setGraphSize(c=!0){let l,u;c?(l=window.screen.width,u=window.screen.height,this.graphSize=this.context.graph.getSize()):[l,u]=this.graphSize,this.context.graph.setSize(l,u),this.context.graph.render()}request(){document.fullscreenElement||!i()||this.$el.requestFullscreen().catch(c=>{n.print.warn(`Error attempting to enable full-screen: ${c.message} (${c.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(c){this.unbindEvents(),super.update(c),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}};A(a,"defaultOptions",{trigger:{},autoFit:!0});let r=a;gl.Fullscreen=r;function i(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}return gl}var vl={},y6;function C0t(){if(y6)return vl;y6=1,Object.defineProperty(vl,"__esModule",{value:!0}),vl.GridLine=void 0;const n=Ft,e=ni,t=Kt,r=Yn(),a=class a extends r.BasePlugin{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"$element",(0,e.createPluginContainer)("grid-line"));A(this,"offset",[0,0]);A(this,"onTransform",c=>{if(!this.options.follow)return;const{data:{translate:l}}=c;l&&this.updateOffset(l)});const u=this.context.canvas.getContainer();(0,e.insertBefore)(u,this.$element),this.updateStyle(),this.bindEvents()}update(c){super.update(c),this.updateStyle()}bindEvents(){const{graph:c}=this.context;c.on(n.GraphEvent.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:c,stroke:l,lineWidth:u,border:h,borderLineWidth:f,borderStroke:d,borderStyle:p}=this.options;Object.assign(this.$element.style,{border:h?`${f}px ${p} ${d}`:"none",backgroundImage:`linear-gradient(${l} ${u}px, transparent ${u}px), linear-gradient(90deg, ${l} ${u}px, transparent ${u}px)`,backgroundSize:`${c}px ${c}px`})}updateOffset(c){this.offset=(0,t.mod)((0,t.add)(this.offset,c),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(n.GraphEvent.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}};A(a,"defaultOptions",{border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"});let i=a;return vl.GridLine=i,vl}var ml={};const U9=Zr(VY);var yl={},Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.reduceDataChanges=A0t;Pc.groupByChangeType=N0t;const M0t=bt,T0t=Gt;function A0t(n){const e={Added:new Map,Updated:new Map,Removed:new Map};return n.forEach(t=>{const{type:r,value:i}=t,a=(0,T0t.idOf)(i);if(r==="NodeAdded"||r==="EdgeAdded"||r==="ComboAdded")e.Added.set(a,t);else if(r==="NodeUpdated"||r==="EdgeUpdated"||r==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:r.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:s}=e.Updated.get(a);e.Updated.set(a,{type:r,value:i,original:s})}else e.Removed.has(a)||e.Updated.set(a,t);else(r==="NodeRemoved"||r==="EdgeRemoved"||r==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function N0t(n){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:c=[],ComboRemoved:l=[]}=(0,M0t.groupBy)(n,u=>u.type);return{add:{nodes:e,edges:i,combos:o},update:{nodes:t,edges:a,combos:c},remove:{nodes:r,edges:s,combos:l}}}var b6;function R0t(){if(b6)return yl;b6=1,Object.defineProperty(yl,"__esModule",{value:!0}),yl.alignFields=i,yl.parseCommand=a;const n=bt,e=_c(),t=Pc,r=Gt;function i(s,o){for(const c in s)(0,n.isObject)(s[c])&&!Array.isArray(s[c])&&s[c]!==null?(o[c]||(o[c]={}),i(s[c],o[c])):o[c]||(o[c]=(0,e.inferDefaultValue)(c))}function a(s,o=!1,c){const l={animation:o,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:u,update:h,remove:f}=(0,t.groupByChangeType)((0,t.reduceDataChanges)(s));return["nodes","edges","combos"].forEach(d=>{h[d]&&h[d].forEach(p=>{var m,y;const g={...p.value};let v={...p.original};if(c){const b=c.graph.getElementType((0,r.idOf)(p.original)),w=b==="edge"?"stroke":"fill",x=c.element.getElementComputedStyle(b,p.original);v={...p.original,style:{[w]:x[w],...p.original.style}}}i(g,v),(m=l.current.update)[d]||(m[d]=[]),l.current.update[d].push(g),(y=l.original.update)[d]||(y[d]=[]),l.original.update[d].push(v)}),u[d]&&u[d].forEach(p=>{var v,m;const g={...p.value};(v=l.current.add)[d]||(v[d]=[]),l.current.add[d].push(g),(m=l.original.remove)[d]||(m[d]=[]),l.original.remove[d].push(g)}),f[d]&&f[d].forEach(p=>{var v,m;const g={...p.value};(v=l.current.remove)[d]||(v[d]=[]),l.current.remove[d].push(g),(m=l.original.add)[d]||(m[d]=[]),l.original.add[d].push(g)})}),l}return yl}var E6;function k0t(){if(E6)return ml;E6=1;var n=jt&&jt.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(ml,"__esModule",{value:!0}),ml.History=void 0;const e=n(U9),t=Ft,r=Th,i=Gt,a=Yn(),s=R0t(),c=class c extends a.BasePlugin{constructor(h,f){super(h,Object.assign({},c.defaultOptions,f));A(this,"emitter");A(this,"batchChanges",null);A(this,"batchAnimation",!1);A(this,"undoStack",[]);A(this,"redoStack",[]);A(this,"freezed",!1);A(this,"executeCommand",(h,f=!0)=>{var p,g,v;this.freezed=!0,(g=(p=this.options).executeCommand)==null||g.call(p,h);const d=f?h.original:h.current;this.context.graph.addData(d.add),this.context.graph.updateData(d.update),this.context.graph.removeData((0,i.idsOf)(d.remove,!1)),(v=this.context.element)==null||v.draw({silence:!0,animation:h.animation}),this.freezed=!1});A(this,"addCommand",h=>{var f;if(!this.freezed){if(h.type===t.GraphEvent.AFTER_DRAW){const{dataChanges:d=[],animation:p=!0}=h.data;if((f=this.context.batch)!=null&&f.isBatching){if(!this.batchChanges)return;this.batchChanges.push(d),this.batchAnimation&&(this.batchAnimation=p);return}this.batchChanges=[d],this.batchAnimation=p}this.undoStackPush((0,s.parseCommand)(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(r.HistoryEvent.ADD,this.undoStack[this.undoStack.length-1])}});A(this,"initBatchCommand",h=>{const{initiate:f}=h.data;this.batchAnimation=!1,f?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)});this.emitter=new e.default;const{graph:d}=this.context;d.on(t.GraphEvent.AFTER_DRAW,this.addCommand),d.on(t.GraphEvent.BATCH_START,this.initBatchCommand),d.on(t.GraphEvent.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var f,d,p,g;const h=this.undoStack.pop();if(h){if(this.executeCommand(h),((d=(f=this.options).beforeAddCommand)==null?void 0:d.call(f,h,!1))===!1)return;this.redoStack.push(h),(g=(p=this.options).afterAddCommand)==null||g.call(p,h,!1),this.notify(r.HistoryEvent.UNDO,h)}return this}redo(){const h=this.redoStack.pop();return h&&(this.executeCommand(h,!1),this.undoStackPush(h),this.notify(r.HistoryEvent.REDO,h)),this}undoAndCancel(){const h=this.undoStack.pop();return h&&(this.executeCommand(h,!1),this.redoStack=[],this.notify(r.HistoryEvent.CANCEL,h)),this}undoStackPush(h){var p,g,v,m;const{stackSize:f}=this.options;f!==0&&this.undoStack.length>=f&&this.undoStack.shift(),((g=(p=this.options).beforeAddCommand)==null?void 0:g.call(p,h,!0))!==!1&&(this.undoStack.push(h),(m=(v=this.options).afterAddCommand)==null||m.call(v,h,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(r.HistoryEvent.CLEAR,null)}notify(h,f){this.emitter.emit(h,{cmd:f}),this.emitter.emit(r.HistoryEvent.CHANGE,{cmd:f})}on(h,f){this.emitter.on(h,f)}destroy(){const{graph:h}=this.context;h.off(t.GraphEvent.AFTER_DRAW,this.addCommand),h.off(t.GraphEvent.BATCH_START,this.initBatchCommand),h.off(t.GraphEvent.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}};A(c,"defaultOptions",{stackSize:0});let o=c;return ml.History=o,ml}var bl={},q_={};Object.defineProperty(q_,"__esModule",{value:!0});q_.computeHullPath=I0t;const D0t=Rh,L0t=Pi,Y9=It,xt=Kt;function I0t(n,e,t){if(n.length===1)return B0t(n[0],e,t);if(n.length===2)return F0t(n,e,t);switch(t){case"smooth":return z0t(n,e);case"sharp":return j0t(n,e);case"rounded":default:return $0t(n,e)}}const B0t=(n,e,t)=>{if(t==="sharp")return[["M",n[0]-e,n[1]-e],["L",n[0]+e,n[1]-e],["L",n[0]+e,n[1]+e],["L",n[0]-e,n[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",n[0],n[1]-e],["A",...r,n[0],n[1]+e],["A",...r,n[0],n[1]-e]]},F0t=(n,e,t)=>{const r=[e,e,0,0,0],i=t==="sharp"?(0,xt.add)(n[0],(0,xt.scale)((0,xt.normalize)((0,xt.subtract)(n[0],n[1])),e)):n[0],a=t==="sharp"?(0,xt.add)(n[1],(0,xt.scale)((0,xt.normalize)((0,xt.subtract)(n[1],n[0])),e)):n[1],s=(0,xt.scale)((0,xt.normalize)((0,xt.perpendicular)((0,xt.subtract)(i,a),!1)),e),o=(0,xt.scale)(s,-1),c=(0,xt.add)(i,s),l=(0,xt.add)(a,s),u=(0,xt.add)(a,o),h=(0,xt.add)(i,o);return t==="sharp"?[["M",c[0],c[1]],["L",l[0],l[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",c[0],c[1]],["L",l[0],l[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,c[0],c[1]]]},$0t=(n,e)=>{const t=(0,Y9.sortByClockwise)(n).map((o,c)=>{const l=(c-2+n.length)%n.length,u=(c-1+n.length)%n.length,h=(c+1)%n.length,f=n[l],d=n[u],p=n[h],g=(0,xt.subtract)(f,d),v=(0,xt.subtract)(d,o),m=(0,xt.subtract)(o,p),y=(_,E)=>(0,xt.angle)(_,E,!0)<Math.PI,b=y(g,v),w=y(v,m),x=_=>(0,xt.scale)((0,xt.normalize)((0,xt.perpendicular)(_,!1)),e),S=x(v);return[{p:(0,xt.toVector2)(b?(0,xt.add)(d,x(g)):(0,xt.add)(d,S)),concave:b&&d},{p:(0,xt.toVector2)(w?(0,xt.add)(o,x(m)):(0,xt.add)(o,S)),concave:w&&o}]}),r=[e,e,0,0,0],i=t.findIndex((o,c)=>!t[(c-1+t.length)%t.length][0].concave&&!t[(c-1+t.length)%t.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=t.slice(i).concat(t.slice(0,i));let s=[];return a.flatMap((o,c)=>{const l=[],u=a[t.length-1];return c===0&&l.push(["M",...u[1].p]),o[0].concave?s.push(o[0].p,o[1].p):l.push(["A",...r,...o[0].p]),o[1].concave?s.unshift(o[1].p):l.push(["L",...o[1].p]),s.length===3&&(l.pop(),l.push(["C",...s.flat()]),s=[]),l})},z0t=(n,e)=>{const t=(0,Y9.sortByClockwise)(n).map((r,i)=>{const a=n[(i+1)%n.length];return{p:r,v:(0,xt.normalize)((0,xt.subtract)(a,r))}});return t.forEach((r,i)=>{const a=i>0?i-1:n.length-1,s=t[a].v,o=(0,xt.normalize)((0,xt.add)(s,(0,xt.scale)(r.v,(0,xt.angle)(s,r.v,!0)<Math.PI?1:-1)));r.p=(0,xt.add)(r.p,(0,xt.scale)(o,e))}),(0,L0t.getClosedSpline)(t.map(r=>r.p))},j0t=(n,e)=>{const r=n.map((a,s)=>{const o=n[s===0?n.length-1:s-1],c=(0,xt.toVector3)((0,xt.scale)((0,xt.normalize)((0,xt.perpendicular)((0,xt.subtract)(o,a),!1)),e));return[(0,xt.add)(o,c),(0,xt.add)(a,c)]}).flat();return r.map((a,s)=>{if(s%2===0)return null;const o=[r[(s-1)%r.length],r[s%r.length]],c=[r[(s+1)%r.length],r[(s+2)%r.length]];return(0,D0t.getLinesIntersection)(o,c,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])};var x6;function q0t(){if(x6)return bl;x6=1;var n=jt&&jt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(bl,"__esModule",{value:!0}),bl.Hull=void 0;const e=bt,t=n(FB),r=Ft,i=Hs(),a=Gt,s=Un,o=Yn(),c=q_,u=class u extends o.BasePlugin{constructor(d,p){super(d,Object.assign({},u.defaultOptions,p));A(this,"shape");A(this,"hullMemberIds",[]);A(this,"path");A(this,"optionsCache");A(this,"drawHull",()=>{if(!this.shape)this.shape=new i.Contour({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const d=!(0,e.isEqual)(this.optionsCache,this.options);this.shape.update(this.getHullStyle(d))}this.optionsCache={...this.options}});A(this,"updateHullPath",d=>{this.shape&&this.options.members.includes((0,a.idOf)(d.data))&&this.shape.update({d:this.getHullPath(!0)})});A(this,"getHullPath",(d=!1)=>{const{graph:p}=this.context,g=this.getMember();if(g.length===0)return"";const v=g.map(b=>p.getNodeData(b)),m=(0,t.default)(v.map(s.positionOf),this.options.concavity).slice(1).reverse(),y=m.flatMap(b=>v.filter(w=>(0,e.isEqual)((0,s.positionOf)(w),b)).map(a.idOf));return(0,e.isEqual)(y,this.hullMemberIds)&&!d?this.path:(this.hullMemberIds=y,this.path=(0,c.computeHullPath)(m,this.getPadding(),this.options.corner),this.path)});this.bindEvents()}bindEvents(){this.context.graph.on(r.GraphEvent.AFTER_RENDER,this.drawHull),this.context.graph.on(r.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(d){const{members:p,padding:g,corner:v,...m}=this.options;return{...m,d:this.getHullPath(d)}}getPadding(){const{graph:d}=this.context;return this.hullMemberIds.reduce((g,v)=>{const{halfExtents:m}=d.getElementRenderBounds(v),y=Math.max(m[0],m[1]);return Math.max(g,y)},0)+this.options.padding}addMember(d){const p=Array.isArray(d)?d:[d];this.options.members=[...new Set([...this.options.members,...p])],this.shape.update({d:this.getHullPath()})}removeMember(d){const p=Array.isArray(d)?d:[d];this.options.members=this.options.members.filter(g=>!p.includes(g)),p.some(g=>this.hullMemberIds.includes(g))&&this.shape.update({d:this.getHullPath()})}updateMember(d){this.options.members=(0,e.isFunction)(d)?d(this.options.members):d,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(r.GraphEvent.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}};A(u,"defaultOptions",{members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2});let l=u;return bl.Hull=l,bl}var El={};const G_=Zr(vft);var w6;function G0t(){if(w6)return El;w6=1,Object.defineProperty(El,"__esModule",{value:!0}),El.Legend=void 0;const n=G_,e=bt,t=Ft,r=Yn(),a=class a extends r.BasePlugin{constructor(c,l){super(c,Object.assign({},a.defaultOptions,l));A(this,"typePrefix","__data__");A(this,"element",null);A(this,"draw",!1);A(this,"fieldMap",{node:new Map,edge:new Map,combo:new Map});A(this,"selectedItems",[]);A(this,"bindEvents",()=>{const{graph:c}=this.context;c.on(t.GraphEvent.AFTER_DRAW,this.createElement)});A(this,"changeState",(c,l)=>{const{graph:u}=this.context,{typePrefix:h}=this,f=(0,e.get)(c,[h,"id"]),d=(0,e.get)(c,[h,"style","labelText"]),[p]=f.split("__"),g=this.fieldMap[p].get(d)||[];u.setElementState(Object.fromEntries(g==null?void 0:g.map(v=>[v,l])))});A(this,"click",c=>{if(this.options.trigger==="hover")return;const l=(0,e.get)(c,[this.typePrefix,"id"]);this.selectedItems.includes(l)?(this.selectedItems=this.selectedItems.filter(u=>u!==l),this.changeState(c,[])):(this.selectedItems.push(l),this.changeState(c,"selected"))});A(this,"mouseleave",c=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(c,[]))});A(this,"mouseenter",c=>{if(this.options.trigger==="click")return;const l=(0,e.get)(c,[this.typePrefix,"id"]);this.selectedItems.includes(l)?this.selectedItems=this.selectedItems.filter(u=>u!==l):(this.selectedItems.push(l),this.changeState(c,"active"))});A(this,"setFieldMap",(c,l,u)=>{if(!c)return;const h=this.fieldMap[u];if(h)if(!h.has(c))h.set(c,[l]);else{const f=h.get(c);f&&(f.push(l),h.set(c,f))}});A(this,"getEvents",()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}));A(this,"getMarkerData",(c,l)=>{if(!c)return[];const{model:u,element:h,graph:f}=this.context,{nodes:d,edges:p,combos:g}=u.getData(),v={},m=S=>(0,e.isFunction)(c)?c(S):c,y={node:"circle",edge:"line",combo:"rect"},b={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},w=(S,_)=>h==null?void 0:h.getElementComputedStyle(S,_),x=(S,_)=>{S.forEach(E=>{const{id:P}=E,O=(0,e.get)(E,["data",m(E)]),C=(h==null?void 0:h.getElementType(_,E))||"circle",M=w(_,E),T=(_==="edge"?M==null?void 0:M.stroke:M==null?void 0:M.fill)||"#1783ff";P&&O&&O.replace(/\s+/g,"")&&(this.setFieldMap(O,P,_),v[O]||(v[O]={id:`${_}__${P}`,label:O,marker:b[C]||y[_],elementType:_,lineWidth:1,stroke:T,fill:T}))})};switch(l){case"node":x(d,"node");break;case"edge":x(p,"edge");break;case"combo":x(g,"combo");break;default:return[]}return Object.values(v)});A(this,"layout",c=>{const l={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"};let{flexDirection:u,alignItems:h,justifyContent:f}=l;const d={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return c in d&&([u,h,f]=d[c]),{display:"flex",flexDirection:u,justifyContent:f,alignItems:h}});A(this,"createElement",()=>{if(this.draw){this.updateElement();return}const{canvas:c}=this.context,[l,u]=c.getSize(),{width:h=l,height:f=u,nodeField:d,edgeField:p,comboField:g,trigger:v,position:m,...y}=this.options,b=this.getMarkerData(d,"node"),w=this.getMarkerData(p,"edge"),x=this.getMarkerData(g,"combo"),S=[...b,...x,...w],_=this.layout(m),E=new n.Layout({style:{width:h,height:f,..._}}),P=Object.assign({width:h,height:f,data:S,itemMarkerLineWidth:({lineWidth:C})=>C,itemMarker:({marker:C})=>C,itemMarkerStroke:({stroke:C})=>C,itemMarkerFill:({fill:C})=>C,gridCol:b.length},y,this.getEvents()),O=new n.Category({className:"legend",style:P});E.appendChild(O),c.appendChild(E),this.element=E,this.draw=!0});this.bindEvents()}update(c){super.update(c),this.clear(),this.createElement()}clear(){var c;(c=this.element)==null||c.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;this.element.getChildByIndex(0).update({itemMarkerOpacity:({id:l})=>!this.selectedItems.length||this.selectedItems.includes(l)?1:.5,itemLabelOpacity:({id:l})=>!this.selectedItems.length||this.selectedItems.includes(l)?1:.5})}destroy(){this.clear(),this.context.graph.off(t.GraphEvent.AFTER_DRAW,this.createElement),super.destroy()}};A(a,"defaultOptions",{position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16});let i=a;return El.Legend=i,El}var xl={};const K9=Zr(cdt);var S6;function V0t(){if(S6)return xl;S6=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.Timebar=void 0;const n=G_,e=Pe,t=K9,r=bt,i=Gt,a=qs,s=Yn(),o=["timestamp","time","date","datetime"],f=class f extends s.BasePlugin{constructor(g,v){super(g,Object.assign({},f.defaultOptions,v));A(this,"timebar");A(this,"canvas");A(this,"wrapper");A(this,"originalData");this.backup(),this.upsertTimebar()}get padding(){return(0,a.parsePadding)(this.options.padding)}play(){var g;(g=this.timebar)==null||g.play()}pause(){var g;(g=this.timebar)==null||g.pause()}forward(){var g;(g=this.timebar)==null||g.forward()}backward(){var g;(g=this.timebar)==null||g.backward()}reset(){var g;(g=this.timebar)==null||g.reset()}update(g){super.update(g),this.backup(),Object.keys(g).forEach(v=>{switch(v){case"position":this.upsertWrapper();break;default:this.upsertTimebar();break}})}backup(){this.originalData=l(this.context.graph.getData())}upsertTimebar(){const{canvas:g}=this.context,{onChange:v,timebarType:m,data:y,x:b,y:w,width:x,height:S,mode:_,...E}=this.options,P=g.getSize(),[O]=this.padding;this.upsertCanvas().ready.then(()=>{var M;const C={x:P[0]/2-x/2,y:O,onChange:T=>{const R=((0,r.isArray)(T)?T:[T,T]).map(D=>(0,r.isDate)(D)?D.getTime():D);this.options.mode==="modify"?this.filterElements(R):this.hiddenElements(R),v==null||v(R)},...E,data:y.map(T=>(0,r.isNumber)(T)?{time:T,value:0}:T),width:x,height:S,type:m};this.timebar?this.timebar.update(C):(this.timebar=new n.Timebar({style:C}),(M=this.canvas)==null||M.appendChild(this.timebar))})}upsertWrapper(){var b;if(!this.wrapper){const w=document.createElement("div");w.style.position="absolute",this.wrapper=w}const{x:g,y:v,className:m,position:y}=this.options;return m&&(this.wrapper.className=m),(0,r.isNumber)(g)||(0,r.isNumber)(v)?Object.assign(this.wrapper.style,{left:`${g??0}px`,top:`${v??0}px`}):Object.assign(this.wrapper.style,{[y==="top"?"bottom":"top"]:"unset",[y==="top"?"top":"bottom"]:"0px"}),(b=this.context.canvas.getContainer())==null||b.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var w,x;const g=this.upsertWrapper();if(this.canvas)return this.canvas;const{height:v}=this.options,[m]=this.context.canvas.getSize(),[y,,b]=this.padding;return this.canvas=new e.Canvas({container:g,width:m,height:v+y+b,renderer:((x=(w=this.context.options).renderer)==null?void 0:x.call(w,"main"))||new t.Renderer,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}async filterElements(g){var S;if(!this.originalData)return;const{elementTypes:v,getTime:m}=this.options,{graph:y,element:b}=this.context,w=l(this.originalData);v.forEach(_=>{const E=`${_}s`;w[E]=(this.originalData[E]||[]).filter(P=>{const O=m(P);return!!u(O,g)})});const x=[...w.nodes,...w.combos].map(_=>(0,i.idOf)(_));w.edges=w.edges.filter(_=>{const E=_.source,P=_.target;return x.includes(E)&&x.includes(P)}),y.setData(w),await((S=b.draw({animation:!1,silence:!0}))==null?void 0:S.finished)}hiddenElements(g){const{graph:v}=this.context,{elementTypes:m,getTime:y}=this.options,b=[],w=[];m.forEach(x=>{var E;const S=`${x}s`;(((E=this.originalData)==null?void 0:E[S])||[]).forEach(P=>{const O=(0,i.idOf)(P),C=y(P);u(C,g)?w.push(O):b.push(O)})}),v.hideElement(b,!1),v.showElement(w,!1)}destroy(){var v,m,y;const{graph:g}=this.context;this.originalData&&g.setData({...this.originalData}),(v=this.timebar)==null||v.destroy(),(m=this.canvas)==null||m.destroy(),(y=this.wrapper)==null||y.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}};A(f,"defaultOptions",{position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:g=>h(g,o,void 0),loop:!1});let c=f;xl.Timebar=c;const l=d=>{const{nodes:p=[],edges:g=[],combos:v=[]}=d;return{nodes:[...p],edges:[...g],combos:[...v]}},u=(d,p)=>{if((0,r.isNumber)(p))return d===p;const[g,v]=p;return d>=g&&d<=v},h=(d,p,g)=>{var v;for(let m=0;m<p.length;m++){const y=p[m],b=(v=d.data)==null?void 0:v[y];if(b)return b}return g};return xl}var wl={},Rs={};Object.defineProperty(Rs,"__esModule",{value:!0});Rs.BUILD_IN_SVG_ICON=Rs.TOOLBAR_CSS=void 0;Rs.parsePositionToStyle=W0t;function W0t(n){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return n.split("-").forEach(r=>{e[r]="8px"}),e.flexDirection=n.startsWith("top")||n.startsWith("bottom")?"row":"column",e}Rs.TOOLBAR_CSS=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`;Rs.BUILD_IN_SVG_ICON=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var _6;function H0t(){if(_6)return wl;_6=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.Toolbar=void 0;const n=ni,e=Yn(),t=Rs,i=class i extends e.BasePlugin{constructor(o,c){super(o,Object.assign({},i.defaultOptions,c));A(this,"$element",(0,n.createPluginContainer)("toolbar",!1));A(this,"onToolbarItemClick",o=>{const{onClick:c}=this.options;if(o.target instanceof Element&&o.target.className.includes("g6-toolbar-item")){const l=o.target.getAttribute("value");c==null||c(l,o.target)}});const l=this.context.canvas.getContainer();this.$element.style.display="flex",l.appendChild(this.$element),(0,n.insertDOM)("g6-toolbar-css","style",{},t.TOOLBAR_CSS,document.head),(0,n.insertDOM)("g6-toolbar-svgicon","div",{display:"none"},t.BUILD_IN_SVG_ICON),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(c)}async update(o){super.update(o);const{className:c,position:l,style:u}=this.options;this.$element.className=`g6-toolbar ${c||""}`,Object.assign(this.$element.style,u,(0,t.parsePositionToStyle)(l)),this.$element.innerHTML=await this.getDOMContent()}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}async getDOMContent(){return(await this.options.getItems()).map(c=>`
          <div class="g6-toolbar-item" value="${c.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${c.id}"></use>
            </svg>
          </div>`).join("")}};A(i,"defaultOptions",{position:"top-left"});let r=i;return wl.Toolbar=r,wl}var Sl={},O6;function U0t(){if(O6)return Sl;O6=1,Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.Tooltip=void 0;const n=G_,e=bt,t=Yn(),i=class i extends t.BasePlugin{constructor(o,c){super(o,Object.assign({},i.defaultOptions,c));A(this,"currentTarget",null);A(this,"tooltipElement",null);A(this,"container",null);A(this,"isEnable",o=>{const{enable:c}=this.options;return typeof c=="function"?c(o):c});A(this,"onClick",o=>{const{target:{id:c}}=o;this.currentTarget===c?(this.currentTarget=null,this.hide(o)):(this.currentTarget=c,this.show(o))});A(this,"onPointerMove",o=>{const{target:c}=o;!this.currentTarget||c.id===this.currentTarget||this.show(o)});A(this,"onPointerLeave",o=>{this.hide(o),this.currentTarget=null});A(this,"onCanvasMove",o=>{this.hide(o),this.currentTarget=null});A(this,"onPointerEnter",o=>{this.show(o)});A(this,"showById",o=>{const c={target:{id:o}};this.show(c)});A(this,"getElementData",(o,c)=>{const{model:l}=this.context;switch(c){case"node":return l.getNodeData([o]);case"edge":return l.getEdgeData([o]);case"combo":return l.getComboData([o]);default:return[]}});A(this,"show",o=>{const{client:c,target:{id:l}}=o,u=this.context.graph.getElementType(l);if(!this.tooltipElement||!this.isEnable(o))return;const{getContent:h,title:f}=this.options;this.currentTarget=l;const d=this.getElementData(l,u);let p,g;if(c)p=c.x,g=c.y;else{const m=(0,e.get)(d,"0.style",{x:0,y:0});p=m.x,g=m.y}let v={};if(h)v.content=h(o,d);else{const m=this.context.graph.getElementRenderStyle(l),y=u==="node"?m.fill:m.stroke;v={title:f||u,data:d.map(b=>({name:"ID",value:b.id||`${b.source} -> ${b.target}`,color:y}))}}this.tooltipElement.update({x:p,y:g,style:{".tooltip":{visibility:"visible"}},...v})});A(this,"hide",o=>{var u;if(!o){(u=this.tooltipElement)==null||u.hide();return}if(!this.tooltipElement||!this.isEnable(o))return;const{client:{x:c,y:l}}=o;this.tooltipElement.hide(c,l)});A(this,"initTooltip",()=>{var _;const{canvas:o}=this.context,{center:c}=o.getBounds(),l=o.getContainer(),{top:u,left:h}=l.getBoundingClientRect(),{style:f,position:d,enterable:p,container:g={x:-h,y:-u},title:v,offset:m}=this.options,[y,b]=c,[w,x]=o.getSize(),S=new n.Tooltip({className:"tooltip",style:{x:y,y:b,container:g,title:v,bounding:{x:0,y:0,width:w,height:x},position:d,enterable:p,offset:m,style:f}});return(_=this.container)==null||_.appendChild(S.HTMLTooltipElement),S});this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(o){var c;this.unbindEvents(),super.update(o),this.tooltipElement&&((c=this.container)==null||c.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:o}=this.context,c=o.getContainer();c&&(this.container=c,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:o}=this.context,c=this.getEvents();Object.keys(c).forEach(l=>{o.off(l,c[l])})}bindEvents(){const{graph:o}=this.context,c=this.getEvents();Object.keys(c).forEach(l=>{o.on(l,c[l])})}destroy(){var o;this.unbindEvents(),this.tooltipElement&&((o=this.container)==null||o.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}};A(i,"defaultOptions",{trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}});let r=i;return Sl.Tooltip=r,Sl}var _l={},C0={};Object.defineProperty(C0,"__esModule",{value:!0});C0.getTextWatermark=Y0t;C0.getImageWatermark=K0t;let uo;function X9(n,e){return uo||(uo=document.createElement("canvas")),uo.width=n,uo.height=e,uo.getContext("2d").clearRect(0,0,n,e),uo}async function Y0t(n,e,t,r){const i=X9(n,e),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:c,textFontSize:l,textFontFamily:u,textFontVariant:h,textFontWeight:f,textAlign:d,textBaseline:p}=r;return a.textAlign=d,a.textBaseline=p,a.translate(n/2,e/2),a.font=`${l}px ${u} ${h} ${f}`,s&&a.rotate(s),o&&(a.globalAlpha=o),c&&(a.fillStyle=c,a.fillText(`${t}`,0,0)),i.toDataURL()}async function K0t(n,e,t,r){const i=X9(n,e),a=i.getContext("2d"),{rotate:s,opacity:o}=r;s&&a.rotate(s),o&&(a.globalAlpha=o);const c=new Image;return c.crossOrigin="anonymous",c.src=t,new Promise(l=>{c.onload=function(){const u=n>c.width?(n-c.width)/2:0,h=e>c.height?(e-c.height)/2:0;a.drawImage(c,0,0,c.width,c.height,u,h,n-u*2,e-h*2),l(i.toDataURL())}})}var P6;function X0t(){if(P6)return _l;P6=1,Object.defineProperty(_l,"__esModule",{value:!0}),_l.Watermark=void 0;const n=ni,e=Yn(),t=C0,i=class i extends e.BasePlugin{constructor(o,c){super(o,Object.assign({},i.defaultOptions,c));A(this,"$element",(0,n.createPluginContainer)("watermark"));this.context.canvas.getContainer().appendChild(this.$element),this.update(c)}async update(o){super.update(o);const{width:c,height:l,text:u,imageURL:h,...f}=this.options;Object.keys(f).forEach(p=>{p.startsWith("background")&&(this.$element.style[p]=o[p])});const d=h?await(0,t.getImageWatermark)(c,l,h,f):await(0,t.getTextWatermark)(c,l,u,f);this.$element.style.backgroundImage=`url(${d})`}destroy(){super.destroy(),this.$element.remove()}};A(i,"defaultOptions",{width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"});let r=i;return _l.Watermark=r,_l}var C6;function Z9(){return C6||(C6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Watermark=n.Tooltip=n.Toolbar=n.Timebar=n.Legend=n.Hull=n.History=n.GridLine=n.Fullscreen=n.Contextmenu=n.CameraSetting=n.BubbleSets=n.BasePlugin=n.Background=void 0;var e=l0t();Object.defineProperty(n,"Background",{enumerable:!0,get:function(){return e.Background}});var t=Yn();Object.defineProperty(n,"BasePlugin",{enumerable:!0,get:function(){return t.BasePlugin}});var r=w0t();Object.defineProperty(n,"BubbleSets",{enumerable:!0,get:function(){return r.BubbleSets}});var i=S0t();Object.defineProperty(n,"CameraSetting",{enumerable:!0,get:function(){return i.CameraSetting}});var a=O0t();Object.defineProperty(n,"Contextmenu",{enumerable:!0,get:function(){return a.Contextmenu}});var s=P0t();Object.defineProperty(n,"Fullscreen",{enumerable:!0,get:function(){return s.Fullscreen}});var o=C0t();Object.defineProperty(n,"GridLine",{enumerable:!0,get:function(){return o.GridLine}});var c=k0t();Object.defineProperty(n,"History",{enumerable:!0,get:function(){return c.History}});var l=q0t();Object.defineProperty(n,"Hull",{enumerable:!0,get:function(){return l.Hull}});var u=G0t();Object.defineProperty(n,"Legend",{enumerable:!0,get:function(){return u.Legend}});var h=V0t();Object.defineProperty(n,"Timebar",{enumerable:!0,get:function(){return h.Timebar}});var f=H0t();Object.defineProperty(n,"Toolbar",{enumerable:!0,get:function(){return f.Toolbar}});var d=U0t();Object.defineProperty(n,"Tooltip",{enumerable:!0,get:function(){return d.Tooltip}});var p=X0t();Object.defineProperty(n,"Watermark",{enumerable:!0,get:function(){return p.Watermark}})}(ax)),ax}var Q9={},M0={},T0={};Object.defineProperty(T0,"__esModule",{value:!0});T0.create=tvt;const Z0t=["#7E92B5","#F4664A","#FFBE3A"],Q0t={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},J0t={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function tvt(n){const{bgColor:e,textColor:t,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:c=.06,nodeIconOpacityInactive:l=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=Z0t,nodePaletteOptions:f=Q0t,edgeColor:d,edgeColorDisabled:p,edgePaletteOptions:g=J0t,comboColor:v,comboColorDisabled:m,comboStroke:y,comboStrokeDisabled:b,edgeColorInactive:w}=n;return{background:e,node:{palette:f,style:{badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:l,labelFill:t,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:c,fill:i,fillOpacity:c,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:c}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:w,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:v,halo:!1,haloLineWidth:12,haloStroke:y,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:y},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}Object.defineProperty(M0,"__esModule",{value:!0});M0.dark=void 0;const evt=T0,nvt={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},rvt={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:nvt,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"};M0.dark=(0,evt.create)(rvt);var A0={};Object.defineProperty(A0,"__esModule",{value:!0});A0.light=void 0;const ivt=T0,avt={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"};A0.light=(0,ivt.create)(avt);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.light=n.dark=void 0;var e=M0;Object.defineProperty(n,"dark",{enumerable:!0,get:function(){return e.dark}});var t=A0;Object.defineProperty(n,"light",{enumerable:!0,get:function(){return t.light}})})(Q9);var ox={},Ol={},Pl={},M6;function Us(){if(M6)return Pl;M6=1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.BaseTransform=void 0;const n=Oc();class e extends n.BaseExtension{beforeDraw(r,i){return r}}return Pl.BaseTransform=e,Pl}var T6;function svt(){if(T6)return Ol;T6=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.ArrangeDrawOrder=void 0;const n=Gt,e=Us();class t extends e.BaseTransform{beforeDraw(i){const{model:a}=this.context,s=i.add.combos,o=c=>{const l=[];return c.forEach((u,h)=>{const d=a.getAncestorsData(h,"combo").map(p=>(0,n.idOf)(p)).reverse();l.push([h,u,d.length])}),new Map(l.sort(([,,u],[,,h])=>h-u).map(([u,h])=>[u,h]))};return i.add.combos=o(s),i.update.combos=o(i.update.combos),i}}return Ol.ArrangeDrawOrder=t,Ol}var Cl={},cx={},Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.orth=ovt;Dr.getDirection=qn;Dr.getBBoxSize=gp;Dr.pointToPoint=tF;Dr.nodeToPoint=Tu;Dr.pointToNode=V_;Dr.nodeToNode=eF;Dr.insideNode=yd;Dr.freeJoin=rh;const J9=bt,cn=de,Sr=It,So=Kt;function ovt(n,e,t,r,i,a){const s=[n,...i,e];let o=null;const c=[];for(let l=0,u=s.length;l<u-1;l++){const h=l+1,f=s[l],d=s[h],p=(0,Sr.isOrthogonal)(f,d);let g=null;l===0?h===u-1?t.intersects(r)?g=yd(f,d,t,r):p||(g=eF(f,d,t,r)):(0,cn.isPointInBBox)(d,t)?g=yd(f,d,t,(0,cn.getNodeBBox)(d,a),o):p||(g=Tu(f,d,t)):h===u-1?(0,cn.isPointInBBox)(f,r)?g=yd(f,d,(0,cn.getNodeBBox)(f,a),r,o):p||(g=V_(f,d,r,o)):p||(g=tF(f,d,o)),g?(c.push(...g.points),o=g.direction):o=qn(f,d),h<u-1&&c.push(d)}return c}const cvt={N:"S",S:"N",W:"E",E:"W"},A6={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function qn(n,e){const[t,r]=n,[i,a]=e;return t===i?r>a?"N":"S":r===a?t>i?"W":"E":null}function gp(n,e){return e==="N"||e==="S"?(0,cn.getBBoxHeight)(n):(0,cn.getBBoxWidth)(n)}function tF(n,e,t){const r=[n[0],e[1]],i=[e[0],n[1]],a=qn(n,r),s=qn(n,i),o=t?cvt[t]:null,c=a===t||a!==o&&s!==t?r:i;return{points:[c],direction:qn(c,e)}}function Tu(n,e,t){const r=rh(n,e,t);return{points:[r],direction:qn(r,e)}}function V_(n,e,t,r){const i=[[e[0],n[1]],[n[0],e[1]]],a=i.filter(o=>(0,cn.isPointOutsideBBox)(o,t)&&!(0,cn.isPointOnBBoxBoundary)(o,t,!0)),s=a.filter(o=>qn(o,n)!==r);if(s.length>0){const o=s.find(c=>qn(n,c)===r)||s[0];return{points:[o],direction:qn(o,e)}}else{const o=(0,J9.difference)(i,a)[0],c=(0,Sr.moveTo)(e,o,gp(t,r)/2);return{points:[rh(c,n,t),c],direction:qn(c,e)}}}function eF(n,e,t,r){let i=Tu(n,e,t);const a=(0,So.toVector3)(i.points[0]);if((0,cn.isPointInBBox)(a,r)){i=Tu(e,n,r);const s=(0,So.toVector3)(i.points[0]);if((0,cn.isPointInBBox)(s,t)){const o=(0,Sr.moveTo)(n,a,gp(t,qn(n,a))/2),c=(0,Sr.moveTo)(e,s,gp(r,qn(e,s))/2),l=[(o[0]+c[0])/2,(o[1]+c[1])/2],u=Tu(n,l,t),h=V_(l,e,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function yd(n,e,t,r,i){const s=(0,cn.getCombinedBBox)([t,r]),o=(0,So.distance)(e,s.center)>(0,So.distance)(n,s.center),[c,l]=o?[e,n]:[n,e],u=(0,cn.getBBoxHeight)(s)+(0,cn.getBBoxWidth)(s);let h;if(i){const p=[c[0]+u*Math.cos(A6[i]),c[1]+u*Math.sin(A6[i])];h=(0,Sr.moveTo)((0,cn.getNearestPointToPoint)(s,p),p,.01)}else h=(0,Sr.moveTo)((0,cn.getNearestPointToPoint)(s,c),c,-.01);let f=rh(h,l,s),d=[(0,Sr.round)(h,2),(0,Sr.round)(f,2)];if((0,J9.isEqual)((0,Sr.round)(h),(0,Sr.round)(f))){const p=(0,So.angle)((0,So.subtract)(h,c),[1,0,0])+Math.PI/2;f=[l[0]+u*Math.cos(p),l[1]+u*Math.sin(p),0],f=(0,Sr.round)((0,Sr.moveTo)((0,cn.getNearestPointToPoint)(s,f),l,-.01),2);const g=rh(h,f,s);d=[h,g,f]}return{points:o?d.reverse():d,direction:qn(o?h:f,e)}}function rh(n,e,t){let r=[n[0],e[1]];return(0,cn.isPointInBBox)(r,t)&&(r=[e[0],n[1]]),r}var N6;function Cc(){return N6||(N6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRadians=void 0,n.getLabelPositionStyle=l,n.getBadgePositionStyle=u,n.getCurveControlPoint=f,n.parseCurveOffset=d,n.parseCurvePosition=p,n.getQuadraticPath=g,n.getCubicPath=v,n.getPolylinePath=m,n.getBorderRadiusPoints=y,n.getLoopEndpoints=w,n.getCubicLoopPath=x,n.getCubicLoopControlPoints=S,n.getPolylineLoopPath=_,n.getPolylineLoopControlPoints=E,n.getSubgraphRelatedEdges=P,n.findActualConnectNodeData=O,n.getArrowSize=C;const e=bt,t=de,r=ra,i=Ln(),a=Gt,s=It,o=Dr,c=Kt;function l(M,T,R,D,B){let V=typeof T=="number"?T:.5;T==="start"&&(V=0),T==="end"&&(V=.99);const W=(0,s.parsePoint)(M.getPoint(V)),Y=(0,s.parsePoint)(M.getPoint(V+.01));let U=T==="start"?"left":T==="end"?"right":"center";if((0,s.isHorizontal)(W,Y)||!R){const[pe,Be]=h(M,V,D,B);return{transform:`translate(${pe}, ${Be})`,textAlign:U}}let J=Math.atan2(Y[1]-W[1],Y[0]-W[0]);Y[0]<W[0]&&(U=U==="center"?U:U==="left"?"right":"left",D*=-1,J+=Math.PI);const[ht,lt]=h(M,V,D,B,J),Nt=`translate(${ht}, ${lt}) rotate(${J/Math.PI*180}deg)`;return{textAlign:U,transform:Nt}}function u(M,T,R,D,B){var $,V;const j=(($=M.badge)==null?void 0:$.getGeometryBounds().halfExtents[0])*2||0,L=((V=M.label)==null?void 0:V.getGeometryBounds().halfExtents[0])*2||0;return l(M.key,R,!0,(L?(L/2+j/2)*(T==="suffix"?1:-1):0)+D,B)}function h(M,T,R,D,B){const[j,L]=(0,s.parsePoint)(M.getPoint(T));let $=R,V=D;return B&&($=R*Math.cos(B)-D*Math.sin(B),V=R*Math.sin(B)+D*Math.cos(B)),[j+$,L+V]}function f(M,T,R,D){if((0,e.isEqual)(M,T))return M;const B=(0,c.subtract)(T,M),j=[M[0]+R*B[0],M[1]+R*B[1]],L=(0,c.normalize)((0,c.perpendicular)(B,!1));return j[0]+=D*L[0],j[1]+=D*L[1],j}function d(M){return(0,e.isNumber)(M)?[M,-M]:M}function p(M){return(0,e.isNumber)(M)?[M,1-M]:M}function g(M,T,R){return[["M",M[0],M[1]],["Q",R[0],R[1],T[0],T[1]]]}function v(M,T,R){return[["M",M[0],M[1]],["C",R[0][0],R[0][1],R[1][0],R[1][1],T[0],T[1]]]}function m(M,T=0,R=!1){const D=M[0],B=M[M.length-1],j=M.slice(1,M.length-1),L=[["M",D[0],D[1]]];return j.forEach(($,V)=>{const W=j[V-1]||D,Y=j[V+1]||B;if(!(0,s.isCollinear)(W,$,Y)&&T){const[U,J]=y(W,$,Y,T);L.push(["L",U[0],U[1]],["Q",$[0],$[1],J[0],J[1]],["L",J[0],J[1]])}else L.push(["L",$[0],$[1]])}),L.push(["L",B[0],B[1]]),R&&L.push(["Z"]),L}function y(M,T,R,D){const B=(0,c.manhattanDistance)(M,T),j=(0,c.manhattanDistance)(R,T),L=Math.min(D,Math.min(B,j)/2),$=[T[0]-L/B*(T[0]-M[0]),T[1]-L/B*(T[1]-M[1])],V=[T[0]-L/j*(T[0]-R[0]),T[1]-L/j*(T[1]-R[1])];return[$,V]}const b=M=>{const T=Math.PI/2,R=(0,t.getBBoxHeight)(M)/2,D=(0,t.getBBoxWidth)(M)/2,B=Math.atan2(R,D)/2,j=Math.atan2(D,R)/2;return{top:[-T-j,-T+j],"top-right":[-T+j,-B],"right-top":[-T+j,-B],right:[-B,B],"bottom-right":[B,T-j],"right-bottom":[B,T-j],bottom:[T-j,T+j],"bottom-left":[T+j,Math.PI-B],"left-bottom":[T+j,Math.PI-B],left:[Math.PI-B,Math.PI+B],"top-left":[Math.PI+B,-T-j],"left-top":[Math.PI+B,-T-j]}};n.getRadians=b;function w(M,T,R,D,B){const j=(0,t.getNodeBBox)(M),L=M.getCenter();let $=D&&(0,i.getPortPosition)(D),V=B&&(0,i.getPortPosition)(B);if(!$||!V){const W=(0,n.getRadians)(j),Y=W[T][0],U=W[T][1],[J,at]=(0,t.getBBoxSize)(j),ht=Math.max(J,at),lt=(0,c.add)(L,[ht*Math.cos(Y),ht*Math.sin(Y),0]),Nt=(0,c.add)(L,[ht*Math.cos(U),ht*Math.sin(U),0]);$=(0,i.getNodeConnectionPoint)(M,lt),V=(0,i.getNodeConnectionPoint)(M,Nt),R||([$,V]=[V,$])}return[$,V]}function x(M,T,R,D,B,j){const L=M.getPorts()[B||j],$=M.getPorts()[j||B];let[V,W]=w(M,T,R,L,$);const Y=S(M,V,W,D);return L&&(V=(0,i.getPortConnectionPoint)(L,Y[0])),$&&(W=(0,i.getPortConnectionPoint)($,Y[Y.length-1])),v(V,W,Y)}function S(M,T,R,D){const B=M.getCenter();if((0,e.isEqual)(T,R)){const j=(0,c.subtract)(T,B),L=[D*Math.sign(j[0])||D/2,D*Math.sign(j[1])||-D/2,0];return[(0,c.add)(T,L),(0,c.add)(R,(0,c.multiply)(L,[1,-1,1]))]}return[(0,s.moveTo)(B,T,(0,c.distance)(B,T)+D),(0,s.moveTo)(B,R,(0,c.distance)(B,R)+D)]}function _(M,T,R,D,B,j,L){const $=(0,i.getAllPorts)(M),V=$[j||L],W=$[L||j];let[Y,U]=w(M,R,D,V,W);const J=E(M,Y,U,B);return V&&(Y=(0,i.getPortConnectionPoint)(V,J[0])),W&&(U=(0,i.getPortConnectionPoint)(W,J[J.length-1])),m([Y,...J,U],T)}function E(M,T,R,D){const B=[],j=(0,t.getNodeBBox)(M);if((0,e.isEqual)(T,R))switch((0,t.getNearestSideToPoint)(j,T)){case"left":B.push([T[0]-D,T[1]]),B.push([T[0]-D,T[1]+D]),B.push([T[0],T[1]+D]);break;case"right":B.push([T[0]+D,T[1]]),B.push([T[0]+D,T[1]+D]),B.push([T[0],T[1]+D]);break;case"top":B.push([T[0],T[1]-D]),B.push([T[0]+D,T[1]-D]),B.push([T[0]+D,T[1]]);break;case"bottom":B.push([T[0],T[1]+D]),B.push([T[0]+D,T[1]+D]),B.push([T[0]+D,T[1]]);break}else{const L=(0,t.getNearestSideToPoint)(j,T),$=(0,t.getNearestSideToPoint)(j,R);if(L===$){const V=L;let W,Y;switch(V){case"left":W=Math.min(T[0],R[0])-D,B.push([W,T[1]]),B.push([W,R[1]]);break;case"right":W=Math.max(T[0],R[0])+D,B.push([W,T[1]]),B.push([W,R[1]]);break;case"top":Y=Math.min(T[1],R[1])-D,B.push([T[0],Y]),B.push([R[0],Y]);break;case"bottom":Y=Math.max(T[1],R[1])+D,B.push([T[0],Y]),B.push([R[0],Y]);break}}else{const V=(J,at)=>({left:[at[0]-D,at[1]],right:[at[0]+D,at[1]],top:[at[0],at[1]-D],bottom:[at[0],at[1]+D]})[J],W=V(L,T),Y=V($,R),U=(0,o.freeJoin)(W,Y,j);B.push(W,U,Y)}}return B}function P(M,T){const R=new Set,D=new Set,B=new Set;return M.forEach(j=>{T(j).forEach($=>{R.add($),M.includes($.source)&&M.includes($.target)?D.add($):B.add($)})}),{edges:Array.from(R),internal:Array.from(D),external:Array.from(B)}}function O(M,T){const R=[];let D=M;for(;D;){R.push(D);const B=T((0,a.idOf)(D));if(B)D=B;else break}if(R.some(B=>{var j;return(j=B.style)==null?void 0:j.collapsed})){const B=R.reverse().findIndex(r.isCollapsed);return R[B]||R.at(-1)}return M}function C(M,T){return T||(M<4?10:M===4?12:M*2.5)}}(cx)),cx}var N0={};Object.defineProperty(N0,"__esModule",{value:!0});N0.reassignTo=uvt;const lvt=Gt;function uvt(n,e,t,r,i){const a=(0,lvt.idOf)(r),s=`${t}s`,o=i?r:n.add[s].get(a)||n.update[s].get(a)||n.remove[s].get(a)||r;Object.entries(n).forEach(([c,l])=>{e===c?l[s].set(a,o):l[s].delete(a)})}var R6;function hvt(){if(R6)return Cl;R6=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.CollapseExpandCombo=void 0;const n=ra,e=Cc(),t=Gt,r=Us(),i=N0;class a extends r.BaseTransform{beforeDraw(o,c){if(c.stage==="visibility")return o;const{model:l}=this.context,{add:u,update:h}=o,f=[...o.update.combos.entries(),...o.add.combos.entries()];for(;f.length;){const[d,p]=f.pop();if((0,n.isCollapsed)(p)){const g=l.getDescendantsData(d),v=g.map(t.idOf),{internal:m,external:y}=(0,e.getSubgraphRelatedEdges)(v,b=>l.getRelatedEdgesData(b));g.forEach(b=>{const w=(0,t.idOf)(b),x=f.findIndex(([_])=>_===w);x!==-1&&f.splice(x,1);const S=l.getElementType(w);(0,i.reassignTo)(o,"remove",S,b)}),m.forEach(b=>(0,i.reassignTo)(o,"remove","edge",b)),y.forEach(b=>{var S;const w=(0,t.idOf)(b);((S=this.context.element)==null?void 0:S.getElement(w))?h.edges.set(w,b):u.edges.set(w,b)})}else{const g=l.getChildrenData(d),v=g.map(t.idOf),{edges:m}=(0,e.getSubgraphRelatedEdges)(v,y=>l.getRelatedEdgesData(y));[...g,...m].forEach(y=>{var S;const b=(0,t.idOf)(y),w=l.getElementType(b);((S=this.context.element)==null?void 0:S.getElement(b))?(0,i.reassignTo)(o,"update",w,y):(0,i.reassignTo)(o,"add",w,y),w==="combo"&&f.push([b,y])})}}return o}}return Cl.CollapseExpandCombo=a,Cl}var Ml={},k6;function fvt(){if(k6)return Ml;k6=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.CollapseExpandNode=void 0;const n=Ft,e=ra,t=Gt,r=Us(),i=N0,a=(o,c,l,u)=>{const h=`${l}s`,f=(0,t.idOf)(u);!o.add[h].has(f)&&!o.update[h].has(f)&&o[c][h].set((0,t.idOf)(u),u)};class s extends r.BaseTransform{getElement(c){return this.context.element.getElement(c)}handleExpand(c,l){if(a(l,"add","node",c),(0,e.isCollapsed)(c))return;const u=(0,t.idOf)(c);a(l,"add","node",c),this.context.model.getRelatedEdgesData(u,"out").forEach(d=>{(0,i.reassignTo)(l,"add","edge",d)}),this.context.model.getChildrenData(u).forEach(d=>{this.handleExpand(d,l)})}beforeDraw(c){const{graph:l,model:u}=this.context,{add:{nodes:h,edges:f},update:{nodes:d}}=c,p=new Map,g=new Map;h.forEach((m,y)=>{(0,e.isCollapsed)(m)&&p.set(y,m)}),f.forEach(m=>{if(l.getElementType(m.source)!=="node")return;const y=l.getNodeData(m.source);(0,e.isCollapsed)(y)&&p.set(m.source,y)}),d.forEach((m,y)=>{const b=this.getElement(y);if(!b)return;const w=b.attributes.collapsed;(0,e.isCollapsed)(m)?w||p.set(y,m):w&&g.set(y,m)});const v=new Set;return p.forEach((m,y)=>{u.getDescendantsData(y).forEach(w=>{const x=(0,t.idOf)(w);if(v.has(x))return;(0,i.reassignTo)(c,"remove","node",w),u.getRelatedEdgesData(x).forEach(_=>{(0,i.reassignTo)(c,"remove","edge",_)}),v.add(x)})}),g.forEach((m,y)=>{if(u.getAncestorsData(y,n.TREE_KEY).some(e.isCollapsed)){(0,i.reassignTo)(c,"remove","node",m);return}this.handleExpand(m,c)}),c}}return Ml.CollapseExpandNode=s,Ml}var lx={},ux={},hx={},Tl={},mn={};Object.defineProperty(mn,"__esModule",{value:!0});mn.simple=mn.triangleRect=mn.rect=mn.vee=mn.diamond=mn.triangle=mn.circle=void 0;const dvt=(n,e)=>{const t=Math.max(n,e)/2;return[["M",-n/2,0],["A",t,t,0,1,0,2*t-n/2,0],["A",t,t,0,1,0,-n/2,0],["Z"]]};mn.circle=dvt;const pvt=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",n/2,e/2],["Z"]];mn.triangle=pvt;const gvt=(n,e)=>[["M",-n/2,0],["L",0,-e/2],["L",n/2,0],["L",0,e/2],["Z"]];mn.diamond=gvt;const vvt=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",4*n/5-n/2,0],["L",n/2,e/2],["Z"]];mn.vee=vvt;const mvt=(n,e)=>[["M",-n/2,-e/2],["L",n/2,-e/2],["L",n/2,e/2],["L",-n/2,e/2],["Z"]];mn.rect=mvt;const yvt=(n,e)=>{const t=n/2,r=n/7,i=n-r;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+r-t,-e/2],["L",i+r-t,e/2],["L",i-t,e/2],["Z"]]};mn.triangleRect=yvt;const bvt=(n,e)=>[["M",n/2,-e/2],["L",-n/2,0],["L",n/2,0],["L",-n/2,0],["L",n/2,e/2]];mn.simple=bvt;var Al={},D6;function nF(){if(D6)return Al;D6=1,Object.defineProperty(Al,"__esModule",{value:!0}),Al.BaseElement=void 0;const n=Hs();class e extends n.BaseShape{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(r,i){const a=super.animate(r,i);return a&&(a.onframe=()=>this.onframe(),a.finished.then(()=>this.onframe())),a}}return Al.BaseElement=e,Al}var L6;function Bh(){if(L6)return Tl;L6=1;var n=jt&&jt.__createBinding||(Object.create?function(b,w,x,S){S===void 0&&(S=x);var _=Object.getOwnPropertyDescriptor(w,x);(!_||("get"in _?!w.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return w[x]}}),Object.defineProperty(b,S,_)}:function(b,w,x,S){S===void 0&&(S=x),b[S]=w[x]}),e=jt&&jt.__setModuleDefault||(Object.create?function(b,w){Object.defineProperty(b,"default",{enumerable:!0,value:w})}:function(b,w){b.default=w}),t=jt&&jt.__decorate||function(b,w,x,S){var _=arguments.length,E=_<3?w:S===null?S=Object.getOwnPropertyDescriptor(w,x):S,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(b,w,x,S);else for(var O=b.length-1;O>=0;O--)(P=b[O])&&(E=(_<3?P(E):_>3?P(w,x,E):P(w,x))||E);return _>3&&E&&Object.defineProperty(w,x,E),E},r=jt&&jt.__importStar||function(b){if(b&&b.__esModule)return b;var w={};if(b!=null)for(var x in b)x!=="default"&&Object.prototype.hasOwnProperty.call(b,x)&&n(w,b,x);return e(w,b),w};Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.BaseEdge=void 0;const i=Pe,a=bt,s=de,o=Cc(),c=Ln(),l=Ie,u=Si,h=Ne,f=r(mn),d=Ws,p=nF(),g=Ah,v=Hs(),y=class y extends p.BaseElement{constructor(x){super((0,h.mergeOptions)({style:y.defaultStyleProps},x));A(this,"type","edge")}get sourceNode(){const{context:x,sourceNode:S}=this.parsedAttributes;return x.element.getElement(S)}get targetNode(){const{context:x,targetNode:S}=this.parsedAttributes;return x.element.getElement(S)}getKeyStyle(x){const{loop:S,..._}=this.getGraphicStyle(x),{sourceNode:E,targetNode:P}=this;return{d:S&&(0,c.isSameNode)(E,P)?this.getLoopPath(x):this.getKeyPath(x),...(0,l.omitStyleProps)(_,["halo","label","startArrow","endArrow"])}}getLoopPath(x){const{sourcePort:S,targetPort:_}=x,E=this.sourceNode,P=(0,s.getNodeBBox)(E),O=Math.max((0,s.getBBoxWidth)(P),(0,s.getBBoxHeight)(P)),{placement:C,clockwise:M,dist:T=O}=(0,l.subStyleProps)(this.getGraphicStyle(x),"loop");return(0,o.getCubicLoopPath)(E,C,M,T,S,_)}getEndpoints(x){const{sourcePort:S,targetPort:_}=x,{sourceNode:E,targetNode:P}=this,[O,C]=(0,c.findPorts)(E,P,S,_),M=(0,c.getConnectionPoint)(O||E,C||P),T=(0,c.getConnectionPoint)(C||P,O||E);return[M,T]}getHaloStyle(x){if(x.halo===!1)return!1;const S=this.getKeyStyle(x),_=(0,l.subStyleProps)(this.getGraphicStyle(x),"halo");return{...S,..._}}getLabelStyle(x){if(x.label===!1||!x.labelText)return!1;const S=(0,l.subStyleProps)(this.getGraphicStyle(x),"label"),{placement:_,offsetX:E,offsetY:P,autoRotate:O,maxWidth:C,...M}=S,T=(0,o.getLabelPositionStyle)(this.shapeMap.key,_,O,E,P),R=this.shapeMap.key.getLocalBounds(),D=(0,d.getWordWrapWidthByEnds)([R.min,R.max],C);return Object.assign({wordWrapWidth:D},T,M)}getBadgeStyle(x){if(x.badge===!1||!x.badgeText)return!1;const{offsetX:S,offsetY:_,placement:E,...P}=(0,l.subStyleProps)(x,"badge");return Object.assign(P,(0,o.getBadgePositionStyle)(this.shapeMap,E,x.labelPlacement,S,_))}drawArrow(x,S){var C;const _=S==="start",P=x[S==="start"?"startArrow":"endArrow"],O=this.shapeMap.key;if(P){const M=this.getArrowStyle(x,_),[T,R,D]=_?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],B=O.parsedStyle[T];if(B)B.attr(M);else{const j=M.src?i.Image:i.Path,L=new j({style:M});O.style[T]=L}O.style[R]=x[D]||M.width/2+ +M.lineWidth}else{const M=_?"markerStart":"markerEnd";(C=O.style[M])==null||C.destroy(),O.style[M]=null}}getArrowStyle(x,S){const _=this.getShape("key").attributes,E=S?"startArrow":"endArrow",{size:P,type:O,...C}=(0,l.subStyleProps)(this.getGraphicStyle(x),E),[M,T]=(0,u.parseSize)((0,o.getArrowSize)(_.lineWidth,P)),D=((0,a.isFunction)(O)?O:f[O]||f.triangle)(M,T);return Object.assign((0,a.pick)(_,["stroke","strokeOpacity","fillOpacity"]),{width:M,height:T},{...D&&{d:D,fill:O==="simple"?"":_.stroke}},C)}drawLabelShape(x,S){this.upsert("label",v.Label,this.getLabelStyle(x),S)}drawHaloShape(x,S){this.upsert("halo",i.Path,this.getHaloStyle(x),S)}drawBadgeShape(x,S){this.upsert("badge",v.Badge,this.getBadgeStyle(x),S)}drawSourceArrow(x){this.drawArrow(x,"start")}drawTargetArrow(x){this.drawArrow(x,"end")}drawKeyShape(x,S){return this.upsert("key",i.Path,this.getKeyStyle(x),S)}render(x=this.parsedAttributes,S=this){this.drawKeyShape(x,S),this.getShape("key")&&(this.drawSourceArrow(x),this.drawTargetArrow(x),this.drawLabelShape(x,S),this.drawHaloShape(x,S),this.drawBadgeShape(x,S))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(x,S){const _=super.animate(x,S);return _&&new Proxy(_,{set:(E,P,O)=>(P==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(E,P,O))})}};A(y,"defaultStyleProps",{badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0});let m=y;return Tl.BaseEdge=m,t([(0,g.effect)((b,w)=>b.getLabelStyle(w))],m.prototype,"drawLabelShape",null),t([(0,g.effect)((b,w)=>b.getHaloStyle(w))],m.prototype,"drawHaloShape",null),t([(0,g.effect)((b,w)=>b.getBadgeStyle(w))],m.prototype,"drawBadgeShape",null),t([(0,g.effect)((b,w)=>b.getArrowStyle(w,"start"))],m.prototype,"drawSourceArrow",null),t([(0,g.effect)((b,w)=>b.getArrowStyle(w,"end"))],m.prototype,"drawTargetArrow",null),t([(0,g.effect)((b,w)=>b.getKeyStyle(w))],m.prototype,"drawKeyShape",null),Tl}var Nl={},I6;function W_(){if(I6)return Nl;I6=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.Cubic=void 0;const n=Cc(),e=Ne,t=Bh(),i=class i extends t.BaseEdge{constructor(s){super((0,e.mergeOptions)({style:i.defaultStyleProps},s))}getKeyPath(s){const[o,c]=this.getEndpoints(s),{controlPoints:l,curvePosition:u,curveOffset:h}=s,f=this.getControlPoints(o,c,(0,n.parseCurvePosition)(u),(0,n.parseCurveOffset)(h),l);return(0,n.getCubicPath)(o,c,f)}getControlPoints(s,o,c,l,u){return(u==null?void 0:u.length)===2?u:[(0,n.getCurveControlPoint)(s,o,c[0],l[0]),(0,n.getCurveControlPoint)(s,o,c[1],l[1])]}};A(i,"defaultStyleProps",{curvePosition:.5,curveOffset:20});let r=i;return Nl.Cubic=r,Nl}var Rl={},B6;function Evt(){if(B6)return Rl;B6=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.CubicHorizontal=void 0;const n=Ne,e=W_(),r=class r extends e.Cubic{constructor(a){super((0,n.mergeOptions)({style:r.defaultStyleProps},a))}getControlPoints(a,s,o,c){const l=s[0]-a[0];return[[a[0]+l*o[0]+c[0],a[1]],[s[0]-l*o[1]+c[1],s[1]]]}};A(r,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});let t=r;return Rl.CubicHorizontal=t,Rl}var kl={},F6;function xvt(){if(F6)return kl;F6=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.CubicVertical=void 0;const n=Ne,e=W_(),r=class r extends e.Cubic{constructor(a){super((0,n.mergeOptions)({style:r.defaultStyleProps},a))}getControlPoints(a,s,o,c){const l=s[1]-a[1];return[[a[0],a[1]+l*o[0]+c[0]],[s[0],s[1]-l*o[1]+c[1]]]}};A(r,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});let t=r;return kl.CubicVertical=t,kl}var Dl={},$6;function wvt(){if($6)return Dl;$6=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.Line=void 0;const n=Ne,e=Bh(),r=class r extends e.BaseEdge{constructor(a){super((0,n.mergeOptions)({style:r.defaultStyleProps},a))}getKeyPath(a){const[s,o]=this.getEndpoints(a);return[["M",s[0],s[1]],["L",o[0],o[1]]]}};A(r,"defaultStyleProps",{});let t=r;return Dl.Line=t,Dl}var Ll={},z6;function Svt(){if(z6)return Ll;z6=1,Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.Polyline=void 0;const n=de,e=Cc(),t=Ln(),r=Ie,i=Dr,a=Ne,s=Bh(),c=class c extends s.BaseEdge{constructor(u){super((0,a.mergeOptions)({style:c.defaultStyleProps},u))}getKeyPath(u){const{radius:h}=u,{sourceNode:f,targetNode:d}=this,{sourcePoint:p,targetPoint:g,sourcePort:v,targetPort:m}=this.getEndpointsAndPorts(u),y=this.getControlPoints(u,p,g),b=(0,t.getConnectionPoint)(v||f,y[0]||m||d),w=(0,t.getConnectionPoint)(m||d,y[y.length-1]||v||f);return(0,e.getPolylinePath)([b,...y,w],h)}getEndpointsAndPorts(u){const{sourcePort:h,targetPort:f}=u,{sourceNode:d,targetNode:p}=this,[g,v]=(0,t.findPorts)(d,p,h,f);return{sourcePoint:g?(0,t.getPortPosition)(g):d.getCenter(),targetPoint:v?(0,t.getPortPosition)(v):p.getCenter(),sourcePort:g,targetPort:v}}getControlPoints(u,h,f){const{controlPoints:d,router:p,routerPadding:g}=u,{sourceNode:v,targetNode:m}=this;if(!p)return[...d];const y=(0,n.getNodeBBox)(v,g),b=(0,n.getNodeBBox)(m,g);return(0,i.orth)(h,f,y,b,d,g)}getLoopPath(u){const{sourcePort:h,targetPort:f,radius:d}=u,p=this.sourceNode,g=(0,n.getNodeBBox)(p),v=Math.max((0,n.getBBoxWidth)(g),(0,n.getBBoxHeight)(g))/4,{placement:m,clockwise:y,dist:b=v}=(0,r.subStyleProps)(this.getGraphicStyle(u),"loop");return(0,e.getPolylineLoopPath)(p,d,m,y,b,h,f)}};A(c,"defaultStyleProps",{radius:0,controlPoints:[],router:!1,routerName:"orth",routerPadding:10});let o=c;return Ll.Polyline=o,Ll}var Il={},j6;function _vt(){if(j6)return Il;j6=1,Object.defineProperty(Il,"__esModule",{value:!0}),Il.Quadratic=void 0;const n=Cc(),e=Ne,t=Bh(),i=class i extends t.BaseEdge{constructor(s){super((0,e.mergeOptions)({style:i.defaultStyleProps},s))}getKeyPath(s){const{curvePosition:o,curveOffset:c}=s,[l,u]=this.getEndpoints(s),h=s.controlPoint||(0,n.getCurveControlPoint)(l,u,o,c);return(0,n.getQuadraticPath)(l,u,h)}};A(i,"defaultStyleProps",{curvePosition:.5,curveOffset:30});let r=i;return Il.Quadratic=r,Il}var q6;function rF(){return q6||(q6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Quadratic=n.Polyline=n.Line=n.CubicVertical=n.CubicHorizontal=n.Cubic=n.BaseEdge=void 0;var e=Bh();Object.defineProperty(n,"BaseEdge",{enumerable:!0,get:function(){return e.BaseEdge}});var t=W_();Object.defineProperty(n,"Cubic",{enumerable:!0,get:function(){return t.Cubic}});var r=Evt();Object.defineProperty(n,"CubicHorizontal",{enumerable:!0,get:function(){return r.CubicHorizontal}});var i=xvt();Object.defineProperty(n,"CubicVertical",{enumerable:!0,get:function(){return i.CubicVertical}});var a=wvt();Object.defineProperty(n,"Line",{enumerable:!0,get:function(){return a.Line}});var s=Svt();Object.defineProperty(n,"Polyline",{enumerable:!0,get:function(){return s.Polyline}});var o=_vt();Object.defineProperty(n,"Quadratic",{enumerable:!0,get:function(){return o.Quadratic}})}(hx)),hx}var Bl={},fx={},Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.ViewportEvent=Tr.ElementLifeCycleEvent=Tr.AnimateEvent=Tr.GraphLifeCycleEvent=Tr.BaseEvent=void 0;class Fh{constructor(e){A(this,"type");this.type=e}}Tr.BaseEvent=Fh;class Ovt extends Fh{constructor(t,r){super(t);A(this,"data");this.data=r}}Tr.GraphLifeCycleEvent=Ovt;class Pvt extends Fh{constructor(t,r,i,a){super(t);A(this,"animationType");A(this,"animation");A(this,"data");this.animationType=r,this.animation=i,this.data=a}}Tr.AnimateEvent=Pvt;class Cvt extends Fh{constructor(t,r,i){super(t);A(this,"elementType");A(this,"data");this.elementType=r,this.data=i}}Tr.ElementLifeCycleEvent=Cvt;class Mvt extends Fh{constructor(t,r){super(t);A(this,"data");this.data=r}}Tr.ViewportEvent=Mvt;var G6;function Mc(){return G6||(G6=1,function(n){var e=jt&&jt.__createBinding||(Object.create?function(o,c,l,u){u===void 0&&(u=l);var h=Object.getOwnPropertyDescriptor(c,l);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[l]}}),Object.defineProperty(o,u,h)}:function(o,c,l,u){u===void 0&&(u=l),o[u]=c[l]}),t=jt&&jt.__exportStar||function(o,c){for(var l in o)l!=="default"&&!Object.prototype.hasOwnProperty.call(c,l)&&e(c,o,l)};Object.defineProperty(n,"__esModule",{value:!0}),n.emit=a,n.eventTargetOf=s;const r=Pe,i=Ln();t(Tr,n);function a(o,c){o.emit(c.type,c)}function s(o){if(!o)return null;if(o instanceof r.Document)return{type:"canvas",element:o};let c=o;for(;c;){if((0,i.isNode)(c))return{type:"node",element:c};if((0,i.isEdge)(c))return{type:"edge",element:c};if((0,i.isCombo)(c))return{type:"combo",element:c};c=c.parentElement}return null}}(fx)),fx}var Fl={},V6;function Tvt(){if(V6)return Fl;V6=1,Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.Animation=void 0;const n=R9(),e=_c(),t=_i;class r{constructor(a){A(this,"context");A(this,"tasks",[]);A(this,"animations",new Set);this.context=a}getTasks(){const a=[...this.tasks];return this.tasks=[],a}add(a,s){this.tasks.push([a,s])}animate(a,s,o){var u,h,f;(u=s==null?void 0:s.before)==null||u.call(s);const c=this.getTasks().map(([d,p])=>{var w,x,S;const{element:g,elementType:v,stage:m}=d,y=(0,e.getElementAnimationOptions)(this.context.options,v,m,a);(w=p==null?void 0:p.before)==null||w.call(p);const b=(0,n.executor)(g,this.inferStyle(d,o),y);return b?((x=p==null?void 0:p.beforeAnimate)==null||x.call(p,b),b.finished.then(()=>{var _,E;(_=p==null?void 0:p.afterAnimate)==null||_.call(p,b),(E=p==null?void 0:p.after)==null||E.call(p),this.animations.delete(b)})):(S=p==null?void 0:p.after)==null||S.call(p),b}).filter(Boolean);c.forEach(d=>this.animations.add(d));const l=(0,e.createAnimationsProxy)(c);return l?((h=s==null?void 0:s.beforeAnimate)==null||h.call(s,l),l.finished.then(()=>{var d,p;(d=s==null?void 0:s.afterAnimate)==null||d.call(s,l),(p=s==null?void 0:s.after)==null||p.call(s),this.release()})):(f=s==null?void 0:s.after)==null||f.call(s),l}inferStyle(a,s){const{element:o,elementType:c,stage:l,originalStyle:u,modifiedStyle:h}=a,f={...u},d={...h},p=()=>(0,t.getCachedStyle)(o,"opacity")??(0,e.inferDefaultValue)("opacity");if(l==="enter")Object.assign(f,{opacity:0});else if(l==="exit")Object.assign(d,{opacity:0});else if(l==="show")Object.assign(f,{opacity:0}),Object.assign(d,{opacity:p()});else if(l==="hide")Object.assign(f,{opacity:p()}),Object.assign(d,{opacity:0});else if(l==="collapse"){const{collapse:g}=s||{},{target:v,descendants:m,position:y}=g;if(c==="node"){if(m.includes(o.id)){const[b,w,x]=y;Object.assign(d,{x:b,y:w,z:x})}}else if(c==="combo"){if(o.id===v||m.includes(o.id)){const[b,w]=y;Object.assign(d,{x:b,y:w,childrenNode:f.childrenNode})}}else c==="edge"&&Object.assign(d,{sourceNode:f.sourceNode,targetNode:f.targetNode})}else if(l==="expand"){const{expand:g}=s||{},{target:v,descendants:m,position:y}=g;if(c==="node"){if(o.id===v||m.includes(o.id)){const[b,w,x]=y;Object.assign(f,{x:b,y:w,z:x})}}else if(c==="combo"){if(o.id===v||m.includes(o.id)){const[b,w,x]=y;Object.assign(f,{x:b,y:w,z:x,childrenNode:d.childrenNode})}}else c==="edge"&&Object.assign(f,{sourceNode:d.sourceNode,targetNode:d.targetNode})}return[f,d]}stop(){this.animations.forEach(a=>a.cancel())}clear(){this.tasks=[]}release(){var o,c;const{canvas:a}=this.context,s=(c=(o=a.document)==null?void 0:o.timeline)==null?void 0:c.animationsWithPromises;s&&(a.document.timeline.animationsWithPromises=s.filter(l=>l.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}return Fl.Animation=r,Fl}var $l={},W6;function Avt(){if(W6)return $l;W6=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.BatchController=void 0;const n=Ft,e=Mc();class t{constructor(i){A(this,"context");A(this,"batchCount",0);this.context=i}emit(i){const{graph:a}=this.context;a.emit(i.type,i)}startBatch(i=!0){this.batchCount++,this.batchCount===1&&this.emit(new e.GraphLifeCycleEvent(n.GraphEvent.BATCH_START,{initiate:i}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new e.GraphLifeCycleEvent(n.GraphEvent.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}return $l.BatchController=t,$l}var zl={},H6;function Nvt(){if(H6)return zl;H6=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.BehaviorController=void 0;const n=Ft,e=Oc(),t=Ln(),r=Mc();class i extends e.ExtensionController{constructor(o){super(o);A(this,"currentTarget",null);A(this,"currentTargetType",null);A(this,"category","behavior");A(this,"forwardCanvasEvents",o=>{const{target:c}=o,l=(0,r.eventTargetOf)(c);if(!l)return;const{graph:u,canvas:h}=this.context,{type:f,element:d}=l;if("destroyed"in d&&((0,t.isToBeDestroyed)(d)||d.destroyed))return;const{type:p,detail:g,button:v}=o,m={...o,target:d,targetType:f,originalTarget:c};p===n.CommonEvent.POINTER_MOVE&&(this.currentTarget!==d&&(this.currentTarget&&u.emit(`${this.currentTargetType}:${n.CommonEvent.POINTER_LEAVE}`,{...m,type:n.CommonEvent.POINTER_LEAVE,target:this.currentTarget}),d&&(Object.assign(m,{type:n.CommonEvent.POINTER_ENTER}),u.emit(`${f}:${n.CommonEvent.POINTER_ENTER}`,m))),this.currentTarget=d,this.currentTargetType=f),p===n.CommonEvent.CLICK&&v===2||(u.emit(`${f}:${p}`,m),u.emit(p,m)),p===n.CommonEvent.CLICK&&g===2&&(Object.assign(m,{type:n.CommonEvent.DBLCLICK}),u.emit(`${f}:${n.CommonEvent.DBLCLICK}`,m),u.emit(n.CommonEvent.DBLCLICK,m)),p===n.CommonEvent.POINTER_DOWN&&v===2&&(Object.assign(m,{type:n.CommonEvent.CONTEXT_MENU,preventDefault:()=>{var y;(y=h.getContainer())==null||y.addEventListener(n.CommonEvent.CONTEXT_MENU,b=>b.preventDefault(),{once:!0})}}),u.emit(`${f}:${n.CommonEvent.CONTEXT_MENU}`,m),u.emit(n.CommonEvent.CONTEXT_MENU,m))});A(this,"forwardContainerEvents",o=>{this.context.graph.emit(o.type,o)});this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(o){this.setExtensions(o)}forwardEvents(){const o=this.context.canvas.getContainer();o&&[n.ContainerEvent.KEY_DOWN,n.ContainerEvent.KEY_UP].forEach(l=>{o.addEventListener(l,this.forwardContainerEvents)});const c=this.context.canvas.document;c&&[n.CommonEvent.CLICK,n.CommonEvent.DBLCLICK,n.CommonEvent.POINTER_OVER,n.CommonEvent.POINTER_LEAVE,n.CommonEvent.POINTER_ENTER,n.CommonEvent.POINTER_MOVE,n.CommonEvent.POINTER_OUT,n.CommonEvent.POINTER_DOWN,n.CommonEvent.POINTER_UP,n.CommonEvent.CONTEXT_MENU,n.CommonEvent.DRAG_START,n.CommonEvent.DRAG,n.CommonEvent.DRAG_END,n.CommonEvent.DRAG_ENTER,n.CommonEvent.DRAG_OVER,n.CommonEvent.DRAG_LEAVE,n.CommonEvent.DROP,n.CommonEvent.WHEEL].forEach(l=>{c.addEventListener(l,this.forwardCanvasEvents)})}destroy(){const o=this.context.canvas.getContainer();o&&[n.ContainerEvent.KEY_DOWN,n.ContainerEvent.KEY_UP].forEach(c=>{o.removeEventListener(c,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}return zl.BehaviorController=i,zl}var R0={};const Rvt=Zr(Rdt);Object.defineProperty(R0,"__esModule",{value:!0});R0.Canvas=void 0;const dx=Pe,iF=K9,kvt=Rvt,Dvt=bt,U6=de,ci=It,aF=["background","main","label","transient"];class Lvt{constructor(e){A(this,"extends");A(this,"config");this.config=e;const{renderer:t,background:r,cursor:i,...a}=e,s=Y6(t),o=Object.fromEntries(aF.map(c=>{const l=new dx.Canvas({...a,supportsMutipleCanvasesInOneContainer:!0,renderer:s[c],background:c==="background"?r:void 0});return[c,l]}));K6(o),this.extends={config:e,renderer:t,renderers:s,layers:o}}getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(r=>r.resize(e,t))}getBounds(){return(0,U6.getCombinedBBox)(Object.values(this.getLayers()).map(e=>e.document.documentElement).filter(e=>e.childNodes.length>0).map(e=>e.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var i;const r=((i=e.style)==null?void 0:i.$layer)||"main";return this.getLayer(r).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=Y6(e);this.extends.renderers=t,Object.entries(t).forEach(([r,i])=>this.getLayer(r).setRenderer(i)),K6(this.getLayers())}getCanvasByViewport(e){return(0,ci.parsePoint)(this.getLayer().viewport2Canvas((0,ci.toPointObject)(e)))}getViewportByCanvas(e){return(0,ci.parsePoint)(this.getLayer().canvas2Viewport((0,ci.toPointObject)(e)))}getViewportByClient(e){return(0,ci.parsePoint)(this.getLayer().client2Viewport((0,ci.toPointObject)(e)))}getClientByViewport(e){return(0,ci.parsePoint)(this.getLayer().viewport2Client((0,ci.toPointObject)(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),r=t.client2Viewport((0,ci.toPointObject)(e));return(0,ci.parsePoint)(t.viewport2Canvas(r))}async toDataURL(e={}){const t=window.devicePixelRatio||1,{mode:r="viewport",...i}=e;let[a,s,o,c]=[0,0,0,0];if(r==="viewport")[o,c]=this.getSize();else if(r==="overall"){const m=this.getBounds(),y=(0,U6.getBBoxSize)(m);[a,s]=m.min,[o,c]=y}const l=(0,Dvt.createDOM)('<div id="virtual-image"></div>'),u=new dx.Canvas({width:o,height:c,renderer:new iF.Renderer,devicePixelRatio:t,container:l,background:this.extends.config.background});await u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),f=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);h.translate([d[0]-f.x,d[1]-f.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const p=this.getCamera(),g=u.getCamera();if(r==="viewport")g.setZoom(p.getZoom()),g.setPosition(p.getPosition()),g.setFocalPoint(p.getFocalPoint());else if(r==="overall"){const[m,y,b]=g.getPosition(),[w,x,S]=g.getFocalPoint();g.setPosition([m+a,y+s,b]),g.setFocalPoint([w+a,x+s,S])}const v=u.getContextService();return new Promise(m=>{u.addEventListener(dx.CanvasEvent.RERENDER,async()=>{await new Promise(b=>setTimeout(b,300));const y=await v.toDataURL(i);m(y)})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}R0.Canvas=Lvt;function Y6(n){return Object.fromEntries(aF.map(e=>{const t=(n==null?void 0:n(e))||new iF.Renderer;return e==="main"?t.registerPlugin(new kvt.Plugin({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):t.unregisterPlugin(t.getPlugin("dom-interaction")),[e,t]}))}function K6(n){Object.entries(n).forEach(([e,t])=>{const r=t.getContextService().getDomElement();r.style.position="absolute",r.style.outline="none",r.tabIndex=1,e!=="main"&&(r.style.pointerEvents="none")})}var k0={},$h={};Object.defineProperty($h,"__esModule",{value:!0});$h.mergeElementsData=Ivt;$h.cloneElementData=Bvt;$h.isEmptyData=Fvt;const px=bt;function Ivt(n,e){const{data:t,style:r,...i}=n,{data:a,style:s,...o}=e,c={...i,...o};return(t||a)&&Object.assign(c,{data:{...t,...a}}),(r||s)&&Object.assign(c,{style:{...r,...s}}),c}function Bvt(n){const{data:e,style:t,...r}=n,i=r;return e&&(i.data={...e}),t&&(i.style={...t}),i}function Fvt(n){return!(0,px.get)(n,["nodes","length"])&&!(0,px.get)(n,["edges","length"])&&!(0,px.get)(n,["combos","length"])}var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.toGraphlibData=jvt;Tc.toG6Data=qvt;Tc.createTreeStructure=Gvt;const gx=Ft,$vt=Gt,zvt=na;function jvt(n){const{id:e=(0,$vt.idOf)(n),style:t,data:r,...i}=n,a={...n,style:{...t},data:{...r}};return(0,zvt.isEdgeData)(n)?{id:e,data:a,...i}:{id:e,data:a}}function qvt(n){return n.data}function Gvt(n){if(n.hasTreeStructure(gx.TREE_KEY))return;n.attachTreeStructure(gx.TREE_KEY);const e=n.getAllEdges();for(const t of e){const{source:r,target:i}=t;n.setParent(i,r,gx.TREE_KEY)}}Object.defineProperty(k0,"__esModule",{value:!0});k0.DataController=void 0;const Vvt=F_,jl=bt,Rt=Ft,zr=$h,vx=Nh,Ve=Tc,Vt=Gt,Kf=Un,X6=hr,mx=Vs,Wvt=Kt;class Hvt{constructor(){A(this,"model");A(this,"latestRemovedComboIds",new Set);A(this,"comboIds",new Set);A(this,"changes",[]);A(this,"batchCount",0);A(this,"isTraceless",!1);A(this,"enableUpdateNodeLikeHierarchy",!0);this.model=new Vvt.Graph}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===Rt.ChangeType.NodeUpdated||t===Rt.ChangeType.EdgeUpdated||t===Rt.ChangeType.ComboUpdated){const{value:r,original:i}=e;this.changes.push({value:(0,zr.cloneElementData)(r),original:(0,zr.cloneElementData)(i),type:t})}else this.changes.push({value:(0,zr.cloneElementData)(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=(0,Ve.toG6Data)(r);return this.isCombo((0,Vt.idOf)(i))||(e===void 0||e.includes((0,Vt.idOf)(i)))&&t.push(i),t},[])}getEdgeDatum(e){return(0,Ve.toG6Data)(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,r)=>{const i=(0,Ve.toG6Data)(r);return(e===void 0||e.includes((0,Vt.idOf)(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=(0,Ve.toG6Data)(r);return this.isCombo((0,Vt.idOf)(i))&&(e===void 0||e.includes((0,Vt.idOf)(i)))&&t.push(i),t},[])}getAncestorsData(e,t){const{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getAncestors(e,t).map(Ve.toG6Data)}getDescendantsData(e){const t=this.getElementDataById(e),r=[];return(0,mx.dfs)(t,i=>{i!==t&&r.push(i)},i=>this.getChildrenData((0,Vt.idOf)(i)),"TB"),r}getParentData(e,t){const{model:r}=this;if(!t){X6.print.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(e)||!r.hasTreeStructure(t))return;const i=r.getParent(e,t);return i?(0,Ve.toG6Data)(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?Rt.TREE_KEY:Rt.COMBO_KEY,{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getChildren(e,t).map(Ve.toG6Data)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return(0,Ve.toG6Data)(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=(0,Ve.toG6Data)(r);return e?e.includes((0,Vt.idOf)(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)==null?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))==null?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(Ve.toG6Data)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(Ve.toG6Data)}setData(e){const{nodes:t=[],edges:r=[],combos:i=[]}=e,{nodes:a,edges:s,combos:o}=this.getData(),c=(0,vx.arrayDiff)(a,t,h=>(0,Vt.idOf)(h)),l=(0,vx.arrayDiff)(s,r,h=>(0,Vt.idOf)(h)),u=(0,vx.arrayDiff)(o,i,h=>(0,Vt.idOf)(h));this.batch(()=>{this.addData({nodes:c.enter,edges:l.enter,combos:u.enter}),this.updateData({nodes:c.update,edges:l.update,combos:u.update}),this.removeData({nodes:c.exit.map(Vt.idOf),edges:l.exit.map(Vt.idOf),combos:u.exit.map(Vt.idOf)})})}addData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(r)})}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:Rt.ChangeType.NodeAdded}),(0,Ve.toGraphlibData)(t)))),this.updateNodeLikeHierarchy(e))}addEdgeData(e=[]){e.length&&this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:Rt.ChangeType.EdgeAdded}),(0,Ve.toGraphlibData)(t))))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(Rt.COMBO_KEY)||t.attachTreeStructure(Rt.COMBO_KEY),t.addNodes(e.map(r=>(this.comboIds.add((0,Vt.idOf)(r)),this.pushChange({value:r,type:Rt.ChangeType.ComboAdded}),(0,Ve.toGraphlibData)(r)))),this.updateNodeLikeHierarchy(e)}addChildrenData(e,t){const r=this.getNodeLikeDatum(e),i=t.map(Vt.idOf);this.addNodeData(t),this.updateNodeData([{id:e,children:[...r.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(r=>{const i=(0,Vt.idOf)(r);t.attachTreeStructure(Rt.COMBO_KEY),this.setParent(i,(0,Vt.parentIdOf)(r),Rt.COMBO_KEY);const a=r.children;if(a!==void 0){t.attachTreeStructure(Rt.TREE_KEY);const s=a.filter(o=>t.hasNode(o));s.forEach(o=>this.setParent(o,i,Rt.TREE_KEY)),s.length!==a.length&&this.updateNodeData([{id:i,children:s}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(r)})}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const r=[];e.forEach(i=>{const a=(0,Vt.idOf)(i),s=(0,Ve.toG6Data)(t.getNode(a));if((0,jl.isEqual)(s,i))return;const o=(0,zr.mergeElementsData)(s,i);this.pushChange({value:o,original:s,type:Rt.ChangeType.NodeUpdated}),t.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)})}refreshData(){const{nodes:e,edges:t,combos:r}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:Rt.ChangeType.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:Rt.ChangeType.EdgeUpdated})}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Rt.ChangeType.ComboUpdated})})}syncNodeDatum(e){const{model:t}=this,r=(0,Vt.idOf)(e),i=(0,Ve.toG6Data)(t.getNode(r)),a=(0,zr.mergeElementsData)(i,e);t.mergeNodeData(r,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(r=>{const i=(0,Vt.idOf)(r),a=(0,Ve.toG6Data)(t.getEdge(i));if((0,jl.isEqual)(a,r))return;r.source&&a.source!==r.source&&t.updateEdgeSource(i,r.source),r.target&&a.target!==r.target&&t.updateEdgeTarget(i,r.target);const s=(0,zr.mergeElementsData)(a,r);this.pushChange({value:s,original:a,type:Rt.ChangeType.EdgeUpdated}),t.mergeEdgeData(i,s)})})}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const r=[];e.forEach(i=>{const a=(0,Vt.idOf)(i),s=(0,Ve.toG6Data)(t.getNode(a));if((0,jl.isEqual)(s,i))return;const o=(0,zr.mergeElementsData)(s,i);this.pushChange({value:o,original:s,type:Rt.ChangeType.ComboUpdated}),t.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)})}setParent(e,t,r,i=!0){if(e===t)return;const a=(0,Vt.parentIdOf)(this.getNodeLikeDatum(e));if(a!==t&&r===Rt.COMBO_KEY){const s={id:e,combo:t};this.isCombo(e)?this.syncComboDatum(s):this.syncNodeDatum(s)}this.model.setParent(e,t,r),i&&r===Rt.COMBO_KEY&&(0,jl.uniq)([a,t]).forEach(s=>{s!==void 0&&this.refreshComboData(s)})}refreshComboData(e){const t=this.getComboData([e])[0],r=this.getAncestorsData(e,Rt.COMBO_KEY);t&&this.pushChange({value:t,original:t,type:Rt.ChangeType.ComboUpdated}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Rt.ChangeType.ComboUpdated})})}syncComboDatum(e){const{model:t}=this,r=(0,Vt.idOf)(e);if(!t.hasNode(r))return;const i=(0,Ve.toG6Data)(t.getNode(r)),a=(0,zr.mergeElementsData)(i,e);t.mergeNodeData(r,a)}getElementPosition(e){const t=this.getElementDataById(e);return(0,Kf.positionOf)(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const r=this.getElementPosition(e),i=(0,Wvt.add)(r,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[r=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:r,y:i,z:a}}])})}translateComboBy(e,t){const[r=0,i=0,a=0]=t;if([r,i,a].some(isNaN)||[r,i,a].every(o=>o===0))return;const s=this.getComboData([e])[0];s&&(0,mx.dfs)(s,o=>{const c=(0,Vt.idOf)(o),[l,u,h]=(0,Kf.positionOf)(o),f=(0,zr.mergeElementsData)(o,{style:{x:l+r,y:u+i,z:h+a}});this.pushChange({value:f,original:o,type:this.isCombo(c)?Rt.ChangeType.ComboUpdated:Rt.ChangeType.NodeUpdated}),this.model.mergeNodeData(c,f)},o=>this.getChildrenData((0,Vt.idOf)(o)),"BT")}translateComboTo(e,t){var d;if(t.some(isNaN))return;const[r=0,i=0,a=0]=t,s=(d=this.getComboData([e]))==null?void 0:d[0];if(!s)return;const[o,c,l]=(0,Kf.positionOf)(s),u=r-o,h=i-c,f=a-l;(0,mx.dfs)(s,p=>{const g=(0,Vt.idOf)(p),[v,m,y]=(0,Kf.positionOf)(p),b=(0,zr.mergeElementsData)(p,{style:{x:v+u,y:m+h,z:y+f}});this.pushChange({value:b,original:p,type:this.isCombo(g)?Rt.ChangeType.ComboUpdated:Rt.ChangeType.NodeUpdated}),this.model.mergeNodeData(g,b)},p=>this.getChildrenData((0,Vt.idOf)(p)),"BT")}removeData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(Vt.idOf)),this.pushChange({value:this.getNodeData([t])[0],type:Rt.ChangeType.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Rt.ChangeType.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Rt.ChangeType.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(Rt.COMBO_KEY)){const t=(0,Vt.parentIdOf)(this.getNodeLikeDatum(e));this.setParent(e,void 0,Rt.COMBO_KEY,!1),this.model.getChildren(e,Rt.COMBO_KEY).forEach(r=>{const i=(0,Ve.toG6Data)(r),a=(0,Vt.idOf)(i);this.setParent((0,Vt.idOf)(i),t,Rt.COMBO_KEY,!1);const s=(0,zr.mergeElementsData)(i,{id:(0,Vt.idOf)(i),combo:t});this.pushChange({value:s,original:i,type:this.isCombo(a)?Rt.ChangeType.ComboUpdated:Rt.ChangeType.NodeUpdated}),this.model.mergeNodeData((0,Vt.idOf)(i),s)}),(0,jl.isUndefined)(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error((0,X6.format)(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),r=e.getAllEdges();e.removeEdges(r.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}k0.DataController=Hvt;var ql={},Z6;function Uvt(){if(Z6)return ql;Z6=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.ElementController=void 0;const n=Pe,e=bt,t=Ft,r=wn,i=Ys(),a=_i,s=Pc,o=ra,c=Ln(),l=Mc(),u=Gt,h=U_(),f=Un,d=hr,p=Ne,g=N9();class v{constructor(y){A(this,"context");A(this,"container");A(this,"elementMap",{});A(this,"shapeTypeMap",{});A(this,"paletteStyle",{});A(this,"defaultStyle",{});A(this,"stateStyle",{});this.context=y}init(){if(!this.container){const{canvas:y}=this.context;this.container=y.appendChild(new n.Group)}}emit(y,b){b.silence||(0,l.emit)(this.context.graph,y)}forEachElementData(y){r.ELEMENT_TYPES.forEach(b=>{const w=this.context.model.getElementsDataByType(b);y(b,w)})}getElementType(y,b){var _;const{options:w,graph:x}=this.context,S=((_=w[y])==null?void 0:_.type)||b.type;return S?typeof S=="string"?S:S.call(x,b):y==="edge"?"line":"circle"}getTheme(y){return(0,g.themeOf)(this.context.options)[y]||{}}getThemeStyle(y){return this.getTheme(y).style||{}}getThemeStateStyle(y,b){const{state:w={}}=this.getTheme(y);return Object.assign({},...b.map(x=>w[x]||{}))}computePaletteStyle(){const{options:y}=this.context;this.paletteStyle={},this.forEachElementData((b,w)=>{var S,_;const x=Object.assign({},(0,h.parsePalette)((S=this.getTheme(b))==null?void 0:S.palette),(0,h.parsePalette)((_=y[b])==null?void 0:_.palette));x!=null&&x.field&&Object.assign(this.paletteStyle,(0,h.assignColorByPalette)(w,x))})}getPaletteStyle(y,b){const w=this.paletteStyle[b];return w?y==="edge"?{stroke:w}:{fill:w}:{}}computeElementDefaultStyle(y,b){var S;const{options:w}=this.context,x=((S=w[y])==null?void 0:S.style)||{};this.defaultStyle[(0,u.idOf)(b.datum)]=(0,p.computeElementCallbackStyle)(x,b)}computeElementsDefaultStyle(y){const{graph:b}=this.context;this.forEachElementData((w,x)=>{const S=x.length;for(let _=0;_<S;_++){const E=x[_];(y===void 0||y.includes((0,u.idOf)(E)))&&this.computeElementDefaultStyle(w,{datum:E,graph:b})}})}getDefaultStyle(y){return this.defaultStyle[y]||{}}getElementState(y){try{const{model:b}=this.context;return b.getElementState(y)}catch{return[]}}getElementStateStyle(y,b,w){var _,E;const{options:x}=this.context,S=((E=(_=x[y])==null?void 0:_.state)==null?void 0:E[b])||{};return(0,p.computeElementCallbackStyle)(S,w)}computeElementStatesStyle(y,b,w){this.stateStyle[(0,u.idOf)(w.datum)]=Object.assign({},...b.map(x=>this.getElementStateStyle(y,x,w)))}computeElementsStatesStyle(y){const{graph:b}=this.context;this.forEachElementData((w,x)=>{const S=x.length;for(let _=0;_<S;_++){const E=x[_];if(y===void 0||y.includes((0,u.idOf)(E))){const P=this.getElementState((0,u.idOf)(E));this.computeElementStatesStyle(w,P,{datum:E,graph:b})}}})}getStateStyle(y){return this.stateStyle[y]||{}}computeStyle(y,b){y&&["translate","zIndex"].includes(y)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(b),this.computeElementsStatesStyle(b))}getElement(y){return this.elementMap[y]}getElementZIndex(y){const b=this.getElement(y);return b?b.style.zIndex??0:0}getNodes(){return this.context.model.getNodeData().map(({id:y})=>this.elementMap[y])}getEdges(){return this.context.model.getEdgeData().map(y=>this.elementMap[(0,u.idOf)(y)])}getCombos(){return this.context.model.getComboData().map(({id:y})=>this.elementMap[y])}getElementComputedStyle(y,b){const w=(0,u.idOf)(b),x=this.getThemeStyle(y),S=this.getPaletteStyle(y,w),_=b.style||{},E=this.getDefaultStyle(w),P=this.getThemeStateStyle(y,this.getElementState(w)),O=this.getStateStyle(w),C=Object.assign({},x,S,_,E,P,O);if(y==="combo"){const M=this.context.model.getChildrenData(w),R=!!C.collapsed?[]:M.map(u.idOf).filter(D=>this.getElement(D));Object.assign(C,{childrenNode:R,childrenData:M})}return C}draw(y={animation:!0}){this.init();const b=this.computeChangesAndDrawData(y);if(!b)return null;const{dataChanges:w,drawData:x}=b;this.markDestroyElement(x),this.computeStyle(y.stage);const{add:S,update:_,remove:E}=x;this.destroyElements(E,y),this.createElements(S,y),this.updateElements(_,y);const{animation:P,silence:O}=y;return this.context.animation.animate(P,O?{}:{before:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.BEFORE_DRAW,{dataChanges:w,animation:P}),y),beforeAnimate:C=>this.emit(new l.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.DRAW,C,x),y),afterAnimate:C=>this.emit(new l.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.DRAW,C,x),y),after:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.AFTER_DRAW,{dataChanges:w,animation:P}),y)})}computeChangesAndDrawData(y){const{model:b}=this.context,w=b.getChanges(),x=(0,s.reduceDataChanges)(w);if(x.length===0)return null;const{NodeAdded:S=[],NodeUpdated:_=[],NodeRemoved:E=[],EdgeAdded:P=[],EdgeUpdated:O=[],EdgeRemoved:C=[],ComboAdded:M=[],ComboUpdated:T=[],ComboRemoved:R=[]}=(0,e.groupBy)(x,L=>L.type),D=L=>new Map(L.map($=>{const V=$.value;return[(0,u.idOf)(V),V]})),B={add:{nodes:D(S),edges:D(P),combos:D(M)},update:{nodes:D(_),edges:D(O),combos:D(T)},remove:{nodes:D(E),edges:D(C),combos:D(R)}},j=this.transformData(B,y);return b.clearChanges(),{dataChanges:w,drawData:j}}transformData(y,b){const w=this.context.transform.getTransformInstance();return Object.values(w).reduce((x,S)=>S.beforeDraw(x,b),y)}createElement(y,b,w){var M;const x=(0,u.idOf)(b);if(this.getElement(x))return;const _=this.getElementType(y,b),E=this.getElementComputedStyle(y,b),P=(0,i.getExtension)(y,_);if(!P)return d.print.warn(`The element ${_} of ${y} is not registered.`);this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.BEFORE_ELEMENT_CREATE,y,b),w);const O=this.container.appendChild(new P({id:x,style:{context:this.context,...E}}));this.shapeTypeMap[x]=_,this.elementMap[x]=O;const{stage:C="enter"}=w;(M=this.context.animation)==null||M.add({element:O,elementType:y,stage:C,originalStyle:{...O.attributes},modifiedStyle:{...O.attributes,...E}},{after:()=>{var T;this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.AFTER_ELEMENT_CREATE,y,b),w),(T=O.onCreate)==null||T.call(O)}})}createElements(y,b){const{nodes:w,edges:x,combos:S}=y;[["node",w],["combo",S],["edge",x]].forEach(([E,P])=>{P.forEach(O=>this.createElement(E,O,b))})}updateElement(y,b,w){var C;const x=(0,u.idOf)(b),S=this.getElement(x);if(!S)return()=>null;this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.BEFORE_ELEMENT_UPDATE,y,b),w);const _=this.getElementType(y,b),E=this.getElementComputedStyle(y,b);this.shapeTypeMap[x]!==_&&(S.destroy(),delete this.shapeTypeMap[x],delete this.elementMap[x],this.createElement(y,b,{animation:!1,silence:!0}));const{stage:P="update"}=w,O=P!=="visibility"?P:E.visibility==="hidden"?"hide":"show";(C=this.context.animation)==null||C.add({element:S,elementType:y,stage:O,originalStyle:{...S.attributes},modifiedStyle:{...S.attributes,...E}},{before:()=>{const M=this.elementMap[x];P!=="collapse"&&(0,c.updateStyle)(M,E),P==="visibility"&&((0,a.hasCachedStyle)(M,"opacity")||(0,a.cacheStyle)(M,"opacity"),(0,a.setCacheStyle)(M,"visibility",O==="show"?"visible":"hidden"),O==="show"&&(0,c.updateStyle)(M,{visibility:"visible"}))},after:()=>{var T;const M=this.elementMap[x];P==="collapse"&&(0,c.updateStyle)(M,E),O==="hide"&&(0,c.updateStyle)(M,{visibility:(0,a.getCachedStyle)(M,"visibility")}),this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.AFTER_ELEMENT_UPDATE,y,b),w),(T=M.onUpdate)==null||T.call(M)}})}updateElements(y,b){const{nodes:w,edges:x,combos:S}=y;[["node",w],["combo",S],["edge",x]].forEach(([E,P])=>{P.forEach(O=>this.updateElement(E,O,b))})}markDestroyElement(y){Object.values(y.remove).forEach(b=>{b.forEach(w=>{const x=(0,u.idOf)(w),S=this.getElement(x);S&&(0,c.markToBeDestroyed)(S)})})}destroyElement(y,b,w){var E;const{stage:x="exit"}=w,S=(0,u.idOf)(b),_=this.elementMap[S];if(!_)return()=>null;this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.BEFORE_ELEMENT_DESTROY,y,b),w),(E=this.context.animation)==null||E.add({element:_,elementType:y,stage:x,originalStyle:{..._.attributes},modifiedStyle:{..._.attributes}},{after:()=>{var P;this.clearElement(S),_.destroy(),(P=_.onDestroy)==null||P.call(_),this.emit(new l.ElementLifeCycleEvent(t.GraphEvent.AFTER_ELEMENT_DESTROY,y,b),w)}})}destroyElements(y,b){const{nodes:w,edges:x,combos:S}=y;[["combo",S],["edge",x],["node",w]].forEach(([E,P])=>{P.forEach(O=>this.destroyElement(E,O,b))})}clearElement(y){delete this.paletteStyle[y],delete this.defaultStyle[y],delete this.stateStyle[y],delete this.elementMap[y],delete this.shapeTypeMap[y]}async collapseNode(y,b){var T;const{model:w,layout:x}=this.context,S=this.computeChangesAndDrawData({stage:"collapse",animation:b});this.markDestroyElement(S.drawData);const _=await x.simulate();w.updateData(_);const{drawData:E}=this.computeChangesAndDrawData({stage:"collapse",animation:b}),{add:P,remove:O,update:C}=E;this.markDestroyElement(E);const M={animation:b,stage:"collapse",data:E};this.destroyElements(O,M),this.createElements(P,M),this.updateElements(C,M),await((T=this.context.animation.animate(b,{beforeAnimate:R=>this.emit(new l.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.COLLAPSE,R,E),M),afterAnimate:R=>this.emit(new l.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.COLLAPSE,R,E),M)},{collapse:{target:y,descendants:Array.from(O.nodes).map(([,R])=>(0,u.idOf)(R)),position:(0,f.positionOf)(C.nodes.get(y))}}))==null?void 0:T.finished)}async expandNode(y,b){var M;const{model:w,layout:x}=this.context;if(!w.getAncestorsData(y,t.COMBO_KEY).every(T=>(0,o.isCollapsed)(T)))return;const S=(0,f.positionOf)(w.getNodeData([y])[0]),{drawData:{add:_}}=this.computeChangesAndDrawData({stage:"collapse",animation:b});this.createElements(_,{animation:!1,stage:"expand"}),this.context.animation.clear();const E=await x.simulate();w.updateData(E),this.computeStyle("expand");const{drawData:P}=this.computeChangesAndDrawData({stage:"collapse",animation:b}),{update:O}=P,C={animation:b,stage:"expand",data:P};_.edges.forEach(T=>{const R=(0,u.idOf)(T);O.edges.has(R)||O.edges.set(R,T)}),this.updateElements(O,C),await((M=this.context.animation.animate(b,{beforeAnimate:T=>this.emit(new l.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.EXPAND,T,P),C),afterAnimate:T=>this.emit(new l.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.EXPAND,T,P),C)},{expand:{target:y,descendants:Array.from(_.nodes).map(([,T])=>(0,u.idOf)(T)),position:S}}))==null?void 0:M.finished)}async collapseCombo(y,b){var R;const{model:w,element:x}=this.context;if(w.getAncestorsData(y,t.COMBO_KEY).some(D=>(0,o.isCollapsed)(D)))return;const S=x.getElement(y),_=S.getComboPosition({...S.attributes,collapsed:!0}),{dataChanges:E,drawData:P}=this.computeChangesAndDrawData({stage:"collapse",animation:b});this.markDestroyElement(P);const{update:O,remove:C}=P,M={animation:b,stage:"collapse",data:P};this.destroyElements(C,M),this.updateElements(O,M);const T=D=>Array.from(D).map(([,B])=>(0,u.idOf)(B));await((R=this.context.animation.animate(b,{before:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.BEFORE_DRAW,{dataChanges:E,animation:b}),M),beforeAnimate:D=>this.emit(new l.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.COLLAPSE,D,P),M),afterAnimate:D=>this.emit(new l.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.COLLAPSE,D,P),M),after:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.AFTER_DRAW,{dataChanges:E,animation:b}),M)},{collapse:{target:y,descendants:[...T(C.nodes),...T(C.combos)],position:_}}))==null?void 0:R.finished)}async expandCombo(y,b){var M;const{model:w}=this.context,x=(0,f.positionOf)(w.getComboData([y])[0]);this.computeStyle("expand");const{dataChanges:S,drawData:_}=this.computeChangesAndDrawData({stage:"expand",animation:b}),{add:E,update:P}=_,O={animation:b,stage:"expand",data:_};this.createElements(E,O),this.updateElements(P,O);const C=T=>Array.from(T).map(([,R])=>(0,u.idOf)(R));await((M=this.context.animation.animate(b,{before:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.BEFORE_DRAW,{dataChanges:S,animation:b}),O),beforeAnimate:T=>this.emit(new l.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.EXPAND,T,_),O),afterAnimate:T=>this.emit(new l.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.EXPAND,T,_),O),after:()=>this.emit(new l.GraphLifeCycleEvent(t.GraphEvent.AFTER_DRAW,{dataChanges:S,animation:b}),O)},{expand:{target:y,descendants:[...C(E.nodes),...C(E.combos)],position:x}}))==null?void 0:M.finished)}getFrontZIndex(y){const{model:b}=this.context,w=b.getElementType(y),x=b.getElementDataById(y),S=b.getData();if(Object.assign(S,{[`${w}s`]:S[`${w}s`].filter(_=>(0,u.idOf)(_)!==y)}),w==="combo"&&!(0,o.isCollapsed)(x)){const _=b.getAncestorsData(y,t.COMBO_KEY).map(u.idOf);S.nodes=S.nodes.filter(E=>!_.includes((0,u.idOf)(E))),S.combos=S.combos.filter(E=>!_.includes((0,u.idOf)(E))),S.edges=S.edges.filter(({source:E,target:P})=>_.includes(E)&&_.includes(P))}return Math.max(0,...Object.values(S).flat().map(_=>{const E=(0,u.idOf)(_);return this.getElementZIndex(E)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}return ql.ElementController=v,ql}var Gl={},Q6;function Yvt(){if(Q6)return Gl;Q6=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.LayoutController=void 0;const n=F_,e=H9,t=bt,r=Ft,i=P0,a=Ys(),s=_c(),o=Ln(),c=Mc(),l=Tc,u=Gt,h=ei,f=hr,d=Si,p=Vs;class g{constructor(m){A(this,"context");A(this,"supervisor");A(this,"instance");A(this,"instances",[]);A(this,"animationResult");this.context=m}get presetOptions(){return{animation:!!(0,s.getAnimationOptions)(this.context.options,!0)}}get options(){const{options:m}=this.context;return m.layout}getLayoutInstance(){return this.instances}async layout(){if(!this.options)return;const m=Array.isArray(this.options)?this.options:[this.options],{graph:y}=this.context;(0,c.emit)(y,new c.GraphLifeCycleEvent(r.GraphEvent.BEFORE_LAYOUT));for(const b of m){const w=m.indexOf(b),x=this.getLayoutData(b),S={...this.presetOptions,...b};(0,c.emit)(y,new c.GraphLifeCycleEvent(r.GraphEvent.BEFORE_STAGE_LAYOUT,{options:S,index:w}));const _=await this.stepLayout(x,S,w);(0,c.emit)(y,new c.GraphLifeCycleEvent(r.GraphEvent.AFTER_STAGE_LAYOUT,{options:S,index:w})),b.animation||this.updateElementPosition(_,!1)}(0,c.emit)(y,new c.GraphLifeCycleEvent(r.GraphEvent.AFTER_LAYOUT))}async simulate(){if(!this.options)return{};const m=Array.isArray(this.options)?this.options:[this.options];let y={};for(const b of m){const w=m.indexOf(b),x=this.getLayoutData(b);y=await this.stepLayout(x,{...this.presetOptions,...b,animation:!1},w)}return y}async stepLayout(m,y,b){return(0,h.isTreeLayout)(y)?await this.treeLayout(m,y,b):await this.graphLayout(m,y,b)}async graphLayout(m,y,b){const{animation:w,enableWorker:x,iterations:S=300}=y,_=this.initGraphLayout(y);if(!_)return{};if(this.instances[b]=_,this.instance=_,x){const P=_;return this.supervisor=new e.Supervisor(P.graphData2LayoutModel(m),P.instance,{iterations:S}),(0,h.layoutMapping2GraphData)(await this.supervisor.execute())}if((0,e.isLayoutWithIterations)(_))return w?await _.execute(m,{onTick:P=>{this.updateElementPosition(P,!1)}}):(_.execute(m),_.stop(),_.tick(S));const E=await _.execute(m);return w&&this.updateElementPosition(E,w),E}async treeLayout(m,y,b){const{type:w,animation:x}=y,S=(0,a.getExtension)("layout",w);if(!S)return{};const{nodes:_=[],edges:E=[]}=m,P=new n.Graph({nodes:_.map(M=>({id:(0,u.idOf)(M),data:M.data||{}})),edges:E.map(M=>({id:(0,u.idOf)(M),source:M.source,target:M.target,data:M.data||{}}))});(0,l.createTreeStructure)(P);const O={nodes:[],edges:[]};return P.getRoots(r.TREE_KEY).forEach(M=>{(0,p.dfs)(M,R=>{R.children=P.getSuccessors(R.id)},R=>P.getSuccessors(R.id),"TB");const T=S(M,y);(0,p.dfs)(T,R=>{const{id:D,x:B,y:j,z:L=0}=R;O.nodes.push({id:D,style:{x:B,y:j,z:L}})},R=>R.children,"TB")}),x&&this.updateElementPosition(O,x),O}stopLayout(){this.instance&&(0,e.isLayoutWithIterations)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(m){const{nodeFilter:y=()=>!0}=m,{nodes:b,edges:w,combos:x}=this.context.model.getData(),S=O=>this.context.element.getElement(O),_=b.filter(O=>{const C=(0,u.idOf)(O),M=S(C);return!M||(0,o.isToBeDestroyed)(M)?!1:y(O)}),E=new Map(_.map(O=>[(0,u.idOf)(O),O])),P=w.filter(O=>{const{source:C,target:M}=O;return!(!E.has(C)||!E.has(M))});return{nodes:_,edges:P,combos:x}}initGraphLayout(m){const{element:y,viewport:b}=this.context,{type:w,enableWorker:x,animation:S,iterations:_,...E}=m,[P,O]=b.getCanvasSize(),C=[P/2,O/2],M=(m==null?void 0:m.nodeSize)??(j=>{const L=y==null?void 0:y.getElement(j.id),{size:$}=(L==null?void 0:L.attributes)||{};return Math.max(...(0,d.parseSize)($))}),T=(0,a.getExtension)("layout",w);if(!T)return f.print.warn(`The layout of ${w} is not registered.`);const R=Object.getPrototypeOf(T.prototype)===i.BaseLayout.prototype?T:(0,h.layoutAdapter)(T,this.context),D=new R(this.context),B={nodeSize:M,width:P,height:O,center:C};switch(D.id){case"d3-force":case"d3-force-3d":Object.assign(B,{center:{x:P/2,y:O/2,z:0}});break}return(0,t.deepMix)(D.options,B,E),D}updateElementPosition(m,y){const{model:b,element:w}=this.context;return w?(b.updateData(m),w.draw({animation:y,silence:!0})):null}destroy(){var m;this.stopLayout(),this.context={},(m=this.supervisor)==null||m.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}return Gl.LayoutController=g,Gl}var Vl={},J6;function Kvt(){if(J6)return Vl;J6=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.PluginController=void 0;const n=Oc();class e extends n.ExtensionController{constructor(i){super(i);A(this,"category","plugin");this.setPlugins(this.context.options.plugins||[])}setPlugins(i){this.setExtensions(i)}getPluginInstance(i){return this.extensionMap[i]}}return Vl.PluginController=e,Vl}var yx={},tk;function Xvt(){return tk||(tk=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TransformController=n.REQUIRED_TRANSFORMS=void 0;const e=Oc();n.REQUIRED_TRANSFORMS=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class t extends e.ExtensionController{constructor(a){super(a);A(this,"category","transform");this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(a){this.setExtensions([...n.REQUIRED_TRANSFORMS.slice(0,n.REQUIRED_TRANSFORMS.length-1),...a,n.REQUIRED_TRANSFORMS[n.REQUIRED_TRANSFORMS.length-1]])}getTransformInstance(a){return a?this.extensionMap[a]:this.extensionMap}}n.TransformController=t}(yx)),yx}var Wl={},ek;function Zvt(){if(ek)return Wl;ek=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.ViewportController=void 0;const n=Pe,e=bt,t=Ft,r=_c(),i=de,a=Mc(),s=qs,o=Kt;class c{constructor(u){A(this,"context");A(this,"landmarkCounter",0);A(this,"transformResolver");this.context=u;const[h,f]=this.paddingOffset,{zoom:d,rotation:p,x:g=h,y:v=f}=u.options;this.transform({mode:"absolute",scale:d,translate:[g,v],rotate:p},!1)}get padding(){return(0,s.parsePadding)(this.context.options.padding)}get paddingOffset(){const[u,h,f,d]=this.padding,[p,g,v]=[(d-h)/2,(u-f)/2,0];return[p,g,v]}get camera(){return this.context.canvas.getCamera()}createLandmark(u){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,u)}getAnimation(u){const h=(0,r.getAnimationOptions)(this.context.options,u);return h?(0,e.pick)({...h},["easing","duration"]):!1}getCanvasSize(){const{canvas:u}=this.context,{width:h=0,height:f=0}=u.getConfig();return[h,f]}getCanvasCenter(){const{canvas:u}=this.context,{width:h=0,height:f=0}=u.getConfig();return[h/2,f/2,0]}getViewportCenter(){const[u,h]=this.camera.getPosition();return[u,h,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(u){const{camera:h}=this,{mode:f,translate:d=[]}=u,p=this.getZoom(),g=h.getPosition(),v=h.getFocalPoint(),[m,y]=this.getCanvasCenter(),[b=0,w=0,x=0]=d,S=(0,o.divide)([-b,-w,-x],p);return f==="relative"?{position:(0,o.add)(g,S),focalPoint:(0,o.add)(v,S)}:{position:(0,o.add)([m,y,g[2]],S),focalPoint:(0,o.add)([m,y,v[2]],S)}}getRotateOptions(u){const{mode:h,rotate:f=0}=u;return{roll:h==="relative"?this.camera.getRoll()+f:f}}getZoomOptions(u){const{zoomRange:h}=this.context.options,f=this.camera.getZoom(),{mode:d,scale:p=1}=u;return(0,e.clamp)(d==="relative"?f*p:p,...h)}async transform(u,h){const{graph:f}=this.context,{translate:d,rotate:p,scale:g,origin:v}=u;this.cancelAnimation();const m=this.getAnimation(h);if((0,a.emit)(f,new a.ViewportEvent(t.GraphEvent.BEFORE_TRANSFORM,u)),!p&&g&&!d&&v&&!m){this.camera.setZoomByViewportPoint(this.getZoomOptions(u),v),(0,a.emit)(f,new a.ViewportEvent(t.GraphEvent.AFTER_TRANSFORM,u));return}const y={};if(d&&Object.assign(y,this.getTranslateOptions(u)),(0,e.isNumber)(p)&&Object.assign(y,this.getRotateOptions(u)),(0,e.isNumber)(g)&&Object.assign(y,{zoom:this.getZoomOptions(u)}),m)return(0,a.emit)(f,new a.AnimateEvent(t.GraphEvent.BEFORE_ANIMATE,t.AnimationType.TRANSFORM,null,u)),new Promise(b=>{this.transformResolver=b,this.camera.gotoLandmark(this.createLandmark(y),{...m,onfinish:()=>{(0,a.emit)(f,new a.AnimateEvent(t.GraphEvent.AFTER_ANIMATE,t.AnimationType.TRANSFORM,null,u)),(0,a.emit)(f,new a.ViewportEvent(t.GraphEvent.AFTER_TRANSFORM,u)),this.transformResolver=void 0,b()}})});this.camera.gotoLandmark(this.createLandmark(y),{duration:0}),(0,a.emit)(f,new a.ViewportEvent(t.GraphEvent.AFTER_TRANSFORM,u))}async fitView(u,h){const[f,d,p,g]=this.padding,{when:v="always",direction:m="both"}=u||{},[y,b]=this.context.canvas.getSize(),w=y-g-d,x=b-f-p,S=this.context.canvas.getBounds(),_=this.getBBoxInViewport(S),[E,P]=(0,i.getBBoxSize)(_),O=m==="x"&&E>=w||m==="y"&&P>=x||m==="both"&&E>=w&&P>=x;if(v==="overflow"&&!O)return await this.fitCenter(h);const C=w/E,M=x/P,T=m==="x"?C:m==="y"?M:Math.min(C,M),R=this.getAnimation(h);await this.transform({mode:"relative",scale:T,translate:(0,o.add)((0,o.subtract)(this.getCanvasCenter(),this.getBBoxInViewport(S).center),(0,o.divide)(this.paddingOffset,T))},R)}async fitCenter(u){const h=this.context.canvas.getBounds();await this.focus(h,u)}async focusElements(u,h){const{element:f}=this.context;if(!f)return;const d=(0,i.getCombinedBBox)(u.map(p=>f.getElement(p).getRenderBounds()));await this.focus(d,h)}async focus(u,h){const f=this.context.graph.getViewportByCanvas(u.center),d=this.getCanvasCenter(),p=(0,o.subtract)(d,f);await this.transform({mode:"relative",translate:(0,o.add)(p,this.paddingOffset)},h)}getBBoxInViewport(u){const{min:h,max:f}=u,{graph:d}=this.context,[p,g]=d.getViewportByCanvas(h),[v,m]=d.getViewportByCanvas(f),y=new n.AABB;return y.setMinMax([p,g,0],[v,m,0]),y}cancelAnimation(){var u,h;(u=this.camera.landmarks)!=null&&u.length&&this.camera.cancelLandmarkAnimation(),(h=this.transformResolver)==null||h.call(this)}}return Wl.ViewportController=c,Wl}var nk;function Qvt(){if(nk)return Bl;nk=1;var n=jt&&jt.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.Graph=void 0;const e=n(U9),t=bt,r=Ft,i=ra,a=ni,s=Mc(),o=Gt,c=hr,l=Kt,u=Tvt(),h=Avt(),f=Nvt(),d=R0,p=k0,g=Uvt(),v=Yvt(),m=Kvt(),y=Xvt(),b=Zvt(),x=class x extends e.default{constructor(E){super();A(this,"options");A(this,"destroyed",!1);A(this,"context",{model:new p.DataController});A(this,"isCollapsingExpanding",!1);A(this,"onResize",(0,t.debounce)(()=>{this.resize()},300));this.options=Object.assign({},x.defaultOptions,E),this.setOptions(this.options),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}getOptions(){return this.options}setOptions(E){const{behaviors:P,combo:O,data:C,edge:M,height:T,layout:R,node:D,plugins:B,theme:j,transforms:L,width:$,renderer:V}=E;if(V){const W=this.context.canvas;W&&(this.emit(r.GraphEvent.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),W.setRenderer(V),this.emit(r.GraphEvent.AFTER_RENDERER_CHANGE,{renderer:V}))}Object.assign(this.options,E),P&&this.setBehaviors(P),O&&this.setCombo(O),C&&this.setData(C),M&&this.setEdge(M),R&&this.setLayout(R),D&&this.setNode(D),j&&this.setTheme(j),B&&this.setPlugins(B),L&&this.setTransforms(L),((0,t.isNumber)($)||(0,t.isNumber)(T))&&this.setSize($??this.options.width??0,T??this.options.height??0)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(E,P){var O;Object.assign(this.options,{width:E,height:P}),(O=this.context.canvas)==null||O.resize(E,P)}setZoomRange(E){this.options.zoomRange=E}getZoomRange(){return this.options.zoomRange}setNode(E){this.options.node=E,this.context.model.refreshData()}setEdge(E){this.options.edge=E,this.context.model.refreshData()}setCombo(E){this.options.combo=E,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(E){this.options.theme=(0,t.isFunction)(E)?E(this.getTheme()):E}setLayout(E){this.options.layout=(0,t.isFunction)(E)?E(this.getLayout()):E}getLayout(){return this.options.layout}setBehaviors(E){var P;this.options.behaviors=(0,t.isFunction)(E)?E(this.getBehaviors()):E,(P=this.context.behavior)==null||P.setBehaviors(this.options.behaviors)}updateBehavior(E){this.setBehaviors(P=>P.map(O=>typeof O=="object"&&O.key===E.key?{...O,...E}:O))}getBehaviors(){return this.options.behaviors||[]}setPlugins(E){var P;this.options.plugins=(0,t.isFunction)(E)?E(this.getPlugins()):E,(P=this.context.plugin)==null||P.setPlugins(this.options.plugins)}updatePlugin(E){this.setPlugins(P=>P.map(O=>typeof O=="object"&&O.key===E.key?{...O,...E}:O))}getPlugins(){return this.options.plugins||[]}getPluginInstance(E){return this.context.plugin.getPluginInstance(E)}setTransforms(E){var P;this.options.transforms=(0,t.isFunction)(E)?E(this.getTransforms()):E,(P=this.context.transform)==null||P.setTransforms(this.options.transforms)}updateTransform(E){this.setTransforms(P=>P.map(O=>typeof O=="object"&&O.key===E.key?{...O,...E}:O)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(E){return Array.isArray(E)?E.map(P=>this.context.model.getElementDataById(P)):this.context.model.getElementDataById(E)}getNodeData(E){var P;return E===void 0?this.context.model.getNodeData():Array.isArray(E)?this.context.model.getNodeData(E):(P=this.context.model.getNodeData([E]))==null?void 0:P[0]}getEdgeData(E){var P;return E===void 0?this.context.model.getEdgeData():Array.isArray(E)?this.context.model.getEdgeData(E):(P=this.context.model.getEdgeData([E]))==null?void 0:P[0]}getComboData(E){var P;return E===void 0?this.context.model.getComboData():Array.isArray(E)?this.context.model.getComboData(E):(P=this.context.model.getComboData([E]))==null?void 0:P[0]}setData(E){this.context.model.setData((0,t.isFunction)(E)?E(this.getData()):E)}addData(E){this.context.model.addData((0,t.isFunction)(E)?E(this.getData()):E)}addNodeData(E){this.context.model.addNodeData((0,t.isFunction)(E)?E(this.getNodeData()):E)}addEdgeData(E){this.context.model.addEdgeData((0,t.isFunction)(E)?E(this.getEdgeData()):E)}addComboData(E){this.context.model.addComboData((0,t.isFunction)(E)?E(this.getComboData()):E)}addChildrenData(E,P){this.context.model.addChildrenData(E,P)}updateData(E){this.context.model.updateData((0,t.isFunction)(E)?E(this.getData()):E)}updateNodeData(E){this.context.model.updateNodeData((0,t.isFunction)(E)?E(this.getNodeData()):E)}updateEdgeData(E){this.context.model.updateEdgeData((0,t.isFunction)(E)?E(this.getEdgeData()):E)}updateComboData(E){this.context.model.updateComboData((0,t.isFunction)(E)?E(this.getComboData()):E)}removeData(E){this.context.model.removeData((0,t.isFunction)(E)?E(this.getData()):E)}removeNodeData(E){this.context.model.removeNodeData((0,t.isFunction)(E)?E(this.getNodeData()):E)}removeEdgeData(E){this.context.model.removeEdgeData((0,t.isFunction)(E)?E(this.getEdgeData()):E)}removeComboData(E){this.context.model.removeComboData((0,t.isFunction)(E)?E(this.getComboData()):E)}getElementType(E){return this.context.model.getElementType(E)}getRelatedEdgesData(E,P="both"){return this.context.model.getRelatedEdgesData(E,P)}getNeighborNodesData(E){return this.context.model.getNeighborNodesData(E)}getAncestorsData(E,P){return this.context.model.getAncestorsData(E,P)}getParentData(E,P){return this.context.model.getParentData(E,P)}getChildrenData(E){return this.context.model.getChildrenData(E)}getElementDataByState(E,P){return this.context.model.getElementDataByState(E,P)}async initCanvas(){if(this.context.canvas)return await this.context.canvas.ready;const{container:E="container",width:P,height:O,renderer:C,background:M}=this.options;if(E instanceof d.Canvas)this.context.canvas=E,await E.ready;else{const T=(0,t.isString)(E)?document.getElementById(E):E,R=(0,a.sizeOf)(T);this.emit(r.GraphEvent.BEFORE_CANVAS_INIT,{container:T,width:P,height:O});const D=new d.Canvas({container:T,width:P||R[0],height:O||R[1],background:M,renderer:C});this.context.canvas=D,await D.ready,this.emit(r.GraphEvent.AFTER_CANVAS_INIT,{canvas:D})}}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new h.BatchController(this.context)),this.context.plugin||(this.context.plugin=new m.PluginController(this.context)),this.context.viewport||(this.context.viewport=new b.ViewportController(this.context)),this.context.transform||(this.context.transform=new y.TransformController(this.context)),this.context.element||(this.context.element=new g.ElementController(this.context)),this.context.animation||(this.context.animation=new u.Animation(this.context)),this.context.layout||(this.context.layout=new v.LayoutController(this.context)),this.context.behavior||(this.context.behavior=new f.BehaviorController(this.context))}async prepare(){if(await Promise.resolve(),this.destroyed)throw new Error((0,c.format)("The graph instance has been destroyed"));await this.initCanvas(),this.initRuntime()}async render(){await this.prepare(),(0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.BEFORE_RENDER));const E=this.context.element.draw();await Promise.all([E==null?void 0:E.finished,this.context.layout.layout()]),await this.autoFit(),(0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.AFTER_RENDER))}async draw(){var E;await this.prepare(),await((E=this.context.element.draw())==null?void 0:E.finished)}async layout(){await this.context.layout.layout()}stopLayout(){this.context.layout.stopLayout()}async clear(){this.context.model.setData({}),await this.draw()}destroy(){(0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.BEFORE_DESTROY));const{layout:E,animation:P,element:O,model:C,canvas:M,behavior:T,plugin:R}=this.context;R==null||R.destroy(),T==null||T.destroy(),E==null||E.destroy(),P==null||P.destroy(),O==null||O.destroy(),C.destroy(),M==null||M.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,(0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(E,P){const O=!E||!P?(0,a.sizeOf)(this.context.canvas.getContainer()):[E,P];(0,t.isEqual)(O,this.getSize())||((0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.BEFORE_SIZE_CHANGE,{size:O})),this.context.canvas.resize(...O),(0,s.emit)(this,new s.GraphLifeCycleEvent(r.GraphEvent.AFTER_SIZE_CHANGE,{size:O})))}async fitView(E,P){var O;await((O=this.context.viewport)==null?void 0:O.fitView(E,P))}async fitCenter(E){var P;await((P=this.context.viewport)==null?void 0:P.fitCenter(E))}async autoFit(){const{autoFit:E}=this.context.options;if(E)if((0,t.isString)(E))E==="view"?await this.fitView():E==="center"&&await this.fitCenter();else{const{type:P,animation:O}=E;P==="view"?await this.fitView(E.options,O):P==="center"&&await this.fitCenter(O)}}async focusElement(E,P){var O;await((O=this.context.viewport)==null?void 0:O.focusElements(Array.isArray(E)?E:[E],P))}async zoomBy(E,P,O){await this.context.viewport.transform({mode:"relative",scale:E,origin:O},P)}async zoomTo(E,P,O){this.context.viewport.transform({mode:"absolute",scale:E,origin:O},P)}getZoom(){return this.context.viewport.getZoom()}async rotateBy(E,P,O){await this.context.viewport.transform({mode:"relative",rotate:E,origin:O},P)}async rotateTo(E,P,O){await this.context.viewport.transform({mode:"absolute",rotate:E,origin:O},P)}getRotation(){return this.context.viewport.getRotation()}async translateBy(E,P){await this.context.viewport.transform({mode:"relative",translate:E},P)}async translateTo(E,P){await this.context.viewport.transform({mode:"absolute",translate:E},P)}getPosition(){return(0,l.subtract)([0,0],this.getCanvasByViewport([0,0]))}async translateElementBy(E,P,O=!0){var T;const[C,M]=(0,t.isObject)(E)?[E,P??!0]:[{[E]:P},O];Object.entries(C).forEach(([R,D])=>this.context.model.translateNodeLikeBy(R,D)),await((T=this.context.element.draw({animation:M,stage:"translate"}))==null?void 0:T.finished)}async translateElementTo(E,P,O=!0){var T;const[C,M]=(0,t.isObject)(E)?[E,P??!0]:[{[E]:P},O];Object.entries(C).forEach(([R,D])=>this.context.model.translateNodeLikeTo(R,D)),await((T=this.context.element.draw({animation:M,stage:"translate"}))==null?void 0:T.finished)}getElementPosition(E){return this.context.model.getElementPosition(E)}getElementRenderStyle(E){return(0,t.omit)(this.context.element.getElement(E).attributes,["context"])}async setElementVisibility(E,P,O=!0){var B;const[C,M]=(0,t.isObject)(E)?[E,P??!0]:[{[E]:P},O],T={nodes:[],edges:[],combos:[]};Object.entries(C).forEach(([j,L])=>{const $=this.getElementType(j);T[`${$}s`].push({id:j,style:{visibility:L}})});const{model:R,element:D}=this.context;R.preventUpdateNodeLikeHierarchy(()=>{R.updateData(T)}),await((B=D.draw({animation:M,stage:"visibility"}))==null?void 0:B.finished)}async showElement(E,P){const O=Array.isArray(E)?E:[E];await this.setElementVisibility(Object.fromEntries(O.map(C=>[C,"visible"])),P)}async hideElement(E,P){const O=Array.isArray(E)?E:[E];await this.setElementVisibility(Object.fromEntries(O.map(C=>[C,"hidden"])),P)}getElementVisibility(E){var O;const P=this.context.element.getElement(E);return((O=P==null?void 0:P.style)==null?void 0:O.visibility)??"visible"}async setElementZIndex(E,P){var R;const O={nodes:[],edges:[],combos:[]},C=(0,t.isObject)(E)?E:{[E]:P};Object.entries(C).forEach(([D,B])=>{const j=this.getElementType(D);O[`${j}s`].push({id:D,style:{zIndex:B}})});const{model:M,element:T}=this.context;M.preventUpdateNodeLikeHierarchy(()=>M.updateData(O)),await((R=T.draw({animation:!1,stage:"zIndex"}))==null?void 0:R.finished)}async frontElement(E){const P=Array.isArray(E)?E:[E],{model:O,element:C}=this.context,M={};P.map(T=>{const R=C.getFrontZIndex(T);if(O.getElementType(T)==="combo"){const B=O.getAncestorsData(T,r.COMBO_KEY).at(-1)||this.getComboData(T),j=[B,...O.getDescendantsData((0,o.idOf)(B))],L=R-C.getElementZIndex(T);j.forEach($=>{M[(0,o.idOf)($)]=this.getElementZIndex((0,o.idOf)($))+L})}else M[T]=R}),await this.setElementZIndex(M)}getElementZIndex(E){var C,M;const{model:P,element:O}=this.context;return((M=(C=P.getElementDataById(E))==null?void 0:C.style)==null?void 0:M.zIndex)??O.getElementZIndex(E)}async setElementState(E,P,O=!0){var D;const[C,M]=(0,t.isObject)(E)?[E,P??!0]:[{[E]:P},O],T=B=>B?Array.isArray(B)?B:[B]:[],R={nodes:[],edges:[],combos:[]};Object.entries(C).forEach(([B,j])=>{const L=this.getElementType(B);R[`${L}s`].push({id:B,states:T(j)})}),this.updateData(R),await((D=this.context.element.draw({animation:M}))==null?void 0:D.finished)}getElementState(E){return this.context.model.getElementState(E)}getElementRenderBounds(E){return this.context.element.getElement(E).getRenderBounds()}async collapseElement(E,P=!0){const{model:O,element:C}=this.context;if((0,i.isCollapsed)(O.getNodeLikeData([E])[0])||this.isCollapsingExpanding)return;const M=O.getElementType(E);this.isCollapsingExpanding=!0,this.setElementCollapsibility(E,!0),M==="node"?await C.collapseNode(E,P):M==="combo"&&await C.collapseCombo(E,P),this.isCollapsingExpanding=!1}async expandElement(E,P=!0){const{model:O,element:C}=this.context;if(!(0,i.isCollapsed)(O.getNodeLikeData([E])[0])||this.isCollapsingExpanding)return;const M=O.getElementType(E);this.isCollapsingExpanding=!0,this.setElementCollapsibility(E,!1),M==="node"?await C.expandNode(E,P):M==="combo"&&await C.expandCombo(E,P),this.isCollapsingExpanding=!1}setElementCollapsibility(E,P){const O=this.getElementType(E);O==="node"?this.updateNodeData([{id:E,style:{collapsed:P}}]):O==="combo"&&this.updateComboData([{id:E,style:{collapsed:P}}])}async toDataURL(E={}){return this.context.canvas.toDataURL(E)}getCanvasByViewport(E){return this.context.canvas.getCanvasByViewport(E)}getViewportByCanvas(E){return this.context.canvas.getViewportByCanvas(E)}getClientByCanvas(E){return this.context.canvas.getClientByCanvas(E)}getCanvasByClient(E){return this.context.canvas.getCanvasByClient(E)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(E,P,O){return super.on(E,P,O)}once(E,P){return super.once(E,P)}off(E,P){return super.off(E,P)}};A(x,"defaultOptions",{autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]});let w=x;return Bl.Graph=w,Bl}var H_={};Object.defineProperty(H_,"__esModule",{value:!0});H_.treeToGraphData=tmt;const Jvt=Vs;function tmt(n,e){const{getNodeData:t=o=>{if(!o.children)return o;const{children:c,...l}=o;return{...l,children:c.map(u=>u.id)}},getEdgeData:r=(o,c)=>({source:o.id,target:c.id}),getChildren:i=o=>o.children||[]}=e||{},a=[],s=[];return(0,Jvt.dfs)(n,o=>{a.push(t(o));const c=i(o);for(const l of c)s.push(r(o,l))},o=>i(o),"TB"),{nodes:a,edges:s}}var rk;function emt(){return rk||(rk=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.AntVDagreLayout=n.Label=n.Icon=n.BaseShape=n.Badge=n.Triangle=n.Star=n.Rect=n.Image=n.Hexagon=n.HTML=n.Ellipse=n.Donut=n.Diamond=n.Circle=n.BaseNode=n.Quadratic=n.Polyline=n.Line=n.CubicVertical=n.CubicHorizontal=n.Cubic=n.BaseEdge=n.RectCombo=n.CircleCombo=n.BaseCombo=n.NodeEvent=n.HistoryEvent=n.GraphEvent=n.ExtensionCategory=n.EdgeEvent=n.ContainerEvent=n.CommonEvent=n.ComboEvent=n.CanvasEvent=n.ZoomCanvas=n.ScrollCanvas=n.OptimizeViewportTransform=n.LassoSelect=n.HoverActivate=n.FocusElement=n.FixElementSize=n.DragElementForce=n.DragElement=n.DragCanvas=n.CreateEdge=n.CollapseExpand=n.ClickSelect=n.BrushSelect=n.BaseBehavior=void 0,n.treeToGraphData=n.parseSize=n.Shortcut=n.subStyleProps=n.omitStyleProps=n.invokeLayoutMethod=n.idOf=n.isCollapsed=n.BaseTransform=n.Graph=n.register=n.getExtensions=n.getExtension=n.Watermark=n.Tooltip=n.Toolbar=n.Timebar=n.Legend=n.Hull=n.History=n.GridLine=n.Fullscreen=n.Contextmenu=n.CameraSetting=n.BubbleSets=n.BasePlugin=n.mindmap=n.indented=n.dendrogram=n.compactBox=n.RandomLayout=n.RadialLayout=n.MDSLayout=n.GridLayout=n.FruchtermanLayout=n.ForceLayout=n.ForceAtlas2Layout=n.DagreLayout=n.D3ForceLayout=n.ConcentricLayout=n.ComboCombinedLayout=n.CircularLayout=n.BaseLayout=void 0;var e=W9();Object.defineProperty(n,"BaseBehavior",{enumerable:!0,get:function(){return e.BaseBehavior}}),Object.defineProperty(n,"BrushSelect",{enumerable:!0,get:function(){return e.BrushSelect}}),Object.defineProperty(n,"ClickSelect",{enumerable:!0,get:function(){return e.ClickSelect}}),Object.defineProperty(n,"CollapseExpand",{enumerable:!0,get:function(){return e.CollapseExpand}}),Object.defineProperty(n,"CreateEdge",{enumerable:!0,get:function(){return e.CreateEdge}}),Object.defineProperty(n,"DragCanvas",{enumerable:!0,get:function(){return e.DragCanvas}}),Object.defineProperty(n,"DragElement",{enumerable:!0,get:function(){return e.DragElement}}),Object.defineProperty(n,"DragElementForce",{enumerable:!0,get:function(){return e.DragElementForce}}),Object.defineProperty(n,"FixElementSize",{enumerable:!0,get:function(){return e.FixElementSize}}),Object.defineProperty(n,"FocusElement",{enumerable:!0,get:function(){return e.FocusElement}}),Object.defineProperty(n,"HoverActivate",{enumerable:!0,get:function(){return e.HoverActivate}}),Object.defineProperty(n,"LassoSelect",{enumerable:!0,get:function(){return e.LassoSelect}}),Object.defineProperty(n,"OptimizeViewportTransform",{enumerable:!0,get:function(){return e.OptimizeViewportTransform}}),Object.defineProperty(n,"ScrollCanvas",{enumerable:!0,get:function(){return e.ScrollCanvas}}),Object.defineProperty(n,"ZoomCanvas",{enumerable:!0,get:function(){return e.ZoomCanvas}});var t=Ft;Object.defineProperty(n,"CanvasEvent",{enumerable:!0,get:function(){return t.CanvasEvent}}),Object.defineProperty(n,"ComboEvent",{enumerable:!0,get:function(){return t.ComboEvent}}),Object.defineProperty(n,"CommonEvent",{enumerable:!0,get:function(){return t.CommonEvent}}),Object.defineProperty(n,"ContainerEvent",{enumerable:!0,get:function(){return t.ContainerEvent}}),Object.defineProperty(n,"EdgeEvent",{enumerable:!0,get:function(){return t.EdgeEvent}}),Object.defineProperty(n,"ExtensionCategory",{enumerable:!0,get:function(){return t.ExtensionCategory}}),Object.defineProperty(n,"GraphEvent",{enumerable:!0,get:function(){return t.GraphEvent}}),Object.defineProperty(n,"HistoryEvent",{enumerable:!0,get:function(){return t.HistoryEvent}}),Object.defineProperty(n,"NodeEvent",{enumerable:!0,get:function(){return t.NodeEvent}});var r=lF();Object.defineProperty(n,"BaseCombo",{enumerable:!0,get:function(){return r.BaseCombo}}),Object.defineProperty(n,"CircleCombo",{enumerable:!0,get:function(){return r.CircleCombo}}),Object.defineProperty(n,"RectCombo",{enumerable:!0,get:function(){return r.RectCombo}});var i=rF();Object.defineProperty(n,"BaseEdge",{enumerable:!0,get:function(){return i.BaseEdge}}),Object.defineProperty(n,"Cubic",{enumerable:!0,get:function(){return i.Cubic}}),Object.defineProperty(n,"CubicHorizontal",{enumerable:!0,get:function(){return i.CubicHorizontal}}),Object.defineProperty(n,"CubicVertical",{enumerable:!0,get:function(){return i.CubicVertical}}),Object.defineProperty(n,"Line",{enumerable:!0,get:function(){return i.Line}}),Object.defineProperty(n,"Polyline",{enumerable:!0,get:function(){return i.Polyline}}),Object.defineProperty(n,"Quadratic",{enumerable:!0,get:function(){return i.Quadratic}});var a=Y_();Object.defineProperty(n,"BaseNode",{enumerable:!0,get:function(){return a.BaseNode}}),Object.defineProperty(n,"Circle",{enumerable:!0,get:function(){return a.Circle}}),Object.defineProperty(n,"Diamond",{enumerable:!0,get:function(){return a.Diamond}}),Object.defineProperty(n,"Donut",{enumerable:!0,get:function(){return a.Donut}}),Object.defineProperty(n,"Ellipse",{enumerable:!0,get:function(){return a.Ellipse}}),Object.defineProperty(n,"HTML",{enumerable:!0,get:function(){return a.HTML}}),Object.defineProperty(n,"Hexagon",{enumerable:!0,get:function(){return a.Hexagon}}),Object.defineProperty(n,"Image",{enumerable:!0,get:function(){return a.Image}}),Object.defineProperty(n,"Rect",{enumerable:!0,get:function(){return a.Rect}}),Object.defineProperty(n,"Star",{enumerable:!0,get:function(){return a.Star}}),Object.defineProperty(n,"Triangle",{enumerable:!0,get:function(){return a.Triangle}});var s=Hs();Object.defineProperty(n,"Badge",{enumerable:!0,get:function(){return s.Badge}}),Object.defineProperty(n,"BaseShape",{enumerable:!0,get:function(){return s.BaseShape}}),Object.defineProperty(n,"Icon",{enumerable:!0,get:function(){return s.Icon}}),Object.defineProperty(n,"Label",{enumerable:!0,get:function(){return s.Label}});var o=P0;Object.defineProperty(n,"AntVDagreLayout",{enumerable:!0,get:function(){return o.AntVDagreLayout}}),Object.defineProperty(n,"BaseLayout",{enumerable:!0,get:function(){return o.BaseLayout}}),Object.defineProperty(n,"CircularLayout",{enumerable:!0,get:function(){return o.CircularLayout}}),Object.defineProperty(n,"ComboCombinedLayout",{enumerable:!0,get:function(){return o.ComboCombinedLayout}}),Object.defineProperty(n,"ConcentricLayout",{enumerable:!0,get:function(){return o.ConcentricLayout}}),Object.defineProperty(n,"D3ForceLayout",{enumerable:!0,get:function(){return o.D3ForceLayout}}),Object.defineProperty(n,"DagreLayout",{enumerable:!0,get:function(){return o.DagreLayout}}),Object.defineProperty(n,"ForceAtlas2Layout",{enumerable:!0,get:function(){return o.ForceAtlas2Layout}}),Object.defineProperty(n,"ForceLayout",{enumerable:!0,get:function(){return o.ForceLayout}}),Object.defineProperty(n,"FruchtermanLayout",{enumerable:!0,get:function(){return o.FruchtermanLayout}}),Object.defineProperty(n,"GridLayout",{enumerable:!0,get:function(){return o.GridLayout}}),Object.defineProperty(n,"MDSLayout",{enumerable:!0,get:function(){return o.MDSLayout}}),Object.defineProperty(n,"RadialLayout",{enumerable:!0,get:function(){return o.RadialLayout}}),Object.defineProperty(n,"RandomLayout",{enumerable:!0,get:function(){return o.RandomLayout}}),Object.defineProperty(n,"compactBox",{enumerable:!0,get:function(){return o.compactBox}}),Object.defineProperty(n,"dendrogram",{enumerable:!0,get:function(){return o.dendrogram}}),Object.defineProperty(n,"indented",{enumerable:!0,get:function(){return o.indented}}),Object.defineProperty(n,"mindmap",{enumerable:!0,get:function(){return o.mindmap}});var c=Z9();Object.defineProperty(n,"BasePlugin",{enumerable:!0,get:function(){return c.BasePlugin}}),Object.defineProperty(n,"BubbleSets",{enumerable:!0,get:function(){return c.BubbleSets}}),Object.defineProperty(n,"CameraSetting",{enumerable:!0,get:function(){return c.CameraSetting}}),Object.defineProperty(n,"Contextmenu",{enumerable:!0,get:function(){return c.Contextmenu}}),Object.defineProperty(n,"Fullscreen",{enumerable:!0,get:function(){return c.Fullscreen}}),Object.defineProperty(n,"GridLine",{enumerable:!0,get:function(){return c.GridLine}}),Object.defineProperty(n,"History",{enumerable:!0,get:function(){return c.History}}),Object.defineProperty(n,"Hull",{enumerable:!0,get:function(){return c.Hull}}),Object.defineProperty(n,"Legend",{enumerable:!0,get:function(){return c.Legend}}),Object.defineProperty(n,"Timebar",{enumerable:!0,get:function(){return c.Timebar}}),Object.defineProperty(n,"Toolbar",{enumerable:!0,get:function(){return c.Toolbar}}),Object.defineProperty(n,"Tooltip",{enumerable:!0,get:function(){return c.Tooltip}}),Object.defineProperty(n,"Watermark",{enumerable:!0,get:function(){return c.Watermark}});var l=Ys();Object.defineProperty(n,"getExtension",{enumerable:!0,get:function(){return l.getExtension}}),Object.defineProperty(n,"getExtensions",{enumerable:!0,get:function(){return l.getExtensions}}),Object.defineProperty(n,"register",{enumerable:!0,get:function(){return l.register}});var u=Qvt();Object.defineProperty(n,"Graph",{enumerable:!0,get:function(){return u.Graph}});var h=oF();Object.defineProperty(n,"BaseTransform",{enumerable:!0,get:function(){return h.BaseTransform}});var f=ra;Object.defineProperty(n,"isCollapsed",{enumerable:!0,get:function(){return f.isCollapsed}});var d=Gt;Object.defineProperty(n,"idOf",{enumerable:!0,get:function(){return d.idOf}});var p=ei;Object.defineProperty(n,"invokeLayoutMethod",{enumerable:!0,get:function(){return p.invokeLayoutMethod}});var g=Ie;Object.defineProperty(n,"omitStyleProps",{enumerable:!0,get:function(){return g.omitStyleProps}}),Object.defineProperty(n,"subStyleProps",{enumerable:!0,get:function(){return g.subStyleProps}});var v=Oi;Object.defineProperty(n,"Shortcut",{enumerable:!0,get:function(){return v.Shortcut}});var m=Si;Object.defineProperty(n,"parseSize",{enumerable:!0,get:function(){return m.parseSize}});var y=H_;Object.defineProperty(n,"treeToGraphData",{enumerable:!0,get:function(){return y.treeToGraphData}})}(ux)),ux}var ik;function sF(){return ik||(ik=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getEdgeEndsContext=n.GetEdgeActualEnds=void 0;const e=Ft,t=emt(),r=Cc(),i=Us();class a extends i.BaseTransform{beforeDraw(c){const{add:l,update:u}=c,{model:h}=this.context;return[...l.edges.entries(),...u.edges.entries()].forEach(([,f])=>{(0,n.getEdgeEndsContext)(h,f)}),c}}n.GetEdgeActualEnds=a;const s=(o,c)=>{const{source:l,target:u}=c,h=o.getElementDataById(l),f=o.getElementDataById(u),d=(0,r.findActualConnectNodeData)(h,y=>o.getParentData(y,e.COMBO_KEY)),p=(0,r.findActualConnectNodeData)(f,y=>o.getParentData(y,e.COMBO_KEY)),g=(0,t.idOf)(d),v=(0,t.idOf)(p),m={sourceNode:g,targetNode:v};return c.style?Object.assign(c.style,m):c.style=m,c};n.getEdgeEndsContext=s}(lx)),lx}var bx={},ak;function nmt(){return ak||(ak=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isParallelEdges=n.getParallelEdges=n.groupByEndpoints=n.ProcessParallelEdges=void 0;const e=bt,t=Pc,r=Gt,i=Gs,a=Us(),s=sF(),o="quadratic",c=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"],d=class d extends a.BaseTransform{constructor(v,m){super(v,Object.assign({},d.defaultOptions,m));A(this,"cacheMergeStyle",new Map);A(this,"getAffectedParallelEdges",v=>{const{add:{edges:m},update:{nodes:y,edges:b,combos:w},remove:{edges:x}}=v,{model:S}=this.context,_=new Map,E=(C,M)=>{S.getRelatedEdgesData(M).forEach(R=>!_.has((0,r.idOf)(R))&&_.set((0,r.idOf)(R),R))};y.forEach(E),w.forEach(E);const P=C=>{const M=S.getEdgeData().map(R=>(0,s.getEdgeEndsContext)(S,R));(0,n.getParallelEdges)(C,M,!0).forEach(R=>!_.has((0,r.idOf)(R))&&_.set((0,r.idOf)(R),R))};if(x.size&&x.forEach(P),m.size&&m.forEach(P),b.size){const C=(0,t.groupByChangeType)((0,t.reduceDataChanges)(S.getChanges())).update.edges;b.forEach(M=>{var R;P(M);const T=(R=C.find(D=>(0,r.idOf)(D.value)===(0,r.idOf)(M)))==null?void 0:R.original;T&&!(0,n.isParallelEdges)(M,T)&&P(T)})}(0,e.isEmpty)(this.options.edges)||_.forEach((C,M)=>!this.options.edges.includes(M)&&_.delete(M));const O=S.getEdgeData().map(r.idOf);return new Map([..._].sort((C,M)=>O.indexOf(C[0])-O.indexOf(M[0])))});A(this,"applyBundlingStyle",(v,m,y)=>{const{edgeMap:b,reverses:w}=(0,n.groupByEndpoints)(m);b.forEach(x=>{x.forEach((S,_,E)=>{var M;const O=Object.assign(S,{type:o,style:(()=>{const T=E.length,R={};if(S.source===S.target){const D=c.length;R.loopPlacement=c[_%D],R.loopDist=Math.floor(_/D)*y+50}else if(T===1)R.curveOffset=0;else{const D=(_%2===0?1:-1)*(w[`${S.source}|${S.target}|${_}`]?-1:1);R.curveOffset=T%2===1?D*Math.ceil(_/2)*y*2:D*(Math.floor(_/2)*y*2+y)}return Object.assign({},S.style,R)})()});((M=this.context.element)==null?void 0:M.getElement((0,r.idOf)(S)))?(0,i.reassignTo)(v,"update","edge",O,!0):(0,i.reassignTo)(v,"add","edge",O,!0)})})});A(this,"resetEdgeStyle",v=>{const m=v.style||{},y=this.cacheMergeStyle.get((0,r.idOf)(v))||{};return Object.keys(y).forEach(b=>{(0,e.isEqual)(m[b],y[b])&&(v[b]?m[b]=v[b]:delete m[b])}),Object.assign(v,{style:m})});A(this,"applyMergingStyle",(v,m)=>{const{edgeMap:y,reverses:b}=(0,n.groupByEndpoints)(m);y.forEach(w=>{var S;if(w.length===1){const _=w[0],E=(S=this.context.element)==null?void 0:S.getElement((0,r.idOf)(_));(0,i.reassignTo)(v,E?"update":"add","edge",this.resetEdgeStyle(_),!0);return}const x=w.map(({source:_,target:E,style:P={}},O)=>{const{startArrow:C,endArrow:M}=P,T={},[R,D]=b[`${_}|${E}|${O}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,e.isBoolean)(C)&&(T[R]=C),(0,e.isBoolean)(M)&&(T[D]=M),T}).reduce((_,E)=>({..._,...E}),{});w.forEach((_,E,P)=>{var O;if(E===0){const C=Object.assign({},(0,e.isFunction)(this.options.style)?this.options.style(P):this.options.style,{childrenData:P});this.cacheMergeStyle.set((0,r.idOf)(_),C);const M={..._,type:"line",style:{...x,...C}},T=(O=this.context.element)==null?void 0:O.getElement((0,r.idOf)(_));(0,i.reassignTo)(v,T?"update":"add","edge",M,!0)}else(0,i.reassignTo)(v,"remove","edge",_)})})})}beforeDraw(v){const m=this.getAffectedParallelEdges(v);return m.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(v,m,this.options.distance):this.applyMergingStyle(v,m)),v}};A(d,"defaultOptions",{mode:"bundle",edges:void 0,distance:15});let l=d;n.ProcessParallelEdges=l;const u=p=>{const g=new Map,v=new Set,m={};for(const[y,b]of p){if(v.has(y))continue;const{source:w,target:x}=b,S=`${w}-${x}`;g.has(S)||g.set(S,[]),g.get(S).push(b),v.add(y);for(const[_,E]of p)v.has(_)||(0,n.isParallelEdges)(b,E)&&(g.get(S).push(E),v.add(_),w===E.target&&x===E.source&&(m[`${E.source}|${E.target}|${g.get(S).length-1}`]=!0))}return{edgeMap:g,reverses:m}};n.groupByEndpoints=u;const h=(p,g,v)=>g.filter(m=>(v||(0,r.idOf)(m)!==(0,r.idOf)(p))&&(0,n.isParallelEdges)(m,p));n.getParallelEdges=h;const f=(p,g)=>{const{sourceNode:v,targetNode:m}=p.style||{},{sourceNode:y,targetNode:b}=g.style||{};return v===y&&m===b||v===b&&m===y};n.isParallelEdges=f}(bx)),bx}var Hl={},sk;function rmt(){if(sk)return Hl;sk=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.UpdateRelatedEdge=void 0;const n=Gt,e=Us();class t extends e.BaseTransform{beforeDraw(i,a){const{stage:s}=a;if(s==="visibility")return i;const{model:o}=this.context,{update:{nodes:c,edges:l,combos:u}}=i,h=(f,d)=>{o.getRelatedEdgesData(d).forEach(g=>!l.has((0,n.idOf)(g))&&l.set((0,n.idOf)(g),g))};return c.forEach(h),u.forEach(h),i}}return Hl.UpdateRelatedEdge=t,Hl}var ok;function oF(){return ok||(ok=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateRelatedEdge=n.ProcessParallelEdges=n.GetEdgeActualEnds=n.CollapseExpandNode=n.CollapseExpandCombo=n.BaseTransform=n.ArrangeDrawOrder=void 0;var e=svt();Object.defineProperty(n,"ArrangeDrawOrder",{enumerable:!0,get:function(){return e.ArrangeDrawOrder}});var t=Us();Object.defineProperty(n,"BaseTransform",{enumerable:!0,get:function(){return t.BaseTransform}});var r=hvt();Object.defineProperty(n,"CollapseExpandCombo",{enumerable:!0,get:function(){return r.CollapseExpandCombo}});var i=fvt();Object.defineProperty(n,"CollapseExpandNode",{enumerable:!0,get:function(){return i.CollapseExpandNode}});var a=sF();Object.defineProperty(n,"GetEdgeActualEnds",{enumerable:!0,get:function(){return a.GetEdgeActualEnds}});var s=nmt();Object.defineProperty(n,"ProcessParallelEdges",{enumerable:!0,get:function(){return s.ProcessParallelEdges}});var o=rmt();Object.defineProperty(n,"UpdateRelatedEdge",{enumerable:!0,get:function(){return o.UpdateRelatedEdge}})}(ox)),ox}var ck;function imt(){if(ck)return qc;ck=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.BUILT_IN_EXTENSIONS=void 0;const n=rgt(),e=W9(),t=uF(),r=P0,i=Mr,a=Z9(),s=Q9,o=oF();return qc.BUILT_IN_EXTENSIONS={animation:{"combo-collapse":n.ComboCollapse,"combo-expand":n.ComboExpand,"node-collapse":n.NodeCollapse,"node-expand":n.NodeExpand,"path-in":n.PathIn,"path-out":n.PathOut,fade:n.Fade,translate:n.Translate},behavior:{"brush-select":e.BrushSelect,"click-select":e.ClickSelect,"collapse-expand":e.CollapseExpand,"create-edge":e.CreateEdge,"drag-canvas":e.DragCanvas,"drag-element-force":e.DragElementForce,"drag-element":e.DragElement,"fix-element-size":e.FixElementSize,"focus-element":e.FocusElement,"hover-activate":e.HoverActivate,"lasso-select":e.LassoSelect,"optimize-viewport-transform":e.OptimizeViewportTransform,"scroll-canvas":e.ScrollCanvas,"zoom-canvas":e.ZoomCanvas},combo:{circle:t.CircleCombo,rect:t.RectCombo},edge:{cubic:t.Cubic,line:t.Line,polyline:t.Polyline,quadratic:t.Quadratic,"cubic-horizontal":t.CubicHorizontal,"cubic-vertical":t.CubicVertical},layout:{"antv-dagre":r.AntVDagreLayout,"combo-combined":r.ComboCombinedLayout,"compact-box":r.compactBox,"force-atlas2":r.ForceAtlas2Layout,circular:r.CircularLayout,concentric:r.ConcentricLayout,"d3-force":r.D3ForceLayout,dagre:r.DagreLayout,dendrogram:r.dendrogram,force:r.ForceLayout,fruchterman:r.FruchtermanLayout,grid:r.GridLayout,indented:r.indented,mds:r.MDSLayout,mindmap:r.mindmap,radial:r.RadialLayout,random:r.RandomLayout},node:{circle:t.Circle,diamond:t.Diamond,ellipse:t.Ellipse,hexagon:t.Hexagon,html:t.HTML,image:t.Image,rect:t.Rect,star:t.Star,donut:t.Donut,triangle:t.Triangle},palette:{spectral:i.spectral,tableau:i.tableau,oranges:i.oranges,greens:i.greens,blues:i.blues},theme:{dark:s.dark,light:s.light},plugin:{"bubble-sets":a.BubbleSets,"grid-line":a.GridLine,background:a.Background,contextmenu:a.Contextmenu,fullscreen:a.Fullscreen,history:a.History,hull:a.Hull,legend:a.Legend,timebar:a.Timebar,toolbar:a.Toolbar,tooltip:a.Tooltip,watermark:a.Watermark},transform:{"update-related-edges":o.UpdateRelatedEdge,"arrange-draw-order":o.ArrangeDrawOrder,"collapse-expand-combo":o.CollapseExpandCombo,"collapse-expand-node":o.CollapseExpandNode,"process-parallel-edges":o.ProcessParallelEdges,"get-edge-actual-ends":o.GetEdgeActualEnds}},qc}var lk;function Ys(){if(lk)return ns;lk=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.register=r,ns.getExtension=i,ns.getExtensions=a,ns.registerBuiltInExtensions=s;const n=hr,e=imt(),t={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{}};function r(o,c,l,u=!1){const h=t[o][c];!u&&h?h!==l&&n.print.warn(`The extension ${c} of ${o} has been registered before.`):Object.assign(t[o],{[c]:l})}function i(o,c){var u;const l=(u=t[o])==null?void 0:u[c];if(l)return l}function a(o){return t[o]}function s(){Object.entries(e.BUILT_IN_EXTENSIONS).forEach(([o,c])=>{Object.entries(c).forEach(([l,u])=>{r(o,l,u)})})}return ns}var uk;function U_(){if(uk)return co;uk=1,Object.defineProperty(co,"__esModule",{value:!0}),co.parsePalette=i,co.assignColorByPalette=a,co.getPaletteColors=s;const n=bt,e=Ys(),t=Gt,r=hr;function i(o){if(o)return typeof o=="string"||typeof o=="function"||Array.isArray(o)?{type:"group",field:c=>c.id,color:o,invert:!1}:o}function a(o,c){if(!c)return{};const{type:l,color:u,field:h,invert:f}=c,d=g=>{const v=typeof u=="string"?(0,e.getExtension)("palette",u):u;if(typeof v=="function"){const m={};return g.forEach(([y,b])=>{m[y]=v(f?1-b:b)}),m}else if(Array.isArray(v)){const m=f?[...v].reverse():v,y={};return g.forEach(([b,w])=>{y[b]=m[w%v.length]}),y}return{}},p=(g,v)=>{var m;return typeof g=="string"?(m=v.data)==null?void 0:m[g]:g==null?void 0:g(v)};if(l==="group"){const g=(0,n.groupBy)(o,b=>{if(!h)return"default";const w=p(h,b);return w?String(w):"default"}),v=Object.keys(g),m=d(v.map((b,w)=>[b,w])),y={};return Object.entries(g).forEach(([b,w])=>{w.forEach(x=>{y[(0,t.idOf)(x)]=m[b]})}),y}else if(l==="value"){const[g,v]=o.reduce(([y,b],w)=>{const x=p(h,w);if(typeof x!="number")throw new Error((0,r.format)(`Palette field ${h} is not a number`));return[Math.min(y,x),Math.max(b,x)]},[1/0,-1/0]),m=v-g;return d(o.map(y=>[y.id,(p(h,y)-g)/m]))}}function s(o){const c=typeof o=="string"?(0,e.getExtension)("palette",o):o;if(typeof c!="function")return c}return co}var hk;function Ks(){if(hk)return jc;hk=1;var n=jt&&jt.__decorate||function(g,v,m,y){var b=arguments.length,w=b<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,m):y,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,v,m,y);else for(var S=g.length-1;S>=0;S--)(x=g[S])&&(w=(b<3?x(w):b>3?x(v,m,w):x(v,m))||w);return b>3&&w&&Object.defineProperty(v,m,w),w};Object.defineProperty(jc,"__esModule",{value:!0}),jc.BaseNode=void 0;const e=Pe,t=Ln(),r=L_,i=U_(),a=It,s=Ie,o=Si,c=Ne,l=Ws,u=nF(),h=Ah,f=Hs(),p=class p extends u.BaseElement{constructor(m){super((0,c.mergeOptions)({style:p.defaultStyleProps},m));A(this,"type","node")}getSize(m=this.attributes){const{size:y}=m;return(0,o.parseSize)(y)}getKeyStyle(m){const y=this.getGraphicStyle(m);return Object.assign((0,s.omitStyleProps)(y,["label","halo","icon","badge","port"]))}getLabelStyle(m){if(m.label===!1||!m.labelText)return!1;const{placement:y,maxWidth:b,offsetX:w,offsetY:x,...S}=(0,s.subStyleProps)(this.getGraphicStyle(m),"label"),_=this.getShape("key").getLocalBounds();return Object.assign((0,t.getTextStyleByPlacement)(_,y,w,x),{wordWrapWidth:(0,l.getWordWrapWidthByBox)(_,b)},S)}getHaloStyle(m){if(m.halo===!1)return!1;const{fill:y,...b}=this.getKeyStyle(m),w=(0,s.subStyleProps)(this.getGraphicStyle(m),"halo");return{...b,stroke:y,...w}}getIconStyle(m){if(m.icon===!1||!m.iconText&&!m.iconSrc)return!1;const y=(0,s.subStyleProps)(this.getGraphicStyle(m),"icon");return Object.assign((0,r.inferIconStyle)(m.size,y),y)}getBadgesStyle(m){var O;const y=(0,s.subObject)(this.shapeMap,"badge-"),b={};if(Object.keys(y).forEach(C=>{b[C]=!1}),m.badge===!1||!((O=m.badges)!=null&&O.length))return b;const{badges:w=[],badgePalette:x,opacity:S=1,..._}=m,E=(0,i.getPaletteColors)(x),P=(0,s.subStyleProps)(this.getGraphicStyle(_),"badge");return w.forEach((C,M)=>{b[M]={backgroundFill:E?E[M%(E==null?void 0:E.length)]:void 0,opacity:S,...P,...this.getBadgeStyle(C)}}),b}getBadgeStyle(m){const y=this.getShape("key"),{placement:b="top",offsetX:w,offsetY:x,...S}=m;return{...(0,t.getTextStyleByPlacement)(y.getLocalBounds(),b,w,x,!0),...S}}getPortsStyle(m){var S;const y=this.getPorts(),b={};if(Object.keys(y).forEach(_=>{b[_]=!1}),m.port===!1||!((S=m.ports)!=null&&S.length))return b;const w=(0,s.subStyleProps)(this.getGraphicStyle(m),"port"),{ports:x=[]}=m;return x.forEach((_,E)=>{const P=_.key||E,O={...w,..._};if((0,t.isSimplePort)(O))b[P]=!1;else{const[C,M]=this.getPortXY(m,_);b[P]={transform:`translate(${C}, ${M})`,...O}}}),b}getPortXY(m,y){const{placement:b="left"}=y,w=this.getShape("key").getLocalBounds();return(0,t.getPortXYByPlacement)(w,b)}getPorts(){return(0,s.subObject)(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(m){const y=this.getShape("key").getBounds();return(0,a.getRectIntersectPoint)(m,y)}drawHaloShape(m,y){const b=this.getShape("key");this.upsert("halo",b.constructor,this.getHaloStyle(m),y)}drawIconShape(m,y){this.upsert("icon",f.Icon,this.getIconStyle(m),y)}drawBadgeShapes(m,y){const b=this.getBadgesStyle(m);Object.keys(b).forEach(w=>{this.upsert(`badge-${w}`,f.Badge,b[w],y)})}drawPortShapes(m,y){const b=this.getPortsStyle(m);Object.keys(b).forEach(w=>{this.upsert(`port-${w}`,e.Circle,b[w],y)})}drawLabelShape(m,y){this.upsert("label",f.Label,this.getLabelStyle(m),y)}_drawKeyShape(m,y){return this.drawKeyShape(m,y)}render(m=this.parsedAttributes,y=this){this._drawKeyShape(m,y),this.getShape("key")&&(this.drawHaloShape(m,y),this.drawIconShape(m,y),this.drawBadgeShapes(m,y),this.drawLabelShape(m,y),this.drawPortShapes(m,y))}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}};A(p,"defaultStyleProps",{x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0});let d=p;return jc.BaseNode=d,n([(0,h.effect)((g,v)=>g.getHaloStyle(v))],d.prototype,"drawHaloShape",null),n([(0,h.effect)((g,v)=>g.getIconStyle(v))],d.prototype,"drawIconShape",null),n([(0,h.effect)((g,v)=>g.getBadgesStyle(v))],d.prototype,"drawBadgeShapes",null),n([(0,h.effect)((g,v)=>g.getPortsStyle(v))],d.prototype,"drawPortShapes",null),n([(0,h.effect)((g,v)=>g.getLabelStyle(v))],d.prototype,"drawLabelShape",null),n([(0,h.effect)((g,v)=>g.getKeyStyle(v))],d.prototype,"_drawKeyShape",null),jc}var Ul={},fk;function cF(){if(fk)return Ul;fk=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.Circle=void 0;const n=Pe,e=wn,t=It,r=Ne,i=Ks(),s=class s extends i.BaseNode{constructor(c){super((0,r.mergeOptions)({style:s.defaultStyleProps},c))}drawKeyShape(c,l){return this.upsert("key",n.Circle,this.getKeyStyle(c),l)}getKeyStyle(c){return{...super.getKeyStyle(c),r:Math.min(...this.getSize(c))/2}}getIconStyle(c){const l=super.getIconStyle(c),{r:u}=this.getShape("key").attributes,h=u*2*e.ICON_SIZE_RATIO;return l?{width:h,height:h,...l}:!1}getIntersectPoint(c){const l=this.getShape("key").getBounds();return(0,t.getEllipseIntersectPoint)(c,l)}};A(s,"defaultStyleProps",{size:32});let a=s;return Ul.Circle=a,Ul}var Yl={},Kl={},dk;function D0(){if(dk)return Kl;dk=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.Polygon=void 0;const n=Pe,e=It,t=Ks();class r extends t.BaseNode{constructor(a){super(a)}get parsedAttributes(){return this.attributes}drawKeyShape(a,s){return this.upsert("key",n.Polygon,this.getKeyStyle(a),s)}getKeyStyle(a){return{...super.getKeyStyle(a),points:this.getPoints(a)}}getIntersectPoint(a){var c,l;const{points:s}=this.getShape("key").attributes,o=[+(((c=this.attributes)==null?void 0:c.x)||0),+(((l=this.attributes)==null?void 0:l.y)||0)];return(0,e.getPolygonIntersectPoint)(a,o,s).point}}return Kl.Polygon=r,Kl}var pk;function amt(){if(pk)return Yl;pk=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.Diamond=void 0;const n=Ln(),e=D0();class t extends e.Polygon{constructor(i){super(i)}getPoints(i){const[a,s]=this.getSize(i);return(0,n.getDiamondPoints)(a,s)}}return Yl.Diamond=t,Yl}var Xl={},gk;function smt(){if(gk)return Xl;gk=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.Donut=void 0;const n=Pe,e=bt,t=U_(),r=Ie,i=Si,a=Ne,s=cF(),f=class f extends s.Circle{constructor(p){super((0,a.mergeOptions)({style:f.defaultStyleProps},p))}parseOuterR(){const{size:p}=this.parsedAttributes;return Math.min(...(0,i.parseSize)(p))/2}parseInnerR(){const{innerR:p}=this.parsedAttributes;return(0,e.isString)(p)?parseInt(p)/100*this.parseOuterR():p}drawDonutShape(p,g){const{donuts:v}=p;if(!(v!=null&&v.length))return;const m=v.map(E=>(0,e.isNumber)(E)?{value:E}:E),y=(0,r.subStyleProps)(this.getGraphicStyle(p),"donut"),b=(0,t.getPaletteColors)(p.donutPalette);if(!b)return;const w=m.reduce((E,P)=>E+(P.value??0),0),x=this.parseOuterR(),S=this.parseInnerR();let _=0;m.forEach((E,P)=>{const{value:O=0,color:C=b[P%b.length],...M}=E,T=(w===0?1/m.length:O/w)*360;this.upsert(`round${P}`,n.Path,{...y,d:h(x,S,_,_+T),fill:C,...M},g),_+=T})}render(p,g=this){super.render(p,g),this.drawDonutShape(p,g)}};A(f,"defaultStyleProps",{innerR:"50%",donuts:[],donutPalette:"tableau"});let o=f;Xl.Donut=o;const c=(d,p,g,v)=>[d+Math.sin(v)*g,p-Math.cos(v)*g],l=(d,p,g,v)=>v<=0||g<=v?[["M",d-g,p],["A",g,g,0,1,1,d+g,p],["A",g,g,0,1,1,d-g,p],["Z"]]:[["M",d-g,p],["A",g,g,0,1,1,d+g,p],["A",g,g,0,1,1,d-g,p],["Z"],["M",d+v,p],["A",v,v,0,1,0,d-v,p],["A",v,v,0,1,0,d+v,p],["Z"]],u=(d,p,g,v,m,y)=>{const[b,w]=[m/360*2*Math.PI,y/360*2*Math.PI],x=[c(d,p,v,b),c(d,p,g,b),c(d,p,g,w),c(d,p,v,w)],S=w-b>Math.PI?1:0;return[["M",x[0][0],x[0][1]],["L",x[1][0],x[1][1]],["A",g,g,0,S,1,x[2][0],x[2][1]],["L",x[3][0],x[3][1]],["A",v,v,0,S,0,x[0][0],x[0][1]],["Z"]]},h=(d=0,p=0,g,v)=>{const[m,y]=[0,0];return Math.abs(g-v)%360<1e-6?l(m,y,d,p):u(m,y,d,p,g,v)};return Xl}var Zl={},vk;function omt(){if(vk)return Zl;vk=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.Ellipse=void 0;const n=Pe,e=wn,t=It,r=Ne,i=Ks(),s=class s extends i.BaseNode{constructor(c){super((0,r.mergeOptions)({style:s.defaultStyleProps},c))}drawKeyShape(c,l){return this.upsert("key",n.Ellipse,this.getKeyStyle(c),l)}getKeyStyle(c){const l=super.getKeyStyle(c),[u,h]=this.getSize(c);return{...l,rx:u/2,ry:h/2}}getIconStyle(c){const l=super.getIconStyle(c),{rx:u,ry:h}=this.getShape("key").attributes,f=Math.min(+u,+h)*2*e.ICON_SIZE_RATIO;return l?{width:f,height:f,...l}:!1}getIntersectPoint(c){const l=this.getShape("key").getBounds();return(0,t.getEllipseIntersectPoint)(c,l)}};A(s,"defaultStyleProps",{size:[45,35]});let a=s;return Zl.Ellipse=a,Zl}var Ql={},mk;function cmt(){if(mk)return Ql;mk=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.Hexagon=void 0;const n=wn,e=Ln(),t=D0();class r extends t.Polygon{constructor(a){super(a)}getOuterR(a){return a.outerR||Math.min(...this.getSize(a))/2}getPoints(a){return(0,e.getHexagonPoints)(this.getOuterR(a))}getIconStyle(a){const s=super.getIconStyle(a),o=this.getOuterR(a)*n.ICON_SIZE_RATIO;return s?{width:o,height:o,...s}:!1}}return Ql.Hexagon=r,Ql}var Jl={},yk;function lmt(){if(yk)return Jl;yk=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.HTML=void 0;const n=Pe,e=bt,t=Ft,r=Ks(),a=class a extends r.BaseNode{constructor(c){super({...c,style:Object.assign({},a.defaultStyleProps,c.style)});A(this,"rootPointerEvent",new n.FederatedPointerEvent(null));A(this,"forwardEvents",c=>{const l=this.context.canvas,u=l.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(c,u).forEach(f=>{const d=this.bootstrapEvent(this.rootPointerEvent,f,u,c);l.context.eventService.mapEvent(d)})})}get eventService(){return this.context.canvas.context.eventService}get events(){return[t.CommonEvent.CLICK,t.CommonEvent.POINTER_DOWN,t.CommonEvent.POINTER_MOVE,t.CommonEvent.POINTER_UP,t.CommonEvent.POINTER_OVER,t.CommonEvent.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(c){const l=(0,e.pick)(c,["innerHTML","pointerEvents","cursor"]),[u,h]=this.getSize(c);return{...l,width:u,height:h}}drawKeyShape(c,l){const u=this.getKeyStyle(c),{width:h=0,height:f=0}=u,d=this.upsert("key-container",n.Rect,{width:h,height:f,opacity:0},l);return this.upsert("key",n.HTML,u,d)}connectedCallback(){const c=this.getDomElement();this.events.forEach(l=>{c.addEventListener(l,this.forwardEvents)})}attributeChangedCallback(c,l,u){c==="zIndex"&&l!==u&&(this.getDomElement().style.zIndex=u)}destroy(){const c=this.getDomElement();this.events.forEach(l=>{c.removeEventListener(l,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(c,l){const u=[];if(l.isTouchEvent(c))for(let h=0;h<c.changedTouches.length;h++){const f=c.changedTouches[h];(0,e.isUndefined)(f.button)&&(f.button=0),(0,e.isUndefined)(f.buttons)&&(f.buttons=1),(0,e.isUndefined)(f.isPrimary)&&(f.isPrimary=c.touches.length===1&&c.type==="touchstart"),(0,e.isUndefined)(f.width)&&(f.width=f.radiusX||1),(0,e.isUndefined)(f.height)&&(f.height=f.radiusY||1),(0,e.isUndefined)(f.tiltX)&&(f.tiltX=0),(0,e.isUndefined)(f.tiltY)&&(f.tiltY=0),(0,e.isUndefined)(f.pointerType)&&(f.pointerType="touch"),(0,e.isUndefined)(f.pointerId)&&(f.pointerId=f.identifier||0),(0,e.isUndefined)(f.pressure)&&(f.pressure=f.force||.5),(0,e.isUndefined)(f.twist)&&(f.twist=0),(0,e.isUndefined)(f.tangentialPressure)&&(f.tangentialPressure=0),f.isNormalized=!0,f.type=c.type,u.push(f)}else if(l.isMouseEvent(c)){const h=c;(0,e.isUndefined)(h.isPrimary)&&(h.isPrimary=!0),(0,e.isUndefined)(h.width)&&(h.width=1),(0,e.isUndefined)(h.height)&&(h.height=1),(0,e.isUndefined)(h.tiltX)&&(h.tiltX=0),(0,e.isUndefined)(h.tiltY)&&(h.tiltY=0),(0,e.isUndefined)(h.pointerType)&&(h.pointerType="mouse"),(0,e.isUndefined)(h.pointerId)&&(h.pointerId=1),(0,e.isUndefined)(h.pressure)&&(h.pressure=.5),(0,e.isUndefined)(h.twist)&&(h.twist=0),(0,e.isUndefined)(h.tangentialPressure)&&(h.tangentialPressure=0),h.isNormalized=!0,u.push(h)}else u.push(c);return u}transferMouseData(c,l){c.isTrusted=l.isTrusted,c.srcElement=l.srcElement,c.timeStamp=performance.now(),c.type=l.type,c.altKey=l.altKey,c.metaKey=l.metaKey,c.shiftKey=l.shiftKey,c.ctrlKey=l.ctrlKey,c.button=l.button,c.buttons=l.buttons,c.client.x=l.clientX,c.client.y=l.clientY,c.movement.x=l.movementX,c.movement.y=l.movementY,c.page.x=l.pageX,c.page.y=l.pageY,c.screen.x=l.screenX,c.screen.y=l.screenY,c.relatedTarget=null}bootstrapEvent(c,l,u,h){c.view=u,c.originalEvent=null,c.nativeEvent=h,c.pointerId=l.pointerId,c.width=l.width,c.height=l.height,c.isPrimary=l.isPrimary,c.pointerType=l.pointerType,c.pressure=l.pressure,c.tangentialPressure=l.tangentialPressure,c.tiltX=l.tiltX,c.tiltY=l.tiltY,c.twist=l.twist,this.transferMouseData(c,l);const{x:f,y:d}=this.getViewportXY(l);c.viewport.x=f,c.viewport.y=d;const[p,g]=this.context.canvas.getCanvasByViewport([f,d]);return c.canvas.x=p,c.canvas.y=g,c.global.copyFrom(c.canvas),c.offset.copyFrom(c.canvas),c.isTrusted=h.isTrusted,c.type==="pointerleave"&&(c.type="pointerout"),c}getViewportXY(c){let l,u;const{offsetX:h,offsetY:f,clientX:d,clientY:p}=c;if(this.context.canvas.context.config.supportsCSSTransform&&!(0,e.isNil)(h)&&!(0,e.isNil)(f))l=h,u=f;else{const g=this.eventService.client2Viewport({x:d,y:p});l=g.x,u=g.y}return{x:l,y:u}}onframe(){super.onframe();const{opacity:c}=this.attributes;this.getDomElement().style.opacity=`${c}`}};A(a,"defaultStyleProps",{size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"});let i=a;return Jl.HTML=i,Jl}var tu={},bk;function umt(){if(bk)return tu;bk=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.Image=void 0;const n=Pe,e=wn,t=Ie,r=Ne,i=Kt,a=Ks(),o=class o extends a.BaseNode{constructor(l){super((0,r.mergeOptions)({style:o.defaultStyleProps},l))}getKeyStyle(l){const[u,h]=this.getSize(l),{fillOpacity:f,opacity:d=f,...p}=super.getKeyStyle(l);return{opacity:d,...p,width:u,height:h,x:-u/2,y:-h/2}}getHaloStyle(l){if(l.halo===!1)return!1;this.getShape("key").attributes;const u=(0,t.subStyleProps)(this.getGraphicStyle(l),"halo"),h=Number(u.lineWidth),[f,d]=(0,i.add)(this.getSize(l),[h,h]);return{...u,width:f,height:d,fill:"transparent",x:-f/2,y:-d/2}}getIconStyle(l){const u=super.getIconStyle(l),[h,f]=this.getSize(l);return u?{width:h*e.ICON_SIZE_RATIO,height:f*e.ICON_SIZE_RATIO,...u}:!1}drawKeyShape(l,u){return this.upsert("key",n.Image,this.getKeyStyle(l),u)}drawHaloShape(l,u){this.upsert("halo",n.Rect,this.getHaloStyle(l),u)}};A(o,"defaultStyleProps",{size:32});let s=o;return tu.Image=s,tu}var eu={},Ek;function hmt(){if(Ek)return eu;Ek=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.Rect=void 0;const n=Pe,e=wn,t=Ks();class r extends t.BaseNode{constructor(a){super(a)}getKeyStyle(a){const[s,o]=this.getSize(a);return{...super.getKeyStyle(a),width:s,height:o,x:-s/2,y:-o/2}}getIconStyle(a){const s=super.getIconStyle(a),{width:o,height:c}=this.getShape("key").attributes;return s?{width:o*e.ICON_SIZE_RATIO,height:c*e.ICON_SIZE_RATIO,...s}:!1}drawKeyShape(a,s){return this.upsert("key",n.Rect,this.getKeyStyle(a),s)}}return eu.Rect=r,eu}var nu={},xk;function fmt(){if(xk)return nu;xk=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.Star=void 0;const n=wn,e=Ln(),t=D0();class r extends t.Polygon{constructor(a){super(a)}getInnerR(a){return a.innerR||this.getOuterR(a)*3/8}getOuterR(a){return Math.min(...this.getSize(a))/2}getPoints(a){return(0,e.getStarPoints)(this.getOuterR(a),this.getInnerR(a))}getIconStyle(a){const s=super.getIconStyle(a),o=this.getInnerR(a)*2*n.ICON_SIZE_RATIO;return s?{width:o,height:o,...s}:!1}getPortXY(a,s){const{placement:o="top"}=s,c=this.getShape("key").getLocalBounds(),l=(0,e.getStarPorts)(this.getOuterR(a),this.getInnerR(a));return(0,e.getPortXYByPlacement)(c,o,l,!1)}}return nu.Star=r,nu}var ru={},wk;function dmt(){if(wk)return ru;wk=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.Triangle=void 0;const n=bt,e=wn,t=de,r=Ln(),i=Ie,a=Ne,s=D0(),c=class c extends s.Polygon{constructor(u){super((0,a.mergeOptions)({style:c.defaultStyleProps},u))}getPoints(u){const{direction:h}=u,[f,d]=this.getSize(u);return(0,r.getTrianglePoints)(f,d,h)}getPortXY(u,h){const{direction:f}=u,{placement:d="top"}=h,p=this.getShape("key").getLocalBounds(),[g,v]=this.getSize(u),m=(0,r.getTrianglePorts)(g,v,f);return(0,r.getPortXYByPlacement)(p,d,m,!1)}getIconStyle(u){const{icon:h,iconText:f,iconSrc:d,direction:p}=u;if(h===!1||(0,n.isEmpty)(f||d))return!1;const g=(0,i.subStyleProps)(this.getGraphicStyle(u),"icon"),v=this.getShape("key").getLocalBounds(),[m,y]=(0,t.getTriangleCenter)(v,p),b=(0,t.getIncircleRadius)(v,p)*2*e.ICON_SIZE_RATIO;return{x:m,y,width:b,height:b,...g}}};A(c,"defaultStyleProps",{size:40,direction:"up"});let o=c;return ru.Triangle=o,ru}var Sk;function Y_(){return Sk||(Sk=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Triangle=n.Star=n.Rect=n.Image=n.HTML=n.Hexagon=n.Ellipse=n.Donut=n.Diamond=n.Circle=n.BaseNode=void 0;var e=Ks();Object.defineProperty(n,"BaseNode",{enumerable:!0,get:function(){return e.BaseNode}});var t=cF();Object.defineProperty(n,"Circle",{enumerable:!0,get:function(){return t.Circle}});var r=amt();Object.defineProperty(n,"Diamond",{enumerable:!0,get:function(){return r.Diamond}});var i=smt();Object.defineProperty(n,"Donut",{enumerable:!0,get:function(){return i.Donut}});var a=omt();Object.defineProperty(n,"Ellipse",{enumerable:!0,get:function(){return a.Ellipse}});var s=cmt();Object.defineProperty(n,"Hexagon",{enumerable:!0,get:function(){return s.Hexagon}});var o=lmt();Object.defineProperty(n,"HTML",{enumerable:!0,get:function(){return o.HTML}});var c=umt();Object.defineProperty(n,"Image",{enumerable:!0,get:function(){return c.Image}});var l=hmt();Object.defineProperty(n,"Rect",{enumerable:!0,get:function(){return l.Rect}});var u=fmt();Object.defineProperty(n,"Star",{enumerable:!0,get:function(){return u.Star}});var h=dmt();Object.defineProperty(n,"Triangle",{enumerable:!0,get:function(){return h.Triangle}})}(ZE)),ZE}var _k;function K_(){if(_k)return zc;_k=1;var n=jt&&jt.__decorate||function(m,y,b,w){var x=arguments.length,S=x<3?y:w===null?w=Object.getOwnPropertyDescriptor(y,b):w,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(m,y,b,w);else for(var E=m.length-1;E>=0;E--)(_=m[E])&&(S=(x<3?_(S):x>3?_(y,b,S):_(y,b))||S);return x>3&&S&&Object.defineProperty(y,b,S),S};Object.defineProperty(zc,"__esModule",{value:!0}),zc.BaseCombo=void 0;const e=Pe,t=bt,r=Ft,i=de,a=Gt,s=qs,o=Un,c=Ie,l=Si,u=Ne,h=Kt,f=Ah,d=Y_(),p=Hs(),v=class v extends d.BaseNode{constructor(b){super((0,u.mergeOptions)({style:v.defaultStyleProps},b));A(this,"type","combo");this.updateComboPosition(this.parsedAttributes)}getKeySize(b){const{collapsed:w,childrenNode:x=[]}=b;return x.length===0?this.getEmptyKeySize(b):w?this.getCollapsedKeySize(b):this.getExpandedKeySize(b)}getEmptyKeySize(b){const{padding:w,collapsedSize:x}=b,[S,_,E,P]=(0,s.parsePadding)(w);return(0,h.add)((0,l.parseSize)(x),[P+_,S+E,0])}getCollapsedKeySize(b){return(0,l.parseSize)(b.collapsedSize)}getExpandedKeySize(b){const w=this.getContentBBox(b);return[(0,i.getBBoxWidth)(w),(0,i.getBBoxHeight)(w),0]}getContentBBox(b){const{context:w,childrenNode:x=[],padding:S}=b,_=x.map(P=>w.element.getElement(P)).filter(Boolean);if(_.length===0){const P=new e.AABB,{x:O=0,y:C=0,size:M}=b,[T,R]=(0,l.parseSize)(M);return P.setMinMax([O-T/2,C-R/2,0],[O+T/2,C+R/2,0]),P}const E=(0,i.getCombinedBBox)(_.map(P=>P.getBounds()));return S?(0,i.getExpandedBBox)(E,S):E}drawCollapsedMarkerShape(b,w){this.upsert("collapsed-marker",p.Icon,this.getCollapsedMarkerStyle(b),w)}getCollapsedMarkerStyle(b){if(!b.collapsed||!b.collapsedMarker)return!1;const{type:w,...x}=(0,c.subStyleProps)(this.getGraphicStyle(b),"collapsedMarker"),S=this.getShape("key"),[_,E]=(0,o.getXYByPlacement)(S.getLocalBounds(),"center"),P={...x,x:_,y:E};if(w){const O=this.getCollapsedMarkerText(w,b);Object.assign(P,{text:O})}return P}getCollapsedMarkerText(b,w){const{context:x,childrenData:S=[]}=w,{model:_}=x;return b==="descendant-count"?_.getDescendantsData(this.id).length.toString():b==="child-count"?S.length.toString():b==="node-count"?_.getDescendantsData(this.id).filter(E=>_.getElementType((0,a.idOf)(E))==="node").length.toString():(0,t.isFunction)(b)?b(S):""}getComboZIndex(b){return(this.context.model.getAncestorsData(this.id,r.COMBO_KEY)||[]).length}getComboPosition(b){const{x:w=0,y:x=0,collapsed:S,context:_,childrenData:E=[]}=b;if(E.length===0)return[+w,+x,0];if(S){const{model:P}=_,O=P.getDescendantsData(this.id).filter(C=>!P.isCombo((0,a.idOf)(C)));if(O.length>0){const C=O.reduce((M,T)=>(0,h.add)(M,(0,o.positionOf)(T)),[0,0,0]);return(0,h.divide)(C,O.length)}return[+w,+x,0]}return this.getContentBBox(b).center}getComboStyle(b){const{zIndex:w=this.getComboZIndex(b)}=b,[x,S]=this.getComboPosition(b);return{x,y:S,transform:`translate(${x}, ${S})`,zIndex:w}}updateComboPosition(b){const w=this.getComboStyle(b);Object.assign(this.style,w);const{x,y:S}=w;this.context.model.syncComboDatum({id:this.id,style:{x,y:S}})}render(b,w=this){super.render(b,w),this.drawCollapsedMarkerShape(b,w)}update(b={}){super.update(b),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(b,w){const x=super.animate(this.attributes.collapsed?b:b.map(({x:S,y:_,z:E,transform:P,...O})=>O),w);return x&&new Proxy(x,{set:(S,_,E)=>(_==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(S,_,E))})}};A(v,"defaultStyleProps",{childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"});let g=v;return zc.BaseCombo=g,n([(0,f.effect)((m,y)=>m.getCollapsedMarkerStyle(y))],g.prototype,"drawCollapsedMarkerShape",null),zc}var iu={},Ok;function pmt(){if(Ok)return iu;Ok=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.CircleCombo=void 0;const n=Pe,e=de,t=It,r=Ie,i=Si,a=K_();class s extends a.BaseCombo{constructor(c){super(c)}drawKeyShape(c,l){return this.upsert("key",n.Circle,this.getKeyStyle(c),l)}getKeyStyle(c){const{collapsed:l}=c,u=super.getKeyStyle(c),[h]=this.getKeySize(c);return{...u,...l&&(0,r.subStyleProps)(u,"collapsed"),r:h/2}}getCollapsedKeySize(c){const[l,u]=(0,i.parseSize)(c.collapsedSize),h=Math.max(l,u)/2;return[h*2,h*2,0]}getExpandedKeySize(c){const l=this.getContentBBox(c),[u,h]=(0,e.getBBoxSize)(l),f=Math.sqrt(u**2+h**2)/2;return[f*2,f*2,0]}getIntersectPoint(c){const l=this.getShape("key").getBounds();return(0,t.getEllipseIntersectPoint)(c,l)}}return iu.CircleCombo=s,iu}var au={},Pk;function gmt(){if(Pk)return au;Pk=1,Object.defineProperty(au,"__esModule",{value:!0}),au.RectCombo=void 0;const n=Pe,e=Ie,t=K_();class r extends t.BaseCombo{constructor(a){super(a)}drawKeyShape(a,s){return this.upsert("key",n.Rect,this.getKeyStyle(a),s)}getKeyStyle(a){const s=super.getKeyStyle(a),[o,c]=this.getKeySize(a);return{...s,...a.collapsed&&(0,e.subStyleProps)(s,"collapsed"),width:o,height:c,x:-o/2,y:-c/2}}}return au.RectCombo=r,au}var Ck;function lF(){return Ck||(Ck=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RectCombo=n.CircleCombo=n.BaseCombo=void 0;var e=K_();Object.defineProperty(n,"BaseCombo",{enumerable:!0,get:function(){return e.BaseCombo}});var t=pmt();Object.defineProperty(n,"CircleCombo",{enumerable:!0,get:function(){return t.CircleCombo}});var r=gmt();Object.defineProperty(n,"RectCombo",{enumerable:!0,get:function(){return r.RectCombo}})}(XE)),XE}var Mk;function uF(){return Mk||(Mk=1,function(n){var e=jt&&jt.__createBinding||(Object.create?function(r,i,a,s){s===void 0&&(s=a);var o=Object.getOwnPropertyDescriptor(i,a);(!o||("get"in o?!i.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return i[a]}}),Object.defineProperty(r,s,o)}:function(r,i,a,s){s===void 0&&(s=a),r[s]=i[a]}),t=jt&&jt.__exportStar||function(r,i){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&e(i,r,a)};Object.defineProperty(n,"__esModule",{value:!0}),t(lF(),n),t(rF(),n),t(Y_(),n)}(KE)),KE}var Tk;function Ln(){if(Tk)return ae;Tk=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.isNode=s,ae.isEdge=o,ae.isCombo=c,ae.isElement=l,ae.isSameNode=u,ae.getPortXYByPlacement=f,ae.getAllPorts=d,ae.isSimplePort=p,ae.getPortPosition=g,ae.findPorts=v,ae.findPort=m,ae.getConnectionPoint=b,ae.getPortConnectionPoint=w,ae.getNodeConnectionPoint=x,ae.getTextStyleByPlacement=S,ae.getStarPoints=_,ae.getStarPorts=E,ae.getTrianglePoints=P,ae.getTrianglePorts=O,ae.getBoundingPoints=C,ae.getDiamondPoints=M,ae.isVisible=T,ae.updateStyle=R,ae.getHexagonPoints=D,ae.markToBeDestroyed=B,ae.isToBeDestroyed=j;const n=bt,e=uF(),t=de,r=na,i=It,a=Un;function s(L){return L instanceof e.BaseNode&&L.type==="node"}function o(L){return L instanceof e.BaseEdge}function c(L){return L instanceof e.BaseCombo}function l(L){return s(L)||o(L)||c(L)}function u(L,$){return!L||!$?!1:L===$}const h={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function f(L,$,V=h,W=!0){const Y=[.5,.5],U=(0,n.isString)($)?(0,n.get)(V,$.toLocaleLowerCase(),Y):$;if(!W&&(0,n.isString)($))return U;const[J,at]=U||Y;return[L.min[0]+(0,t.getBBoxWidth)(L)*J,L.min[1]+(0,t.getBBoxHeight)(L)*at]}function d(L){if(!L)return{};const $=L.getPorts();return(L.attributes.ports||[]).forEach((W,Y)=>{var at;const{key:U,placement:J}=W;p(W)&&($[at=U||Y]||($[at]=(0,a.getXYByPlacement)(L.getShape("key").getBounds(),J)))}),$}function p(L){const{r:$}=L;return!$||Number($)===0}function g(L){return(0,r.isPoint)(L)?L:L.getPosition()}function v(L,$,V,W){const Y=m(L,$,V,W),U=m($,L,W,V);return[Y,U]}function m(L,$,V,W){const Y=d(L);if(V)return Y[V];const U=Object.values(Y);if(U.length===0)return;const J=U.map(lt=>g(lt)),at=y($,W),[ht]=(0,i.findNearestPoints)(J,at);return U.find(lt=>g(lt)===ht)}function y(L,$){const V=d(L);if($)return[g(V[$])];const W=Object.values(V);return W.length>0?W.map(Y=>g(Y)):[L.getCenter()]}function b(L,$){return c(L)||s(L)?x(L,$):w(L,$)}function w(L,$){if(!L||!$)return[0,0,0];if((0,r.isPoint)(L))return L;if(L.attributes.linkToCenter)return L.getPosition();const V=(0,r.isPoint)($)?$:s($)?$.getCenter():$.getPosition();return(0,i.getEllipseIntersectPoint)(V,L.getBounds())}function x(L,$){if(!L||!$)return[0,0,0];const V=(0,r.isPoint)($)?$:s($)?$.getCenter():$.getPosition();return L.getIntersectPoint(V)||L.getCenter()}function S(L,$="bottom",V=0,W=0,Y=!1){const U=$.split("-"),[J,at]=(0,a.getXYByPlacement)(L,$),ht=U.includes("left")?"right":U.includes("right")?"left":"center";let lt=U.includes("top")?"bottom":U.includes("bottom")?"top":"middle";return Y&&(lt=lt==="top"?"bottom":lt==="bottom"?"top":lt),{transform:`translate(${J+V}, ${at+W})`,textBaseline:lt,textAlign:ht}}function _(L,$){return[[0,-L],[$*Math.cos(3*Math.PI/10),-$*Math.sin(3*Math.PI/10)],[L*Math.cos(Math.PI/10),-L*Math.sin(Math.PI/10)],[$*Math.cos(Math.PI/10),$*Math.sin(Math.PI/10)],[L*Math.cos(3*Math.PI/10),L*Math.sin(3*Math.PI/10)],[0,$],[-L*Math.cos(3*Math.PI/10),L*Math.sin(3*Math.PI/10)],[-$*Math.cos(Math.PI/10),$*Math.sin(Math.PI/10)],[-L*Math.cos(Math.PI/10),-L*Math.sin(Math.PI/10)],[-$*Math.cos(3*Math.PI/10),-$*Math.sin(3*Math.PI/10)]]}function E(L,$){const V={};return V.top=[0,-L],V.left=[-L*Math.cos(Math.PI/10),-L*Math.sin(Math.PI/10)],V["left-bottom"]=[-L*Math.cos(3*Math.PI/10),L*Math.sin(3*Math.PI/10)],V.bottom=[0,$],V["right-bottom"]=[L*Math.cos(3*Math.PI/10),L*Math.sin(3*Math.PI/10)],V.right=V.default=[L*Math.cos(Math.PI/10),-L*Math.sin(Math.PI/10)],V}function P(L,$,V){const W=$/2,Y=L/2,U={up:[[-Y,W],[Y,W],[0,-W]],left:[[-Y,0],[Y,W],[Y,-W]],right:[[-Y,W],[-Y,-W],[Y,0]],down:[[-Y,-W],[Y,-W],[0,W]]};return U[V]||U.up}function O(L,$,V){const W=$/2,Y=L/2,U={};return V==="down"?(U.bottom=U.default=[0,W],U.right=[Y,-W],U.left=[-Y,-W]):V==="left"?(U.top=[Y,-W],U.bottom=[Y,W],U.left=U.default=[-Y,0]):V==="right"?(U.top=[-Y,-W],U.bottom=[-Y,W],U.right=U.default=[Y,0]):(U.left=[-Y,W],U.top=U.default=[0,-W],U.right=[Y,W]),U}function C(L,$){return[[L/2,-$/2],[L/2,$/2],[-L/2,$/2],[-L/2,-$/2]]}function M(L,$){return[[0,-$/2],[L/2,0],[0,$/2],[-L/2,0]]}function T(L){return(0,n.get)(L,["style","visibility"])!=="hidden"}function R(L,$){"update"in L?L.update($):L.attr($)}function D(L){return[[0,L],[L*Math.sqrt(3)/2,L/2],[L*Math.sqrt(3)/2,-L/2],[0,-L],[-L*Math.sqrt(3)/2,-L/2],[-L*Math.sqrt(3)/2,L/2]]}function B(L){(0,n.set)(L,"__to_be_destroyed__",!0)}function j(L){return(0,n.get)(L,"__to_be_destroyed__",!1)}return ae}var vmt=Ln();const ig=class ig extends un{constructor(e){console.log("node created."),super(Hdt({style:ig.defaultStyleProps},e)),this.level=0,this.keyOpacity=0,this.imageOpacity=0,this.lastKeyOpacity=0,this.lastImageOpacity=0,this.emergeStep=.01,this.disappearStep=.02,this.initialized=!1,this.disappear=!1,this.imageMode=!1,this.emergeEnd=!1,this.leafOpacityIncreaseFlag=1,this.maxLevelThisGraph=0,this.isLeaf=!1,this.leafOpacityUpdate=!0,this.currentEmergeLevel=0,this.currentDisappearLevel=0,this.targetEdges=null,this.sourceEdges=null,e.style.opacity=0,e.style.labelOpacity=0;const r=this.context.model.getNodeData([this.id])[0];this.keyOpacity=0,this.imageOpacity=0,this.lastKeyOpacity=0,this.lastImageOpacity=0,this.disappear=!1,this.imageMode=!1,this.emergeEnd=!1,this.level=r.data.level,this.initialized=!1,this.currentEmergeLevel=0,this.currentDisappearLevel=0,this.maxLevelThisGraph=this.context.graph.maxLevel,this.isLeaf=r.data.type==="leaf",this.leafOpacityUpdate=!0,this.context.graph.on("NewGraph:Initialize",i=>{this.keyOpacity=0,this.imageOpacity=0,this.disappear=!1,this.imageMode=!1,this.emergeEnd=!1}),this.context.graph.on("NewGraph:EnterTextState",i=>{this.disappear||(this.imageMode&&(this.imageOpacity=0,this.keyOpacity=0,this.emergeEnd=!1),this.imageMode=!1)}),this.context.graph.on("NewGraph:EnterImageState",i=>{this.disappear||(this.imageMode||(this.imageOpacity=0,this.keyOpacity=0,this.emergeEnd=!1),this.imageMode=!0)}),this.context.graph.on("NewGraph:Disappear",i=>{this.disappear=!0}),this.context.graph.on("NewGraph:EmergeLevelUpdate",i=>{this.currentEmergeLevel=i}),this.context.graph.on("NewGraph:DisappearLevelUpdate",i=>{this.currentDisappearLevel=i}),this.context.graph.on("MixedNode:emergeEnd",i=>{this.isLeaf&&(this.emergeEnd=!0)}),this.targetEdges=new Array,this.sourceEdges=new Array;for(const i of this.context.graph.getEdgeData())i.target===this.id&&this.targetEdges.push(i),i.source===this.id&&this.sourceEdges.push(i)}drawKeyShape(e,t){return this.upsert("key",Zi,this.getKeyStyle(e),t)}getKeyStyle(e){if(typeof this.initialized>"u")return{...super.getKeyStyle(e),opacity:0,r:0};let t=0,r=0;return this.imageMode?(t=0,r=16):(t=this.keyOpacity,r=Math.min(...this.getSize(e))/2),{...super.getKeyStyle(e),opacity:t,r}}getIconStyle(e){const t=super.getIconStyle(e),{r}=this.getShape("key").attributes,i=r*2*x9;return t?{width:i,height:i,...t}:!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Jdt(e,t)}getImageStyle(e){if(typeof this.initialized>"u"){const[a,s]=[48,48];return{...super.getKeyStyle(e),opacity:0,width:a,height:s,x:-a/2,y:-s/2}}let t=0;this.imageMode?t=this.imageOpacity:t=0;const[r,i]=[48,48];return{...super.getKeyStyle(e),opacity:t,width:r,height:i,x:-r/2,y:-i/2}}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;if(!this.initialized)return{placement:"center",maxWidth:10,offsetX:0,offsetY:0,text:"",opacity:0};let t=0;this.imageMode||typeof this.initialized>"u"?t=0:t=this.keyOpacity;const{placement:r,maxWidth:i,offsetX:a,offsetY:s,...o}=ze(this.getGraphicStyle(e),"label");o.opacity=t;const c=this.getShape("key").getLocalBounds();return Object.assign(vmt.getTextStyleByPlacement(c,r,a,s),{wordWrapWidth:v0t(c,i)},o)}drawImageShape(e,t){return this.upsert("image",Ds,this.getImageStyle(e),t)}updateOpacity(){if(this.imageMode||(this.disappear?this.currentDisappearLevel>=this.level&&this.keyOpacity>0&&(this.keyOpacity-=this.disappearStep,this.keyOpacity<0&&(this.keyOpacity=0)):(this.currentEmergeLevel>=this.level&&this.keyOpacity<.8&&!this.emergeEnd&&(this.keyOpacity+=this.emergeStep,this.keyOpacity>.8&&(this.keyOpacity=.8,this.level===this.maxLevelThisGraph&&!this.emergeEnd&&this.context.graph.emit("MixedNode:emergeEnd"))),this.isLeaf&&this.emergeEnd&&(this.leafOpacityUpdate&&(this.keyOpacity+=this.emergeStep*this.leafOpacityIncreaseFlag),this.keyOpacity<0&&(this.keyOpacity=0,this.leafOpacityUpdate=!1,setTimeout(()=>{this.leafOpacityIncreaseFlag=1,this.leafOpacityUpdate=!0},.2*1e3)),this.keyOpacity>.8&&(this.keyOpacity=.8,this.leafOpacityUpdate=!1,setTimeout(()=>{this.leafOpacityIncreaseFlag=-1,this.leafOpacityUpdate=!0},5*1e3))))),this.imageMode&&(this.disappear?this.currentDisappearLevel>=this.level&&this.imageOpacity>0&&(this.imageOpacity-=this.disappearStep,this.imageOpacity<0&&(this.imageOpacity=0)):this.currentEmergeLevel>=this.level&&this.imageOpacity<.8&&(this.imageOpacity+=this.emergeStep,this.imageOpacity>.8&&(this.imageOpacity=.8))),this.disappear)for(const e of this.sourceEdges)e.style.opacity=this.imageMode?this.imageOpacity:this.keyOpacity;else for(const e of this.targetEdges)e.style.opacity=this.imageMode?this.imageOpacity:this.keyOpacity}render(e,t){if(!this.destroyed){if(!this.initialized){if(this.initialized===void 0)return super.render(e,t);this.initialized===!1&&(this.initialized=!0)}this.updateOpacity(),this.lastKeyOpacity!==this.keyOpacity&&(this.lastKeyOpacity=this.keyOpacity,this.drawKeyShape(e,t),this.drawLabelShape(e,t)),this.lastImageOpacity!==this.imageOpacity&&(this.lastImageOpacity=this.imageOpacity,this.drawImageShape(e,t))}}destroy(){this.targetEdges=null,this.sourceEdges=null,super.destroy()}};ig.defaultStyleProps={size:32};let w2=ig;const mmt={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class ymt{constructor(e={}){this.options=e,this.id="extended-force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options={...mmt,...e}}async execute(e,t){return this.genericForceLayout(!1,e,t)}async assign(e,t){await this.genericForceLayout(!0,e,t)}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<e;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(r=>this.lastGraph.mergeNodeData(r.id,{x:r.data.x,y:r.data.y,z:this.options.dimensions===3?r.data.z:void 0})),t}async genericForceLayout(e,t,r){const i={...this.options,...r},a=t.getAllNodes(),s=t.getAllEdges(),o=this.formatOptions(i,t),{dimensions:c,width:l,height:u,nodeSize:h,getMass:f,nodeStrength:d,edgeStrength:p,linkDistance:g}=o,v=a.map((E,P)=>({...E,data:{...E.data,x:rt(E.data.x)?E.data.x:Math.random()*l,y:rt(E.data.y)?E.data.y:Math.random()*u,z:rt(E.data.z)?E.data.z:Math.random()*Math.sqrt(l*u),size:h(E)||30,mass:f(E),nodeStrength:d(E)}})),m=s.map(E=>({...E,data:{...E.data,edgeStrength:p(E),linkDistance:g(E,t.getNode(E.source),t.getNode(E.target))}}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const y={};a.forEach((E,P)=>{y[E.id]={x:0,y:0,z:0}});const b=new qe({nodes:v,edges:m});this.formatCentripetal(o,b);const{maxIteration:w,minMovement:x,onTick:S}=o;if(this.lastLayoutNodes=v,this.lastLayoutEdges=m,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=b,this.lastOptions=o,this.lastVelMap=y,typeof window>"u")return;let _=0;return new Promise(E=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&E({nodes:Ex(t,v),edges:s}),this.runOneStep(b,t,_,y,o),this.updatePosition(t,b,y,o),e&&v.forEach(P=>t.mergeNodeData(P.id,{x:P.data.x,y:P.data.y,z:c===3?P.data.z:void 0})),S==null||S({nodes:Ex(t,v),edges:s}),_++,(_>=w||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),E({nodes:Ex(t,v),edges:s}))},20),this.running=!0})}formatOptions(e,t){const r={...e},{width:i,height:a,getMass:s,nodeSize:o}=e;r.width=!i&&typeof window<"u"?window.innerWidth:i,r.height=!a&&typeof window<"u"?window.innerHeight:a,e.center||(r.center=[r.width/2,r.height/2]),s||(r.getMass=h=>{let f=1;rt(h==null?void 0:h.data.mass)&&(f=h==null?void 0:h.data.mass);const d=t.getDegree(h.id,"both");return!d||d<5?f:d*5*f});const c=ir(0,e.nodeSpacing);let l;o?ft(o)?l=h=>o(h)+c(h):en(o)?l=h=>{const f=o;return Math.max(f[0],f[1])+c(h)}:l=h=>o+c(h):l=h=>{const{size:f}=(h==null?void 0:h.data)||{};return f?en(f)?Math.max(f[0],f[1])+c(h):ne(f)?Math.max(f.width,f.height)+c(h):f+c(h):10+c(h)},r.nodeSize=l;const u=e.linkDistance?ir(1,e.linkDistance):h=>1+r.nodeSize(t.getNode(h.source))+r.nodeSize(t.getNode(h.target));return r.linkDistance=u,r.nodeStrength=ir(1,e.nodeStrength),r.edgeStrength=ir(1,e.edgeStrength),r}formatCentripetal(e,t){const{dimensions:r,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:c,nodeClusterBy:l}=e,u=t.getAllNodes(),h=i||{leaf:2,single:2,others:1,center:m=>({x:a[0],y:a[1],z:r===3?a[2]:void 0})};typeof s!="function"&&(e.clusterNodeStrength=m=>s);let f,d;if(o&&l&&(f=Ak(t,l),d=Array.from(new Set(u==null?void 0:u.map(m=>m.data[l])))||[],e.centripetalOptions=Object.assign(h,{single:100,leaf:m=>{const{siblingLeaves:y,sameTypeLeaves:b}=f[m.id]||{};return(b==null?void 0:b.length)===(y==null?void 0:y.length)||(d==null?void 0:d.length)===1?1:e.clusterNodeStrength(m)},others:1,center:m=>{const y=t.getDegree(m.id,"both");if(!y)return{x:100,y:100,z:0};let b;if(y===1){const{sameTypeLeaves:w=[]}=f[m.id]||{};w.length===1?b=void 0:w.length>1&&(b=Nk(w))}else b=void 0;return{x:b==null?void 0:b.x,y:b==null?void 0:b.y,z:b==null?void 0:b.z}}})),c&&l){f||(f=Ak(t,l)),d||(d=Array.from(new Set(u.map(y=>y.data[l])))),d=d.filter(y=>y!==void 0);const m={};d.forEach(y=>{const b=u.filter(w=>w.data[l]===y).map(w=>t.getNode(w.id));m[y]=Nk(b)}),e.centripetalOptions=Object.assign(h,{single:y=>e.clusterNodeStrength(y),leaf:y=>e.clusterNodeStrength(y),others:y=>e.clusterNodeStrength(y),center:y=>{const b=m[y.data[l]];return{x:b==null?void 0:b.x,y:b==null?void 0:b.y,z:b==null?void 0:b.z}}})}const{leaf:p,single:g,others:v}=e.centripetalOptions||{};p&&typeof p!="function"&&(e.centripetalOptions.leaf=()=>p),g&&typeof g!="function"&&(e.centripetalOptions.single=()=>g),v&&typeof v!="function"&&(e.centripetalOptions.others=()=>v)}runOneStep(e,t,r,i,a){const s={},o=e.getAllNodes(),c=e.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:l}=a;if(this.calRepulsive(e,s,a),c&&this.calAttractive(e,s,a),this.calGravity(e,t,s,a),this.updateVelocity(e,s,i,a),l){const u=this.calTotalEnergy(s,o);l({energy:u,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:r})}}calTotalEnergy(e,t){if(!(t!=null&&t.length))return 0;let r=0;return t.forEach((i,a)=>{const s=e[i.id].x,o=e[i.id].y,c=this.options.dimensions===3?e[i.id].z:0,l=s*s+o*o+c*c,{mass:u=1}=i.data;r+=u*l*.5}),r}calRepulsive(e,t,r){const{dimensions:i,factor:a,coulombDisScale:s}=r;A5(e,a,s*s,t,i)}calAttractive(e,t,r){const{dimensions:i,nodeSize:a}=r;e.getAllEdges().forEach((s,o)=>{const{source:c,target:l}=s,u=e.getNode(c),h=e.getNode(l);if(!u||!h)return;let f=h.data.x-u.data.x,d=h.data.y-u.data.y,p=i===3?h.data.z-u.data.z:0;!f&&!d&&(f=Math.random()*.01,d=Math.random()*.01,i===3&&!p&&(p=Math.random()*.01));const g=Math.sqrt(f*f+d*d+p*p);if(g<a(u)+a(h))return;const v=f/g,m=d/g,y=p/g,{linkDistance:b=200,edgeStrength:w=200}=s.data||{},S=(b-g)*w,_=u.data.mass||1,E=h.data.mass||1,P=1/_,O=1/E,C=v*S,M=m*S,T=y*S;t[c].x-=C*P,t[c].y-=M*P,t[c].z-=T*P,t[l].x+=C*O,t[l].y+=M*O,t[l].z+=T*O})}calGravity(e,t,r,i){const{getCenter:a}=i,s=e.getAllNodes(),o=t.getAllNodes(),c=t.getAllEdges(),{width:l,height:u,center:h,gravity:f,centripetalOptions:d}=i;s&&s.forEach(p=>{const{id:g,data:v}=p,{mass:m,x:y,y:b,z:w}=v,x=t.getNode(g);let S=0,_=0,E=0,P=f;const O=e.getDegree(g,"in"),C=e.getDegree(g,"out"),M=e.getDegree(g,"both"),T=a==null?void 0:a(x,M);if(T){const[R,D,B]=T;S=y-R,_=b-D,P=B}else S=y-h[0],_=b-h[1],E=w-h[2];if(P&&(r[g].x-=P*S/m,r[g].y-=P*_/m,r[g].z-=P*E/m),d){const{leaf:R,single:D,others:B,center:j}=d,{x:L,y:$,z:V,centerStrength:W}=(j==null?void 0:j(x,o,c,l,u))||{x:0,y:0,z:0,centerStrength:0};if(!rt(L)||!rt($))return;const Y=(y-L)/m,U=(b-$)/m,J=(w-V)/m;if(W&&(r[g].x-=W*Y,r[g].y-=W*U,r[g].z-=W*J),M===0){const ht=D(x);if(!ht)return;r[g].x-=ht*Y,r[g].y-=ht*U,r[g].z-=ht*J;return}if(O===0||C===0){const ht=R(x,o,c);if(!ht)return;r[g].x-=ht*Y,r[g].y-=ht*U,r[g].z-=ht*J;return}const at=B(x);if(!at)return;r[g].x-=at*Y,r[g].y-=at*U,r[g].z-=at*J}})}updateVelocity(e,t,r,i){const{damping:a,maxSpeed:s,interval:o,dimensions:c}=i,l=e.getAllNodes();l!=null&&l.length&&l.forEach(u=>{const{id:h}=u;let f=(r[h].x+t[h].x*o)*a||.01,d=(r[h].y+t[h].y*o)*a||.01,p=c===3?(r[h].z+t[h].z*o)*a||.01:0;const g=Math.sqrt(f*f+d*d+p*p);if(g>s){const v=s/g;f=v*f,d=v*d,p=v*p}r[h]={x:f,y:d,z:p}})}updatePosition(e,t,r,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,c=t.getAllNodes();if(!(c!=null&&c.length)){this.judgingDistance=0;return}let l=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),c.forEach(u=>{const{id:h}=u,f=e.getNode(h);if(rt(f.data.fx)&&rt(f.data.fy)){t.mergeNodeData(h,{x:f.data.fx,y:f.data.fy,z:o===3?f.data.fz:void 0});return}const d=r[h].x*s,p=r[h].y*s,g=o===3?r[h].z*s:0;t.mergeNodeData(h,{x:u.data.x+d,y:u.data.y+p,z:u.data.z+g});const v=Math.sqrt(d*d+p*p+g*g);switch(a){case"max":this.judgingDistance<v&&(this.judgingDistance=v);break;case"min":this.judgingDistance>v&&(this.judgingDistance=v);break;default:l=l+v;break}}),(!a||a==="mean")&&(this.judgingDistance=l/c.length)}}const Ak=(n,e)=>{const t=n.getAllNodes();if(!(t!=null&&t.length))return{};const r={};return t.forEach((i,a)=>{n.getDegree(i.id,"both")===1&&(r[i.id]=bmt(n,"leaf",i,e))}),r},bmt=(n,e,t,r)=>{const i=n.getDegree(t.id,"in"),a=n.getDegree(t.id,"out");let s=t,o=[];i===0?(s=n.getSuccessors(t.id)[0],o=n.getNeighbors(s.id)):a===0&&(s=n.getPredecessors(t.id)[0],o=n.getNeighbors(s.id)),o=o.filter(l=>n.getDegree(l.id,"in")===0||n.getDegree(l.id,"out")===0);const c=Emt(n,e,r,t,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:c}},Emt=(n,e,t,r,i)=>{const a=r.data[t]||"";let s=(i==null?void 0:i.filter(o=>o.data[t]===a))||[];return s=s.filter(o=>n.getDegree(o.id,"in")===0||n.getDegree(o.id,"out")===0),s},Nk=n=>{const e={x:0,y:0};n.forEach(r=>{const{x:i,y:a}=r.data;e.x+=i||0,e.y+=a||0});const t=n.length||1;return{x:e.x/t,y:e.y/t}},Ex=(n,e)=>e.map(t=>{const{id:r,data:i}=t,a=n.getNode(r);return{...a,data:{...a.data,x:i.x,y:i.y,z:i.z}}});C_(Uo.NODE,"mixed-node",w2);C_(Uo.LAYOUT,"extended-force",ymt);const xmt=1e6;function X_(n){let e=10;switch(n.data.level){case 0:e=150;break;case 1:e=55;break;case 2:e=30;break;case 3:e=20;break}return e}function wmt(n){return .02*((n.data.level+1)*.5)*X_(n)}function hF(n){let e=["#eaf2ff","#90aeff","#5187fb"],t=n.data.level;return t>e.length-1&&(t=e.length-1),e[t]}function Smt(n){if(n.data.level===0)return"#90aeff";let e=hF(n);return Mt(e).darken(1).hex()}function Z_(n){const e=n.data.level;return e===0?35:e===1&&n.data.text.length===2?18:12}function _mt(n){const e=n.data.level,t=Z_(n);if(dF(n)==="center"){if(e===0)return t*.4;const r=n.data.text;if(e===1&&r.length<=2)return t*.25;if(e>=2)return t*.1}return 0}function Omt(n){return"#000000"}function fF(n){if(n.data.level===0)return"center";const e=n.data.text;if(e.length==1)return"center";const t=X_(n),r=Z_(n);return e.length*r<t?"center":"right"}function dF(n){return fF(n)==="right"?"left":"center"}function Pmt(n){return n.data.text}const Cmt={type:"mixed-node",style:{size:X_,fill:hF,labelText:Pmt,labelTextAlign:dF,labelPlacement:fF,labelOffsetY:_mt,labelMaxWidth:200,labelFill:Omt,labelBackground:!1,labelFontSize:Z_,stroke:Smt,lineWidth:wmt,src:n=>n.data.src,droppable:!1,draggable:!1,opacity:0,labelOpacity:0}},Mmt={type:"line",style:{startArrow:!1,endArrow:!1,lineWidth:.5,stroke:"#557bd8"}},Tmt={type:"extended-force",frameTimeInterval:40,speed:8,dimensions:2,maxIteration:xmt,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:10,minMovement:.001,interval:.02,linkDistance:200,preventOverlap:!0,nodeSpacing:10,distanceThresholdMode:"mean",animation:!0};function Amt(n){return n[Math.floor(Math.random()*n.length)]}async function is(n){return new Promise(e=>setTimeout(e,n*1e3))}class Nmt extends v2{constructor(e){super(e),this.maxLevel=0,this.maxLevel=this.getNodeData().map(t=>t.data.level).reduce((t,r)=>Math.max(t,r));for(const t of this.getNodeData())t.data.src=e.dynamicImageSource.call();for(const t of this.getEdgeData())t.style.opacity=0}async render(){return super.render()}async animation(){this.emit("NewGraph:Initialize"),this.emit("NewGraph:EnterTextState");for(let a=0;a<this.maxLevel+1;a++)this.emit("NewGraph:EmergeLevelUpdate",a),await is(3);await is(30),this.emit("NewGraph:EnterImageState"),await is(15),this.emit("NewGraph:EnterTextState"),await is(30),this.emit("NewGraph:EnterImageState"),await is(15),this.emit("NewGraph:Disappear");for(let a=0;a<this.maxLevel+1;a++)this.emit("NewGraph:DisappearLevelUpdate",a),await is(.8);await is(3)}destroy(){return console.log("destroy Graph."),super.destroy()}}const Rmt={class:"mountNodeParent"},kmt=BF({__name:"KnowledgeGraph",setup(n){const e=()=>location.reload(),t=FF(null),r=$F();let i=null,a=null,s="";const o=async c=>{if(r.currentRoute.value.name!=="KnowledgeGraph")return;const l=JSON.parse(c.data);if(l.type==="heartbeat"){a.send("1");return}l.type==="command"&&l.operation==="update"&&(console.log("update command received."),s!==l.content&&e())};return zF(async()=>{var h;if(a=await kF(),a&&(a.onopen=async f=>{console.log("ws connected.")},a.onmessage=o),s=(await DF()).content,!s)return;const u=(await LF(s)).content;if(u!=null&&u.data&&((h=u==null?void 0:u.images)==null?void 0:h.length)>0){const f=[];for(const d of u.images)f.push(IF(d));i=new Nmt({container:t.value,autoResize:!1,padding:0,animation:!1,background:"#ffffff",dynamicImageSource:()=>Amt(f),data:u.data,node:Cmt,edge:Mmt,layout:Tmt,behaviors:[]}),await Promise.race([i.render(),i.animation()]),e()}}),jF(async()=>{a&&a.readyState===WebSocket.OPEN&&a.close(),i==null||i.destroy()}),(c,l)=>(qF(),GF("div",Rmt,[VF("div",{ref_key:"mountNode",ref:t,class:"mountNode"},null,512)]))}}),Qmt=WF(kmt,[["__scopeId","data-v-2276e25e"]]);export{Qmt as default};
